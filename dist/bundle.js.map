{"version":3,"file":"bundle.js","sources":["../src/lib/utils/validator.js","../src/lib/utils/invariants.js","../src/lib/furmly_base.js","../src/lib/furmly_input.js","../src/lib/utils/memcache.js","../src/lib/actions/constants.js","../src/lib/reducers/navigation.js","../src/lib/action-enhancers/index.js","../src/lib/actions/index.js","../src/lib/furmly_view.js","../src/lib/furmly_container.js","../src/lib/furmly_process.js","../src/lib/furmly_section.js","../src/lib/utils/view.js","../src/lib/furmly_select.js","../src/lib/furmly_selectset.js","../src/lib/furmly_list.js","../src/lib/furmly_hidden.js","../src/lib/furmly_nav.js","../src/lib/furmly_image.js","../src/lib/furmly_grid.js","../src/lib/furmly_htmlview.js","../src/lib/furmly_fileupload.js","../src/lib/furmly_actionview.js","../src/lib/furmly_label.js","../src/lib/furmly_webview.js","../src/lib/furmly_command.js","../src/lib/index.js","../src/furmly_mapping.js","../src/lib/reducers/view.js","../src/lib/reducers/index.js","../src/lib/utils/formatExpression.js","../src/lib/utils/index.js"],"sourcesContent":["export default class Validator {\r\n\tconstructor(context) {\r\n\t\tthis.run = this.run.bind(context);\r\n\t}\r\n\trun() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (\r\n\t\t\t\t(!this.props.validators || !this.props.validators.length) &&\r\n\t\t\t\t(!this.props.asyncValidators ||\r\n\t\t\t\t\t!this.props.asyncValidators.length)\r\n\t\t\t)\r\n\t\t\t\treturn resolve();\r\n\r\n\t\t\tif (this.props.validators) {\r\n\t\t\t\tlet result = this.props.validators.reduce(\r\n\t\t\t\t\t(current, element) => {\r\n\t\t\t\t\t\t// statements\r\n\t\t\t\t\t\tlet valid = current.valid,\r\n\t\t\t\t\t\t\terror = \"\";\r\n\t\t\t\t\t\tswitch (element.validatorType) {\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.REQUIRED:\r\n\t\t\t\t\t\t\t\tvalid = this.hasValue();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.MAXLENGTH:\r\n\t\t\t\t\t\t\t\tvalid = this.isLessThanMaxLength(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.MINLENGTH:\r\n\t\t\t\t\t\t\t\tvalid = this.isGreaterThanMinLength(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.REGEX:\r\n\t\t\t\t\t\t\t\tvalid = this.matchesRegex(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof valid == \"string\") {\r\n\t\t\t\t\t\t\terror = valid;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\tcurrent.errors.push(error),\r\n\t\t\t\t\t\t\t\t(current.valid = false),\r\n\t\t\t\t\t\t\t\tcurrent\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn current;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ errors: [], valid: true }\r\n\t\t\t\t);\r\n\t\t\t\tif (!result.valid) {\r\n\t\t\t\t\tthis.setState({ errors: result.errors });\r\n\t\t\t\t\treturn reject();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.props.asyncValidators &&\r\n\t\t\t\tthis.props.asyncValidators.length &&\r\n\t\t\t\t!this.props.valid\r\n\t\t\t) {\r\n\t\t\t\treturn reject();\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({ errors: null });\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport const VALIDATOR_TYPES = {\r\n\tREQUIRED: \"REQUIRED\",\r\n\tMAXLENGTH: \"MAXLENGTH\",\r\n\tMINLENGTH: \"MINLENGTH\",\r\n\tREGEX: \"REGEX\"\r\n};\r\n","import { Component } from \"react\";\r\nexport default {\r\n\tvalidComponent: function(component, name) {\r\n\t\tif (!component) throw new Error(`${name} cannot be null`);\r\n\t\tif (\r\n\t\t\t!Component.prototype.isPrototypeOf(component) &&\r\n\t\t\ttypeof component !== \"function\"\r\n\t\t)\r\n\t\t\tthrow new Error(\r\n\t\t\t\t`${name} must either be a valid react Component or a Function`\r\n\t\t\t);\r\n\t\treturn true;\r\n\t}\r\n};\r\n","import React from \"react\";\r\nimport debug from \"debug\";\r\nimport hoistNonReactStatic from \"hoist-non-react-statics\";\r\n\r\nexport default WrappedComponent => {\r\n  class HOCComponent extends React.Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.log = this.log.bind(this);\r\n    }\r\n    componentDidMount() {\r\n      this.logger = debug(`furmly-client:${this._constructor.name}`);\r\n      this.props.log(\"componentDidMount\");\r\n    }\r\n    componentWillUnmount() {\r\n      this.props.log(\"componentWillUnmount\");\r\n      this.logger = null;\r\n    }\r\n    log(m) {\r\n      this.logger(`${m}:::${this.props.name}`);\r\n    }\r\n    render() {\r\n      this.props.log(\"render\");\r\n      return <WrappedComponent {...this.props} log={this.log} />;\r\n    }\r\n  }\r\n  hoistNonReactStatic(HOCComponent, WrappedComponent);\r\n  return HOCComponent;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\nimport withLogger from \"./furmly_base\";\r\n\r\n/**\r\n * Higher order function that recieves Platform specific implementation of Input\r\n * @param  {Function} Input Input class\r\n * @return {Function}       Wrapped class\r\n */\r\nexport default (LabelWrapper, Input, DatePicker, Checkbox) => {\r\n  invariants.validComponent(LabelWrapper, \"LabelWrapper\");\r\n  invariants.validComponent(Input, \"Input\");\r\n  invariants.validComponent(DatePicker, \"DatePicker\");\r\n  invariants.validComponent(Checkbox, \"Checkbox\");\r\n  class FurmlyInput extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {};\r\n      this.setDefault = this.setDefault.bind(this);\r\n      this.valueChanged = this.valueChanged.bind(this);\r\n      this.runValidators = this.runValidators.bind(this);\r\n      this.hasValue = this.hasValue.bind(this);\r\n      this.isLessThanMaxLength = this.isLessThanMaxLength.bind(this);\r\n      this.isGreaterThanMinLength = this.isGreaterThanMinLength.bind(this);\r\n      this.matchesRegex = this.matchesRegex.bind(this);\r\n      this.runAsyncValidators = this.runAsyncValidators.bind(this);\r\n      this.props.validator.validate = () => {\r\n        return this.runValidators();\r\n      };\r\n      this.toValueChanged = this.toValueChanged.bind(this);\r\n      this.formatDateRange = this.formatDateRange.bind(this);\r\n      this.fromValueChanged = this.fromValueChanged.bind(this);\r\n      this.setDateFromRange = this.setDateFromRange.bind(this);\r\n      this.isDateRange = this.isDateRange.bind(this);\r\n    }\r\n    componentDidMount() {\r\n      this._mounted = true;\r\n      setTimeout(() => {\r\n        if (this._mounted) {\r\n          this.setDefault();\r\n          this.setDateFromRange();\r\n        }\r\n      }, 0);\r\n    }\r\n    componentWillReceiveProps(next) {\r\n      if (next.component_uid !== this.props.component_uid) {\r\n        this.setDefault(next);\r\n      }\r\n      if (\r\n        next.value &&\r\n        this.props.value !== next.value &&\r\n        this.isDateRange(next)\r\n      ) {\r\n        this.setDateFromRange(next);\r\n      }\r\n    }\r\n    componentWillUnmount() {\r\n      this._mounted = false;\r\n    }\r\n\r\n    isDateRange(props = this.props) {\r\n      return props.args && props.args.config && props.args.config.isRange;\r\n    }\r\n\r\n    setDateFromRange(props = this.props) {\r\n      if (props.value && this.isDateRange()) {\r\n        let [fromValue, toValue] = props.value.split(\"-\");\r\n        this.setState({\r\n          fromValue: new Date(fromValue),\r\n          toValue: new Date(toValue)\r\n        });\r\n      }\r\n    }\r\n    runValidators() {\r\n      return new ValidationHelper(this).run();\r\n    }\r\n    runAsyncValidators(value) {\r\n      this.props.runAsyncValidator(\r\n        this.props.asyncValidators[0],\r\n        value,\r\n        this.props.asyncValidators[0] + this.props.component_uid\r\n      );\r\n    }\r\n    hasValue() {\r\n      return !!this.props.value || \"is required\";\r\n    }\r\n    isRequired() {\r\n      return (\r\n        this.props.validators &&\r\n        this.props.validators.filter(\r\n          x => x.validatorType == VALIDATOR_TYPES.REQUIRED\r\n        ).length > 0\r\n      );\r\n    }\r\n    isLessThanMaxLength(element) {\r\n      return (\r\n        (this.props.value && this.props.value.length <= element.args.max) ||\r\n        element.error ||\r\n        \"The maximum number of letters/numbers is \" + element.args.max\r\n      );\r\n    }\r\n    isGreaterThanMinLength(element) {\r\n      return (\r\n        (this.props.value && this.props.value.length >= element.args.min) ||\r\n        element.error ||\r\n        \"The minimum number of letters/numbers is\" + element.args.min\r\n      );\r\n    }\r\n    matchesRegex(element) {\r\n      return (\r\n        new RegExp(element.args.exp).test(this.props.value) ||\r\n        element.error ||\r\n        \"Invalid entry\"\r\n      );\r\n    }\r\n    valueChanged(value) {\r\n      this.props.valueChanged({ [this.props.name]: value });\r\n      if (this.props.asyncValidators && this.props.asyncValidators.length)\r\n        this.runAsyncValidators(value);\r\n\r\n      this.setState({ errors: [] });\r\n    }\r\n    fromValueChanged(fromValue) {\r\n      if (this.state.toValue && fromValue < this.state.toValue) {\r\n        this.valueChanged(this.formatDateRange(fromValue));\r\n      } else {\r\n        this.valueChanged(null);\r\n      }\r\n      this.setState({\r\n        fromValue,\r\n        toValue: fromValue > this.state.toValue ? null : this.state.toValue\r\n      });\r\n    }\r\n    formatDateRange(from = this.state.fromValue, to = this.state.toValue) {\r\n      return `${from.toLocaleDateString()} - ${to.toLocaleDateString()}`;\r\n    }\r\n    toValueChanged(toValue) {\r\n      if (this.state.fromValue) {\r\n        this.valueChanged(this.formatDateRange(this.state.fromValue, toValue));\r\n      }\r\n      this.setState({\r\n        toValue\r\n      });\r\n    }\r\n    getDateConfig(args) {\r\n      let result = {};\r\n      if (args.config) {\r\n        args = args.config;\r\n        if (args.max) {\r\n          if (args.max == \"TODAY\") result.maxDate = new Date();\r\n          else result.maxDate = new Date(args.maxConfig.date);\r\n        }\r\n        if (args.min) {\r\n          if (args.min == \"TODAY\") result.minDate = new Date();\r\n          else result.minDate = new Date(args.minConfig.date);\r\n        }\r\n        if (args.isRange) {\r\n          result.toValueChanged = this.toValueChanged;\r\n          result.fromValueChanged = this.fromValueChanged;\r\n          result.toValue = this.state.toValue;\r\n          result.fromValue = this.state.fromValue;\r\n        }\r\n        result.isRange = args.isRange;\r\n      }\r\n\r\n      return result;\r\n    }\r\n    setDefault(props = this.props) {\r\n      if (!props.value && props.args && props.args.default)\r\n        this.valueChanged(props.args.default);\r\n    }\r\n    render() {\r\n      /*jshint ignore:start */\r\n      let args = this.props.args,\r\n        Result;\r\n      const { type, valueChanged, ...passThrough } = this.props;\r\n      if (\r\n        !args ||\r\n        !args.type ||\r\n        args.type == \"text\" ||\r\n        args.type == \"number\" ||\r\n        args.type == \"password\"\r\n      ) {\r\n        Result = Input;\r\n        args = args || { type: \"text\" };\r\n      }\r\n      if (args.type == \"checkbox\") Result = Checkbox;\r\n\r\n      if (args.type == \"date\") {\r\n        Result = DatePicker;\r\n        Object.assign(passThrough, this.getDateConfig(args));\r\n      }\r\n      return (\r\n        <LabelWrapper\r\n          value={this.props.label}\r\n          inner={\r\n            <Result\r\n              type={args.type}\r\n              {...passThrough}\r\n              disabled={args && args.disabled}\r\n              required={this.isRequired()}\r\n              value={this.props.value}\r\n              errors={this.state.errors}\r\n              valueChanged={this.valueChanged}\r\n            />\r\n          }\r\n        />\r\n      );\r\n      /*jshint ignore:end */\r\n    }\r\n  }\r\n  FurmlyInput.propTypes = {\r\n    valueChanged: PropTypes.func\r\n  };\r\n  return withLogger(FurmlyInput);\r\n};\r\n","export default class MemCache {\r\n\tconstructor(opts) {\r\n\t\tthis.defaultTTL = (opts && opts.ttl) || 300000;\r\n\t\tthis.store = this.store.bind(this);\r\n\t\tthis.get = this.get.bind(this);\r\n\t\tthis._items = {};\r\n\t}\r\n\tgetKey(obj) {\r\n\t\tswitch (typeof obj) {\r\n\t\t\tcase \"string\":\r\n\t\t\t\treturn obj;\r\n\t\t\tcase \"object\":\r\n\t\t\t\treturn JSON.stringify(obj);\r\n\t\t\tcase \"undefined\":\r\n\t\t\t\tthrow \"Key cannot be null\";\r\n\t\t}\r\n\t}\r\n\thasKey(key) {\r\n\t\treturn this._items.hasOwnProperty(this.getKey(key));\r\n\t}\r\n\tget(key) {\r\n\t\tlet _key = this.getKey(key);\r\n\t\treturn (this._items[_key] && this._items[_key].value) || undefined;\r\n\t}\r\n\tstore(key, value, ttl = this.defaultTTL) {\r\n\t\tlet _key = this.getKey(key);\r\n\t\tif (this._items[_key]) {\r\n\t\t\tclearTimeout(this._items[_key].handle);\r\n\t\t}\r\n\t\tlet handle = setTimeout(this.remove.bind(this, _key), ttl);\r\n\t\tthis._items[_key] = { value, handle };\r\n\t}\r\n\tremove(key) {\r\n\t\tdelete this._items[key];\r\n\t}\r\n}\r\n","export default {\r\n\tVALUE_CHANGED: \"VALUE_CHANGED\",\r\n\tGET_REFRESH_TOKEN: \"GET_REFRESH_TOKEN\",\r\n\tGOT_REFRESH_TOKEN: \"GOT_REFRESH_TOKEN\",\r\n\tFAILED_TO_GET_REFRESH_TOKEN: \"FAILED_TO_GET_REFRESH_TOKEN\",\r\n\tCLEAR_STACK: \"CLEAR_STACK\",\r\n\tREPLACE_STACK: \"REPLACE_STACK\",\r\n\tSET_FURMLY_PARAMS: \"SET_FURMLY_PARAMS\",\r\n\tREMOVE_LAST_FURMLY_PARAMS: \"REMOVE_LAST_FURMLY_PARAMS\",\r\n\tALREADY_VISIBLE: \"ALREADY_VISIBLE\",\r\n\tCLEAR_DATA: \"CLEAR_DATA\",\r\n\tADD_NAVIGATION_CONTEXT: \"ADD_NAVIGATION_CONTEXT\",\r\n\tREMOVE_NAVIGATION_CONTEXT: \"REMOVE_NAVIGATION_CONTEXT\",\r\n\tOPEN_CONFIRMATION: \"OPEN_CONFIRMATION\",\r\n\tFETCHED_PROCESS: \"FETCHED_PROCESS\",\r\n\tFAILED_TO_FETCH_PROCESS: \"FAILED_TO_FETCH_PROCESS\",\r\n\tFETCHING_PROCESS: \"FETCHING_PROCESS\",\r\n\tSESSION_MAY_HAVE_EXPIRED: \"SESSION_MAY_HAVE_EXPIRED\",\r\n\tFETCHING_GRID: \"FETCHING_GRID\",\r\n\tGET_SINGLE_ITEM_FOR_GRID: \"GET_SINGLE_ITEM_FOR_GRID\",\r\n\tGOT_SINGLE_ITEM_FOR_GRID: \"GOT_SINGLE_ITEM_FOR_GRID\",\r\n\tERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID:\r\n\t\t\"ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID\",\r\n\tFURMLY_GET_MORE_FOR_GRID: \"FURMLY_GET_MORE_FOR_GRID\",\r\n\tERROR_WHILE_FETCHING_GRID: \"ERROR_WHILE_FETCHING_GRID\",\r\n\tFILTERED_GRID: \"FILTERED_GRID\",\r\n\tFURMLY_PROCESSOR_RUNNING: \"FURMLY_PROCESSOR_RUNNING\",\r\n\tFURMLY_PROCESSOR_RAN: \"FURMLY_PROCESSOR_RAN\",\r\n\tFURMLY_PROCESSOR_FAILED: \"FURMLY_PROCESSOR_FAILED\",\r\n\tFURMLY_PROCESS_RUNNING: \"FURMLY_PROCESS_RUNNING\",\r\n\tFURMLY_PROCESS_RAN: \"FURMLY_PROCESS_RAN\",\r\n\tFURMLY_PROCESS_FAILED: \"FURMLY_PROCESS_FAILED\",\r\n\tAPI_ERROR: \"API_ERROR\",\r\n\tSTART_FILE_UPLOAD: \"START_FILE_UPLOAD\",\r\n\tFILE_UPLOADED: \"FILE_UPLOADED\",\r\n\tFILE_UPLOAD_FAILED: \"FILE_UPLOAD_FAILED\",\r\n\tGET_PREVIEW: \"GET_PREVIEW\",\r\n\tGOT_PREVIEW: \"GOT_PREVIEW\",\r\n\tFAILED_TO_GET_PREVIEW: \"FAILED_TO_GET_PREVIEW\",\r\n\tGET_ITEM_TEMPLATE: \"GET_ITEM_TEMPLATE\",\r\n\tGOT_ITEM_TEMPLATE: \"GOT_ITEM_TEMPLATE\",\r\n\tFAILED_TO_GET_ITEM_TEMPLATE: \"FAILED_TO_GET_ITEM_TEMPLATE\",\r\n\tGET_FILTER_TEMPLATE: \"GET_FILTER_TEMPLATE\",\r\n\tGOT_FILTER_TEMPLATE: \"GOT_FILTER_TEMPLATE\",\r\n\tFAILED_TO_GET_FILTER_TEMPLATE: \"FAILED_TO_GET_FILTER_TEMPLATE\",\r\n\tADD_TO_OPEN_CHATS: \"ADD_TO_OPEN_CHATS\",\r\n\tNEW_MESSAGE: \"NEW_MESSAGE\",\r\n\tNEW_GROUP_MESSAGE: \"NEW_GROUP_MESSAGE\"\r\n};\r\n","import { default as ACTIONS } from \"../actions/constants\";\r\nimport _ from \"lodash\";\r\n\r\nexport default function(state = createStack(), action) {\r\n\tswitch (action.type) {\r\n\t\tcase ACTIONS.SET_FURMLY_PARAMS:\r\n\t\tcase ACTIONS.ALREADY_VISIBLE:\r\n\t\t\tif (hasScreenAlready(state, action.payload)) {\r\n\t\t\t\tmakeTop(state, action.payload);\r\n\t\t\t} else {\r\n\t\t\t\tstate.stack.push(action.payload);\r\n\t\t\t}\r\n\t\t\tvar stack = copyStack(state);\r\n\t\t\tcountRef(stack, stack.stack.length - 1, action.payload);\r\n\t\t\treturn Object.assign({}, state, stack);\r\n\t\tcase ACTIONS.REPLACE_STACK:\r\n\t\t\tvar stack = createStack();\r\n\t\t\tstack.stack = action.payload.slice();\r\n\t\t\tstack.stack.forEach(\r\n\t\t\t\tcountRef.bind(null, stack, stack.stack.length - 1)\r\n\t\t\t);\r\n\t\t\treturn Object.assign({}, state, stack);\r\n\r\n\t\tcase ACTIONS.REMOVE_LAST_FURMLY_PARAMS:\r\n\t\t\tvar stack = copyStack(state),\r\n\t\t\t\titem = stack.stack.pop();\r\n\t\t\tif (\r\n\t\t\t\titem &&\r\n\t\t\t\t(item.key == \"Furmly\" || item.$routeName == \"Furmly\") &&\r\n\t\t\t\tstack._references[item.params.id]\r\n\t\t\t) {\r\n\t\t\t\tlet refs = stack._references[item.params.id][0];\r\n\t\t\t\tstack._references[item.params.id][0] = refs - 1;\r\n\t\t\t\t//clean up.\r\n\t\t\t\tif (!stack._references[item.params.id][0])\r\n\t\t\t\t\tdelete stack._references[item.params.id];\r\n\t\t\t}\r\n\t\t\treturn Object.assign({}, state, stack);\r\n\t\tcase ACTIONS.CLEAR_STACK:\r\n\t\t\treturn createStack();\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nfunction copyStack(state) {\r\n\tlet stack = state.stack.slice(),\r\n\t\t_references = JSON.parse(JSON.stringify(state._references));\r\n\treturn { stack, _references };\r\n}\r\nfunction makeTop(state, curr) {\r\n\tstate.stack.push(\r\n\t\tstate.stack.splice(state._references[curr.params.id][1], 1)[0]\r\n\t);\r\n\tstate._references[curr.params.id][1] = state.stack.length - 1;\r\n}\r\nexport function hasScreenAlready(state, current) {\r\n\treturn state.stack.filter(x => _.isEqual(x, current)).length;\r\n}\r\n\r\nfunction addToStack(item, stack) {}\r\nfunction countRef(stack, index, e) {\r\n\tif (e.key == \"Furmly\" || e.$routeName == \"Furmly\") {\r\n\t\tif (stack._references[e.params.id]) {\r\n\t\t\tstack._references[e.params.id][0] =\r\n\t\t\t\tstack._references[e.params.id][0] + 1;\r\n\t\t} else {\r\n\t\t\tstack._references[e.params.id] = [1, index];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction createStack() {\r\n\tlet stack = [],\r\n\t\t_references = {};\r\n\treturn { stack, _references };\r\n}\r\n","import { hasScreenAlready } from \"../reducers/navigation\";\r\nexport const CHECK_FOR_EXISTING_SCREEN = Symbol(\"CHECK FOR EXISTING SCREEN\");\r\nconst enhancers = [\r\n\t{\r\n\t\tid: CHECK_FOR_EXISTING_SCREEN,\r\n\t\tmapState: function(state, action) {\r\n\t\t\tif (hasScreenAlready(state.furmly.navigation, action.payload))\r\n\t\t\t\treturn { hasScreenAlready: true, ...action.payload };\r\n\t\t}\r\n\t}\r\n];\r\nexport default () => enhancers;\r\n","import config from \"client_config\";\r\nimport CALL_API from \"call_api\";\r\nimport MemCache from \"../utils/memcache\";\r\nimport { CHECK_FOR_EXISTING_SCREEN } from \"../action-enhancers\";\r\nimport debug from \"debug\";\r\nimport { default as ACTIONS } from \"./constants\";\r\nconst log = debug(\"furmly-actions\");\r\n\r\nconst preDispatch = config.preDispatch,\r\n  preRefreshToken = config.preRefreshToken,\r\n  BASE_URL = global.BASE_URL || config.baseUrl,\r\n  throttled = {},\r\n  cache = new MemCache({ ttl: config.processorsCacheTimeout });\r\n\r\n\r\nexport const displayMessage = text => {\r\n  return {\r\n    type: \"SHOW_MESSAGE\",\r\n    message: text\r\n  };\r\n};\r\nfunction copy(value) {\r\n  return JSON.parse(JSON.stringify(value));\r\n}\r\n\r\nfunction getQueryParams(args) {\r\n  return args\r\n    ? \"?\" +\r\n      Object.keys(args)\r\n        .map((x, index, arr) => {\r\n          return `${x}=${encodeURIComponent(args[x]) +\r\n            (index != arr.length - 1 ? \"&\" : \"\")}`;\r\n        })\r\n        .join(\"\")\r\n    : \"\";\r\n}\r\nexport function setParams(args) {\r\n  return {\r\n    type: ACTIONS.SET_FURMLY_PARAMS,\r\n    [CHECK_FOR_EXISTING_SCREEN]: true,\r\n    payload: args\r\n  };\r\n}\r\n\r\nexport function replaceStack(args) {\r\n  return {\r\n    type: ACTIONS.REPLACE_STACK,\r\n    payload: args\r\n  };\r\n}\r\nexport function goBack(args) {\r\n  return { type: ACTIONS.REMOVE_LAST_FURMLY_PARAMS, payload: args };\r\n}\r\nexport function clearNavigationStack() {\r\n  return { type: ACTIONS.CLEAR_STACK };\r\n}\r\nexport function alreadyVisible(args) {\r\n  return {\r\n    type: ACTIONS.ALREADY_VISIBLE,\r\n    payload: args\r\n  };\r\n}\r\n\r\nexport function removeNavigationContext() {\r\n  return {\r\n    type: ACTIONS.REMOVE_NAVIGATION_CONTEXT\r\n  };\r\n}\r\n\r\nexport function addNavigationContext(args) {\r\n  return {\r\n    type: ACTIONS.ADD_NAVIGATION_CONTEXT,\r\n    payload: args\r\n  };\r\n}\r\nexport function openConfirmation(id, message, params) {\r\n  return {\r\n    type: ACTIONS.OPEN_CONFIRMATION,\r\n    payload: { message, params, id }\r\n  };\r\n}\r\nexport function valueChanged(payload) {\r\n  return {\r\n    type: ACTIONS.VALUE_CHANGED,\r\n    payload\r\n  };\r\n}\r\nfunction defaultError(dispatch, customType, meta, throttleEnabled) {\r\n  return {\r\n    type: customType || \"SHOW_MESSAGE\",\r\n    meta: (action, state, res) => {\r\n      if (customType && res.status !== 401)\r\n        dispatch(\r\n          displayMessage(\r\n            res.statusText ||\r\n              (res.headers &&\r\n                res.headers.map &&\r\n                res.headers.map.errormessage &&\r\n                res.headers.map.errormessage[0]) ||\r\n              \"Sorry , an error occurred while processing your request\"\r\n          )\r\n        );\r\n      log(\"an error occurred\");\r\n      log(action);\r\n      let args = action[CALL_API];\r\n      if (throttleEnabled) {\r\n        let throttleKey = args.endpoint + args.body;\r\n        throttled[throttleKey] = throttled[throttleKey] || [0, 1];\r\n        throttled[throttleKey][0] += config.processorRetryOffset || 500;\r\n        throttled[throttleKey][1] += 1;\r\n      }\r\n      //session expired\r\n      if (res.status == 401) {\r\n        dispatch(showMessage(\"Session may have expired\"));\r\n        dispatch({ type: ACTIONS.SESSION_MAY_HAVE_EXPIRED });\r\n      }\r\n\r\n      return meta\r\n        ? meta(action, state, res)\r\n        : res.statusText || \"An unknown error has occurred\";\r\n    }\r\n  };\r\n}\r\nexport const furmlyDownloadUrl = `${BASE_URL}/api/download/:id`;\r\nexport function fetchFurmlyProcess(id, args) {\r\n  if (config.cacheProcessDescription) {\r\n    let cacheKey = { id, args },\r\n      hasKey = cache.hasKey(cacheKey);\r\n    if (hasKey) {\r\n      let payload = Object.assign({}, cache.get(cacheKey));\r\n\r\n      return dispatch => {\r\n        dispatch({\r\n          type: ACTIONS.FETCHED_PROCESS,\r\n          payload\r\n        });\r\n      };\r\n    }\r\n  }\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/process/describe/${id}${getQueryParams(\r\n            Object.assign({}, args || {}, { $uiOnDemand: !!config.uiOnDemand })\r\n          )}`,\r\n          types: [\r\n            { type: ACTIONS.FETCHING_PROCESS, meta: id },\r\n            {\r\n              type: ACTIONS.FETCHED_PROCESS,\r\n              payload: (action, state, res) => {\r\n                //workaround for react-native fetch.\r\n                setTimeout(() => null, 0);\r\n                return res.json().then(d => {\r\n                  let response = { id: id, data: d };\r\n                  if (config.cacheProcessDescription && !d.data) {\r\n                    cache.store({ id, args }, copy(response));\r\n                  }\r\n                  return response;\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FAILED_TO_FETCH_PROCESS, () => id)\r\n          ],\r\n          method: \"GET\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          }\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\nexport function clearElementData(key) {\r\n  return {\r\n    type: ACTIONS.CLEAR_DATA,\r\n    payload: key\r\n  };\r\n}\r\nexport function getMoreForGrid(id, args, key) {\r\n  return runFurmlyProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.FETCHING_GRID,\r\n    resultCustomType: ACTIONS.FURMLY_GET_MORE_FOR_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_FETCHING_GRID,\r\n    disableCache: true,\r\n    disableRetry: true\r\n  });\r\n}\r\nexport function filterGrid(id, args, key) {\r\n  return runFurmlyProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.FETCHING_GRID,\r\n    resultCustomType: ACTIONS.FILTERED_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_FETCHING_GRID,\r\n    disableCache: true,\r\n    disableRetry: true\r\n  });\r\n}\r\n\r\nexport function getItemTemplate(id, args, key) {\r\n  return runFurmlyProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_ITEM_TEMPLATE,\r\n    resultCustomType: ACTIONS.GOT_ITEM_TEMPLATE,\r\n    errorCustomType: ACTIONS.FAILED_TO_GET_ITEM_TEMPLATE,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getFilterTemplate(id, args, key) {\r\n  return runFurmlyProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_FILTER_TEMPLATE,\r\n    resultCustomType: ACTIONS.GOT_FILTER_TEMPLATE,\r\n    errorCustomType: ACTIONS.FAILED_TO_GET_FILTER_TEMPLATE,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getSingleItemForGrid(id, args, key) {\r\n  return runFurmlyProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_SINGLE_ITEM_FOR_GRID,\r\n    resultCustomType: ACTIONS.GOT_SINGLE_ITEM_FOR_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getRefreshToken() {\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      [CALL_API]: preRefreshToken(\r\n        {\r\n          endpoint: `${BASE_URL}/api/refresh_token`,\r\n          types: [\r\n            ACTIONS.GET_REFRESH_TOKEN,\r\n            ACTIONS.GOT_REFRESH_TOKEN,\r\n            ACTIONS.FAILED_TO_GET_REFRESH_TOKEN\r\n          ],\r\n          body: null\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n  };\r\n}\r\n\r\nexport function runFurmlyProcessor(\r\n  id,\r\n  args,\r\n  key,\r\n  {\r\n    requestCustomType,\r\n    resultCustomType,\r\n    errorCustomType,\r\n    returnsUI,\r\n    disableCache,\r\n    disableRetry,\r\n    retry\r\n  } = {}\r\n) {\r\n  if (config.cacheProcessorResponses && !disableCache) {\r\n    let cacheKey = { id, args },\r\n      hasKey = cache.hasKey(cacheKey);\r\n    if (hasKey) {\r\n      let payload = copy(cache.get(cacheKey));\r\n      payload.key = key;\r\n\r\n      return dispatch => {\r\n        dispatch({\r\n          type: resultCustomType || ACTIONS.FURMLY_PROCESSOR_RAN,\r\n          payload\r\n        });\r\n      };\r\n    }\r\n  }\r\n\r\n  return (dispatch, getState) => {\r\n    let body = JSON.stringify(args),\r\n      endpoint = `${BASE_URL}/api/processors/run/${id}`,\r\n      throttleKey = `${endpoint}${body}`;\r\n\r\n    if (retry) throttled[throttleKey] = [config.processorRetryOffset || 500, 0];\r\n    if (\r\n      throttled[throttleKey] &&\r\n      (config.maxProcessorRetries &&\r\n        throttled[throttleKey][1] >= config.maxProcessorRetries)\r\n    )\r\n      return dispatch(\r\n        showMessage(\r\n          \"Max attempts to reach our backend servers has been reached. Please check your internet connection\"\r\n        )\r\n      );\r\n    let waitIndex = config.waitingProcessors.length,\r\n      waitHandle = setTimeout(() => {\r\n        config.waitingProcessors.splice(waitIndex, 1);\r\n        dispatch({\r\n          [CALL_API]: preDispatch(\r\n            {\r\n              endpoint,\r\n              types: [\r\n                {\r\n                  type: requestCustomType || ACTIONS.FURMLY_PROCESSOR_RUNNING,\r\n                  meta: { id, key, args }\r\n                },\r\n                {\r\n                  type: resultCustomType || ACTIONS.FURMLY_PROCESSOR_RAN,\r\n                  payload: (action, state, res) => {\r\n                    return res.json().then(data => {\r\n                      delete throttled[throttleKey];\r\n                      if (data && typeof data.message == \"string\") {\r\n                        dispatch(showMessage(data.message));\r\n                      }\r\n                      let response = { id, data, args, key, returnsUI };\r\n                      if (config.cacheProcessorResponses && !disableCache) {\r\n                        cache.store({ id, args }, response);\r\n                      }\r\n                      return response;\r\n                    });\r\n                  }\r\n                },\r\n                defaultError(\r\n                  dispatch,\r\n                  errorCustomType || ACTIONS.FURMLY_PROCESSOR_FAILED,\r\n                  () => key,\r\n                  !config.disableProcessorRetry && !disableRetry\r\n                )\r\n              ],\r\n              method: \"POST\",\r\n              headers: {\r\n                Accept: \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n              },\r\n              body\r\n            },\r\n            getState()\r\n          )\r\n        });\r\n      }, throttled[throttleKey] || 0);\r\n\r\n    config.waitingProcessors.push(waitHandle);\r\n  };\r\n}\r\n\r\nexport function showMessage(message) {\r\n  return {\r\n    type: \"SHOW_MESSAGE\",\r\n    message\r\n  };\r\n}\r\n\r\nexport function runFurmlyProcess(details) {\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/process/run/${details.id}`,\r\n          types: [\r\n            {\r\n              type: ACTIONS.FURMLY_PROCESS_RUNNING,\r\n              meta: {\r\n                id: details.id,\r\n                form: details.form,\r\n                currentStep: details.currentStep\r\n              }\r\n            },\r\n            {\r\n              type: ACTIONS.FURMLY_PROCESS_RAN,\r\n              payload: (action, state, res) => {\r\n                return res\r\n                  .json()\r\n                  .then(d => {\r\n                    if (d && typeof d.message == \"string\") {\r\n                      dispatch(showMessage(d.message));\r\n                    }\r\n                    let id = details.id;\r\n                    if (\r\n                      !(config.uiOnDemand && d.status == \"COMPLETED\") &&\r\n                      !(\r\n                        !config.uiOnDemand &&\r\n                        (state.furmly.view[id].description.steps.length == 1 ||\r\n                          (state.furmly.navigation.stack.length &&\r\n                            state.furmly.navigation.stack[\r\n                              state.furmly.navigation.stack.length - 1\r\n                            ].params.currentStep +\r\n                              1 >\r\n                              state.furmly.view[id].description.steps.length -\r\n                                1))\r\n                      ) &&\r\n                      !state.furmly.view[id].description\r\n                        .disableBackwardNavigation\r\n                    ) {\r\n                      let _p = copy(\r\n                        state.furmly.navigation.stack[\r\n                          state.furmly.navigation.stack.length - 1\r\n                        ]\r\n                      );\r\n                      _p.params.currentStep = (_p.params.currentStep || 0) + 1;\r\n                      dispatch(setParams(_p));\r\n                      if (config.notifyStepAdvance) {\r\n                        config.notifyStepAdvance(dispatch, state, _p);\r\n                      }\r\n                    }\r\n                    return { id: details.id, data: d };\r\n                  })\r\n                  .catch(er => {\r\n                    log(er);\r\n                    dispatch({\r\n                      type: \"SHOW_MESSAGE\",\r\n                      message:\r\n                        \"An error occurred while trying to understand a response from the server.\"\r\n                    });\r\n                  });\r\n              }\r\n            },\r\n            defaultError(\r\n              dispatch,\r\n              ACTIONS.FURMLY_PROCESS_FAILED,\r\n              () => details.id\r\n            )\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          },\r\n          body: JSON.stringify(\r\n            Object.assign({}, details.form, {\r\n              $instanceId: details.instanceId,\r\n              $uiOnDemand: !!config.uiOnDemand,\r\n              $currentStep: parseInt(details.currentStep)\r\n            })\r\n          )\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\nexport function getFurmlyFilePreview(id, key, fileType, query) {\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/upload/preview/${id + (query || \"\")}`,\r\n          types: [\r\n            { type: ACTIONS.GET_PREVIEW, meta: key },\r\n            {\r\n              type: ACTIONS.GOT_PREVIEW,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(d => {\r\n                  return { data: d, key };\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FAILED_TO_GET_PREVIEW, () => key)\r\n          ],\r\n          method: \"GET\",\r\n          headers: {\r\n            Accept: \"*/*\",\r\n            \"Content-Type\": \"application/json\"\r\n          }\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n  };\r\n}\r\n\r\nexport function uploadFurmlyFile(file, key) {\r\n  let formData = new FormData();\r\n\r\n  formData.append(\"file\", file);\r\n\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/upload`,\r\n          types: [\r\n            { type: ACTIONS.START_FILE_UPLOAD, meta: key },\r\n            {\r\n              type: ACTIONS.FILE_UPLOADED,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(d => {\r\n                  return { key, id: d.id };\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FILE_UPLOAD_FAILED, () => key)\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\"\r\n          },\r\n          body: formData\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n  };\r\n}\r\n\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport invariants from \"./utils/invariants\";\r\nimport { valueChanged } from \"./actions\";\r\nimport withLogger from \"./furmly_base\";\r\nexport default (Page, Warning, Container) => {\r\n  invariants.validComponent(Page, \"Page\");\r\n  invariants.validComponent(Warning, \"Warning\");\r\n  invariants.validComponent(Container, \"Container\");\r\n\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    //log(\"mapping state to props\");\r\n    let _state = state.furmly.view[ownProps.currentProcess],\r\n      description = _state && _state.description,\r\n      map = {\r\n        value: (_state && _state[ownProps.currentStep]) || null\r\n      };\r\n\r\n    if (description && description.steps[ownProps.currentStep]) {\r\n      map.elements = description.steps[ownProps.currentStep].form.elements;\r\n      if (description.steps[ownProps.currentStep].mode == \"VIEW\")\r\n        map.hideSubmit = true;\r\n      map.title = description.title;\r\n      map.processDescription = description.description;\r\n    }\r\n    return map;\r\n  };\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      valueChanged: args => dispatch(valueChanged(args))\r\n    };\r\n  };\r\n\r\n  class FurmlyView extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.onValueChanged = this.onValueChanged.bind(this);\r\n      this.submit = this.submit.bind(this);\r\n      //pass reference to validate func\r\n      this.state = {\r\n        validator: {}\r\n      };\r\n    }\r\n\r\n    onValueChanged(form) {\r\n      //this.state.form = form.furmly_view;\r\n      this.props.valueChanged({\r\n        form: form.furmly_view,\r\n        id: this.props.currentProcess,\r\n        step: this.props.currentStep\r\n      });\r\n    }\r\n    submit() {\r\n      this.state.validator\r\n        .validate()\r\n        .then(\r\n          () => {\r\nthis.props.log(\"currentStep:\" + (this.props.currentStep || \"0\"));\r\n            this.props.submit(this.props.value);\r\n          },\r\n          () => {\r\nthis.props.log(\"the form is invalid\");\r\n          }\r\n        )\r\n        .catch(er => {\r\nthis.props.log(\"an error occurred while validating form \");\r\nthis.props.log(er);\r\n        });\r\n    }\r\n    render() {\r\n      if (!this.props.elements || !this.props.elements.length)\r\n        return (\r\n          <Page hideSubmit={true}>\r\n            <Warning message=\"Oops you are not supposed to be here. Something may be broken. Please navigate home/login\" />\r\n          </Page>\r\n        );\r\n      /*jshint ignore:start*/\r\n      return (\r\n        <Page\r\n          submit={this.submit}\r\n          hideSubmit={this.props.hideSubmit}\r\n          processDescription={this.props.processDescription}\r\n        >\r\n          <Container\r\n            label={this.props.title}\r\n            elements={this.props.elements}\r\n            name=\"furmly_view\"\r\n            value={this.props.value}\r\n            valueChanged={this.onValueChanged}\r\n            validator={this.state.validator}\r\n            navigation={this.props.navigation}\r\n            currentStep={this.props.currentStep}\r\n            currentProcess={this.props.currentProcess}\r\n          />\r\n        </Page>\r\n      );\r\n      /*jshint ignore:end*/\r\n    }\r\n  }\r\n\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlyView));\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (...args) => {\r\n  //invariants\r\n  let Section = args[0],\r\n    Header = args[1],\r\n    ComponentWrapper,\r\n    ComponentLocator;\r\n  if (args.length == 3) {\r\n    ComponentLocator = args[2];\r\n  } else {\r\n    ComponentWrapper = args[2];\r\n    ComponentLocator = args[3];\r\n  }\r\n\r\n  if (\r\n    invariants.validComponent(Section, \"Section\") &&\r\n    invariants.validComponent(Header, \"Header\") &&\r\n    !ComponentLocator\r\n  )\r\n    throw new Error(\"ComponentLocator cannot be null (furmly_container)\");\r\n\r\n  return withLogger(\r\n    class extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.onValueChanged = this.onValueChanged.bind(this);\r\n        this.state = {\r\n          _validations: (this.props.elements || []).map(x => ({}))\r\n        };\r\n        this.setValidator = this.setValidator.bind(this);\r\n        this.setValidator();\r\n      }\r\n      componentWillReceiveProps(next) {\r\n        if (\r\n          next.elements &&\r\n          (next.elements !== this.props.elements ||\r\n            next.elements.length !== this.props.elements.length)\r\n        ) {\r\n          let _validations = next.elements.map(x => ({}));\r\nthis.props.log(`creating new validators for container ${this.props.name}`);\r\n          this.setState({ _validations });\r\n        }\r\n      }\r\n      setValidator() {\r\n        this.props.validator.validate = () => {\r\n          return Promise.all(\r\n            this.state._validations.map(x => {\r\n              if (x.validate) return x.validate();\r\n\r\n              return new Promise((resolve, reject) => {\r\n                resolve();\r\n              });\r\n            })\r\n          );\r\n        };\r\n      }\r\n      onValueChanged() {\r\n        let form = Object.assign(\r\n          {},\r\n          this.props.value || {},\r\n          ...Array.prototype.slice.call(arguments)\r\n        );\r\n\r\n        this.props.valueChanged({ [this.props.name]: form });\r\n      }\r\n\r\n      render() {\r\n        //this._validations.length = 0;\r\n        let keys = this.props.value ? Object.keys(this.props.value) : [],\r\n          self = this,\r\n          extraVal = {},\r\n          notifyExtra = [],\r\n          elements = (this.props.elements || [])\r\n            .sort((x, y) => {\r\n              return x.order - y.order;\r\n            })\r\n            .map((x, index) => {\r\n              let FurmlyComponent = ComponentLocator(x),\r\n                source = self.props.value,\r\n                //validator = {},\r\n                value = source ? this.props.value[x.name] : null;\r\n              //this._validations.push(validator);\r\n              if (\r\n                source &&\r\n                source.hasOwnProperty(x.name) &&\r\n                keys.indexOf(x.name) !== -1\r\n              )\r\n                keys.splice(keys.indexOf(x.name), 1);\r\n              /*jshint ignore:start*/\r\n              if (!FurmlyComponent)\r\n                throw new Error(\r\n                  \"Unknown component:\" + JSON.stringify(x, null, \" \")\r\n                );\r\n              if (FurmlyComponent.notifyExtra) {\r\n                notifyExtra.push(index);\r\n                return extra => {\r\n                  let component = (\r\n                    <FurmlyComponent\r\n                      {...x}\r\n                      extra={extra}\r\n                      key={x.name}\r\n                      value={value}\r\n                      validator={this.state._validations[index]}\r\n                      valueChanged={this.onValueChanged}\r\n                      navigation={this.props.navigation}\r\n                      currentProcess={this.props.currentProcess}\r\n                      currentStep={this.props.currentStep}\r\n                    />\r\n                  );\r\n                  if (ComponentWrapper)\r\n                    return ComponentWrapper(\r\n                      x.elementType,\r\n                      x.uid,\r\n                      x.name,\r\n                      component\r\n                    );\r\n\r\n                  return component;\r\n                };\r\n              }\r\n              let component = (\r\n                <FurmlyComponent\r\n                  {...x}\r\n                  value={value}\r\n                  validator={this.state._validations[index]}\r\n                  key={x.name}\r\n                  valueChanged={this.onValueChanged}\r\n                  navigation={this.props.navigation}\r\n                  currentProcess={this.props.currentProcess}\r\n                  currentStep={this.props.currentStep}\r\n                />\r\n              );\r\n              return ComponentWrapper\r\n                ? ComponentWrapper(x.elementType, x.uid, x.name, component)\r\n                : component;\r\n              /*jshint ignore:end*/\r\n            });\r\n\r\n        if (keys.length || notifyExtra.length) {\r\n          if (!notifyExtra.length) {\r\n            // console.warn(\r\n            // \t\"there are extra properties that no component cares about \" +\r\n            // \t\tJSON.stringify(keys, null, \" \")\r\n            // );\r\n            // console.warn('shouldnt happen too often');\r\n          }\r\n\r\n          keys.forEach(x => {\r\n            extraVal[x] = self.props.value[x];\r\n          });\r\n\r\n          notifyExtra.forEach(x => {\r\n            elements[x] = elements[x](Object.assign({}, extraVal));\r\n          });\r\n        }\r\n        if (this.props.label)\r\n          return (\r\n            <Section>\r\n              <Header text={this.props.label} />\r\n              {elements}\r\n            </Section>\r\n          );\r\n        /*jshint ignore:start*/\r\n        return <Section>{elements}</Section>;\r\n        /*jshint ignore:end*/\r\n      }\r\n    }\r\n  );\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { fetchFurmlyProcess, runFurmlyProcess } from \"./actions\";\r\nimport _ from \"lodash\";\r\nimport invariants from \"./utils/invariants\";\r\nimport withLogger from \"./furmly_base\";\r\n/**\r\n * Higher order function that recieves Platform specific implementation of Input\r\n * @param  {Function} Input Input class\r\n * @return {Function}       Wrapped class\r\n */\r\nexport default (ProgressBar, TextView, FurmlyView) => {\r\n  invariants.validComponent(ProgressBar, \"ProgressBar\");\r\n  invariants.validComponent(TextView, \"TextView\");\r\n  invariants.validComponent(FurmlyView, \"FurmlyView\");\r\n\r\n  //map elements in FurmlyInput props to elements in store.\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    let _state = state.furmly.view[`${ownProps.id}`];\r\n    return {\r\n      busy: !!state.furmly.view[`${ownProps.id}-busy`],\r\n      description: _state && _state.description,\r\n      instanceId: _state && _state.instanceId,\r\n      message: state.furmly.view.message,\r\n      completed: _state && _state.completed\r\n    };\r\n  };\r\n\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      fetch: (id, params) => {\r\n        dispatch(fetchFurmlyProcess(id, params));\r\n      },\r\n      runProcess: info => {\r\n        dispatch(runFurmlyProcess(info));\r\n      }\r\n    };\r\n  };\r\n\r\n  class FurmlyProcess extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {};\r\n      this.submit = this.submit.bind(this);\r\n    }\r\n    componentDidMount() {\r\n      if (\r\n        !this.props.description ||\r\n        (this.props.id !== this.props.description._id &&\r\n          this.props.id !== this.props.description.uid)\r\n      ) {\r\n        this.props.fetch(this.props.id, this.props.fetchParams);\r\n      }\r\n    }\r\n    componentWillReceiveProps(next) {\r\n      if (next.completed && next.completed != this.props.completed)\r\n        return this.props.navigation.goBack();\r\n\r\n      if (\r\n        ((next.id !== this.props.id ||\r\n          !_.isEqual(next.fetchParams, this.props.fetchParams)) &&\r\n          !next.busy &&\r\n          !next.description) ||\r\n        (next.id == this.props.id &&\r\n          !_.isEqual(next.fetchParams, this.props.fetchParams) &&\r\n          !next.busy)\r\n      )\r\n        this.props.fetch(next.id, next.fetchParams);\r\n    }\r\n    submit(form) {\r\n      this.props.runProcess({\r\n        id: this.props.id,\r\n        form,\r\n        currentStep: this.props.currentStep,\r\n        instanceId: this.props.instanceId\r\n      });\r\n    }\r\n    render() {\r\n      /*jshint ignore:start */\r\n      if (this.props.busy || typeof this.props.busy == \"undefined\") {\r\n        return <ProgressBar title=\"Please wait...\" />;\r\n      }\r\n      if (!this.props.description) {\r\n        return (\r\n          <TextView text=\"Sorry we couldnt load that process...please wait a few minutes and retry.\" />\r\n        );\r\n      }\r\n      return (\r\n        <FurmlyView\r\n          currentStep={this.props.currentStep || 0}\r\n          currentProcess={this.props.id}\r\n          navigation={this.props.navigation}\r\n          submit={this.submit}\r\n        />\r\n      );\r\n\r\n      /*jshint ignore:end */\r\n    }\r\n  }\r\n  // FurmlyProcess.propTypes = {\r\n  // \tid: React.PropTypes.string.isRequired,\r\n  // \tfetchParams: React.PropTypes.object,\r\n  // \tdescription: React.PropTypes.object\r\n  // };\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlyProcess));\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nimport withLogger from \"./furmly_base\";\r\nexport default (Layout, Header, Container) => {\r\n  invariants.validComponent(Layout, \"Layout\");\r\n  invariants.validComponent(Header, \"Header\");\r\n  invariants.validComponent(Container, \"Container\");\r\n  class FurmlySection extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n    }\r\n    render() {\r\n      /*jshint ignore:start*/\r\n      //get the container for retrieving\r\n      return (\r\n        <Layout>\r\n          <Header description={this.props.description}>\r\n            {this.props.label}\r\n          </Header>\r\n          <Container\r\n            elements={this.props.args.elements}\r\n            name={this.props.name}\r\n            value={this.props.value}\r\n            valueChanged={this.props.valueChanged}\r\n            validator={this.props.validator}\r\n            navigation={this.props.navigation}\r\n            currentProcess={this.props.currentProcess}\r\n            currentStep={this.props.currentStep}\r\n          />\r\n        </Layout>\r\n      );\r\n      /*jshint ignore:end*/\r\n    }\r\n  }\r\n\r\n  return withLogger(FurmlySection);\r\n};\r\n","export function getTitleFromState(state) {\r\n\tlet id =\r\n\t\tstate.furmly.navigation.stack.length &&\r\n\t\tstate.furmly.navigation.stack[state.furmly.navigation.stack.length - 1]\r\n\t\t\t.params.id;\r\n\r\n\tif (!id) return \"School Manager\";\r\n\treturn (\r\n\t\t(state.furmly.view[id] &&\r\n\t\t\tstate.furmly.view[`${id}-busy`] &&\r\n\t\t\t\"Loading...\") ||\r\n\t\t(state.furmly.view[id] &&\r\n\t\t\tstate.furmly.view[id].description &&\r\n\t\t\tstate.furmly.view[id].description.steps[\r\n\t\t\t\tstate.furmly.view[id].currentStep || 0\r\n\t\t\t].description) ||\r\n\t\t(state.furmly.view[id] &&\r\n\t\t\tstate.furmly.view[id].description &&\r\n\t\t\tstate.furmly.view[id].description.title) ||\r\n\t\t\"School Manager\"\r\n\t);\r\n}\r\n\r\nexport function getValueBasedOnMode(props, v) {\r\n\treturn (\r\n\t\t(props.args &&\r\n\t\tprops.args.mode &&\r\n\t\ttypeof v !== \"object\" &&\r\n\t\tprops.args.mode == \"ObjectId\" && { $objectID: v }) ||\r\n\t\tv\r\n\t);\r\n}\r\nexport function isObjectIdMode(props) {\r\n\treturn props.args && props.args.mode === \"ObjectId\";\r\n}\r\nexport function getCurrentStepFromState(state) {\r\n\treturn (\r\n\t\t(state.furmly.navigation.stack.length &&\r\n\t\t\tstate.furmly.navigation.stack[\r\n\t\t\t\tstate.furmly.navigation.stack.length - 1\r\n\t\t\t].params.currentStep) ||\r\n\t\t0\r\n\t);\r\n}\r\nexport function getCurrentStep(state) {\r\n\treturn (\r\n\t\t(state.furmly.navigation.stack.length &&\r\n\t\t\tstate.furmly.navigation.stack[\r\n\t\t\t\tstate.furmly.navigation.stack.length - 1\r\n\t\t\t].params.currentStep) ||\r\n\t\t0\r\n\t);\r\n}\r\n\r\nexport function getCurrentProcess(state) {\r\n\tfor (var i = state.furmly.navigation.stack.length - 1; i >= 0; i--) {\r\n\t\tif (state.furmly.navigation.stack[i].key == \"Furmly\") {\r\n\t\t\treturn state.furmly.navigation.stack[i].params.id;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\nexport function getKey(state, key, ownProps) {\r\n\treturn `${ownProps.currentStep}/${ownProps.currentProcess}/${key}`;\r\n}\r\nconst exp = /^(\\d+)\\/([a-f\\d]{1,24}|[a-zA-Z0-9_]+)\\/.+$/i;\r\nexport function isValidKey(key) {\r\n\tlet result = exp.exec(key);\r\n\tif (!result) return false;\r\n\r\n\treturn { step: result[1], process: result[2] };\r\n}\r\n\r\nexport function runThroughObj(conditions, data, result = {}, parent = null) {\r\n\tif (data)\r\n\t\tObject.keys(data).forEach(key => {\r\n\t\t\tlet send = false;\r\n\t\t\tfor (var v = 0; v < conditions.length; v++) {\r\n\t\t\t\tif (conditions[v](key, data, result, parent)) return result;\r\n\t\t\t}\r\n\t\t\tif (Array.prototype.isPrototypeOf(data[key]))\r\n\t\t\t\treturn data[key].forEach(function(element) {\r\n\t\t\t\t\trunThroughObj(conditions, element, result, data);\r\n\t\t\t\t});\r\n\t\t\tif (data[key] && typeof data[key] == \"object\")\r\n\t\t\t\treturn runThroughObj(conditions, data[key], result, data);\r\n\t\t});\r\n\treturn result;\r\n}\r\n\r\nexport function unwrapObjectValue(value) {\r\n\treturn value && typeof value == \"object\" ? value.$objectID : value;\r\n}\r\n/**\r\n * This method retrieves all the recursively declared templates and returns them. it also assigns \r\n * unique ids to every element it finds.\r\n * @param  {[type]} null    [description]\r\n * @param  {[type]} [\t(key, data,         result, parent) [description]\r\n * @param  {[type]} (key,   data,         result, parent  [description]\r\n * @return {[type]}         [description]\r\n */\r\nexport const getTemplatesAndAddComponentUid = runThroughObj.bind(null, [\r\n\t(key, data, result, parent) => {\r\n\t\tif (key === \"furmly_ref\") {\r\n\t\t\tif (data.template)\r\n\t\t\t\treturn (result[data.furmly_ref] = data.template), result;\r\n\t\t\tif (parent && parent.itemTemplate)\r\n\t\t\t\treturn (result[data.furmly_ref] = parent.itemTemplate), result;\r\n\t\t}\r\n\t},\r\n\t(key, data, result, parent) => {\r\n\t\tif (key == \"elementType\" && !data.component_uid) {\r\n\t\t\tdata.component_uid = uuid();\r\n\t\t}\r\n\t}\r\n]);\r\n\r\nexport const toggleAllBusyIndicators = runThroughObj.bind(null, [\r\n\t(key, data) => {\r\n\t\tif (\r\n\t\t\t/(getting|busy|fetching)+/i.test(key) &&\r\n\t\t\ttypeof data[key] == \"boolean\"\r\n\t\t) {\r\n\t\t\tdata[key] = false;\r\n\t\t}\r\n\t}\r\n]);\r\nconst keyInvariants = function(fn) {\r\n\treturn function(key) {\r\n\t\tif (typeof key === \"undefined\")\r\n\t\t\tthrow new Error(\"Key cannot be undefined\");\r\n\t\tif (typeof key === \"object\") throw new Error(\"Key cannot be an object\");\r\n\t\tif (typeof key !== \"string\") throw new Error(\"Key must be a string\");\r\n\t\treturn fn.call(this, key);\r\n\t};\r\n};\r\nexport const getBusyKey = keyInvariants(key => `${key}-busy`);\r\nexport const getErrorKey = keyInvariants(key => `${key}-error`);\r\nexport const copy = value => JSON.parse(JSON.stringify(value));\r\n\r\nexport default {\r\n\tgetCurrentStepFromState,\r\n\tgetTitleFromState,\r\n\tgetCurrentStep,\r\n\tgetCurrentProcess,\r\n\tisValidKey,\r\n\tgetKey\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runFurmlyProcessor } from \"./actions\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\nimport {\r\n  getKey,\r\n  unwrapObjectValue,\r\n  getBusyKey,\r\n  getErrorKey\r\n} from \"./utils/view\";\r\nimport withLogger from \"./furmly_base\";\r\nexport default (ProgressIndicator, Layout, Container) => {\r\n  if (\r\n    invariants.validComponent(ProgressIndicator, \"ProgressIndicator\") &&\r\n    invariants.validComponent(Layout, \"Layout\") &&\r\n    !Container\r\n  )\r\n    throw new Error(\"Container cannot be null (furmly_select)\");\r\n\r\n  //map elements in FurmlyView props to elements in store.\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    if (ownProps.args.type == \"PROCESSOR\") {\r\n      let component_uid = getKey(state, ownProps.component_uid, ownProps);\r\n      let st = state.furmly.view[component_uid];\r\n      return {\r\n        items: st,\r\n        busy: !!state.furmly.view[getBusyKey(component_uid)],\r\n        error: !!state.furmly.view[getErrorKey(component_uid)],\r\n        component_uid\r\n      };\r\n    }\r\n    //evaluate stuff in the parent container to retrieve the\r\n  };\r\n\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      fetch: (id, params, key) => {\r\n        dispatch(runFurmlyProcessor(id, params, key));\r\n      }\r\n    };\r\n  };\r\n\r\n  class FurmlySelect extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {};\r\n      this.fetchItems = this.fetchItems.bind(this);\r\n      this.onValueChanged = this.onValueChanged.bind(this);\r\n      this.selectFirstItem = this.selectFirstItem.bind(this);\r\n      this.getValueBasedOnMode = this.getValueBasedOnMode.bind(this);\r\n      this.props.validator.validate = () => {\r\n        return this.runValidators();\r\n      };\r\n      this.isValidValue = this.isValidValue.bind(this);\r\n      this.isObjectIdMode = this.isObjectIdMode.bind(this);\r\n    }\r\n    hasValue() {\r\n      return !!this.props.value || \"is required\";\r\n    }\r\n    runValidators() {\r\n      return new ValidationHelper(this).run();\r\n    }\r\n    onValueChanged(value) {\r\n      if (this._mounted) {\r\n        this.props.valueChanged({\r\n          [this.props.name]: this.getValueBasedOnMode(value)\r\n        });\r\n      }\r\n    }\r\n    fetchItems(source, args, component_uid) {\r\n      if (this._mounted) {\r\n        if (!source || !component_uid)\r\n          throw new Error(\"Something is wrong with our configuration\");\r\n        this.props.fetch(source, JSON.parse(args || \"{}\"), component_uid);\r\n      }\r\n    }\r\n    isValidValue(items = this.props.items, value = this.props.value) {\r\n      value = unwrapObjectValue(value);\r\n      return items && items.length && items.filter(x => x._id == value).length;\r\n    }\r\n    getValueBasedOnMode(v) {\r\n      return (\r\n        (this.props.args &&\r\n          this.props.args.mode &&\r\n          typeof v !== \"object\" &&\r\n          this.props.args.mode == \"ObjectId\" && { $objectID: v }) ||\r\n        v\r\n      );\r\n    }\r\n    componentWillReceiveProps(next) {\r\n      if (\r\n        !next.error &&\r\n        (next.args.config.value !== this.props.args.config.value ||\r\n          (next.args.config.customArgs !== this.props.args.config.customArgs &&\r\n            !next.busy) ||\r\n          next.component_uid !== this.props.component_uid ||\r\n          (next.args.config.value &&\r\n            typeof next.items == \"undefined\" &&\r\n            !next.busy))\r\n      ) {\r\n        return this.fetchItems(\r\n          next.args.config.value,\r\n          next.args.config.customArgs,\r\n          next.component_uid\r\n        );\r\n      }\r\n\r\n      if (next.items && next.items.length == 1 && !next.value) {\r\n        return this.selectFirstItem(next.items[0]._id);\r\n      }\r\n\r\n      if (\r\n        (next.items &&\r\n          next.value &&\r\n          !this.isValidValue(next.items, next.value)) ||\r\n        (!next.items && !next.busy && !next.error)\r\n      ) {\r\n        return this.onValueChanged(null);\r\n      }\r\n    }\r\n\r\n    selectFirstItem(item) {\r\n      setTimeout(() => {\r\n        this.onValueChanged(item);\r\n      }, 0);\r\n    }\r\n    componentWillUnmount() {\r\n      this._mounted = false;\r\n    }\r\n    isObjectIdMode() {\r\n      return this.props.args && this.props.args.mode === \"ObjectId\";\r\n    }\r\n    componentDidMount() {\r\n      this._mounted = true;\r\n      if (!this.props.items) {\r\nthis.props.log(\r\n          \"fetching items in componentDidMount for current:\" + this.props.name\r\n        );\r\n        this.fetchItems(\r\n          this.props.args.config.value,\r\n          this.props.args.config.customArgs,\r\n          this.props.component_uid\r\n        );\r\n      }\r\n\r\n      if (\r\n        this.props.items &&\r\n        this.props.items.length == 1 &&\r\n        !this.props.value\r\n      ) {\r\n        return this.selectFirstItem(this.props.items[0]._id);\r\n      }\r\n      if (\r\n        this.isObjectIdMode() &&\r\n        this.props.value &&\r\n        typeof this.props.value !== \"object\"\r\n      ) {\r\n        //update the form to indicate its an objectId.\r\n        return setTimeout(() => {\r\n          this.onValueChanged(this.props.value);\r\n        }, 0);\r\n      }\r\n    }\r\n    isEmptyOrNull(v) {\r\n      return !v || !v.length;\r\n    }\r\n    render() {\r\n      /*jshint ignore:start*/\r\n\r\nthis.props.log(`rendering ${this.props.name}`);\r\n      if (this.isEmptyOrNull(this.props.items)) {\r\nthis.props.log(`${this.props.name} is empty`);\r\n        return <ProgressIndicator />;\r\n      }\r\n      return (\r\n        <Layout\r\n          value={this.props.label}\r\n          inner={\r\n            <Container\r\n              disabled={\r\n                !!this.props.args.disabled ||\r\n                (this.props.items && this.props.items.length == 1)\r\n              }\r\n              errors={this.state.errors}\r\n              label={this.props.label}\r\n              items={this.props.items}\r\n              displayProperty=\"displayLabel\"\r\n              keyProperty=\"_id\"\r\n              value={unwrapObjectValue(this.props.value)}\r\n              valueChanged={this.onValueChanged}\r\n            />\r\n          }\r\n        />\r\n      );\r\n      /*jshint ignore:end*/\r\n    }\r\n  }\r\n\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlySelect));\r\n};\r\n","import React from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nimport { unwrapObjectValue } from \"./utils/view\";\r\nimport { connect } from \"react-redux\";\r\nimport { runFurmlyProcessor } from \"./actions\";\r\nimport ValidationHelper from \"./utils/validator\";\r\nimport { getKey, getErrorKey, getBusyKey } from \"./utils/view\";\r\nimport _ from \"lodash\";\r\nimport withLogger from \"./furmly_base\";\r\n\r\nexport default (Layout, Picker, ProgressBar, Container) => {\r\n  //map elements in FurmlyView props to elements in store.\r\n  invariants.validComponent(Layout, \"Layout\");\r\n  invariants.validComponent(Picker, \"Picker\");\r\n  invariants.validComponent(Container, \"Container\");\r\n  const noPath = \"selectset_no_path\";\r\n  const noItems = [];\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      getItems: (id, args, key, extra) =>\r\n        dispatch(runFurmlyProcessor(id, args, key, extra))\r\n    };\r\n  };\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    let component_uid = getKey(state, ownProps.component_uid, ownProps),\r\n      items = state.furmly.view[component_uid] || ownProps.args.items;\r\n    return {\r\n      busy: !!state.furmly.view[getBusyKey(component_uid)],\r\n      error: !!state.furmly.view[getErrorKey(component_uid)],\r\n      items,\r\n      contentItems: getPickerItemsById(ownProps.value, items),\r\n      component_uid\r\n    };\r\n  };\r\n  const getPickerItemsById = function(v, items) {\r\n    if (v && items && items.length) {\r\n      let z = unwrapObjectValue(v);\r\n      let r = items.filter(x => x.id == z);\r\n      return (r.length && r[0].elements) || noItems;\r\n    }\r\n\r\n    return noItems;\r\n  };\r\n  class FurmlySelectSet extends React.Component {\r\n    constructor(props) {\r\n      super(props, log);\r\n      this.retryFetch = this.retryFetch.bind(this);\r\n      this.onPickerValueChanged = this.onPickerValueChanged.bind(this);\r\n      this.onContainerValueChanged = this.onContainerValueChanged.bind(this);\r\n      this.getPickerValue = this.getPickerValue.bind(this);\r\n      this.getContainerValue = this.getContainerValue.bind(this);\r\n      let containerValues = (props.contentItems || []).reduce((sum, x) => {\r\n        if (this.props.extra.hasOwnProperty(x.name))\r\n          sum[x.name] = this.props.extra[x.name];\r\n        return sum;\r\n      }, {});\r\n      this.state = {\r\n        containerValues,\r\n        containerValidator: {}\r\n      };\r\n      this.selectFirstItem = this.selectFirstItem.bind(this);\r\n      this.respondToPickerValueChanged = this.respondToPickerValueChanged.bind(\r\n        this\r\n      );\r\n      this.oneOption = this.oneOption.bind(this);\r\n      this.props.validator.validate = () => {\r\n        return this.runValidators();\r\n      };\r\n      this.getValueBasedOnMode = this.getValueBasedOnMode.bind(this);\r\n      this.isObjectIdMode = this.isObjectIdMode.bind(this);\r\n    }\r\n    hasValue() {\r\n      return !!this.props.value || \"is required\";\r\n    }\r\n    runValidators() {\r\n      return Promise.all([\r\n        new ValidationHelper(this).run(),\r\n        this.state.containerValidator.validate()\r\n      ]);\r\n    }\r\n\r\n    componentWillReceiveProps(next) {\r\n      if (\r\n        !next.error &&\r\n        (next.args.processor !== this.props.args.processor ||\r\n          (next.component_uid !== this.props.component_uid &&\r\n            next.args.processor) ||\r\n          typeof next.items == \"undefined\") &&\r\n        !next.busy\r\n      )\r\n        this.fetchItems(\r\n          next.args.processor,\r\n          next.args.processorArgs,\r\n          next.component_uid\r\n        );\r\n\r\n      if (next.items && next.items.length == 1 && !next.value) {\r\n        return this.selectFirstItem(next.items);\r\n      }\r\n    }\r\n\r\n    retryFetch() {\r\n      this.props.log(`retrying fetch`);\r\n      this.fetchItems(\r\n        this.props.args.processor,\r\n        this.props.args.processorArgs,\r\n        this.props.component_uid,\r\n        { retry: true }\r\n      );\r\n    }\r\n\r\n    fetchItems(source, args, component_uid) {\r\n      let _args = this._onContainerValueChanged.call(\r\n        this,\r\n        this.state.containerValues\r\n      );\r\n      _args.shift();\r\n      this.props.log(`fetching items`);\r\n      this.props.getItems(\r\n        source,\r\n        Object.assign(\r\n          JSON.parse(args || this.props.args.processorArgs || \"{}\"),\r\n          {\r\n            _args\r\n          }\r\n        ),\r\n        component_uid || this.props.component_uid\r\n      );\r\n    }\r\n\r\n    componentWillUnmount() {\r\n      this._mounted = false;\r\n    }\r\n    componentDidMount() {\r\n      this._mounted = true;\r\n      if (this.props.args.processor && typeof this.props.items == \"undefined\") {\r\n        this.fetchItems(this.props.args.processor);\r\n      }\r\n\r\n      if (\r\n        this.props.items &&\r\n        this.props.items.length == 1 &&\r\n        !this.props.value\r\n      ) {\r\n        return setTimeout(() => {\r\n          this.selectFirstItem();\r\n        }, 0);\r\n      }\r\n\r\n      if (\r\n        this.isObjectIdMode() &&\r\n        this.props.value &&\r\n        typeof this.props.value !== \"object\"\r\n      ) {\r\n        //update the form to indicate its an objectId.\r\n        return setTimeout(() => {\r\n          this.onPickerValueChanged(this.props.value);\r\n        }, 0);\r\n      }\r\n    }\r\n\r\n    isObjectIdMode() {\r\n      return this.props.args && this.props.args.mode === \"ObjectId\";\r\n    }\r\n    oneOption() {\r\n      return this.props.items && this.props.items.length == 1;\r\n    }\r\n    getCurrentContainerValue() {\r\n      return (\r\n        (this.props.args.path && {\r\n          [this.props.args.path]: this.props.extra[this.props.args.path]\r\n        }) ||\r\n        this.state.containerValues\r\n      );\r\n    }\r\n    selectFirstItem(items = this.props.items) {\r\n      this.onPickerValueChanged(items[0].id);\r\n    }\r\n    getPickerValue(value = this.props.value) {\r\n      return {\r\n        [this.props.name]: this.getValueBasedOnMode(value)\r\n      };\r\n    }\r\n\r\n    onContainerValueChanged(value, pickerValue) {\r\n      // this.props.log(\r\n      // \t`value changed ${JSON.stringify(\r\n      // \t\tvalue,\r\n      // \t\tnull,\r\n      // \t\t\" \"\r\n      // \t)} pickerValue:${JSON.stringify(pickerValue, null, \" \")}`\r\n      // );\r\n      let eve = this._onContainerValueChanged.call(this, value, pickerValue);\r\n      // this.props.log(`eventual params:${JSON.stringify(eve, null, \" \")}`);\r\n\r\n      this.props.valueChanged.apply(this, eve);\r\n    }\r\n    _shouldComponentUpdateComparer(x, y, a, b, key) {\r\n      if (a == b) return true;\r\n      if (key == \"extra\") {\r\n        if (y.contentItems && y.contentItems.length)\r\n          return _.isEqual(a[y.args.path], b[y.args.path]);\r\n\r\n        return true;\r\n      }\r\n    }\r\n    //potentially expensive.\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n      if (\r\n        (nextProps.args.path ||\r\n          (!nextProps.args.path && !nextProps.contentItems.length)) &&\r\n        _.isEqual(this.state.errors, nextState.errors) &&\r\n        _.isEqualWith(\r\n          this.props,\r\n          nextProps,\r\n          this._shouldComponentUpdateComparer.bind(this, this.props, nextProps)\r\n        )\r\n      ) {\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    }\r\n    _onContainerValueChanged(value, pickerValue) {\r\n      pickerValue = pickerValue || this.getPickerValue();\r\n      if (this.props.args.path) {\r\n        let _p = [pickerValue];\r\n        //push this to unset previous value\r\n        if (!value) _p.push({ [this.props.args.path]: undefined });\r\n        else _p.push(value);\r\n        return _p;\r\n      }\r\n\r\n      let superCancel =\r\n        this.state.containerValues &&\r\n        Object.keys(this.state.containerValues).reduce((sum, x) => {\r\n          return (sum[x] = undefined), sum;\r\n        }, {});\r\n\r\n      //path is not defined so unpack the properties and send.\r\n      let result = [\r\n        pickerValue,\r\n        ...Object.keys((value && value[noPath]) || {}).map(x => {\r\n          return { [x]: value[noPath][x] };\r\n        })\r\n      ];\r\n\r\n      if (superCancel && Object.keys(superCancel).length > 0) {\r\n        //insert this to remove previous values.\r\n        result.splice(1, 0, superCancel);\r\n      }\r\n      setTimeout(() => {\r\n        if (this._mounted) {\r\n          this.setState({\r\n            containerValues: (value && value[noPath]) || null\r\n          });\r\n        }\r\n      });\r\n      this.props.log(`container values changed ${JSON.stringify(result)}`);\r\n      return result;\r\n    }\r\n\r\n    getValueBasedOnMode(v) {\r\n      return (\r\n        (this.props.args &&\r\n          this.props.args.mode &&\r\n          typeof v !== \"object\" &&\r\n          this.props.args.mode == \"ObjectId\" && { $objectID: v }) ||\r\n        v\r\n      );\r\n    }\r\n    respondToPickerValueChanged(v) {\r\n      this.onContainerValueChanged(null, this.getPickerValue(v));\r\n    }\r\n    onPickerValueChanged(v) {\r\n      this.onContainerValueChanged(\r\n        this.getCurrentContainerValue(),\r\n        this.getPickerValue(v)\r\n      );\r\n    }\r\n    getContainerValue() {\r\n      return this.props.args.path\r\n        ? this.props.extra\r\n          ? this.props.extra[this.props.args.path]\r\n          : {}\r\n        : this.props.extra;\r\n    }\r\n    isEmptyOrNull(v) {\r\n      return !v || !v.length;\r\n    }\r\n    render() {\r\n      this.props.log(`rendering called`);\r\n      /*jshint ignore:start*/\r\n      if (this.props.busy) {\r\n        this.props.log(`${this.props.name} is busy`);\r\n        return <ProgressBar onClick={this.props.retryFetch} />;\r\n      }\r\n\r\n      return (\r\n        <Layout\r\n          value={this.props.label}\r\n          inner={\r\n            <Picker\r\n              label={this.props.label}\r\n              disabled={!!this.props.args.disabled || this.oneOption()}\r\n              items={this.props.items}\r\n              errors={this.state.errors}\r\n              displayProperty=\"displayLabel\"\r\n              keyProperty=\"id\"\r\n              value={unwrapObjectValue(this.props.value)}\r\n              valueChanged={this.respondToPickerValueChanged}\r\n              currentProcess={this.props.currentProcess}\r\n              currentStep={this.props.currentStep}\r\n            />\r\n          }\r\n          extraElements={\r\n            <Container\r\n              name={this.props.args.path || noPath}\r\n              value={this.getContainerValue()}\r\n              valueChanged={this.onContainerValueChanged}\r\n              elements={this.props.contentItems}\r\n              validator={this.state.containerValidator}\r\n              navigation={this.props.navigation}\r\n              currentProcess={this.props.currentProcess}\r\n              currentStep={this.props.currentStep}\r\n            />\r\n          }\r\n        />\r\n      );\r\n      /*jshint ignore:end*/\r\n    }\r\n  }\r\n\r\n  FurmlySelectSet.notifyExtra = true;\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlySelectSet));\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport ValidatorHelper from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\nimport _ from \"lodash\";\r\nimport {\r\n  runFurmlyProcessor,\r\n  openConfirmation,\r\n  clearElementData\r\n} from \"./actions\";\r\nimport { getKey, copy } from \"./utils/view\";\r\nimport withLogger from \"./furmly_base\";\r\n\r\nexport default (\r\n  Layout,\r\n  Button,\r\n  List,\r\n  Modal,\r\n  ErrorText,\r\n  ProgressBar,\r\n  Container\r\n) => {\r\n  invariants.validComponent(Layout, \"Layout\");\r\n  invariants.validComponent(Button, \"Button\");\r\n  invariants.validComponent(List, \"List\");\r\n  invariants.validComponent(Modal, \"Modal\");\r\n  invariants.validComponent(ErrorText, \"ErrorText\");\r\n  invariants.validComponent(Container, \"Container\");\r\n\r\n  const EDIT = \"EDIT\",\r\n    NEW = \"NEW\";\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    let component_uid = getKey(state, ownProps.component_uid, ownProps);\r\n\r\n    return {\r\n      confirmation:\r\n        state.app &&\r\n        state.app.confirmationResult &&\r\n        state.app.confirmationResult[component_uid],\r\n      templateCache: state.furmly.view.templateCache,\r\n      dataTemplate: state.furmly.view[component_uid],\r\n      component_uid,\r\n      busy: state.furmly.view[`${component_uid}-busy`],\r\n      items: ownProps.value\r\n    };\r\n  };\r\n  const equivalent = function(arr, arr2) {\r\n    if ((!arr && !arr2) || (arr && arr.length == 0 && arr2 && arr2.length == 0))\r\n      return true;\r\n\r\n    if ((arr && !arr2) || (arr2 && !arr) || arr.length !== arr2.length)\r\n      return false;\r\n\r\n    return _.isEqualWith(arr, arr2, (objValue, otherValue) => {\r\n      if (objValue === arr || otherValue === arr2) return;\r\n      if (typeof otherValue == \"string\") {\r\n        return !!_.findKey(objValue, function(v) {\r\n          return v == otherValue;\r\n        });\r\n      }\r\n      let r = _.isMatch(objValue, otherValue);\r\n      return r;\r\n    });\r\n  };\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      getListItemDataTemplate: (id, args, key) =>\r\n        dispatch(runFurmlyProcessor(id, args, key)),\r\n      openConfirmation: (id, message, params) =>\r\n        dispatch(openConfirmation(id, message, params)),\r\n      clearElementData: key => dispatch(clearElementData(key))\r\n    };\r\n  };\r\n\r\n  class FurmlyList extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        validator: {},\r\n        modalVisible: false\r\n      };\r\n      this.showModal = this.showModal.bind(this);\r\n      this.closeModal = this.closeModal.bind(this);\r\n      this.valueChanged = this.valueChanged.bind(this);\r\n      this.getItemTemplate = this.getItemTemplate.bind(this);\r\n      this.edit = this.edit.bind(this);\r\n      this.runValidators = this.runValidators.bind(this);\r\n      this.isDisabled = this.isDisabled.bind(this);\r\n      this.getListItemDataTemplate = this.getListItemDataTemplate.bind(this);\r\n      this.props.validator.validate = () => {\r\n        return this.runValidators();\r\n      };\r\n      this.remove = this.remove.bind(this);\r\n    }\r\n\r\n    componentWillReceiveProps(next) {\r\n      if (\r\n        next.confirmation !== this.props.confirmation &&\r\n        next.confirmation &&\r\n        next.confirmation.params &&\r\n        typeof next.confirmation.params.index !== \"undefined\" &&\r\n        this.props.items &&\r\n        this.props.items.length\r\n      ) {\r\n        let items = (this.props.items || []).slice();\r\n        return (\r\n          items.splice(next.confirmation.params.index, 1),\r\n          this.props.valueChanged({\r\n            [this.props.name]: items\r\n          })\r\n        );\r\n      }\r\n      if (this.props.component_uid !== next.component_uid) {\r\n        if (this._mounted) {\r\n          this.getItemTemplate();\r\n          if (\r\n            (!next.dataTemplate || next.dataTemplate.length) &&\r\n            !next.items &&\r\n            next.args &&\r\n            next.args.default &&\r\n            next.args.default.length\r\n          ) {\r\n            this.props.valueChanged({\r\n              [this.props.name]: next.args.default.slice()\r\n            });\r\n          }\r\n          this.setState({\r\n            edit: null,\r\n            modalVisible: false\r\n          });\r\n        }\r\n      }\r\n      if (\r\n        next.args.listItemDataTemplateProcessor &&\r\n        next.items &&\r\n        next.items.length &&\r\n        next.items !== next.dataTemplate &&\r\n        next.dataTemplate == this.props.dataTemplate &&\r\n        !next.busy\r\n      ) {\r\n        this.getListItemDataTemplate(next.items, next);\r\n      }\r\n\r\n      if (\r\n        next.dataTemplate &&\r\n        next.dataTemplate !== this.props.dataTemplate &&\r\n        !next.busy\r\n      ) {\r\n        if (this._mounted) {\r\n          this.props.valueChanged({\r\n            [this.props.name]: next.dataTemplate\r\n          });\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    componentWillUnmount() {\r\n      this._mounted = false;\r\n      //need to cleanup the namespace.\r\n      this.props.clearElementData(this.props.component_uid);\r\n    }\r\n\r\n    componentDidMount() {\r\n      this._mounted = true;\r\n      //if its template is a reference then store it.\r\n      if (this.isTemplateRef()) {\r\n        this.props.templateCache[\r\n          this.isTemplateRef()\r\n        ] = Array.prototype.isPrototypeOf(this.props.args.itemTemplate)\r\n          ? this.props.args.itemTemplate\r\n          : this.props.args.itemTemplate.template;\r\n      }\r\n\r\n      let equal = equivalent(this.props.dataTemplate, this.props.items);\r\n      //if theres a data template processor then run it.\r\n      if (\r\n        this.props.args.listItemDataTemplateProcessor &&\r\n        this.props.items &&\r\n        this.props.items.length &&\r\n        !equal\r\n      ) {\r\n        this.getListItemDataTemplate(this.props.items);\r\n      }\r\n\r\n      if (this.props.dataTemplate && this.props.dataTemplate.length && equal) {\r\n        setTimeout(() => {\r\n          this.props.valueChanged({\r\n            [this.props.name]: this.props.dataTemplate\r\n          });\r\n        }, 0);\r\n      }\r\n\r\n      if (\r\n        (!this.props.dataTemplate || !this.props.dataTemplate.length) &&\r\n        !this.props.items &&\r\n        this.props.args &&\r\n        this.props.args.default &&\r\n        this.props.args.default.length\r\n      ) {\r\n        setTimeout(() => {\r\n          this.props.valueChanged({\r\n            [this.props.name]: this.props.args.default.slice()\r\n          });\r\n        });\r\n      }\r\n\r\n      this.getItemTemplate();\r\n    }\r\n\r\n    getListItemDataTemplate(i, props = this.props) {\r\n      this.props.getListItemDataTemplate(\r\n        props.args.listItemDataTemplateProcessor,\r\n        i,\r\n        props.component_uid\r\n      );\r\n    }\r\n    isTemplateRef() {\r\n      return (\r\n        (this.props.args.itemTemplate &&\r\n          !Array.prototype.isPrototypeOf(this.props.args.itemTemplate) &&\r\n          this.props.args.itemTemplate.furmly_ref) ||\r\n        (this.props.args.behavior &&\r\n          this.props.args.behavior.furmly_ref &&\r\n          this.props.args.itemTemplate)\r\n      );\r\n    }\r\n    runValidators() {\r\n      return new ValidatorHelper(this).run();\r\n    }\r\n    isDisabled() {\r\n      return this.props.args && this.props.args.disabled;\r\n    }\r\n    showModal() {\r\n      if (!this.isDisabled()) this.setState({ modalVisible: true, mode: NEW });\r\n    }\r\n    hasValue() {\r\n      return (\r\n        (this.props.items && this.props.items.length) ||\r\n        \"Requires atleast one item to have been added to the list\"\r\n      );\r\n    }\r\n    isLessThanMaxLength(element) {\r\n      return (\r\n        (this.props.items &&\r\n          this.props.items.length &&\r\n          this.props.items.length <= element.args.max) ||\r\n        (element.error || \"The maximum number of items is \" + element.args.max)\r\n      );\r\n    }\r\n    isGreaterThanMinLength(element) {\r\n      return (\r\n        (this.props.items &&\r\n          this.props.items.length &&\r\n          this.props.items.length >= element.args.min) ||\r\n        (element.error || \"The minimum number of items is \" + element.args.min)\r\n      );\r\n    }\r\n    closeModal(result) {\r\n      //he/she clicked ok\r\n      if (result) {\r\n        this.state.validator\r\n          .validate()\r\n          .then(() => {\r\n            let items = (this.props.items || []).slice();\r\n\r\n            if (this.state.mode == NEW) items.push(this.state.edit);\r\n            else items.splice(this.state.existing, 1, this.state.edit);\r\n            this.props.valueChanged({ [this.props.name]: items });\r\n            this.setState({\r\n              modalVisible: false,\r\n              edit: null,\r\n              existing: null\r\n            });\r\n\r\n            // if (this.props.args.listItemDataTemplateProcessor)\r\n            // \tthis.getListItemDataTemplate(items);\r\n          })\r\n          .catch(er => {\r\nthis.props.log(er);\r\n          });\r\n        return;\r\n      }\r\n      //canceled the modal box.\r\n\r\n      this.setState({ modalVisible: false, edit: null });\r\n    }\r\n    valueChanged(v) {\r\n      //this.state.form = v && v[FurmlyList.modalName()];\r\n      this.setState({ edit: v && v[FurmlyList.modalName()] });\r\n    }\r\n\r\n    remove(index) {\r\n      this.props.openConfirmation(\r\n        this.props.component_uid,\r\n        \"Are you sure you want to remove that item ?\",\r\n        { index }\r\n      );\r\n    }\r\n    edit(index) {\r\n      this.setState({\r\n        edit: JSON.parse(JSON.stringify(this.props.items[index])),\r\n        existing: index,\r\n        mode: EDIT,\r\n        modalVisible: true\r\n      });\r\n    }\r\n    static modalName() {\r\n      return \"_modal_\";\r\n    }\r\n    getItemTemplate() {\r\n      if (this.state.itemTemplate) return;\r\n\r\n      if (!this.props.args.itemTemplate) {\r\n        if (\r\n          (!this.props.args.behavior ||\r\n            !this.props.args.behavior.template_ref) &&\r\n          !this.props.args.disabled\r\n        )\r\n          throw new Error(\"Empty List view item template\");\r\n\r\n        this.props.args.itemTemplate =\r\n          this.props.templateCache[\r\n            this.props.args.behavior && this.props.args.behavior.template_ref\r\n          ] || [];\r\n      }\r\n\r\n      let itemTemplate = copy(\r\n        this.isTemplateRef() &&\r\n        !Array.prototype.isPrototypeOf(this.props.args.itemTemplate)\r\n          ? this.props.args.itemTemplate.template\r\n          : this.props.args.itemTemplate\r\n      );\r\n\r\n      if (\r\n        this.props.args.behavior &&\r\n        this.props.args.behavior.extension &&\r\n        this.props.args.behavior.extension.length\r\n      )\r\n        this.props.args.behavior.extension.forEach((element, index) => {\r\n          element.key = index;\r\n          itemTemplate.push(copy(element));\r\n        });\r\n\r\n      //this happens asynchronously;\r\n      setTimeout(() => {\r\n        if (this._mounted)\r\n          this.setState({\r\n            itemTemplate: itemTemplate\r\n          });\r\n      }, 0);\r\n    }\r\n\r\n    render() {\r\n      if (this.props.busy) {\r\n        return <ProgressBar />;\r\n      }\r\n      let //template = this.getItemTemplate(),\r\n      disabled = this.isDisabled();\r\n\r\n      return (\r\n        /*jshint ignore:start */\r\n        <Layout value={this.props.label} description={this.props.description}>\r\n          <Button disabled={disabled} click={this.showModal} />\r\n          <List\r\n            items={this.props.items}\r\n            rowClicked={this.edit}\r\n            rowRemoved={this.remove}\r\n            rowTemplate={\r\n              this.props.args.rowTemplate &&\r\n              JSON.parse(this.props.args.rowTemplate)\r\n            }\r\n            disabled={disabled}\r\n          />\r\n          <ErrorText value={this.state.errors} />\r\n          <Modal\r\n            template={\r\n              <Container\r\n                elements={this.state.itemTemplate}\r\n                value={this.state.edit}\r\n                name={FurmlyList.modalName()}\r\n                validator={this.state.validator}\r\n                valueChanged={this.valueChanged}\r\n                navigation={this.props.navigation}\r\n                currentProcess={this.props.currentProcess}\r\n                currentStep={this.props.currentStep}\r\n              />\r\n            }\r\n            visibility={this.state.modalVisible}\r\n            done={this.closeModal}\r\n          />\r\n        </Layout>\r\n        /*jshint ignore:end */\r\n      );\r\n    }\r\n  }\r\n\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlyList));\r\n};\r\n","import React from \"react\";\r\nimport { isObjectIdMode, getValueBasedOnMode } from \"./utils/view\";\r\n\r\nexport default class FurmlyHidden extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.init = this.init.bind(this);\r\n\t}\r\n\tcomponentDidMount() {\r\n\t\tthis.init();\r\n\t}\r\n\tinit(props = this.props) {\r\n\t\tif (\r\n\t\t\tprops.args &&\r\n\t\t\tprops.args.default &&\r\n\t\t\tprops.args.default !== props.value &&\r\n\t\t\t!props.value\r\n\t\t)\r\n\t\t\treturn this.props.valueChanged({\r\n\t\t\t\t[props.name]: getValueBasedOnMode(props, props.args.default)\r\n\t\t\t});\r\n\r\n\t\tif (isObjectIdMode(props) && this.props.value !== props.value) {\r\n\t\t\tthis.props.valueChanged({\r\n\t\t\t\t[props.name]: getValueBasedOnMode(props, props.value)\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tcomponentWillReceiveProps(next) {\r\n\t\tthis.init(next);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn null;\r\n\t}\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport invariants from \"./utils/invariants\";\r\nimport withLogger from \"./furmly_base\";\r\nexport default (Link, NavigationActions) => {\r\n  if (invariants.validComponent(Link, \"Link\") && !NavigationActions)\r\n    throw new Error(\"NavigationActions cannot be null (furmly_nav)\");\r\n\r\n  const mapDispatchToState = dispatch => {\r\n    return {\r\n      dispatch\r\n    };\r\n  };\r\n\r\n  const mapStateToProps = (_, initialProps) => state => {\r\n    return {\r\n      context: state && state.furmly.view && state.furmly.view.navigationContext\r\n    };\r\n  };\r\n\r\n  //{text:\"link text\",type:\"FURMLY or CLIENT\",config:{value:\"\"}}\r\n  class FurmlyNav extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.go = this.go.bind(this);\r\n      this.state = { link: this.props.value };\r\n    }\r\n    static getParams(firstItemIsLink, link) {\r\n      let key_value = link.split(\"|\");\r\n      if (firstItemIsLink) link = key_value.shift();\r\n      let params = key_value.reduce((sum, x) => {\r\n          let sp = x.split(\"=\");\r\n          return (sum[sp[0]] = decodeURIComponent(sp[1])), sum;\r\n        }, {}),\r\n        result = { params };\r\n      if (firstItemIsLink || !key_value.length) result.link = link;\r\n      return result;\r\n    }\r\n    go() {\r\n      let params = null;\r\n      let link =\r\n        this.state.link ||\r\n        (this.props.args.config && this.props.args.config.value);\r\n      if (link) {\r\n        let linkAndParams = FurmlyNav.getParams(true, link);\r\n        if (this.props.args.params) {\r\n          let paramsOnly = FurmlyNav.getParams(false, this.props.args.params);\r\n          Object.assign(linkAndParams.params, paramsOnly.params);\r\n        }\r\n\r\n        link = linkAndParams.link;\r\n        params = linkAndParams.params;\r\n        switch (this.props.args.type) {\r\n          case FurmlyNav.NAV_TYPE.CLIENT:\r\n            //this.props.dispatch(\r\n            NavigationActions.navigate(\r\n              {\r\n                key: link,\r\n                params\r\n              },\r\n              this.props.context,\r\n              this.props.navigation\r\n            );\r\n            //);\r\n            break;\r\n\r\n          case FurmlyNav.NAV_TYPE.FURMLY:\r\n            //const setParamsAction =\r\n            NavigationActions.setParams(\r\n              {\r\n                params: { id: link, fetchParams: params },\r\n                key: \"Furmly\"\r\n              },\r\n              this.props.context,\r\n              this.props.navigation\r\n            );\r\n          //this.props.dispatch(setParamsAction);\r\n        }\r\n      }\r\n    }\r\n    render() {\r\n      return (\r\n        /*jshint ignore:start */\r\n        <Link\r\n          text={this.props.args.text}\r\n          disabled={this.props.args.disabled}\r\n          go={this.go}\r\n        />\r\n        /*jshint ignore:end */\r\n      );\r\n    }\r\n  }\r\n  FurmlyNav.NAV_TYPE = { CLIENT: \"CLIENT\", FURMLY: \"FURMLY\" };\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToState\r\n  )(withLogger(FurmlyNav));\r\n};\r\n","import React from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default Image => {\r\n  invariants.validComponent(Image, \"Image\");\r\n\r\n  return withLogger(props => {\r\n    let { value, args, ...rest } = props;\r\n    if (value && props.args.type == \"URL\") {\r\n      let data = props.args.config.data.replace(\r\n          new RegExp(`{${props.name}}`, \"g\"),\r\n          value\r\n        ),\r\n        args = Object.assign({}, props.args);\r\n      args.config = { data };\r\n      return <Image args={args} {...rest} />;\r\n    }\r\n    return <Image {...props} />;\r\n  }, \"Image\");\r\n};\r\n","import React from \"react\";\r\nimport FurmlyBase from \"./furmly_base\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  runFurmlyProcessor,\r\n  getMoreForGrid,\r\n  filterGrid,\r\n  getSingleItemForGrid,\r\n  getFilterTemplate,\r\n  getItemTemplate,\r\n  showMessage\r\n} from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport { getKey, copy, getErrorKey } from \"./utils/view\";\r\n\r\nexport const GRID_MODES = {\r\n  CRUD: \"CRUD\",\r\n  EDITONLY: \"EDITONLY\"\r\n};\r\nexport const ITEM_MODES = {\r\n  NEW: \"NEW\",\r\n  EDIT: \"EDIT\"\r\n};\r\n\r\nexport default (\r\n  Layout,\r\n  List,\r\n  ItemView,\r\n  Header,\r\n  ProgressBar,\r\n  CommandsView,\r\n  NavigationActions,\r\n  CommandResultView,\r\n  Container\r\n) => {\r\n  if (\r\n    invariants.validComponent(Layout, \"Layout\") &&\r\n    invariants.validComponent(Header, \"Header\") &&\r\n    invariants.validComponent(List, \"List\") &&\r\n    invariants.validComponent(ItemView, \"ItemView\") &&\r\n    invariants.validComponent(ProgressBar, \"ProgressBar\") &&\r\n    invariants.validComponent(CommandsView, \"CommandsView\") &&\r\n    invariants.validComponent(Container, \"Container\") &&\r\n    invariants.validComponent(CommandResultView, \"CommandResultView\") &&\r\n    !NavigationActions\r\n  )\r\n    throw new Error(\"NavigationActions cannot be null (furmly_grid)\");\r\n\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      run: (id, args, key) =>\r\n        dispatch(\r\n          runFurmlyProcessor(id, args, key, {\r\n            disableCache: true,\r\n            disableRetry: true\r\n          })\r\n        ),\r\n      more: (id, args, key) => dispatch(getMoreForGrid(id, args, key)),\r\n      go: value =>\r\n        dispatch(\r\n          NavigationActions.setParams({\r\n            params: { id: value },\r\n            key: \"Furmly\"\r\n          })\r\n        ),\r\n      getSingleItem: (id, args, key) =>\r\n        dispatch(getSingleItemForGrid(id, args, key)),\r\n      getItemTemplate: (id, args, key) =>\r\n        dispatch(getItemTemplate(id, args, key)),\r\n      getFilterTemplate: (id, args, key) =>\r\n        dispatch(getFilterTemplate(id, args, key)),\r\n      filterGrid: (id, args, key) => dispatch(filterGrid(id, args, key)),\r\n      showMessage: message => dispatch(showMessage(message))\r\n    };\r\n  };\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    let component_uid = getKey(state, ownProps.component_uid, ownProps);\r\n    var result = state.furmly.view[component_uid];\r\n    return {\r\n      component_uid,\r\n\r\n      items: result && result.data ? result.data.items : null,\r\n      total: result && result.data ? result.data.total : 0,\r\n      busy: result && !!result.fetchingGrid,\r\n      error: result && !!result.failedToFetchGrid,\r\n      filterTemplate:\r\n        (result && result.filterTemplate) ||\r\n        (ownProps.args && ownProps.args.filter) ||\r\n        null,\r\n      filter: result && result.filter,\r\n      singleItem: result && result.singleItem,\r\n      itemTemplate: result && result.itemTemplate,\r\n      fetchingSingleItem: result && result.fetchingSingleItem,\r\n      fetchingFilterTemplate: result && result.gettingFilterTemplate,\r\n      fetchingItemTemplate: result && result.gettingTemplate,\r\n      itemTemplateError: result && result[getErrorKey(\"gettingTemplate\")],\r\n      filterTemplateError:\r\n        result && result[getErrorKey(\"gettingFilterTemplate\")],\r\n      singleItemError: result && result[getErrorKey(\"fetchingSingleItem\")],\r\n      commandProcessed:\r\n        state.furmly.view[component_uid + FurmlyGrid.commandResultViewName()],\r\n      commandProcessing:\r\n        state.furmly.view[\r\n          component_uid + FurmlyGrid.commandResultViewName() + \"-busy\"\r\n        ],\r\n      processed: state.furmly.view[component_uid + FurmlyGrid.itemViewName()]\r\n    };\r\n  };\r\n  class FurmlyGrid extends React.Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        form: null,\r\n        validator: {},\r\n        _filterValidator: {},\r\n        showItemView: false,\r\n        count: this.props.args.pageCount || 5,\r\n        showCommandResultView: false\r\n      };\r\n      this.itemValueChanged = this.itemValueChanged.bind(this);\r\n      this.showItemView = this.showItemView.bind(this);\r\n      this.cancel = this.cancel.bind(this);\r\n      this.showItemView = this.showItemView.bind(this);\r\n      this.isCRUD = this.isCRUD.bind(this);\r\n      this.isEDITONLY = this.isEDITONLY.bind(this);\r\n      this.valueChanged = this.valueChanged.bind(this);\r\n      this.getItemsFromSource = this.getItemsFromSource.bind(this);\r\n      this.done = this.done.bind(this);\r\n      this.filter = this.filter.bind(this);\r\n      this.getFilterValue = this.getFilterValue.bind(this);\r\n      this.getItemValue = this.getItemValue.bind(this);\r\n      this.more = this.more.bind(this);\r\n      this.finished = this.finished.bind(this);\r\n      this.openCommandMenu = this.openCommandMenu.bind(this);\r\n      this.closeCommandView = this.closeCommandView.bind(this);\r\n      this.execCommand = this.execCommand.bind(this);\r\n      this.showCommandResult = this.showCommandResult.bind(this);\r\n      this.closeCommandResult = this.closeCommandResult.bind(this);\r\n      this.fetchFilterTemplate = this.fetchFilterTemplate.bind(this);\r\n      if (\r\n        (this.isCRUD() || this.isEDITONLY()) &&\r\n        (!this.props.args.commands ||\r\n          !this.props.args.commands.filter(x => x.commandType == \"$EDIT\")\r\n            .length)\r\n      ) {\r\n        let cmd = {\r\n          commandText: \"Edit\",\r\n          command: { value: \"\" },\r\n          commandType: \"$EDIT\",\r\n          commandIcon: \"mode-edit\"\r\n        };\r\n        if (!this.props.args.commands) this.props.args.commands = [];\r\n        this.props.args.commands.unshift(cmd);\r\n      }\r\n    }\r\n    componentDidMount() {\r\n      this._mounted = true;\r\n      this.fetchFilterTemplate();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n      this._mounted = false;\r\n    }\r\n\r\n    fetchFilterTemplate(props = this.props, other) {\r\n      if (\r\n        !props.filterTemplateError &&\r\n        props.args.filterProcessor &&\r\n        !props.fetchingFilterTemplate &&\r\n        !props.filterTemplate &&\r\n        (!other || (other && props.filterTemplate !== other))\r\n      ) {\r\n        this.props.getFilterTemplate(\r\n          props.args.filterProcessor,\r\n          JSON.parse(props.args.gridArgs || \"{}\"),\r\n          props.component_uid\r\n        );\r\n      }\r\n    }\r\n    showCommandResult(props = this.props) {\r\n      this.setState({\r\n        showCommandsView: false,\r\n        showCommandResultView: true,\r\n        commandResult: props.commandProcessed\r\n      });\r\n    }\r\n    closeCommandResult() {\r\n      this.setState({\r\n        showCommandResultView: false,\r\n        result: null\r\n      });\r\n    }\r\n    componentWillReceiveProps(next) {\r\n      if (next.processed !== this.props.processed) {\r\n        this.getItemsFromSource(null, \"filterGrid\");\r\n      }\r\n\r\n      if (next.commandProcessed !== this.props.commandProcessed) {\r\n        this.showCommandResult(next);\r\n      }\r\n\r\n      if (\r\n        next.singleItem &&\r\n        next.singleItem !== this.props.singleItem &&\r\n        (next.itemTemplate && next.itemTemplate !== this.props.itemTemplate)\r\n      ) {\r\n        return this.showItemView(\r\n          ITEM_MODES.EDIT,\r\n          next.singleItem,\r\n          true,\r\n          next.itemTemplate\r\n        );\r\n      }\r\n\r\n      if (\r\n        next.singleItem &&\r\n        next.singleItem !== this.props.singleItem &&\r\n        !next.fetchingItemTemplate\r\n      ) {\r\n        return this.showItemView(ITEM_MODES.EDIT, next.singleItem, true);\r\n      }\r\n\r\n      if (next.itemTemplate && next.itemTemplate !== this.props.itemTemplate) {\r\n        return this.showItemView(\r\n          this.state.mode,\r\n          this.getItemValue() || this.props.singleItem,\r\n          true,\r\n          next.itemTemplate\r\n        );\r\n      }\r\n\r\n      this.fetchFilterTemplate(next, this.props.filterTemplate);\r\n    }\r\n    getItemsFromSource(filter = getFilterValue(), methodName = \"run\", extra) {\r\n      this.props[methodName](\r\n        this.props.args.source,\r\n        Object.assign(\r\n          {},\r\n          JSON.parse(this.props.args.gridArgs || \"{}\"),\r\n          { count: this.state.count, full: true },\r\n          filter ? { query: filter } : {},\r\n          extra || {}\r\n        ),\r\n        this.props.component_uid\r\n      );\r\n    }\r\n    getItemValue() {\r\n      return this.state.form;\r\n    }\r\n    getFilterValue() {\r\n      return (\r\n        (this.props.value && this.props.value[FurmlyGrid.filterViewName()]) ||\r\n        null\r\n      );\r\n    }\r\n\r\n    filter() {\r\n      this.state._filterValidator.validate().then(\r\n        () => {\r\n          this.getItemsFromSource(this.getFilterValue(), \"filterGrid\");\r\n        },\r\n        () => {\r\nthis.props.log(\"a field in filter is invalid\");\r\n        }\r\n      );\r\n    }\r\n    static itemViewName() {\r\n      return \"_itemView_\";\r\n    }\r\n    static filterViewName() {\r\n      return \"_filterView_\";\r\n    }\r\n    static commandResultViewName() {\r\n      return \"_commandResultView_\";\r\n    }\r\n    valueChanged(value) {\r\n      this.props.valueChanged({\r\n        [this.props.name]: Object.assign(\r\n          {},\r\n          this.props.value || {},\r\n          value || {}\r\n        )\r\n      });\r\n    }\r\n    done(submitted) {\r\n      if (!submitted) return this.cancel();\r\n\r\n      this.state.validator.validate().then(\r\n        () => {\r\n          let id;\r\n          switch (this.state.mode) {\r\n            case ITEM_MODES.NEW:\r\n              id = this.props.args.extra.createProcessor;\r\n              break;\r\n            case ITEM_MODES.EDIT:\r\n              id =\r\n                this.props.args.extra.editProcessor ||\r\n                this.props.args.extra.createProcessor;\r\n              break;\r\n          }\r\n          if (!id) {\r\n            return this.props.log(\r\n              \"done  was called on a grid view in \" +\r\n                this.props.args.mode +\r\n                \" and it does not have a processor for it. \\n\" +\r\n                JSON.stringify(this.props, null, \" \")\r\n            );\r\n          }\r\n\r\n          this.props.run(\r\n            id,\r\n            Object.assign(JSON.parse(this.props.args.gridArgs || \"{}\"), {\r\n              entity: this.getItemValue()\r\n            }),\r\n            this.props.component_uid + FurmlyGrid.itemViewName()\r\n          );\r\n\r\n          this.cancel();\r\n        },\r\n        () => {\r\n          this.props.log(\"some modal fields are invalid\");\r\n        }\r\n      );\r\n    }\r\n    showItemView(mode, args, skipFetch, _itemTemplate) {\r\n      let template = _itemTemplate,\r\n        gettingItemTemplate = false,\r\n        existingValue;\r\n      if (this.props.args.extra)\r\n        switch (mode) {\r\n          case ITEM_MODES.NEW:\r\n            template =\r\n              _itemTemplate ||\r\n              (\r\n                (this.props.args.extra.createTemplate &&\r\n                  this.props.args.extra.createTemplate.length &&\r\n                  this.props.args.extra.createTemplate) ||\r\n                this.props.itemTemplate ||\r\n                []\r\n              ).slice();\r\n            break;\r\n          case ITEM_MODES.EDIT:\r\n            template =\r\n              _itemTemplate ||\r\n              (\r\n                (this.props.args.extra.editTemplate &&\r\n                  this.props.args.extra.editTemplate.length &&\r\n                  this.props.args.extra.editTemplate) ||\r\n                (this.props.args.extra.createTemplate &&\r\n                  this.props.args.extra.createTemplate.length &&\r\n                  this.props.args.extra.createTemplate) ||\r\n                this.props.itemTemplate ||\r\n                []\r\n              ).slice();\r\n            existingValue = args;\r\n            if (\r\n              this.props.args.extra.fetchSingleItemProcessor &&\r\n              !this.props.fetchingSingleItem &&\r\n              !this.props.singleItemError &&\r\n              !skipFetch\r\n            ) {\r\n              template = [];\r\n              existingValue = null;\r\n              this.props.getSingleItem(\r\n                this.props.args.extra.fetchSingleItemProcessor,\r\n                args,\r\n                this.props.component_uid\r\n              );\r\n            }\r\n\r\n            break;\r\n        }\r\n\r\n      if (\r\n        (!template || !Array.prototype.isPrototypeOf(template)) &&\r\n        !this.props.args.extra.fetchTemplateProcessor\r\n      ) {\r\n        return this.props.log(\r\n          \"showItemTemplate was called on a grid view in \" +\r\n            this.props.args.mode +\r\n            \" and it does not have a template. \\n\" +\r\n            JSON.stringify(this.props, null, \" \")\r\n        );\r\n      }\r\n      if (\r\n        (!template || !template.length) &&\r\n        !this.props.fetchingItemTemplate &&\r\n        !this.props.itemTemplateError &&\r\n        this.props.args.extra.fetchTemplateProcessor &&\r\n        !skipFetch\r\n      ) {\r\n        gettingItemTemplate = true;\r\n        this.props.getItemTemplate(\r\n          this.props.args.extra.fetchTemplateProcessor,\r\n          args,\r\n          this.props.component_uid\r\n        );\r\n      }\r\n      let update = {\r\n        validator: {},\r\n        showItemView: true,\r\n        mode: mode,\r\n        showCommandsView: false,\r\n        itemViewElements: template\r\n      };\r\n      if (!gettingItemTemplate)\r\n        update.form = existingValue ? copy(existingValue) : existingValue;\r\n      this.setState(update);\r\n    }\r\n\r\n    more() {\r\n      if (!this.finished() && !this.props.busy && !this.props.error) {\r\n        //log(\"more fired getItemsFromSource\");\r\n        let query = {\r\n          count: this.state.count\r\n        };\r\n        if (this.props.items && this.props.items[this.props.items.length - 1]) {\r\n          query._id = this.props.items[this.props.items.length - 1]._id;\r\n          this.props.log(\"most recent id:\" + query._id);\r\n        }\r\n\r\n        this.getItemsFromSource(this.getFilterValue(), \"more\", query);\r\n      }\r\n    }\r\n    finished() {\r\n      return this.props.items && this.props.total == this.props.items.length;\r\n    }\r\n    cancel() {\r\n      this.setState({\r\n        mode: null,\r\n        showItemView: false,\r\n        itemViewElements: null,\r\n        showCommandsView: false,\r\n        form: null\r\n      });\r\n    }\r\n\r\n    closeCommandView() {\r\n      this.setState({ showCommandsView: false });\r\n    }\r\n    itemValueChanged(value) {\r\n      this.setState({\r\n        form: Object.assign(\r\n          {},\r\n          this.state.form || {},\r\n          (value && value[FurmlyGrid.itemViewName()]) || {}\r\n        )\r\n      });\r\n    }\r\n    openCommandMenu(item) {\r\n      this.setState({ item: item, showCommandsView: true });\r\n    }\r\n    execCommand(command, item = this.state.item) {\r\n      switch (command.commandType) {\r\n        case \"NAV\":\r\n          this.props.go(command.command.value, {\r\n            fetchParams: { _id: item._id }\r\n          });\r\n          break;\r\n        case \"$EDIT\":\r\n          this.showItemView(ITEM_MODES.EDIT, item);\r\n          break;\r\n        case \"PROCESSOR\":\r\n          this.props.run(\r\n            command.command.value,\r\n            Object.assign(\r\n              {},\r\n              JSON.parse(this.props.args.gridArgs || \"{}\"),\r\n              item\r\n            ),\r\n            this.props.component_uid + FurmlyGrid.commandResultViewName()\r\n          );\r\n          break;\r\n      }\r\n    }\r\n    isCRUD() {\r\n      return this.props.args.mode == GRID_MODES.CRUD;\r\n    }\r\n    isEDITONLY() {\r\n      return this.props.args.mode == GRID_MODES.EDITONLY;\r\n    }\r\n    render() {\r\n      this.props.log(\"rendering..\");\r\n\r\n      let args = this.props.args,\r\n        header = this.props.filterTemplate ? (\r\n          <Header filter={() => this.filter()}>\r\n            <Container\r\n              elements={this.props.filterTemplate}\r\n              value={this.getFilterValue()}\r\n              valueChanged={this.valueChanged}\r\n              name={FurmlyGrid.filterViewName()}\r\n              validator={this.state._filterValidator}\r\n              navigation={this.props.navigation}\r\n              currentProcess={this.props.currentProcess}\r\n              currentStep={this.props.currentStep}\r\n            />\r\n          </Header>\r\n        ) : this.props.fetchingFilterTemplate ? (\r\n          <ProgressBar />\r\n        ) : null,\r\n        footer = !this.finished() && this.props.busy ? <ProgressBar /> : null;\r\n\r\n      return (\r\n        <Layout>\r\n          <List\r\n            title={this.props.label}\r\n            canAddOrEdit={this.isCRUD()}\r\n            header={header}\r\n            footer={footer}\r\n            total={this.props.total}\r\n            showItemView={this.showItemView}\r\n            items={this.props.items}\r\n            templateConfig={\r\n              this.props.args.templateConfig\r\n                ? JSON.parse(this.props.args.templateConfig)\r\n                : null\r\n            }\r\n            more={this.more}\r\n            autoFetch={!this.props.args.dontAutoFetchFromSource}\r\n            commands={this.props.args.commands}\r\n            execCommand={this.execCommand}\r\n            openCommandMenu={this.openCommandMenu}\r\n            busy={!this.finished() && this.props.busy}\r\n          />\r\n          <ItemView\r\n            visibility={\r\n              (this.isCRUD() || this.isEDITONLY()) && this.state.showItemView\r\n            }\r\n            done={this.done}\r\n            busy={\r\n              this.props.fetchingSingleItem || this.props.fetchingItemTemplate\r\n            }\r\n            template={\r\n              <Container\r\n                elements={this.state.itemViewElements}\r\n                value={this.getItemValue()}\r\n                name={FurmlyGrid.itemViewName()}\r\n                validator={this.state.validator}\r\n                valueChanged={this.itemValueChanged}\r\n                navigation={this.props.navigation}\r\n                currentProcess={this.props.currentProcess}\r\n                currentStep={this.props.currentStep}\r\n              />\r\n            }\r\n          />\r\n          <CommandsView\r\n            visibility={this.state.showCommandsView}\r\n            close={this.closeCommandView}\r\n            commands={this.props.args.commands}\r\n            execCommand={this.execCommand}\r\n          />\r\n          <CommandResultView\r\n            visibility={this.state.showCommandResultView}\r\n            done={this.closeCommandResult}\r\n            template={\r\n              <Container\r\n                elements={this.state.commandResult}\r\n                name={FurmlyGrid.commandResultViewName()}\r\n                validator={{}}\r\n                navigation={this.props.navigation}\r\n                currentProcess={this.props.currentProcess}\r\n                currentStep={this.props.currentStep}\r\n              />\r\n            }\r\n            title={\"\"}\r\n            busy={this.props.commandProcessing}\r\n          />\r\n        </Layout>\r\n      );\r\n    }\r\n  }\r\n\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlyGrid));\r\n};\r\n","import React, { Component } from \"react\";\r\nimport withLogger from \"./furmly_base\";\r\nexport default PlatformComponent => {\r\n  return withLogger(\r\n    class FurmlyHTMLViewer extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n      }\r\n      render() {\r\n        return (\r\n          <PlatformComponent\r\n            html={\r\n              this.props.value ||\r\n              (this.props.args && this.props.args.html) ||\r\n              \"<h3 style='padding:16px'>Something doesn't add up. Please contact system admin if this happens frequently.</h3>\"\r\n            }\r\n            {...this.props}\r\n          />\r\n        );\r\n      }\r\n    }\r\n  );\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport withLogger from \"./furmly_base\";\r\nimport { uploadFurmlyFile, getFurmlyFilePreview } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport ValidationHelper from \"./utils/validator\";\r\nimport { getKey } from \"./utils/view\";\r\n\r\n/**\r\n * This component should render a file uploader\r\n * @param  {Class} Uploader Component responsible for uploading the file\r\n * @param  {Array} previews Array of component definitions with an id property\r\n * @return {Class}          Configured component.\r\n */\r\n\r\nexport default (Uploader, ProgressBar, Text, previews = []) => {\r\n  invariants.validComponent(Uploader, \"Uploader\");\r\n  invariants.validComponent(ProgressBar, \"ProgressBar\");\r\n  invariants.validComponent(Text, \"Text\");\r\n\r\n  class FurmlyFileUpload extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {};\r\n      this._previewType = this.getPreviewType.call(this);\r\n      this._supported = this.isSupported();\r\n      this._getPreview = this._getPreview.bind(this);\r\n      this._query = this.getPreviewQuery();\r\n      this.props.validator.validate = () => {\r\n        return this.runValidators();\r\n      };\r\n      this.upload = this.upload.bind(this);\r\n    }\r\n    runValidators() {\r\n      return new ValidationHelper(this).run();\r\n    }\r\n    hasValue() {\r\n      return !!this.props.uploadedId || \"is required\";\r\n    }\r\n    getPreviewQuery() {\r\n      return Uploader.getPreviewQuery(this.props.args.fileType);\r\n    }\r\n    getPreviewType() {\r\n      for (var i = 0; i < previews.length; i++) {\r\n        if (previews[i].id.test(this.props.args.fileType)) {\r\n          return previews[i];\r\n        }\r\n      }\r\n    }\r\n    isSupported() {\r\n      return Uploader.supports(this.props.args.fileType);\r\n    }\r\n    componentDidMount() {\r\n      this._mounted = true;\r\n      if (this.props.uploadedId && !this.props.preview) {\r\n        this._getPreview(this.props.uploadedId);\r\n      }\r\n      if (this.props.uploadedId !== this.props.value) {\r\n        //update the form incase the preview came with the fileupload\r\n        setTimeout(() => {\r\n          if (this._mounted)\r\n            this.props.valueChanged({\r\n              [this.props.name]: this.props.uploadedId\r\n            });\r\n        }, 0);\r\n      }\r\n    }\r\n    componentWillUnmount() {\r\n      this._mounted = false;\r\n    }\r\n    _getPreview(id) {\r\n      this.props.getPreview(\r\n        id,\r\n        this.props.component_uid,\r\n        this.props.args.fileType,\r\n        this._query\r\n      );\r\n    }\r\n\r\n    componentWillReceiveProps(next) {\r\n      if (\r\n        next.uploadedId !== this.props.uploadedId ||\r\n        next.component_uid !== this.props.component_uid ||\r\n        next.uploadedId !== next.value\r\n      ) {\r\n        if (\r\n          next.uploadedId &&\r\n          (!next.preview || next.uploadedId !== this.props.uploadedId)\r\n        )\r\n          this._getPreview(next.uploadedId);\r\n        this.props.valueChanged({\r\n          [this.props.name]: next.uploadedId\r\n        });\r\n      }\r\n    }\r\n    upload(file) {\r\n      this.props.upload(file, this.props.component_uid);\r\n    }\r\n    render() {\r\nthis.props.log(`render called for ${this.props.name}`);\r\n      if (this.props.busy) return <ProgressBar />;\r\n      if (!this._supported)\r\n        return <Text message={\"unsupported file upload type\"} />;\r\n      return (\r\n        <Uploader\r\n          key={this.props.component_uid}\r\n          title={this.props.label}\r\n          description={this.props.description}\r\n          upload={this.upload}\r\n          component_uid={this.props.component_uid}\r\n          allowed={this.props.args.fileType}\r\n          previewType={this._previewType}\r\n          preview={this.props.preview}\r\n          errors={this.state.errors}\r\n          disabled={this.props.disabled}\r\n        />\r\n      );\r\n    }\r\n  }\r\n\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    let component_uid = getKey(state, ownProps.component_uid, ownProps);\r\n    let st = state.furmly.view[component_uid] || {};\r\n    return {\r\n      component_uid,\r\n      preview: st.preview,\r\n      busy: st.busy,\r\n      disabled: ownProps.args && ownProps.args.disabled,\r\n      uploadedId: st.uploadedId || ownProps.value\r\n    };\r\n  };\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      upload: (file, key) => dispatch(uploadFurmlyFile(file, key)),\r\n      getPreview: (id, key, fileType, query) =>\r\n        dispatch(getFurmlyFilePreview(id, key, fileType, query))\r\n    };\r\n  };\r\n\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlyFileUpload));\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runFurmlyProcessor } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport _ from \"lodash\";\r\nimport { getKey } from \"./utils/view\";\r\nimport withLogger from \"./furmly_base\";\r\nexport default (\r\n  Layout,\r\n  ProgressBar,\r\n  Filter,\r\n  FilterContainer,\r\n  ContentContainer\r\n) => {\r\n  invariants.validComponent(Filter, \"Filter\");\r\n  invariants.validComponent(FilterContainer, \"FilterContainer\");\r\n  invariants.validComponent(ContentContainer, \"ContentContainer\");\r\n  invariants.validComponent(ProgressBar, \"ProgressBar\");\r\n  invariants.validComponent(Layout, \"Layout\");\r\n\r\n  const mapDispatchToProps = dispatch => {\r\n    return {\r\n      run: (id, args, key) =>\r\n        dispatch(runFurmlyProcessor(id, args, key, { disableCache: true })),\r\n      showMessage: message => dispatch(showMessage(message))\r\n    };\r\n  };\r\n  const mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n    var component_uid = getKey(state, ownProps.component_uid, ownProps),\r\n      _actionState = state.furmly.view[component_uid];\r\n    return {\r\n      resultUI: _actionState && (_actionState.ui || _actionState),\r\n      resultData: _actionState && _actionState.data,\r\n      busy: !!state.furmly.view[component_uid + \"-busy\"],\r\n      component_uid\r\n    };\r\n  };\r\n  const itemViewName = \"_item_view\";\r\n  const contentViewName = \"_content_view\";\r\n  class FurmlyActionView extends React.Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = { _filterValidator: {}, validator: {} };\r\n      this.filter = this.filter.bind(this);\r\n      this.valueChanged = this.valueChanged.bind(this);\r\n      this.filterValueChanged = this.filterValueChanged.bind(this);\r\n    }\r\n    componentWillReceiveProps(next) {\r\n      if (!_.isEqual(next.resultData, this.props.resultData)) {\r\n        this.valueChanged({ [contentViewName]: next.resultData });\r\n      }\r\n    }\r\n    filter() {\r\n      this.state._filterValidator.validate().then(\r\n        () => {\r\n          let { [contentViewName]: contentValue, ...rest } =\r\n            this.props.value || {};\r\n          this.props.run(\r\n            this.props.args.action,\r\n            rest,\r\n            this.props.component_uid\r\n          );\r\n        },\r\n        () => {\r\n          this.props.log(\"a field in filter is invalid\");\r\n        }\r\n      );\r\n    }\r\n    filterValueChanged(value) {\r\n      this.valueChanged(value && value[itemViewName]);\r\n    }\r\n    valueChanged(value) {\r\n      this.props.log(`value changed in action view ${value}`);\r\n      this.props.valueChanged({\r\n        [this.props.name]: Object.assign(\r\n          {},\r\n          this.props.value || {},\r\n          value || {}\r\n        )\r\n      });\r\n    }\r\n    render() {\r\n      this.props.log(\"rendering\");\r\n      if (this.props.busy) return <ProgressBar />;\r\n      let { [contentViewName]: contentValue = {}, ...rest } =\r\n        this.props.value || {};\r\n      return (\r\n        <Layout>\r\n          <Filter\r\n            actionLabel={this.props.args.commandText}\r\n            filter={this.filter}\r\n          >\r\n            <FilterContainer\r\n              elements={this.props.args.elements}\r\n              value={rest}\r\n              name={itemViewName}\r\n              validator={this.state._filterValidator}\r\n              valueChanged={this.filterValueChanged}\r\n              navigation={this.props.navigation}\r\n              currentProcess={this.props.currentProcess}\r\n              currentStep={this.props.currentStep}\r\n            />\r\n          </Filter>\r\n          <ContentContainer\r\n            name={contentViewName}\r\n            elements={this.props.resultUI}\r\n            value={contentValue}\r\n            validator={this.state.validator}\r\n            valueChanged={this.valueChanged}\r\n            navigation={this.props.navigation}\r\n            currentProcess={this.props.currentProcess}\r\n            currentStep={this.props.currentStep}\r\n          />\r\n        </Layout>\r\n      );\r\n    }\r\n  }\r\n\r\n  return connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )(withLogger(FurmlyActionView));\r\n};\r\n","import React from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default Label => {\r\n\tinvariants.validComponent(Label, \"Label\");\r\n\treturn props => {\r\n\t\tlet { value, description, ...rest } = props;\r\n\t\tif (value) {\r\n            return <Label description={value} {...rest} />\r\n\t\t}\r\n\t\treturn <Label {...props} />;\r\n\t};\r\n};\r\n","import React, { PureComponent } from \"react\";\r\n\r\nexport default (WebView, Text) => {\r\n  return class FurmlyWebView extends PureComponent {\r\n    constructor(props) {\r\n      super(props);\r\n    }\r\n    render() {\r\n      if (this.props.args && this.props.args.url) {\r\n        return <WebView url={this.props.args.url} />;\r\n      } else {\r\n        return <Text>{\"Missing url\"}</Text>;\r\n      }\r\n    }\r\n  };\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runFurmlyProcessor, furmlyDownloadUrl } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport withLogger from \"./furmly_base\";\r\nimport debug from \"debug\";\r\nexport default (Link, customDownloadCommand) => {\r\n  invariants.validComponent(Link, \"Link\");\r\n\r\n  const mapDispatchToState = dispatch => {\r\n    return {\r\n      dispatch\r\n    };\r\n  };\r\n  class FurmlyCommand extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.go = this.go.bind(this);\r\n      this.run = this.run.bind(this);\r\n    }\r\n    run() {\r\n      this.props.dispatch(\r\n        runFurmlyProcessor(\r\n          this.props.args.commandProcessor,\r\n          (this.props.args.commandProcessorArgs &&\r\n            JSON.parse(this.props.args.commandProcessorArgs)) ||\r\n            {},\r\n          this.props.component_uid\r\n        )\r\n      );\r\n    }\r\n    go() {\r\n      switch (this.props.args.commandType) {\r\n        case FurmlyCommand.COMMAND_TYPE.DOWNLOAD:\r\n          if (!this.props.args.commandProcessorArgs) {\r\n            throw new Error(\"Download is not properly setup.\");\r\n          }\r\n          let url;\r\n          try {\r\n            let config = JSON.parse(this.props.args.commandProcessorArgs);\r\n            url = furmlyDownloadUrl.replace(\":id\", config.id);\r\n            if (config.access_token) url += `?_t0=${config.access_token}`;\r\n            if (config.isProcessor)\r\n              url += `${url.indexOf(\"?\") == -1 ? \"?\" : \"&\"}_t1=true`;\r\n          } catch (e) {\r\n            throw new Error(\"Download is not properly setup.\");\r\n          }\r\n          this.props.dispatch(customDownloadCommand(this.props.args, url));\r\n          break;\r\n        default:\r\n          this.run();\r\n          break;\r\n      }\r\n    }\r\n    render() {\r\n      return (\r\n        /*jshint ignore:start */\r\n        <Link\r\n          text={this.props.args.commandText}\r\n          icon={this.props.args.commandIcon}\r\n          go={this.go}\r\n        />\r\n        /*jshint ignore:end */\r\n      );\r\n    }\r\n  }\r\n  FurmlyCommand.COMMAND_TYPE = { DEFAULT: \"DEFAULT\", DOWNLOAD: \"DOWNLOAD\" };\r\n  return connect(\r\n    null,\r\n    mapDispatchToState\r\n  )(withLogger(FurmlyCommand));\r\n};\r\n","import furmly_input from \"./furmly_input.js\";\r\nimport furmly_view from \"./furmly_view.js\";\r\nimport furmly_container from \"./furmly_container.js\";\r\nimport furmly_process from \"./furmly_process.js\";\r\nimport furmly_section from \"./furmly_section.js\";\r\nimport furmly_select from \"./furmly_select.js\";\r\nimport furmly_selectset from \"./furmly_selectset.js\";\r\nimport furmly_list from \"./furmly_list.js\";\r\nimport furmly_hidden from \"./furmly_hidden.js\";\r\nimport furmly_nav from \"./furmly_nav\";\r\nimport furmly_image from \"./furmly_image\";\r\nimport furmly_grid from \"./furmly_grid\";\r\nimport furmly_htmlview from \"./furmly_htmlview\";\r\nimport furmly_fileupload from './furmly_fileupload';\r\nimport furmly_actionview from \"./furmly_actionview\";\r\nimport furmly_label from './furmly_label';\r\nimport furmly_webview from \"./furmly_webview\";\r\nimport furmly_command from \"./furmly_command\";\r\n\r\nexport default {\r\n\tfurmly_input,\r\n\tfurmly_view,\r\n\tfurmly_container,\r\n\tfurmly_process, \r\n\tfurmly_section,\r\n\tfurmly_select,\r\n\tfurmly_selectset,\r\n\tfurmly_list,\r\n\tfurmly_hidden,\r\n\tfurmly_nav,\r\n\tfurmly_grid, \r\n\tfurmly_image,\r\n\tfurmly_fileupload,\r\n\tfurmly_actionview,\r\n\tfurmly_htmlview,\r\n\tfurmly_label,\r\n\tfurmly_webview,\r\n\tfurmly_command\r\n}; \r\n","import components from \"./lib\";\r\nconst defaultMap = {\r\n\tINPUT: components.furmly_input,\r\n\tVIEW: components.furmly_view,\r\n\tCONTAINER: components.furmly_container,\r\n\tPROCESS: components.furmly_process,\r\n\tSECTION: components.furmly_section,\r\n\tSELECT: components.furmly_select,\r\n\tSELECTSET: components.furmly_selectset,\r\n\tLIST: components.furmly_list,\r\n\tHIDDEN: components.furmly_hidden,\r\n\tNAV: components.furmly_nav,\r\n\tIMAGE: components.furmly_image,\r\n\tGRID: components.furmly_grid,\r\n\tFILEUPLOAD: components.furmly_fileupload,\r\n\tACTIONVIEW: components.furmly_actionview,\r\n\tHTMLVIEW: components.furmly_htmlview,\r\n\tLABEL: components.furmly_label,\r\n\tWEBVIEW: components.furmly_webview,\r\n\tMESSENGER: components.furmly_messenger,\r\n\tCOMMAND: components.furmly_command,\r\n\trecipes: {},\r\n\t_defaultMap: {},\r\n\tcomponentLocator(interceptors) {\r\n\t\treturn context => {\r\n\t\t\tlet control;\r\n\t\t\tif (interceptors)\r\n\t\t\t\tcontrol = interceptors(context, this, this._defaultMap);\r\n\t\t\tif (!control) {\r\n\t\t\t\tif (context.uid) {\r\n\t\t\t\t\tif (this[context.uid]) return this[context.uid];\r\n\t\t\t\t\tlet upper = context.uid.toUpperCase();\r\n\t\t\t\t\tif (this[upper]) return this[upper];\r\n\t\t\t\t}\r\n\t\t\t\treturn this[context.elementType];\r\n\t\t\t}\r\n\t\t\treturn control;\r\n\t\t};\r\n\t},\r\n\tcook(name, recipe, customName) {\r\n\t\tif (name && recipe) {\r\n\t\t\tif (!Array.prototype.isPrototypeOf(recipe)) {\r\n\t\t\t\tthrow new Error(\"Recipe must be an array\");\r\n\t\t\t}\r\n\t\t\tif (!this._defaultMap[name])\r\n\t\t\t\tthrow new Error(\"Cannot find any recipe for that element\");\r\n\t\t\tif (name == customName) {\r\n\t\t\t\tconsole.warn(\"Custom name will override default recipe\");\r\n\t\t\t}\r\n\r\n\t\t\tlet cooked = this._defaultMap[name].apply(null, recipe);\r\n\t\t\tif (customName) this[customName] = cooked;\r\n\t\t\treturn cooked;\r\n\t\t}\r\n\r\n\t\tif (!this._cooked) {\r\n\t\t\tthis._cooked = true;\r\n\t\t\tObject.keys(this.recipes).forEach(recipe => {\r\n\t\t\t\tthis._defaultMap[recipe] = this[recipe];\r\n\t\t\t\tthis[recipe] = this[recipe].apply(null, this.recipes[recipe]);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n};\r\nexport default defaultMap;\r\n","import _ from \"lodash\";\r\nimport { default as ACTIONS } from \"../actions/constants\";\r\nimport config from \"client_config\";\r\nimport { isValidKey, getBusyKey, getErrorKey } from \"../utils/view\";\r\n\r\nexport default function(state = {}, action) {\r\n\tswitch (action.type) {\r\n\t\tcase ACTIONS.CLEAR_DATA:\r\n\t\t\treturn Object.assign(state, { [action.payload]: null });\r\n\t\tcase ACTIONS.ADD_NAVIGATION_CONTEXT:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tnavigationContext: action.payload\r\n\t\t\t});\r\n\t\tcase ACTIONS.REMOVE_NAVIGATION_CONTEXT:\r\n\t\t\tdelete state.navigationContext;\r\n\t\t\treturn Object.assign({}, state);\r\n\t\tcase ACTIONS.CLEAR_STACK:\r\n\t\t\treturn {};\r\n\t\tcase ACTIONS.FURMLY_PROCESS_FAILED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[getBusyKey(action.meta)]: false\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.REPLACE_STACK:\r\n\t\t\tvar _state = action.payload.reduce(\r\n\t\t\t\t(sum, x) => {\r\n\t\t\t\t\tif (state[x.params.id]) {\r\n\t\t\t\t\t\tsum[x.params.id] = state[x.params.id];\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn sum;\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tnavigationContext: state.navigationContext,\r\n\t\t\t\t\tmessage: state.message\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\treturn _state;\r\n\t\tcase ACTIONS.REMOVE_LAST_FURMLY_PARAMS:\r\n\t\t\t//check if value is a furmly screen\r\n\t\t\t//if it is check if its a process navigation or step navigation\r\n\t\t\t//if it is a process navigation remove the data from the process.\r\n\t\t\t//if it is a step navigation remove the step data from the process.\r\n\t\t\tif (\r\n\t\t\t\taction.payload.item.key == \"Furmly\" ||\r\n\t\t\t\taction.payload.item.$routeName == \"Furmly\"\r\n\t\t\t) {\r\n\t\t\t\t//it is a furmly navigation\r\n\t\t\t\t//confirm there are no other references down the line.\r\n\t\t\t\tlet _state = state[action.payload.item.params.id],\r\n\t\t\t\t\tcurrentStep = (_state && _state.currentStep) || 0;\r\n\t\t\t\tif (\r\n\t\t\t\t\taction.payload.references[action.payload.item.params.id] &&\r\n\t\t\t\t\taction.payload.references[\r\n\t\t\t\t\t\taction.payload.item.params.id\r\n\t\t\t\t\t][0] == 1\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn Object.assign(\r\n\t\t\t\t\t\t{},\r\n\t\t\t\t\t\t//copy over state that does not belong to the removed object\r\n\t\t\t\t\t\tObject.keys(state).reduce((sum, x) => {\r\n\t\t\t\t\t\t\tlet key = isValidKey(x);\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t!key ||\r\n\t\t\t\t\t\t\t\t(key &&\r\n\t\t\t\t\t\t\t\t\tkey.step !== currentStep &&\r\n\t\t\t\t\t\t\t\t\tkey.process !==\r\n\t\t\t\t\t\t\t\t\t\taction.payload.item.params.id)\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\tsum[x] = state[x];\r\n\t\t\t\t\t\t\treturn sum;\r\n\t\t\t\t\t\t}, {}),\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t[action.payload.item.params.id]: null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (\r\n\t\t\t\t\t_state &&\r\n\t\t\t\t\ttypeof action.payload.item.params.currentStep !==\r\n\t\t\t\t\t\t\"undefined\"\r\n\t\t\t\t) {\r\n\t\t\t\t\t//it is a step navigation.\r\n\t\t\t\t\t//remove one from current step.\r\n\r\n\t\t\t\t\t_state.currentStep = _state.currentStep - 1 || 0;\r\n\t\t\t\t\t_state.description.steps = _state.description.steps.slice();\r\n\t\t\t\t\t_state.description.steps.pop();\r\n\t\t\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t\t\t[action.payload.item.params\r\n\t\t\t\t\t\t\t.id]: Object.assign({}, _state || {}, {\r\n\t\t\t\t\t\t\t[action.payload.item.params.currentStep]: null\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn state;\r\n\t\tcase ACTIONS.FURMLY_PROCESS_RAN:\r\n\t\t\tif (action.error || !action.payload) {\r\n\t\t\t\treturn state;\r\n\t\t\t}\r\n\t\t\tlet proc = state[action.payload.id],\r\n\t\t\t\tid = action.payload.id,\r\n\t\t\t\tdata = action.payload.data,\r\n\t\t\t\tcurrentState = {\r\n\t\t\t\t\tcurrentStep: proc.currentStep || 0\r\n\t\t\t\t},\r\n\t\t\t\tbusy = false,\r\n\t\t\t\tdescription = proc.description;\r\n\t\t\tif (\r\n\t\t\t\t(config.uiOnDemand &&\r\n\t\t\t\t\taction.payload.data &&\r\n\t\t\t\t\taction.payload.data.status == \"COMPLETED\") ||\r\n\t\t\t\t(!config.uiOnDemand &&\r\n\t\t\t\t\t(description.steps.length == 1 ||\r\n\t\t\t\t\t\tcurrentState.currentStep + 1 >\r\n\t\t\t\t\t\t\tdescription.steps.length - 1))\r\n\t\t\t) {\r\n\t\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t\t[id]: {\r\n\t\t\t\t\t\tcompleted: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\t[getBusyKey(id)]: false,\r\n\t\t\t\t\tmessage: (typeof data == \"object\" && data.message) || null\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tcurrentState.instanceId = data ? data.$instanceId : null;\r\n\t\t\tif (config.uiOnDemand && description.disableBackwardNavigation)\r\n\t\t\t\tdescription.steps[0] = data.$nextStep;\r\n\t\t\telse {\r\n\t\t\t\tif (config.uiOnDemand) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tdescription.steps.length ==\r\n\t\t\t\t\t\tcurrentState.currentStep + 1\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tdescription.steps.push(data.$nextStep);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcurrentState.currentStep = currentState.currentStep + 1;\r\n\t\t\t}\r\n\t\t\tcurrentState[currentState.currentStep] =\r\n\t\t\t\ttypeof data == \"object\" &&\r\n\t\t\t\ttypeof data.message == \"object\" &&\r\n\t\t\t\tdata.message;\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[id]: Object.assign({}, state[id], currentState),\r\n\t\t\t\t[getBusyKey(id)]: busy\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.FETCHING_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: fetchingGrid(state[action.meta.key], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILTERED_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: filteredGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: getSingleItemForGrid(\r\n\t\t\t\t\tstate[action.meta.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.GOT_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotSingleItemForGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: errorWhileGettingSingleItemForGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.ERROR_WHILE_FETCHING_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToFetchGrid(state[action.meta])\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.FURMLY_GET_MORE_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: reduceGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.FURMLY_PROCESS_RUNNING:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[getBusyKey(action.meta.id)]: !action.error,\r\n\t\t\t\t[action.meta.id]: Object.assign({}, state[action.meta.id], {\r\n\t\t\t\t\t[state[action.meta.id].currentStep || 0]: action.meta.form\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\tcase ACTIONS.VALUE_CHANGED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.id]: Object.assign(\r\n\t\t\t\t\t{},\r\n\t\t\t\t\tstate[action.payload.id],\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t[state[action.payload.id].currentStep || 0]: action\r\n\t\t\t\t\t\t\t.payload.form\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FURMLY_PROCESSOR_RAN:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: action.payload.data,\r\n\t\t\t\t[getBusyKey(action.payload.key)]: false,\r\n\t\t\t\t[getErrorKey(action.payload.key)]: !!action.error\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.FURMLY_PROCESSOR_RUNNING:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[getBusyKey(action.meta.key)]: !action.error,\r\n\t\t\t\t[getErrorKey(action.meta.key)]: !!action.error\r\n\t\t\t});\r\n\t\tcase ACTIONS.FURMLY_PROCESSOR_FAILED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[getBusyKey(action.meta)]: false,\r\n\t\t\t\t[action.meta]: null,\r\n\t\t\t\t[getErrorKey(action.meta)]: true\r\n\t\t\t});\r\n\t\tcase ACTIONS.FETCHED_PROCESS:\r\n\t\t\tlet fetchedValue = Object.assign({}, action.payload.data.data);\r\n\t\t\tlet fetchedDescription = Object.assign(\r\n\t\t\t\t{},\r\n\t\t\t\taction.payload.data.description\r\n\t\t\t);\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.id]: {\r\n\t\t\t\t\tdescription: fetchedDescription,\r\n\t\t\t\t\t0: fetchedValue\r\n\t\t\t\t},\r\n\t\t\t\t//always carry over the navigationContext.\r\n\t\t\t\tnavigationContext: state.navigationContext,\r\n\t\t\t\ttemplateCache: state.templateCache || {},\r\n\t\t\t\t[getBusyKey(action.payload.id)]: false,\r\n\t\t\t\t[getErrorKey(action.payload.id)]: action.error\r\n\t\t\t});\r\n\t\tcase ACTIONS.FETCHING_PROCESS:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[getBusyKey(action.meta)]: !action.error,\r\n\t\t\t\t[getErrorKey(action.meta)]: !!action.error\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_FETCH_PROCESS:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: null,\r\n\t\t\t\t//always carry over the navigationContext.\r\n\t\t\t\tnavigationContext: state.navigationContext,\r\n\t\t\t\t[getBusyKey(action.meta)]: false,\r\n\t\t\t\t[getErrorKey(action.meta)]: true\r\n\t\t\t});\r\n\t\tcase ACTIONS.START_FILE_UPLOAD:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: startUpload(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILE_UPLOADED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: fileUpload(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILE_UPLOAD_FAILED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: uploadFailed(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: getPreview(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotPreview(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetPreview(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_ITEM_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: getTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\tstate[action.meta.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_ITEM_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\t\"itemTemplate\",\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_ITEM_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_FILTER_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: getTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\tstate[action.meta.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_FILTER_TEMPLATE:\r\n\t\t\tif (action.error) {\r\n\t\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\t\taction\r\n\t\t\t\t\t)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\t\"filterTemplate\",\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_FILTER_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nfunction getTemplate(busyIndicator, state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\t[busyIndicator]: !action.error,\r\n\t\t[getErrorKey(busyIndicator)]: action.error\r\n\t});\r\n}\r\nfunction gotTemplate(busyIndicator, propName, state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\t[propName]: action.payload.data,\r\n\t\t[busyIndicator]: false,\r\n\t\t[getErrorKey(busyIndicator)]: action.error\r\n\t});\r\n}\r\nfunction failedToGetTemplate(busyIndicator, state = {}, action) {\r\n\treturn Object.assign({}, state, { [busyIndicator]: false });\r\n}\r\n\r\nfunction startUpload(state = {}, action) {\r\n\treturn Object.assign({}, state, { gettingTemplate: !action.error });\r\n}\r\nfunction fileUpload(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tuploadedId: action.payload.id,\r\n\t\tbusy: false\r\n\t});\r\n}\r\nfunction uploadFailed(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: false });\r\n}\r\nfunction getPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: !action.error });\r\n}\r\nfunction gotPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tpreview: action.payload.data,\r\n\t\tbusy: false\r\n\t});\r\n}\r\nfunction failedToGetPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: false });\r\n}\r\n\r\nfunction reduceGrid(state = {}, action) {\r\n\tif (!state.data || state.data.items.length < action.payload.data.total) {\r\n\t\tlet current = state.data ? state.data.items : [];\r\n\t\taction.payload.data.items = current.concat(action.payload.data.items);\r\n\t\tstate.data = action.payload.data;\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tfetchingGrid: false,\r\n\t\t\tfailedToFetchGrid: !!action.error\r\n\t\t});\r\n\t}\r\n\treturn state;\r\n}\r\n\r\nfunction filteredGrid(state = {}, action) {\r\n\tlet current = state.data ? state.data.items : [];\r\n\tstate.data = action.payload.data;\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingGrid: false,\r\n\t\tfailedToFetchGrid: !!action.error\r\n\t});\r\n}\r\n\r\nfunction fetchingGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingGrid: !action.error,\r\n\t\tfailedToFetchGrid: !!action.error,\r\n\t\tfilter: action.meta && action.meta.args ? action.meta.args.query : null\r\n\t});\r\n}\r\n\r\nfunction failedToFetchGrid(state = {}) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingGrid: false,\r\n\t\tfailedToFetchGrid: true\r\n\t});\r\n}\r\n\r\nfunction getSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingSingleItem: !action.error,\r\n\t\t[getErrorKey(\"fetchingSingleItem\")]: !!action.error\r\n\t});\r\n}\r\n\r\nfunction gotSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tsingleItem: action.payload.data,\r\n\t\tfetchingSingleItem: false,\r\n\t\t[getErrorKey(\"fetchingSingleItem\")]: !!action.error\r\n\t});\r\n}\r\n\r\nfunction errorWhileGettingSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingSingleItem: false,\r\n\t\tsingleItem: undefined,\r\n\t\t[getErrorKey(\"fetchingSingleItem\")]: !!action.error\r\n\t});\r\n}\r\n","import view from \"./view\";\r\nimport navigation from \"./navigation\";\r\nimport { toggleAllBusyIndicators } from \"../utils/view\";\r\nconst reducers = [\r\n\t{ name: \"navigation\", run: navigation },\r\n\t{ name: \"view\", run: view }\r\n];\r\nexport default function(state = {}, action) {\r\n\tif (action.type == \"persist/REHYDRATE\") {\r\n\t\tvar incoming = action.payload.furmly;\r\n\t\tif (incoming) {\r\n\t\t\ttoggleAllBusyIndicators(incoming);\r\n\t\t\tstate = {\r\n\t\t\t\t...state,\r\n\t\t\t\t...incoming\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\tlet changes = false,\r\n\t\tchangedState = reducers.reduce((_state, reducer) => {\r\n\t\t\tlet currentState = state[reducer.name],\r\n\t\t\t\tnewState = (_state[reducer.name] = reducer.run(\r\n\t\t\t\t\tcurrentState,\r\n\t\t\t\t\taction\r\n\t\t\t\t));\r\n\t\t\tif (currentState !== newState) {\r\n\t\t\t\tchanges = true;\r\n\t\t\t}\r\n\t\t\treturn _state;\r\n\t\t}, {});\r\n\treturn changes ? changedState : state;\r\n}\r\n","export default function(string, ...rest) {\r\n\tvar str = string.toString();\r\n\tif (rest.length) {\r\n\t\tvar t = typeof rest[0];\r\n\t\tvar key;\r\n\t\tvar args = \"string\" === t || \"number\" === t ? rest : rest[0];\r\n\r\n\t\tfor (key in args) {\r\n\t\t\tstr = str.replace(new RegExp(\"\\\\{\" + key + \"\\\\}\", \"gi\"), args[key]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn str;\r\n}\r\n","import invariants from \"./invariants\";\r\nimport memcache from \"./memcache\";\r\nimport validator from \"./validator\";\r\nimport formatExpression from \"./formatExpression\";\r\nimport view from \"./view\";\r\n\r\n\r\nexport default {\r\n\tinvariants,\r\n\tmemcache,\r\n\tformatExpression,\r\n\tvalidator,\r\n\tview\r\n};\r\n"],"names":["Validator","context","run","bind","Promise","resolve","reject","props","validators","length","asyncValidators","result","reduce","current","element","valid","error","validatorType","VALIDATOR_TYPES","REQUIRED","hasValue","MAXLENGTH","isLessThanMaxLength","MINLENGTH","isGreaterThanMinLength","REGEX","matchesRegex","errors","push","setState","component","name","Error","Component","prototype","isPrototypeOf","HOCComponent","__originalRenderMethod__","e","ReactSSRErrorHandler","constructor","log","logger","debug","_constructor","m","React","WrappedComponent","LabelWrapper","Input","DatePicker","Checkbox","validComponent","FurmlyInput","state","setDefault","valueChanged","runValidators","runAsyncValidators","validator","validate","toValueChanged","formatDateRange","fromValueChanged","setDateFromRange","isDateRange","_mounted","next","component_uid","value","args","config","isRange","split","fromValue","toValue","Date","ValidationHelper","runAsyncValidator","filter","x","max","min","RegExp","exp","test","from","to","toLocaleDateString","maxDate","maxConfig","date","minDate","minConfig","default","Result","type","passThrough","assign","getDateConfig","label","disabled","isRequired","propTypes","PropTypes","func","withLogger","MemCache","opts","defaultTTL","ttl","store","get","_items","obj","JSON","stringify","key","hasOwnProperty","getKey","_key","undefined","handle","setTimeout","remove","createStack","action","ACTIONS","SET_FURMLY_PARAMS","ALREADY_VISIBLE","hasScreenAlready","payload","stack","copyStack","Object","REPLACE_STACK","slice","forEach","countRef","REMOVE_LAST_FURMLY_PARAMS","item","pop","$routeName","_references","params","id","refs","CLEAR_STACK","parse","makeTop","curr","splice","_","isEqual","index","CHECK_FOR_EXISTING_SCREEN","Symbol","enhancers","furmly","navigation","preDispatch","preRefreshToken","BASE_URL","global","baseUrl","throttled","cache","processorsCacheTimeout","displayMessage","text","copy","getQueryParams","keys","map","arr","encodeURIComponent","join","setParams","replaceStack","goBack","clearNavigationStack","alreadyVisible","removeNavigationContext","REMOVE_NAVIGATION_CONTEXT","addNavigationContext","ADD_NAVIGATION_CONTEXT","openConfirmation","message","OPEN_CONFIRMATION","VALUE_CHANGED","defaultError","dispatch","customType","meta","throttleEnabled","res","status","statusText","headers","errormessage","CALL_API","throttleKey","endpoint","body","processorRetryOffset","showMessage","SESSION_MAY_HAVE_EXPIRED","furmlyDownloadUrl","fetchFurmlyProcess","cacheProcessDescription","cacheKey","hasKey","FETCHED_PROCESS","getState","$uiOnDemand","uiOnDemand","FETCHING_PROCESS","json","then","response","data","d","FAILED_TO_FETCH_PROCESS","clearElementData","CLEAR_DATA","getMoreForGrid","runFurmlyProcessor","FETCHING_GRID","FURMLY_GET_MORE_FOR_GRID","ERROR_WHILE_FETCHING_GRID","filterGrid","FILTERED_GRID","getItemTemplate","GET_ITEM_TEMPLATE","GOT_ITEM_TEMPLATE","FAILED_TO_GET_ITEM_TEMPLATE","getFilterTemplate","GET_FILTER_TEMPLATE","GOT_FILTER_TEMPLATE","FAILED_TO_GET_FILTER_TEMPLATE","getSingleItemForGrid","GET_SINGLE_ITEM_FOR_GRID","GOT_SINGLE_ITEM_FOR_GRID","ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID","getRefreshToken","GET_REFRESH_TOKEN","GOT_REFRESH_TOKEN","FAILED_TO_GET_REFRESH_TOKEN","requestCustomType","resultCustomType","errorCustomType","returnsUI","disableCache","disableRetry","retry","cacheProcessorResponses","FURMLY_PROCESSOR_RAN","maxProcessorRetries","waitIndex","waitingProcessors","waitHandle","FURMLY_PROCESSOR_RUNNING","FURMLY_PROCESSOR_FAILED","disableProcessorRetry","runFurmlyProcess","details","FURMLY_PROCESS_RUNNING","form","currentStep","FURMLY_PROCESS_RAN","view","description","steps","disableBackwardNavigation","_p","notifyStepAdvance","catch","er","FURMLY_PROCESS_FAILED","instanceId","parseInt","getFurmlyFilePreview","fileType","query","GET_PREVIEW","GOT_PREVIEW","FAILED_TO_GET_PREVIEW","uploadFurmlyFile","file","formData","FormData","append","START_FILE_UPLOAD","FILE_UPLOADED","FILE_UPLOAD_FAILED","Page","Warning","Container","mapStateToProps","initialProps","ownProps","_state","currentProcess","elements","mode","hideSubmit","title","processDescription","mapDispatchToProps","FurmlyView","onValueChanged","submit","furmly_view","connect","Section","Header","ComponentWrapper","ComponentLocator","invariants","setValidator","_validations","all","Array","call","arguments","self","extraVal","notifyExtra","sort","y","order","FurmlyComponent","source","indexOf","extra","elementType","uid","ProgressBar","TextView","completed","info","FurmlyProcess","_id","fetch","fetchParams","busy","runProcess","Layout","FurmlySection","getTitleFromState","getValueBasedOnMode","v","$objectID","isObjectIdMode","getCurrentStepFromState","getCurrentStep","getCurrentProcess","i","isValidKey","exec","step","process","runThroughObj","conditions","parent","babelHelpers.typeof","unwrapObjectValue","getTemplatesAndAddComponentUid","template","furmly_ref","itemTemplate","uuid","toggleAllBusyIndicators","keyInvariants","fn","getBusyKey","getErrorKey","ProgressIndicator","st","FurmlySelect","fetchItems","selectFirstItem","isValidValue","items","customArgs","isEmptyOrNull","Picker","noPath","noItems","getPickerItemsById","z","r","FurmlySelectSet","retryFetch","onPickerValueChanged","onContainerValueChanged","getPickerValue","getContainerValue","containerValues","contentItems","sum","respondToPickerValueChanged","oneOption","containerValidator","processor","processorArgs","_args","_onContainerValueChanged","shift","getItems","path","pickerValue","eve","apply","a","b","nextProps","nextState","isEqualWith","_shouldComponentUpdateComparer","superCancel","getCurrentContainerValue","Button","List","Modal","ErrorText","EDIT","NEW","app","confirmationResult","templateCache","equivalent","arr2","objValue","otherValue","findKey","isMatch","FurmlyList","showModal","closeModal","edit","isDisabled","getListItemDataTemplate","confirmation","dataTemplate","listItemDataTemplateProcessor","isTemplateRef","equal","behavior","ValidatorHelper","modalVisible","existing","modalName","template_ref","extension","rowTemplate","FurmlyHidden","init","Link","NavigationActions","mapDispatchToState","navigationContext","FurmlyNav","go","link","linkAndParams","getParams","paramsOnly","NAV_TYPE","CLIENT","navigate","FURMLY","firstItemIsLink","key_value","sp","decodeURIComponent","Image","rest","replace","GRID_MODES","ITEM_MODES","ItemView","CommandsView","CommandResultView","total","fetchingGrid","failedToFetchGrid","filterTemplate","singleItem","fetchingSingleItem","gettingFilterTemplate","gettingTemplate","FurmlyGrid","commandResultViewName","itemViewName","pageCount","itemValueChanged","showItemView","cancel","isCRUD","isEDITONLY","getItemsFromSource","done","getFilterValue","getItemValue","more","finished","openCommandMenu","closeCommandView","execCommand","showCommandResult","closeCommandResult","fetchFilterTemplate","commands","commandType","cmd","unshift","other","filterTemplateError","filterProcessor","fetchingFilterTemplate","gridArgs","commandProcessed","processed","fetchingItemTemplate","methodName","count","full","filterViewName","_filterValidator","submitted","createProcessor","editProcessor","skipFetch","_itemTemplate","gettingItemTemplate","existingValue","createTemplate","editTemplate","fetchSingleItemProcessor","singleItemError","getSingleItem","fetchTemplateProcessor","itemTemplateError","update","showCommandsView","command","CRUD","EDITONLY","header","footer","templateConfig","dontAutoFetchFromSource","itemViewElements","showCommandResultView","commandResult","commandProcessing","html","Uploader","Text","previews","FurmlyFileUpload","_previewType","getPreviewType","_supported","isSupported","_getPreview","_query","getPreviewQuery","upload","uploadedId","supports","preview","getPreview","Filter","FilterContainer","ContentContainer","_actionState","ui","contentViewName","FurmlyActionView","filterValueChanged","resultData","contentValue","commandText","resultUI","Label","WebView","url","PureComponent","customDownloadCommand","FurmlyCommand","commandProcessor","commandProcessorArgs","COMMAND_TYPE","DOWNLOAD","access_token","isProcessor","commandIcon","DEFAULT","defaultMap","components","furmly_input","furmly_container","furmly_process","furmly_section","furmly_select","furmly_selectset","furmly_list","furmly_hidden","furmly_nav","furmly_image","furmly_grid","furmly_fileupload","furmly_actionview","furmly_htmlview","furmly_label","furmly_webview","furmly_messenger","furmly_command","interceptors","control","_defaultMap","upper","toUpperCase","recipe","customName","warn","cooked","_cooked","recipes","references","proc","currentState","$instanceId","$nextStep","filteredGrid","gotSingleItemForGrid","errorWhileGettingSingleItemForGrid","reduceGrid","fetchedValue","fetchedDescription","startUpload","fileUpload","uploadFailed","gotPreview","failedToGetPreview","getTemplate","gotTemplate","failedToGetTemplate","busyIndicator","propName","concat","reducers","incoming","changes","changedState","reducer","newState","string","str","toString","t"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAAqBA;oBACRC,OAAZ,EAAqB;;;OACfC,GAAL,GAAW,KAAKA,GAAL,CAASC,IAAT,CAAcF,OAAd,CAAX;;;;;wBAEK;;;UACE,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;QAEtC,CAAC,CAAC,MAAKC,KAAL,CAAWC,UAAZ,IAA0B,CAAC,MAAKD,KAAL,CAAWC,UAAX,CAAsBC,MAAlD,MACC,CAAC,MAAKF,KAAL,CAAWG,eAAZ,IACA,CAAC,MAAKH,KAAL,CAAWG,eAAX,CAA2BD,MAF7B,CADD,EAKC,OAAOJ,SAAP;;QAEG,MAAKE,KAAL,CAAWC,UAAf,EAA2B;SACtBG,SAAS,MAAKJ,KAAL,CAAWC,UAAX,CAAsBI,MAAtB,CACZ,UAACC,OAAD,EAAUC,OAAV,EAAsB;;UAEjBC,QAAQF,QAAQE,KAApB;UACCC,QAAQ,EADT;cAEQF,QAAQG,aAAhB;YACMC,gBAAgBC,QAArB;gBACS,MAAKC,QAAL,EAAR;;YAEIF,gBAAgBG,SAArB;gBACS,MAAKC,mBAAL,CAAyBR,OAAzB,CAAR;;YAEII,gBAAgBK,SAArB;gBACS,MAAKC,sBAAL,CAA4BV,OAA5B,CAAR;;YAEII,gBAAgBO,KAArB;gBACS,MAAKC,YAAL,CAAkBZ,OAAlB,CAAR;;;UAGE,OAAOC,KAAP,IAAgB,QAApB,EAA8B;eACrBA,KAAR;cAECF,QAAQc,MAAR,CAAeC,IAAf,CAAoBZ,KAApB,GACCH,QAAQE,KAAR,GAAgB,KADjB,EAEAF,OAHD;;aAMMA,OAAP;MA3BW,EA6BZ,EAAEc,QAAQ,EAAV,EAAcZ,OAAO,IAArB,EA7BY,CAAb;SA+BI,CAACJ,OAAOI,KAAZ,EAAmB;YACbc,QAAL,CAAc,EAAEF,QAAQhB,OAAOgB,MAAjB,EAAd;aACOrB,QAAP;;;;QAKD,MAAKC,KAAL,CAAWG,eAAX,IACA,MAAKH,KAAL,CAAWG,eAAX,CAA2BD,MAD3B,IAEA,CAAC,MAAKF,KAAL,CAAWQ,KAHb,EAIE;YACMT,QAAP;;;UAGIuB,QAAL,CAAc,EAAEF,QAAQ,IAAV,EAAd;;IAtDM,CAAP;;;;;;AA4DK,IAAMT,kBAAkB;WACpB,UADoB;YAEnB,WAFmB;YAGnB,WAHmB;QAIvB;CAJD;;AChEP,iBAAe;iBACE,wBAASY,SAAT,EAAoBC,IAApB,EAA0B;MACrC,CAACD,SAAL,EAAgB,MAAM,IAAIE,KAAJ,CAAaD,IAAb,qBAAN;MAEf,CAACE,gBAAUC,SAAV,CAAoBC,aAApB,CAAkCL,SAAlC,CAAD,IACA,OAAOA,SAAP,KAAqB,UAFtB,EAIC,MAAM,IAAIE,KAAJ,CACFD,IADE,2DAAN;SAGM,IAAP;;CAVF;;;;ACDA,AAIA,oBAAe,4BAAoB;MAC3BK,YAD2B;;;;;YAJhC;iBAAQ,KAAKC,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,qBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;0BAMrCxB,KAAZ,EAAmB;;;6HACXA,KADW;;YAEZkC,GAAL,GAAW,MAAKA,GAAL,CAAStC,IAAT,OAAX;;;;;;0CAEkB;aACbuC,MAAL,GAAcC,yBAAuB,KAAKC,YAAL,CAAkBb,IAAzC,CAAd;aACKxB,KAAL,CAAWkC,GAAX,CAAe,mBAAf;;;;6CAEqB;aAChBlC,KAAL,CAAWkC,GAAX,CAAe,sBAAf;aACKC,MAAL,GAAc,IAAd;;;;0BAEEG,CAd2B,EAcxB;aACAH,MAAL,CAAeG,CAAf,WAAsB,KAAKtC,KAAL,CAAWwB,IAAjC;;;;iDAEO;aACFxB,KAAL,CAAWkC,GAAX,CAAe,QAAf;eACOK,6BAAC,gBAAD,eAAsB,KAAKvC,KAA3B,IAAkC,KAAK,KAAKkC,GAA5C,IAAP;;;;IAlBuBK,eAAMb,SADA;;sBAsBbG,YAApB,EAAkCW,gBAAlC;SACOX,YAAP;CAvBF;;;;ACJA,AAMA;;;;;AAKA,oBAAe,UAACY,YAAD,EAAeC,KAAf,EAAsBC,UAAtB,EAAkCC,QAAlC,EAA+C;aACjDC,cAAX,CAA0BJ,YAA1B,EAAwC,cAAxC;aACWI,cAAX,CAA0BH,KAA1B,EAAiC,OAAjC;aACWG,cAAX,CAA0BF,UAA1B,EAAsC,YAAtC;aACWE,cAAX,CAA0BD,QAA1B,EAAoC,UAApC;;MACME,WALsD;;;;;YAX3D;iBAAQ,KAAKhB,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;yBAiBrCxB,KAAZ,EAAmB;;;2HACXA,KADW;;YAEZ+C,KAAL,GAAa,EAAb;YACKC,UAAL,GAAkB,MAAKA,UAAL,CAAgBpD,IAAhB,OAAlB;YACKqD,YAAL,GAAoB,MAAKA,YAAL,CAAkBrD,IAAlB,OAApB;YACKsD,aAAL,GAAqB,MAAKA,aAAL,CAAmBtD,IAAnB,OAArB;YACKiB,QAAL,GAAgB,MAAKA,QAAL,CAAcjB,IAAd,OAAhB;YACKmB,mBAAL,GAA2B,MAAKA,mBAAL,CAAyBnB,IAAzB,OAA3B;YACKqB,sBAAL,GAA8B,MAAKA,sBAAL,CAA4BrB,IAA5B,OAA9B;YACKuB,YAAL,GAAoB,MAAKA,YAAL,CAAkBvB,IAAlB,OAApB;YACKuD,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBvD,IAAxB,OAA1B;YACKI,KAAL,CAAWoD,SAAX,CAAqBC,QAArB,GAAgC,YAAM;eAC7B,MAAKH,aAAL,EAAP;OADF;YAGKI,cAAL,GAAsB,MAAKA,cAAL,CAAoB1D,IAApB,OAAtB;YACK2D,eAAL,GAAuB,MAAKA,eAAL,CAAqB3D,IAArB,OAAvB;YACK4D,gBAAL,GAAwB,MAAKA,gBAAL,CAAsB5D,IAAtB,OAAxB;YACK6D,gBAAL,GAAwB,MAAKA,gBAAL,CAAsB7D,IAAtB,OAAxB;YACK8D,WAAL,GAAmB,MAAKA,WAAL,CAAiB9D,IAAjB,OAAnB;;;;;;0CAEkB;;;aACb+D,QAAL,GAAgB,IAAhB;mBACW,YAAM;cACX,OAAKA,QAAT,EAAmB;mBACZX,UAAL;mBACKS,gBAAL;;SAHJ,EAKG,CALH;;;;gDAOwBG,IAnCgC,EAmC1B;YAC1BA,KAAKC,aAAL,KAAuB,KAAK7D,KAAL,CAAW6D,aAAtC,EAAqD;eAC9Cb,UAAL,CAAgBY,IAAhB;;YAGAA,KAAKE,KAAL,IACA,KAAK9D,KAAL,CAAW8D,KAAX,KAAqBF,KAAKE,KAD1B,IAEA,KAAKJ,WAAL,CAAiBE,IAAjB,CAHF,EAIE;eACKH,gBAAL,CAAsBG,IAAtB;;;;;6CAGmB;aAChBD,QAAL,GAAgB,KAAhB;;;;oCAG8B;YAApB3D,KAAoB,uEAAZ,KAAKA,KAAO;;eACvBA,MAAM+D,IAAN,IAAc/D,MAAM+D,IAAN,CAAWC,MAAzB,IAAmChE,MAAM+D,IAAN,CAAWC,MAAX,CAAkBC,OAA5D;;;;yCAGmC;YAApBjE,KAAoB,uEAAZ,KAAKA,KAAO;;YAC/BA,MAAM8D,KAAN,IAAe,KAAKJ,WAAL,EAAnB,EAAuC;mCACV1D,MAAM8D,KAAN,CAAYI,KAAZ,CAAkB,GAAlB,CADU;;cAChCC,SADgC;cACrBC,OADqB;;eAEhC9C,QAAL,CAAc;uBACD,IAAI+C,IAAJ,CAASF,SAAT,CADC;qBAEH,IAAIE,IAAJ,CAASD,OAAT;WAFX;;;;;sCAMY;eACP,IAAIE,SAAJ,CAAqB,IAArB,EAA2B3E,GAA3B,EAAP;;;;yCAEiBmE,KAnEuC,EAmEhC;aACnB9D,KAAL,CAAWuE,iBAAX,CACE,KAAKvE,KAAL,CAAWG,eAAX,CAA2B,CAA3B,CADF,EAEE2D,KAFF,EAGE,KAAK9D,KAAL,CAAWG,eAAX,CAA2B,CAA3B,IAAgC,KAAKH,KAAL,CAAW6D,aAH7C;;;;iCAMS;eACF,CAAC,CAAC,KAAK7D,KAAL,CAAW8D,KAAb,IAAsB,aAA7B;;;;mCAEW;eAET,KAAK9D,KAAL,CAAWC,UAAX,IACA,KAAKD,KAAL,CAAWC,UAAX,CAAsBuE,MAAtB,CACE;iBAAKC,EAAE/D,aAAF,IAAmBC,gBAAgBC,QAAxC;SADF,EAEEV,MAFF,GAEW,CAJb;;;;0CAOkBK,OArFsC,EAqF7B;eAExB,KAAKP,KAAL,CAAW8D,KAAX,IAAoB,KAAK9D,KAAL,CAAW8D,KAAX,CAAiB5D,MAAjB,IAA2BK,QAAQwD,IAAR,CAAaW,GAA7D,IACAnE,QAAQE,KADR,IAEA,8CAA8CF,QAAQwD,IAAR,CAAaW,GAH7D;;;;6CAMqBnE,OA5FmC,EA4F1B;eAE3B,KAAKP,KAAL,CAAW8D,KAAX,IAAoB,KAAK9D,KAAL,CAAW8D,KAAX,CAAiB5D,MAAjB,IAA2BK,QAAQwD,IAAR,CAAaY,GAA7D,IACApE,QAAQE,KADR,IAEA,6CAA6CF,QAAQwD,IAAR,CAAaY,GAH5D;;;;mCAMWpE,OAnG6C,EAmGpC;eAElB,IAAIqE,MAAJ,CAAWrE,QAAQwD,IAAR,CAAac,GAAxB,EAA6BC,IAA7B,CAAkC,KAAK9E,KAAL,CAAW8D,KAA7C,KACAvD,QAAQE,KADR,IAEA,eAHF;;;;mCAMWqD,KA1G6C,EA0GtC;aACb9D,KAAL,CAAWiD,YAAX,oBAA2B,KAAKjD,KAAL,CAAWwB,IAAtC,EAA6CsC,KAA7C;YACI,KAAK9D,KAAL,CAAWG,eAAX,IAA8B,KAAKH,KAAL,CAAWG,eAAX,CAA2BD,MAA7D,EACE,KAAKiD,kBAAL,CAAwBW,KAAxB;;aAEGxC,QAAL,CAAc,EAAEF,QAAQ,EAAV,EAAd;;;;uCAEe+C,SAjHyC,EAiH9B;YACtB,KAAKpB,KAAL,CAAWqB,OAAX,IAAsBD,YAAY,KAAKpB,KAAL,CAAWqB,OAAjD,EAA0D;eACnDnB,YAAL,CAAkB,KAAKM,eAAL,CAAqBY,SAArB,CAAlB;SADF,MAEO;eACAlB,YAAL,CAAkB,IAAlB;;aAEG3B,QAAL,CAAc;8BAAA;mBAEH6C,YAAY,KAAKpB,KAAL,CAAWqB,OAAvB,GAAiC,IAAjC,GAAwC,KAAKrB,KAAL,CAAWqB;SAF9D;;;;wCAKoE;YAAtDW,IAAsD,uEAA/C,KAAKhC,KAAL,CAAWoB,SAAoC;YAAzBa,EAAyB,uEAApB,KAAKjC,KAAL,CAAWqB,OAAS;;eAC1DW,KAAKE,kBAAL,EAAV,WAAyCD,GAAGC,kBAAH,EAAzC;;;;qCAEab,OA/H2C,EA+HlC;YAClB,KAAKrB,KAAL,CAAWoB,SAAf,EAA0B;eACnBlB,YAAL,CAAkB,KAAKM,eAAL,CAAqB,KAAKR,KAAL,CAAWoB,SAAhC,EAA2CC,OAA3C,CAAlB;;aAEG9C,QAAL,CAAc;;SAAd;;;;oCAIYyC,IAvI4C,EAuItC;YACd3D,SAAS,EAAb;YACI2D,KAAKC,MAAT,EAAiB;iBACRD,KAAKC,MAAZ;cACID,KAAKW,GAAT,EAAc;gBACRX,KAAKW,GAAL,IAAY,OAAhB,EAAyBtE,OAAO8E,OAAP,GAAiB,IAAIb,IAAJ,EAAjB,CAAzB,KACKjE,OAAO8E,OAAP,GAAiB,IAAIb,IAAJ,CAASN,KAAKoB,SAAL,CAAeC,IAAxB,CAAjB;;cAEHrB,KAAKY,GAAT,EAAc;gBACRZ,KAAKY,GAAL,IAAY,OAAhB,EAAyBvE,OAAOiF,OAAP,GAAiB,IAAIhB,IAAJ,EAAjB,CAAzB,KACKjE,OAAOiF,OAAP,GAAiB,IAAIhB,IAAJ,CAASN,KAAKuB,SAAL,CAAeF,IAAxB,CAAjB;;cAEHrB,KAAKE,OAAT,EAAkB;mBACTX,cAAP,GAAwB,KAAKA,cAA7B;mBACOE,gBAAP,GAA0B,KAAKA,gBAA/B;mBACOY,OAAP,GAAiB,KAAKrB,KAAL,CAAWqB,OAA5B;mBACOD,SAAP,GAAmB,KAAKpB,KAAL,CAAWoB,SAA9B;;iBAEKF,OAAP,GAAiBF,KAAKE,OAAtB;;;eAGK7D,MAAP;;;;mCAE6B;YAApBJ,KAAoB,uEAAZ,KAAKA,KAAO;;YACzB,CAACA,MAAM8D,KAAP,IAAgB9D,MAAM+D,IAAtB,IAA8B/D,MAAM+D,IAAN,CAAWwB,OAA7C,EACE,KAAKtC,YAAL,CAAkBjD,MAAM+D,IAAN,CAAWwB,OAA7B;;;;iDAEK;;YAEHxB,OAAO,KAAK/D,KAAL,CAAW+D,IAAtB;YACEyB,eADF;qBAE+C,KAAKxF,KAJ7C;YAICyF,IAJD,UAICA,IAJD;YAIOxC,YAJP,UAIOA,YAJP;YAIwByC,WAJxB;;YAML,CAAC3B,IAAD,IACA,CAACA,KAAK0B,IADN,IAEA1B,KAAK0B,IAAL,IAAa,MAFb,IAGA1B,KAAK0B,IAAL,IAAa,QAHb,IAIA1B,KAAK0B,IAAL,IAAa,UALf,EAME;mBACS/C,KAAT;iBACOqB,QAAQ,EAAE0B,MAAM,MAAR,EAAf;;YAEE1B,KAAK0B,IAAL,IAAa,UAAjB,EAA6BD,SAAS5C,QAAT;;YAEzBmB,KAAK0B,IAAL,IAAa,MAAjB,EAAyB;mBACd9C,UAAT;iBACOgD,MAAP,CAAcD,WAAd,EAA2B,KAAKE,aAAL,CAAmB7B,IAAnB,CAA3B;;eAGAxB,6BAAC,YAAD;iBACS,KAAKvC,KAAL,CAAW6F,KADpB;iBAGItD,6BAAC,MAAD;kBACQwB,KAAK0B;aACPC,WAFN;sBAGY3B,QAAQA,KAAK+B,QAHzB;sBAIY,KAAKC,UAAL,EAJZ;mBAKS,KAAK/F,KAAL,CAAW8D,KALpB;oBAMU,KAAKf,KAAL,CAAW3B,MANrB;0BAOgB,KAAK6B;;UAX3B;;;;;IAlLsBvB,eALkC;;cA0MhDsE,SAAZ,GAAwB;kBACRC,UAAUC;GAD1B;SAGOC,aAAWrD,WAAX,CAAP;CA7MF;;ICXqBsD;mBACRC,IAAZ,EAAkB;;;OACZC,UAAL,GAAmBD,QAAQA,KAAKE,GAAd,IAAsB,MAAxC;OACKC,KAAL,GAAa,KAAKA,KAAL,CAAW5G,IAAX,CAAgB,IAAhB,CAAb;OACK6G,GAAL,GAAW,KAAKA,GAAL,CAAS7G,IAAT,CAAc,IAAd,CAAX;OACK8G,MAAL,GAAc,EAAd;;;;;yBAEMC,KAAK;kBACIA,GAAf,yCAAeA,GAAf;SACM,QAAL;YACQA,GAAP;SACI,QAAL;YACQC,KAAKC,SAAL,CAAeF,GAAf,CAAP;SACI,WAAL;WACO,oBAAN;;;;;yBAGIG,KAAK;UACJ,KAAKJ,MAAL,CAAYK,cAAZ,CAA2B,KAAKC,MAAL,CAAYF,GAAZ,CAA3B,CAAP;;;;yBAEGA,KAAK;OACJG,OAAO,KAAKD,MAAL,CAAYF,GAAZ,CAAX;UACQ,KAAKJ,MAAL,CAAYO,IAAZ,KAAqB,KAAKP,MAAL,CAAYO,IAAZ,EAAkBnD,KAAxC,IAAkDoD,SAAzD;;;;wBAEKJ,KAAKhD,OAA8B;OAAvByC,GAAuB,uEAAjB,KAAKD,UAAY;;OACpCW,OAAO,KAAKD,MAAL,CAAYF,GAAZ,CAAX;OACI,KAAKJ,MAAL,CAAYO,IAAZ,CAAJ,EAAuB;iBACT,KAAKP,MAAL,CAAYO,IAAZ,EAAkBE,MAA/B;;OAEGA,SAASC,WAAW,KAAKC,MAAL,CAAYzH,IAAZ,CAAiB,IAAjB,EAAuBqH,IAAvB,CAAX,EAAyCV,GAAzC,CAAb;QACKG,MAAL,CAAYO,IAAZ,IAAoB,EAAEnD,YAAF,EAASqD,cAAT,EAApB;;;;yBAEML,KAAK;UACJ,KAAKJ,MAAL,CAAYI,GAAZ,CAAP;;;;;;ACjCF,cAAe;gBACC,eADD;oBAEK,mBAFL;oBAGK,mBAHL;8BAIe,6BAJf;cAKD,aALC;gBAMC,eAND;oBAOK,mBAPL;4BAQa,2BARb;kBASG,iBATH;aAUF,YAVE;yBAWU,wBAXV;4BAYa,2BAZb;oBAaK,mBAbL;kBAcG,iBAdH;0BAeW,yBAfX;mBAgBI,kBAhBJ;2BAiBY,0BAjBZ;gBAkBC,eAlBD;2BAmBY,0BAnBZ;2BAoBY,0BApBZ;2CAsBb,0CAtBa;2BAuBY,0BAvBZ;4BAwBa,2BAxBb;gBAyBC,eAzBD;2BA0BY,0BA1BZ;uBA2BQ,sBA3BR;0BA4BW,yBA5BX;yBA6BU,wBA7BV;qBA8BM,oBA9BN;wBA+BS,uBA/BT;YAgCH,WAhCG;oBAiCK,mBAjCL;gBAkCC,eAlCD;qBAmCM,oBAnCN;cAoCD,aApCC;cAqCD,aArCC;wBAsCS,uBAtCT;oBAuCK,mBAvCL;oBAwCK,mBAxCL;8BAyCe,6BAzCf;sBA0CO,qBA1CP;sBA2CO,qBA3CP;gCA4CiB,+BA5CjB;oBA6CK,mBA7CL;cA8CD,aA9CC;oBA+CK;CA/CpB;;ACGe,uBAAwC;KAA/B/D,KAA+B,uEAAvBuE,aAAuB;KAARC,MAAQ;;SAC9CA,OAAO9B,IAAf;OACM+B,QAAQC,iBAAb;OACKD,QAAQE,eAAb;OACKC,iBAAiB5E,KAAjB,EAAwBwE,OAAOK,OAA/B,CAAJ,EAA6C;YACpC7E,KAAR,EAAewE,OAAOK,OAAtB;IADD,MAEO;UACAC,KAAN,CAAYxG,IAAZ,CAAiBkG,OAAOK,OAAxB;;OAEGC,QAAQC,UAAU/E,KAAV,CAAZ;YACS8E,KAAT,EAAgBA,MAAMA,KAAN,CAAY3H,MAAZ,GAAqB,CAArC,EAAwCqH,OAAOK,OAA/C;UACOG,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB8E,KAAzB,CAAP;OACIL,QAAQQ,aAAb;OACKH,QAAQP,aAAZ;SACMO,KAAN,GAAcN,OAAOK,OAAP,CAAeK,KAAf,EAAd;SACMJ,KAAN,CAAYK,OAAZ,CACCC,SAASvI,IAAT,CAAc,IAAd,EAAoBiI,KAApB,EAA2BA,MAAMA,KAAN,CAAY3H,MAAZ,GAAqB,CAAhD,CADD;UAGO6H,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB8E,KAAzB,CAAP;;OAEIL,QAAQY,yBAAb;OACKP,QAAQC,UAAU/E,KAAV,CAAZ;OACCsF,OAAOR,MAAMA,KAAN,CAAYS,GAAZ,EADR;OAGCD,SACCA,KAAKvB,GAAL,IAAY,QAAZ,IAAwBuB,KAAKE,UAAL,IAAmB,QAD5C,KAEAV,MAAMW,WAAN,CAAkBH,KAAKI,MAAL,CAAYC,EAA9B,CAHD,EAIE;QACGC,OAAOd,MAAMW,WAAN,CAAkBH,KAAKI,MAAL,CAAYC,EAA9B,EAAkC,CAAlC,CAAX;UACMF,WAAN,CAAkBH,KAAKI,MAAL,CAAYC,EAA9B,EAAkC,CAAlC,IAAuCC,OAAO,CAA9C;;QAEI,CAACd,MAAMW,WAAN,CAAkBH,KAAKI,MAAL,CAAYC,EAA9B,EAAkC,CAAlC,CAAL,EACC,OAAOb,MAAMW,WAAN,CAAkBH,KAAKI,MAAL,CAAYC,EAA9B,CAAP;;UAEKX,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB8E,KAAzB,CAAP;OACIL,QAAQoB,WAAb;UACQtB,aAAP;;UAEOvE,KAAP;;;;AAIH,SAAS+E,SAAT,CAAmB/E,KAAnB,EAA0B;KACrB8E,QAAQ9E,MAAM8E,KAAN,CAAYI,KAAZ,EAAZ;KACCO,cAAc5B,KAAKiC,KAAL,CAAWjC,KAAKC,SAAL,CAAe9D,MAAMyF,WAArB,CAAX,CADf;QAEO,EAAEX,YAAF,EAASW,wBAAT,EAAP;;AAED,SAASM,OAAT,CAAiB/F,KAAjB,EAAwBgG,IAAxB,EAA8B;OACvBlB,KAAN,CAAYxG,IAAZ,CACC0B,MAAM8E,KAAN,CAAYmB,MAAZ,CAAmBjG,MAAMyF,WAAN,CAAkBO,KAAKN,MAAL,CAAYC,EAA9B,EAAkC,CAAlC,CAAnB,EAAyD,CAAzD,EAA4D,CAA5D,CADD;OAGMF,WAAN,CAAkBO,KAAKN,MAAL,CAAYC,EAA9B,EAAkC,CAAlC,IAAuC3F,MAAM8E,KAAN,CAAY3H,MAAZ,GAAqB,CAA5D;;AAED,AAAO,SAASyH,gBAAT,CAA0B5E,KAA1B,EAAiCzC,OAAjC,EAA0C;QACzCyC,MAAM8E,KAAN,CAAYrD,MAAZ,CAAmB;SAAKyE,EAAEC,OAAF,CAAUzE,CAAV,EAAanE,OAAb,CAAL;EAAnB,EAA+CJ,MAAtD;;;AAGD,AACA,SAASiI,QAAT,CAAkBN,KAAlB,EAAyBsB,KAAzB,EAAgCpH,CAAhC,EAAmC;KAC9BA,EAAE+E,GAAF,IAAS,QAAT,IAAqB/E,EAAEwG,UAAF,IAAgB,QAAzC,EAAmD;MAC9CV,MAAMW,WAAN,CAAkBzG,EAAE0G,MAAF,CAASC,EAA3B,CAAJ,EAAoC;SAC7BF,WAAN,CAAkBzG,EAAE0G,MAAF,CAASC,EAA3B,EAA+B,CAA/B,IACCb,MAAMW,WAAN,CAAkBzG,EAAE0G,MAAF,CAASC,EAA3B,EAA+B,CAA/B,IAAoC,CADrC;GADD,MAGO;SACAF,WAAN,CAAkBzG,EAAE0G,MAAF,CAASC,EAA3B,IAAiC,CAAC,CAAD,EAAIS,KAAJ,CAAjC;;;;;AAKH,SAAS7B,WAAT,GAAuB;KAClBO,QAAQ,EAAZ;KACCW,cAAc,EADf;QAEO,EAAEX,YAAF,EAASW,wBAAT,EAAP;;;AC1EM,IAAMY,4BAA4BC,OAAO,2BAAP,CAAlC;AACP,IAAMC,YAAY,CACjB;KACKF,yBADL;WAEW,kBAASrG,KAAT,EAAgBwE,MAAhB,EAAwB;MAC7BI,iBAAiB5E,MAAMwG,MAAN,CAAaC,UAA9B,EAA0CjC,OAAOK,OAAjD,CAAJ,EACC,kBAASD,kBAAkB,IAA3B,IAAoCJ,OAAOK,OAA3C;;CALc,CAAlB;AASA,aAAe;QAAM0B,SAAN;CAAf;;ACLA,IAAMpH,QAAME,MAAM,gBAAN,CAAZ;;AAEA,IAAMqH,cAAczF,OAAOyF,WAA3B;IACEC,kBAAkB1F,OAAO0F,eAD3B;IAEEC,WAAWC,OAAOD,QAAP,IAAmB3F,OAAO6F,OAFvC;IAGEC,YAAY,EAHd;IAIEC,QAAQ,IAAI3D,QAAJ,CAAa,EAAEG,KAAKvC,OAAOgG,sBAAd,EAAb,CAJV;;AAOA,AAAO,IAAMC,iBAAiB,SAAjBA,cAAiB,OAAQ;SAC7B;UACC,cADD;aAEIC;GAFX;CADK;AAMP,SAASC,IAAT,CAAcrG,KAAd,EAAqB;SACZ8C,KAAKiC,KAAL,CAAWjC,KAAKC,SAAL,CAAe/C,KAAf,CAAX,CAAP;;;AAGF,SAASsG,cAAT,CAAwBrG,IAAxB,EAA8B;SACrBA,OACH,MACAgE,OAAOsC,IAAP,CAAYtG,IAAZ,EACGuG,GADH,CACO,UAAC7F,CAAD,EAAI0E,QAAJ,EAAWoB,GAAX,EAAmB;WACZ9F,CAAV,UAAe+F,mBAAmBzG,KAAKU,CAAL,CAAnB,KACZ0E,YAASoB,IAAIrK,MAAJ,GAAa,CAAtB,GAA0B,GAA1B,GAAgC,EADpB,CAAf;GAFJ,EAKGuK,IALH,CAKQ,EALR,CAFG,GAQH,EARJ;;AAUF,AAAO,SAASC,SAAT,CAAmB3G,IAAnB,EAAyB;;;;UAEtByD,QAAQC;0BACb2B,yBAFH,EAE+B,IAF/B,mCAGWrF,IAHX;;;AAOF,AAAO,SAAS4G,YAAT,CAAsB5G,IAAtB,EAA4B;SAC1B;UACCyD,QAAQQ,aADT;aAEIjE;GAFX;;AAKF,AAAO,SAAS6G,MAAT,CAAgB7G,IAAhB,EAAsB;SACpB,EAAE0B,MAAM+B,QAAQY,yBAAhB,EAA2CR,SAAS7D,IAApD,EAAP;;AAEF,AAAO,SAAS8G,oBAAT,GAAgC;SAC9B,EAAEpF,MAAM+B,QAAQoB,WAAhB,EAAP;;AAEF,AAAO,SAASkC,cAAT,CAAwB/G,IAAxB,EAA8B;SAC5B;UACCyD,QAAQE,eADT;aAEI3D;GAFX;;;AAMF,AAAO,SAASgH,uBAAT,GAAmC;SACjC;UACCvD,QAAQwD;GADhB;;;AAKF,AAAO,SAASC,oBAAT,CAA8BlH,IAA9B,EAAoC;SAClC;UACCyD,QAAQ0D,sBADT;aAEInH;GAFX;;AAKF,AAAO,SAASoH,gBAAT,CAA0BzC,EAA1B,EAA8B0C,OAA9B,EAAuC3C,MAAvC,EAA+C;SAC7C;UACCjB,QAAQ6D,iBADT;aAEI,EAAED,gBAAF,EAAW3C,cAAX,EAAmBC,MAAnB;GAFX;;AAKF,AAAO,SAASzF,YAAT,CAAsB2E,OAAtB,EAA+B;SAC7B;UACCJ,QAAQ8D,aADT;;GAAP;;AAKF,SAASC,YAAT,CAAsBC,QAAtB,EAAgCC,UAAhC,EAA4CC,KAA5C,EAAkDC,eAAlD,EAAmE;SAC1D;UACCF,cAAc,cADf;UAEC,cAAClE,MAAD,EAASxE,KAAT,EAAgB6I,GAAhB,EAAwB;UACxBH,cAAcG,IAAIC,MAAJ,KAAe,GAAjC,EACEL,SACEvB,eACE2B,IAAIE,UAAJ,IACGF,IAAIG,OAAJ,IACCH,IAAIG,OAAJ,CAAYzB,GADb,IAECsB,IAAIG,OAAJ,CAAYzB,GAAZ,CAAgB0B,YAFjB,IAGCJ,IAAIG,OAAJ,CAAYzB,GAAZ,CAAgB0B,YAAhB,CAA6B,CAA7B,CAJJ,IAKE,yDANJ,CADF;YAUE,mBAAJ;YACIzE,MAAJ;UACIxD,OAAOwD,OAAO0E,QAAP,CAAX;UACIN,eAAJ,EAAqB;YACfO,cAAcnI,KAAKoI,QAAL,GAAgBpI,KAAKqI,IAAvC;kBACUF,WAAV,IAAyBpC,UAAUoC,WAAV,KAA0B,CAAC,CAAD,EAAI,CAAJ,CAAnD;kBACUA,WAAV,EAAuB,CAAvB,KAA6BlI,OAAOqI,oBAAP,IAA+B,GAA5D;kBACUH,WAAV,EAAuB,CAAvB,KAA6B,CAA7B;;;UAGEN,IAAIC,MAAJ,IAAc,GAAlB,EAAuB;iBACZS,cAAY,0BAAZ,CAAT;iBACS,EAAE7G,MAAM+B,QAAQ+E,wBAAhB,EAAT;;;aAGKb,QACHA,MAAKnE,MAAL,EAAaxE,KAAb,EAAoB6I,GAApB,CADG,GAEHA,IAAIE,UAAJ,IAAkB,+BAFtB;;GA7BJ;;AAmCF,AAAO,IAAMU,oBAAuB7C,QAAvB,sBAAN;AACP,AAAO,SAAS8C,kBAAT,CAA4B/D,EAA5B,EAAgC3E,IAAhC,EAAsC;MACvCC,OAAO0I,uBAAX,EAAoC;QAC9BC,WAAW,EAAEjE,MAAF,EAAM3E,UAAN,EAAf;QACE6I,SAAS7C,MAAM6C,MAAN,CAAaD,QAAb,CADX;QAEIC,MAAJ,EAAY;UACNhF,UAAUG,OAAOpC,MAAP,CAAc,EAAd,EAAkBoE,MAAMtD,GAAN,CAAUkG,QAAV,CAAlB,CAAd;;aAEO,oBAAY;iBACR;gBACDnF,QAAQqF,eADP;;SAAT;OADF;;;SAQG,UAACrB,QAAD,EAAWsB,QAAX;WACLtB,4BACGS,QADH,EACcxC,YACV;gBACeE,QAAb,8BAA8CjB,EAA9C,GAAmD0B,eACjDrC,OAAOpC,MAAP,CAAc,EAAd,EAAkB5B,QAAQ,EAA1B,EAA8B,EAAEgJ,aAAa,CAAC,CAAC/I,OAAOgJ,UAAxB,EAA9B,CADiD,CADrD;aAIS,CACL,EAAEvH,MAAM+B,QAAQyF,gBAAhB,EAAkCvB,MAAMhD,EAAxC,EADK,EAEL;cACQlB,QAAQqF,eADhB;iBAEW,iBAACtF,MAAD,EAASxE,KAAT,EAAgB6I,GAAhB,EAAwB;;qBAEpB;mBAAM,IAAN;WAAX,EAAuB,CAAvB;iBACOA,IAAIsB,IAAJ,GAAWC,IAAX,CAAgB,aAAK;gBACtBC,WAAW,EAAE1E,IAAIA,EAAN,EAAU2E,MAAMC,CAAhB,EAAf;gBACItJ,OAAO0I,uBAAP,IAAkC,CAACY,EAAED,IAAzC,EAA+C;oBACvC7G,KAAN,CAAY,EAAEkC,MAAF,EAAM3E,UAAN,EAAZ,EAA0BoG,KAAKiD,QAAL,CAA1B;;mBAEKA,QAAP;WALK,CAAP;;OAPC,EAgBL7B,aAAaC,QAAb,EAAuBhE,QAAQ+F,uBAA/B,EAAwD;eAAM7E,EAAN;OAAxD,CAhBK,CAJT;cAsBU,KAtBV;eAuBW;gBACC,kBADD;wBAES;;KA1BV,EA6BVoE,UA7BU,CADd,EADK;GAAP;;AAmCF,AAAO,SAASU,gBAAT,CAA0B1G,GAA1B,EAA+B;SAC7B;UACCU,QAAQiG,UADT;aAEI3G;GAFX;;AAKF,AAAO,SAAS4G,cAAT,CAAwBhF,EAAxB,EAA4B3E,IAA5B,EAAkC+C,GAAlC,EAAuC;SACrC6G,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkC;uBACpBU,QAAQoG,aADY;sBAErBpG,QAAQqG,wBAFa;qBAGtBrG,QAAQsG,yBAHc;kBAIzB,IAJyB;kBAKzB;GALT,CAAP;;AAQF,AAAO,SAASC,UAAT,CAAoBrF,EAApB,EAAwB3E,IAAxB,EAA8B+C,GAA9B,EAAmC;SACjC6G,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkC;uBACpBU,QAAQoG,aADY;sBAErBpG,QAAQwG,aAFa;qBAGtBxG,QAAQsG,yBAHc;kBAIzB,IAJyB;kBAKzB;GALT,CAAP;;;AASF,AAAO,SAASG,eAAT,CAAyBvF,EAAzB,EAA6B3E,IAA7B,EAAmC+C,GAAnC,EAAwC;SACtC6G,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkC;uBACpBU,QAAQ0G,iBADY;sBAErB1G,QAAQ2G,iBAFa;qBAGtB3G,QAAQ4G,2BAHc;kBAIzB;GAJT,CAAP;;;AAQF,AAAO,SAASC,iBAAT,CAA2B3F,EAA3B,EAA+B3E,IAA/B,EAAqC+C,GAArC,EAA0C;SACxC6G,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkC;uBACpBU,QAAQ8G,mBADY;sBAErB9G,QAAQ+G,mBAFa;qBAGtB/G,QAAQgH,6BAHc;kBAIzB;GAJT,CAAP;;;AAQF,AAAO,SAASC,oBAAT,CAA8B/F,EAA9B,EAAkC3E,IAAlC,EAAwC+C,GAAxC,EAA6C;SAC3C6G,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkC;uBACpBU,QAAQkH,wBADY;sBAErBlH,QAAQmH,wBAFa;qBAGtBnH,QAAQoH,wCAHc;kBAIzB;GAJT,CAAP;;;AAQF,AAAO,SAASC,eAAT,GAA2B;SACzB,UAACrD,QAAD,EAAWsB,QAAX,EAAwB;gCAE1Bb,QADH,EACcvC,gBACV;gBACeC,QAAb,uBADF;aAES,CACLnC,QAAQsH,iBADH,EAELtH,QAAQuH,iBAFH,EAGLvH,QAAQwH,2BAHH,CAFT;YAOQ;KARE,EAUVlC,UAVU,CADd;GADF;;;AAkBF,AAAO,SAASa,kBAAT,CACLjF,EADK,EAEL3E,IAFK,EAGL+C,GAHK,EAaL;kFADI,EACJ;MAREmI,iBAQF,SAREA,iBAQF;MAPEC,gBAOF,SAPEA,gBAOF;MANEC,eAMF,SANEA,eAMF;MALEC,SAKF,SALEA,SAKF;MAJEC,YAIF,SAJEA,YAIF;MAHEC,YAGF,SAHEA,YAGF;MAFEC,KAEF,SAFEA,KAEF;;MACIvL,OAAOwL,uBAAP,IAAkC,CAACH,YAAvC,EAAqD;QAC/C1C,WAAW,EAAEjE,MAAF,EAAM3E,UAAN,EAAf;QACE6I,SAAS7C,MAAM6C,MAAN,CAAaD,QAAb,CADX;QAEIC,MAAJ,EAAY;UACNhF,UAAUuC,KAAKJ,MAAMtD,GAAN,CAAUkG,QAAV,CAAL,CAAd;cACQ7F,GAAR,GAAcA,GAAd;;aAEO,oBAAY;iBACR;gBACDoI,oBAAoB1H,QAAQiI,oBAD3B;;SAAT;OADF;;;;SASG,UAACjE,QAAD,EAAWsB,QAAX,EAAwB;QACzBV,OAAOxF,KAAKC,SAAL,CAAe9C,IAAf,CAAX;QACEoI,WAAcxC,QAAd,4BAA6CjB,EAD/C;QAEEwD,mBAAiBC,QAAjB,GAA4BC,IAF9B;;QAIImD,KAAJ,EAAWzF,UAAUoC,WAAV,IAAyB,CAAClI,OAAOqI,oBAAP,IAA+B,GAAhC,EAAqC,CAArC,CAAzB;QAETvC,UAAUoC,WAAV,KACClI,OAAO0L,mBAAP,IACC5F,UAAUoC,WAAV,EAAuB,CAAvB,KAA6BlI,OAAO0L,mBAHxC,EAKE,OAAOlE,SACLc,cACE,mGADF,CADK,CAAP;QAKEqD,YAAY3L,OAAO4L,iBAAP,CAAyB1P,MAAzC;QACE2P,aAAazI,WAAW,YAAM;aACrBwI,iBAAP,CAAyB5G,MAAzB,CAAgC2G,SAAhC,EAA2C,CAA3C;kCAEG1D,QADH,EACcxC,YACV;0BAAA;eAES,CACL;gBACQwF,qBAAqBzH,QAAQsI,wBADrC;gBAEQ,EAAEpH,MAAF,EAAM5B,QAAN,EAAW/C,UAAX;SAHH,EAKL;gBACQmL,oBAAoB1H,QAAQiI,oBADpC;mBAEW,iBAAClI,MAAD,EAASxE,KAAT,EAAgB6I,GAAhB,EAAwB;mBACxBA,IAAIsB,IAAJ,GAAWC,IAAX,CAAgB,gBAAQ;qBACtBrD,UAAUoC,WAAV,CAAP;kBACImB,QAAQ,OAAOA,KAAKjC,OAAZ,IAAuB,QAAnC,EAA6C;yBAClCkB,cAAYe,KAAKjC,OAAjB,CAAT;;kBAEEgC,WAAW,EAAE1E,MAAF,EAAM2E,UAAN,EAAYtJ,UAAZ,EAAkB+C,QAAlB,EAAuBsI,oBAAvB,EAAf;kBACIpL,OAAOwL,uBAAP,IAAkC,CAACH,YAAvC,EAAqD;sBAC7C7I,KAAN,CAAY,EAAEkC,MAAF,EAAM3E,UAAN,EAAZ,EAA0BqJ,QAA1B;;qBAEKA,QAAP;aATK,CAAP;;SARC,EAqBL7B,aACEC,QADF,EAEE2D,mBAAmB3H,QAAQuI,uBAF7B,EAGE;iBAAMjJ,GAAN;SAHF,EAIE,CAAC9C,OAAOgM,qBAAR,IAAiC,CAACV,YAJpC,CArBK,CAFT;gBA8BU,MA9BV;iBA+BW;kBACC,kBADD;0BAES;SAjCpB;;OADU,EAsCVxC,UAtCU,CADd;KAFW,EA4CVhD,UAAUoC,WAAV,KAA0B,CA5ChB,CADf;;WA+CO0D,iBAAP,CAAyBvO,IAAzB,CAA8BwO,UAA9B;GA/DF;;;AAmEF,AAAO,SAASvD,aAAT,CAAqBlB,OAArB,EAA8B;SAC5B;UACC,cADD;;GAAP;;;AAMF,AAAO,SAAS6E,gBAAT,CAA0BC,OAA1B,EAAmC;SACjC,UAAC1E,QAAD,EAAWsB,QAAX;WACLtB,4BACGS,QADH,EACcxC,YACV;gBACeE,QAAb,yBAAyCuG,QAAQxH,EADnD;aAES,CACL;cACQlB,QAAQ2I,sBADhB;cAEQ;cACAD,QAAQxH,EADR;gBAEEwH,QAAQE,IAFV;uBAGSF,QAAQG;;OANpB,EASL;cACQ7I,QAAQ8I,kBADhB;iBAEW,iBAAC/I,MAAD,EAASxE,KAAT,EAAgB6I,GAAhB,EAAwB;iBACxBA,IACJsB,IADI,GAEJC,IAFI,CAEC,aAAK;gBACLG,KAAK,OAAOA,EAAElC,OAAT,IAAoB,QAA7B,EAAuC;uBAC5BkB,cAAYgB,EAAElC,OAAd,CAAT;;gBAEE1C,KAAKwH,QAAQxH,EAAjB;gBAEE,EAAE1E,OAAOgJ,UAAP,IAAqBM,EAAEzB,MAAF,IAAY,WAAnC,KACA,EACE,CAAC7H,OAAOgJ,UAAR,KACCjK,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB8H,WAAtB,CAAkCC,KAAlC,CAAwCvQ,MAAxC,IAAkD,CAAlD,IACE6C,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,IACC6C,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CACE9E,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,GAAuC,CADzC,EAEEuI,MAFF,CAES4H,WAFT,GAGE,CAHF,GAIEtN,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB8H,WAAtB,CAAkCC,KAAlC,CAAwCvQ,MAAxC,GACE,CARR,CADF,CADA,IAYA,CAAC6C,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB8H,WAAtB,CACEE,yBAdL,EAeE;kBACIC,KAAKxG,KACPpH,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CACE9E,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,GAAuC,CADzC,CADO,CAAT;iBAKGuI,MAAH,CAAU4H,WAAV,GAAwB,CAACM,GAAGlI,MAAH,CAAU4H,WAAV,IAAyB,CAA1B,IAA+B,CAAvD;uBACS3F,UAAUiG,EAAV,CAAT;kBACI3M,OAAO4M,iBAAX,EAA8B;uBACrBA,iBAAP,CAAyBpF,QAAzB,EAAmCzI,KAAnC,EAA0C4N,EAA1C;;;mBAGG,EAAEjI,IAAIwH,QAAQxH,EAAd,EAAkB2E,MAAMC,CAAxB,EAAP;WAlCG,EAoCJuD,KApCI,CAoCE,cAAM;kBACPC,EAAJ;qBACS;oBACD,cADC;uBAGL;aAHJ;WAtCG,CAAP;;OAZC,EA0DLvF,aACEC,QADF,EAEEhE,QAAQuJ,qBAFV,EAGE;eAAMb,QAAQxH,EAAd;OAHF,CA1DK,CAFT;cAkEU,MAlEV;eAmEW;gBACC,kBADD;wBAES;OArEpB;YAuEQ9B,KAAKC,SAAL,CACJkB,OAAOpC,MAAP,CAAc,EAAd,EAAkBuK,QAAQE,IAA1B,EAAgC;qBACjBF,QAAQc,UADS;qBAEjB,CAAC,CAAChN,OAAOgJ,UAFQ;sBAGhBiE,SAASf,QAAQG,WAAjB;OAHhB,CADI;KAxEE,EAgFVvD,UAhFU,CADd,EADK;GAAP;;AAsFF,AAAO,SAASoE,oBAAT,CAA8BxI,EAA9B,EAAkC5B,GAAlC,EAAuCqK,QAAvC,EAAiDC,KAAjD,EAAwD;SACtD,UAAC5F,QAAD,EAAWsB,QAAX,EAAwB;gCAE1Bb,QADH,EACcxC,YACV;gBACeE,QAAb,6BAA4CjB,MAAM0I,SAAS,EAAf,CAA5C,CADF;aAES,CACL,EAAE3L,MAAM+B,QAAQ6J,WAAhB,EAA6B3F,MAAM5E,GAAnC,EADK,EAEL;cACQU,QAAQ8J,WADhB;iBAEW,iBAAC/J,MAAD,EAASxE,KAAT,EAAgB6I,GAAhB,EAAwB;iBACxBA,IAAIsB,IAAJ,GAAWC,IAAX,CAAgB,aAAK;mBACnB,EAAEE,MAAMC,CAAR,EAAWxG,QAAX,EAAP;WADK,CAAP;;OALC,EAULyE,aAAaC,QAAb,EAAuBhE,QAAQ+J,qBAA/B,EAAsD;eAAMzK,GAAN;OAAtD,CAVK,CAFT;cAcU,KAdV;eAeW;gBACC,KADD;wBAES;;KAlBV,EAqBVgG,UArBU,CADd;GADF;;;AA6BF,AAAO,SAAS0E,gBAAT,CAA0BC,IAA1B,EAAgC3K,GAAhC,EAAqC;MACtC4K,WAAW,IAAIC,QAAJ,EAAf;;WAESC,MAAT,CAAgB,MAAhB,EAAwBH,IAAxB;;SAEO,UAACjG,QAAD,EAAWsB,QAAX,EAAwB;gCAE1Bb,QADH,EACcxC,YACV;gBACeE,QAAb,gBADF;aAES,CACL,EAAElE,MAAM+B,QAAQqK,iBAAhB,EAAmCnG,MAAM5E,GAAzC,EADK,EAEL;cACQU,QAAQsK,aADhB;iBAEW,iBAACvK,MAAD,EAASxE,KAAT,EAAgB6I,GAAhB,EAAwB;iBACxBA,IAAIsB,IAAJ,GAAWC,IAAX,CAAgB,aAAK;mBACnB,EAAErG,QAAF,EAAO4B,IAAI4E,EAAE5E,EAAb,EAAP;WADK,CAAP;;OALC,EAUL6C,aAAaC,QAAb,EAAuBhE,QAAQuK,kBAA/B,EAAmD;eAAMjL,GAAN;OAAnD,CAVK,CAFT;cAcU,MAdV;eAeW;gBACC;OAhBZ;YAkBQ4K;KAnBE,EAqBV5E,UArBU,CADd;GADF;;;;;ACvdF,AAKA,mBAAe,UAACkF,IAAD,EAAOC,OAAP,EAAgBC,SAAhB,EAA8B;aAChCrP,cAAX,CAA0BmP,IAA1B,EAAgC,MAAhC;aACWnP,cAAX,CAA0BoP,OAA1B,EAAmC,SAAnC;aACWpP,cAAX,CAA0BqP,SAA1B,EAAqC,WAArC;;MAEMC,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;;UAE5DC,SAASvP,MAAMwG,MAAN,CAAagH,IAAb,CAAkB8B,SAASE,cAA3B,CAAb;UACE/B,cAAc8B,UAAUA,OAAO9B,WADjC;UAEElG,MAAM;eACIgI,UAAUA,OAAOD,SAAShC,WAAhB,CAAX,IAA4C;OAHvD;;UAMIG,eAAeA,YAAYC,KAAZ,CAAkB4B,SAAShC,WAA3B,CAAnB,EAA4D;YACtDmC,QAAJ,GAAehC,YAAYC,KAAZ,CAAkB4B,SAAShC,WAA3B,EAAwCD,IAAxC,CAA6CoC,QAA5D;YACIhC,YAAYC,KAAZ,CAAkB4B,SAAShC,WAA3B,EAAwCoC,IAAxC,IAAgD,MAApD,EACEnI,IAAIoI,UAAJ,GAAiB,IAAjB;YACEC,KAAJ,GAAYnC,YAAYmC,KAAxB;YACIC,kBAAJ,GAAyBpC,YAAYA,WAArC;;aAEKlG,GAAP;KAfsB;GAAxB;MAiBMuI,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;oBACS;eAAQrH,SAASvI,aAAac,IAAb,CAAT,CAAR;;KADhB;GADF;;MAMM+O,UA5BqC;;;;;YAL1C;iBAAQ,KAAKhR,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;wBAkCrCxB,KAAZ,EAAmB;;;yHACXA,KADW;;YAEZ+S,cAAL,GAAsB,MAAKA,cAAL,CAAoBnT,IAApB,OAAtB;YACKoT,MAAL,GAAc,MAAKA,MAAL,CAAYpT,IAAZ,OAAd;;YAEKmD,KAAL,GAAa;mBACA;OADb;;;;;;qCAKaqN,IAvC0B,EAuCpB;;aAEdpQ,KAAL,CAAWiD,YAAX,CAAwB;gBAChBmN,KAAK6C,WADW;cAElB,KAAKjT,KAAL,CAAWuS,cAFO;gBAGhB,KAAKvS,KAAL,CAAWqQ;SAHnB;;;;+BAMO;;;aACFtN,KAAL,CAAWK,SAAX,CACGC,QADH,GAEG8J,IAFH,CAGI,YAAM;iBACXnN,KAAL,CAAWkC,GAAX,CAAe,kBAAkB,OAAKlC,KAAL,CAAWqQ,WAAX,IAA0B,GAA5C,CAAf;iBACiBrQ,KAAL,CAAWgT,MAAX,CAAkB,OAAKhT,KAAL,CAAW8D,KAA7B;SALN,EAOI,YAAM;iBACX9D,KAAL,CAAWkC,GAAX,CAAe,qBAAf;SARM,EAWG2O,KAXH,CAWS,cAAM;iBAChB7Q,KAAL,CAAWkC,GAAX,CAAe,0CAAf;iBACKlC,KAAL,CAAWkC,GAAX,CAAe4O,EAAf;SAbM;;;;iDAgBO;YACH,CAAC,KAAK9Q,KAAL,CAAWwS,QAAZ,IAAwB,CAAC,KAAKxS,KAAL,CAAWwS,QAAX,CAAoBtS,MAAjD,EACE,OACEqC;cAAA;YAAM,YAAY,IAAlB;uCACG,OAAD,IAAS,SAAQ,2FAAjB;SAFJ;;eAOAA;cAAA;;oBACU,KAAKyQ,MADf;wBAEc,KAAKhT,KAAL,CAAW0S,UAFzB;gCAGsB,KAAK1S,KAAL,CAAW4S;;uCAE9B,SAAD;mBACS,KAAK5S,KAAL,CAAW2S,KADpB;sBAEY,KAAK3S,KAAL,CAAWwS,QAFvB;kBAGO,aAHP;mBAIS,KAAKxS,KAAL,CAAW8D,KAJpB;0BAKgB,KAAKiP,cALrB;uBAMa,KAAKhQ,KAAL,CAAWK,SANxB;wBAOc,KAAKpD,KAAL,CAAWwJ,UAPzB;yBAQe,KAAKxJ,KAAL,CAAWqQ,WAR1B;4BASkB,KAAKrQ,KAAL,CAAWuS;;SAfjC;;;;;IA5CqB7Q,eA5BkB;;SA+FpCwR,mBACLf,eADK,EAELU,kBAFK,EAGL1M,aAAW2M,UAAX,CAHK,CAAP;CA/FF;;;;ACLA,AAGA,wBAAe,YAAa;oCAAT/O,IAAS;QAAA;;;;MAEtBoP,UAAUpP,KAAK,CAAL,CAAd;MACEqP,SAASrP,KAAK,CAAL,CADX;MAEEsP,yBAFF;MAGEC,yBAHF;MAIIvP,KAAK7D,MAAL,IAAe,CAAnB,EAAsB;uBACD6D,KAAK,CAAL,CAAnB;GADF,MAEO;uBACcA,KAAK,CAAL,CAAnB;uBACmBA,KAAK,CAAL,CAAnB;;;MAIAwP,WAAW1Q,cAAX,CAA0BsQ,OAA1B,EAAmC,SAAnC,KACAI,WAAW1Q,cAAX,CAA0BuQ,MAA1B,EAAkC,QAAlC,CADA,IAEA,CAACE,gBAHH,EAKE,MAAM,IAAI7R,KAAJ,CAAU,oDAAV,CAAN;;SAEK0E;;;;;YAvBN;iBAAQ,KAAKrE,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;oBAyBnCxB,KAAZ,EAAmB;;;iHACXA,KADW;;YAEZ+S,cAAL,GAAsB,MAAKA,cAAL,CAAoBnT,IAApB,OAAtB;YACKmD,KAAL,GAAa;sBACG,CAAC,MAAK/C,KAAL,CAAWwS,QAAX,IAAuB,EAAxB,EAA4BlI,GAA5B,CAAgC;iBAAM,EAAN;SAAhC;OADhB;YAGKkJ,YAAL,GAAoB,MAAKA,YAAL,CAAkB5T,IAAlB,OAApB;YACK4T,YAAL;;;;;;;;gDAEwB5P,IAXvB,EAW6B;YAE5BA,KAAK4O,QAAL,KACC5O,KAAK4O,QAAL,KAAkB,KAAKxS,KAAL,CAAWwS,QAA7B,IACC5O,KAAK4O,QAAL,CAActS,MAAd,KAAyB,KAAKF,KAAL,CAAWwS,QAAX,CAAoBtS,MAF/C,CADF,EAIE;cACIuT,eAAe7P,KAAK4O,QAAL,CAAclI,GAAd,CAAkB;mBAAM,EAAN;WAAlB,CAAnB;eACLtK,KAAL,CAAWkC,GAAX,4CAAwD,KAAKlC,KAAL,CAAWwB,IAAnE;eACeF,QAAL,CAAc,EAAEmS,0BAAF,EAAd;;;;;qCAGW;;;aACRzT,KAAL,CAAWoD,SAAX,CAAqBC,QAArB,GAAgC,YAAM;iBAC7BxD,QAAQ6T,GAAR,CACL,OAAK3Q,KAAL,CAAW0Q,YAAX,CAAwBnJ,GAAxB,CAA4B,aAAK;gBAC3B7F,EAAEpB,QAAN,EAAgB,OAAOoB,EAAEpB,QAAF,EAAP;;mBAET,IAAIxD,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;aAAjC,CAAP;WAHF,CADK,CAAP;SADF;;;;uCAYe;YACXqQ,OAAOrI,OAAOpC,MAAP,gBACT,EADS,EAET,KAAK3F,KAAL,CAAW8D,KAAX,IAAoB,EAFX,2BAGN6P,MAAMhS,SAAN,CAAgBsG,KAAhB,CAAsB2L,IAAtB,CAA2BC,SAA3B,CAHM,GAAX;;aAMK7T,KAAL,CAAWiD,YAAX,oBAA2B,KAAKjD,KAAL,CAAWwB,IAAtC,EAA6C4O,IAA7C;;;;iDAGO;;;;YAEH/F,OAAO,KAAKrK,KAAL,CAAW8D,KAAX,GAAmBiE,OAAOsC,IAAP,CAAY,KAAKrK,KAAL,CAAW8D,KAAvB,CAAnB,GAAmD,EAA9D;YACEgQ,OAAO,IADT;YAEEC,WAAW,EAFb;YAGEC,cAAc,EAHhB;YAIExB,WAAW,CAAC,KAAKxS,KAAL,CAAWwS,QAAX,IAAuB,EAAxB,EACRyB,IADQ,CACH,UAACxP,CAAD,EAAIyP,CAAJ,EAAU;iBACPzP,EAAE0P,KAAF,GAAUD,EAAEC,KAAnB;SAFO,EAIR7J,GAJQ,CAIJ,UAAC7F,CAAD,EAAI0E,KAAJ,EAAc;cACbiL,kBAAkBd,iBAAiB7O,CAAjB,CAAtB;cACE4P,SAASP,KAAK9T,KAAL,CAAW8D,KADtB;;;kBAGUuQ,SAAS,OAAKrU,KAAL,CAAW8D,KAAX,CAAiBW,EAAEjD,IAAnB,CAAT,GAAoC,IAH9C;;cAME6S,UACAA,OAAOtN,cAAP,CAAsBtC,EAAEjD,IAAxB,CADA,IAEA6I,KAAKiK,OAAL,CAAa7P,EAAEjD,IAAf,MAAyB,CAAC,CAH5B,EAKE6I,KAAKrB,MAAL,CAAYqB,KAAKiK,OAAL,CAAa7P,EAAEjD,IAAf,CAAZ,EAAkC,CAAlC;;cAEE,CAAC4S,eAAL,EACE,MAAM,IAAI3S,KAAJ,CACJ,uBAAuBmF,KAAKC,SAAL,CAAepC,CAAf,EAAkB,IAAlB,EAAwB,GAAxB,CADnB,CAAN;cAGE2P,gBAAgBJ,WAApB,EAAiC;wBACnB3S,IAAZ,CAAiB8H,KAAjB;mBACO,iBAAS;kBACV5H,YACFgB,6BAAC,eAAD,eACMkC,CADN;uBAES8P,KAFT;qBAGO9P,EAAEjD,IAHT;uBAISsC,KAJT;2BAKa,OAAKf,KAAL,CAAW0Q,YAAX,CAAwBtK,KAAxB,CALb;8BAMgB,OAAK4J,cANrB;4BAOc,OAAK/S,KAAL,CAAWwJ,UAPzB;gCAQkB,OAAKxJ,KAAL,CAAWuS,cAR7B;6BASe,OAAKvS,KAAL,CAAWqQ;iBAV5B;kBAaIgD,gBAAJ,EACE,OAAOA,iBACL5O,EAAE+P,WADG,EAEL/P,EAAEgQ,GAFG,EAGLhQ,EAAEjD,IAHG,EAILD,SAJK,CAAP;;qBAOKA,SAAP;aAtBF;;cAyBEA,YACFgB,6BAAC,eAAD,eACMkC,CADN;mBAESX,KAFT;uBAGa,OAAKf,KAAL,CAAW0Q,YAAX,CAAwBtK,KAAxB,CAHb;iBAIO1E,EAAEjD,IAJT;0BAKgB,OAAKuR,cALrB;wBAMc,OAAK/S,KAAL,CAAWwJ,UANzB;4BAOkB,OAAKxJ,KAAL,CAAWuS,cAP7B;yBAQe,OAAKvS,KAAL,CAAWqQ;aAT5B;iBAYOgD,mBACHA,iBAAiB5O,EAAE+P,WAAnB,EAAgC/P,EAAEgQ,GAAlC,EAAuChQ,EAAEjD,IAAzC,EAA+CD,SAA/C,CADG,GAEHA,SAFJ;;SA5DO,CAJb;;YAsEI8I,KAAKnK,MAAL,IAAe8T,YAAY9T,MAA/B,EAAuC;eAShCgI,OAAL,CAAa,aAAK;qBACPzD,CAAT,IAAcqP,KAAK9T,KAAL,CAAW8D,KAAX,CAAiBW,CAAjB,CAAd;WADF;;sBAIYyD,OAAZ,CAAoB,aAAK;qBACdzD,CAAT,IAAc+N,SAAS/N,CAAT,EAAYsD,OAAOpC,MAAP,CAAc,EAAd,EAAkBoO,QAAlB,CAAZ,CAAd;WADF;;YAIE,KAAK/T,KAAL,CAAW6F,KAAf,EACE,OACEtD;iBAAA;;uCACG,MAAD,IAAQ,MAAM,KAAKvC,KAAL,CAAW6F,KAAzB,GADF;;SADF;;eAOKtD;iBAAA;;;SAAP;;;;IA7IUb,eADT,EAAP;CApBF;;;;ACHA,AAMA;;;;;AAKA,sBAAe,UAACgT,WAAD,EAAcC,QAAd,EAAwB7B,UAAxB,EAAuC;aACzCjQ,cAAX,CAA0B6R,WAA1B,EAAuC,aAAvC;aACW7R,cAAX,CAA0B8R,QAA1B,EAAoC,UAApC;aACW9R,cAAX,CAA0BiQ,UAA1B,EAAsC,YAAtC;;;MAGMX,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;UAC5DC,SAASvP,MAAMwG,MAAN,CAAagH,IAAb,MAAqB8B,SAAS3J,EAA9B,CAAb;aACO;cACC,CAAC,CAAC3F,MAAMwG,MAAN,CAAagH,IAAb,CAAqB8B,SAAS3J,EAA9B,WADH;qBAEQ4J,UAAUA,OAAO9B,WAFzB;oBAGO8B,UAAUA,OAAOtB,UAHxB;iBAIIjO,MAAMwG,MAAN,CAAagH,IAAb,CAAkBnF,OAJtB;mBAKMkH,UAAUA,OAAOsC;OAL9B;KAFsB;GAAxB;;MAWM/B,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;aACE,eAACnK,EAAD,EAAKD,MAAL,EAAgB;iBACZgE,mBAAmB/D,EAAnB,EAAuBD,MAAvB,CAAT;OAFG;kBAIO,0BAAQ;iBACTwH,iBAAiB4E,IAAjB,CAAT;;KALJ;GADF;;MAWMC,aA5B8C;;;;;YAXnD;iBAAQ,KAAKhT,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;2BAwCrCxB,KAAZ,EAAmB;;;+HACXA,KADW;;YAEZ+C,KAAL,GAAa,EAAb;YACKiQ,MAAL,GAAc,MAAKA,MAAL,CAAYpT,IAAZ,OAAd;;;;;;0CAEkB;YAEhB,CAAC,KAAKI,KAAL,CAAWwQ,WAAZ,IACC,KAAKxQ,KAAL,CAAW0I,EAAX,KAAkB,KAAK1I,KAAL,CAAWwQ,WAAX,CAAuBuE,GAAzC,IACC,KAAK/U,KAAL,CAAW0I,EAAX,KAAkB,KAAK1I,KAAL,CAAWwQ,WAAX,CAAuBiE,GAH7C,EAIE;eACKzU,KAAL,CAAWgV,KAAX,CAAiB,KAAKhV,KAAL,CAAW0I,EAA5B,EAAgC,KAAK1I,KAAL,CAAWiV,WAA3C;;;;;gDAGsBrR,IA3CwB,EA2ClB;YAC1BA,KAAKgR,SAAL,IAAkBhR,KAAKgR,SAAL,IAAkB,KAAK5U,KAAL,CAAW4U,SAAnD,EACE,OAAO,KAAK5U,KAAL,CAAWwJ,UAAX,CAAsBoB,MAAtB,EAAP;;YAGC,CAAChH,KAAK8E,EAAL,KAAY,KAAK1I,KAAL,CAAW0I,EAAvB,IACA,CAACO,EAAEC,OAAF,CAAUtF,KAAKqR,WAAf,EAA4B,KAAKjV,KAAL,CAAWiV,WAAvC,CADF,KAEC,CAACrR,KAAKsR,IAFP,IAGC,CAACtR,KAAK4M,WAHR,IAIC5M,KAAK8E,EAAL,IAAW,KAAK1I,KAAL,CAAW0I,EAAtB,IACC,CAACO,EAAEC,OAAF,CAAUtF,KAAKqR,WAAf,EAA4B,KAAKjV,KAAL,CAAWiV,WAAvC,CADF,IAEC,CAACrR,KAAKsR,IAPV,EASE,KAAKlV,KAAL,CAAWgV,KAAX,CAAiBpR,KAAK8E,EAAtB,EAA0B9E,KAAKqR,WAA/B;;;;6BAEG7E,IA1D2C,EA0DrC;aACNpQ,KAAL,CAAWmV,UAAX,CAAsB;cAChB,KAAKnV,KAAL,CAAW0I,EADK;oBAAA;uBAGP,KAAK1I,KAAL,CAAWqQ,WAHJ;sBAIR,KAAKrQ,KAAL,CAAWgR;SAJzB;;;;iDAOO;;YAEH,KAAKhR,KAAL,CAAWkV,IAAX,IAAmB,OAAO,KAAKlV,KAAL,CAAWkV,IAAlB,IAA0B,WAAjD,EAA8D;iBACrD3S,6BAAC,WAAD,IAAa,OAAM,gBAAnB,GAAP;;YAEE,CAAC,KAAKvC,KAAL,CAAWwQ,WAAhB,EAA6B;iBAEzBjO,6BAAC,QAAD,IAAU,MAAK,2EAAf,GADF;;eAKAA,6BAAC,UAAD;uBACe,KAAKvC,KAAL,CAAWqQ,WAAX,IAA0B,CADzC;0BAEkB,KAAKrQ,KAAL,CAAW0I,EAF7B;sBAGc,KAAK1I,KAAL,CAAWwJ,UAHzB;kBAIU,KAAKwJ;UALjB;;;;;;IAhDwBtR,eA5BwB;;;;;;;;SA6F7CwR,mBACLf,eADK,EAELU,kBAFK,EAGL1M,aAAW2O,aAAX,CAHK,CAAP;CA7FF;;;;ACXA,AAGA,sBAAe,UAACM,MAAD,EAAShC,MAAT,EAAiBlB,SAAjB,EAA+B;aACjCrP,cAAX,CAA0BuS,MAA1B,EAAkC,QAAlC;aACWvS,cAAX,CAA0BuQ,MAA1B,EAAkC,QAAlC;aACWvQ,cAAX,CAA0BqP,SAA1B,EAAqC,WAArC;;MACMmD,aAJsC;;;;;YAH3C;iBAAQ,KAAKvT,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;2BAQrCxB,KAAZ,EAAmB;;0HACXA,KADW;;;;;iDAGV;;;eAILuC;gBAAA;;;kBACE;cAAQ,aAAa,KAAKvC,KAAL,CAAWwQ,WAAhC;iBACQxQ,KAAL,CAAW6F;WAFhB;uCAIG,SAAD;sBACY,KAAK7F,KAAL,CAAW+D,IAAX,CAAgByO,QAD5B;kBAEQ,KAAKxS,KAAL,CAAWwB,IAFnB;mBAGS,KAAKxB,KAAL,CAAW8D,KAHpB;0BAIgB,KAAK9D,KAAL,CAAWiD,YAJ3B;uBAKa,KAAKjD,KAAL,CAAWoD,SALxB;wBAMc,KAAKpD,KAAL,CAAWwJ,UANzB;4BAOkB,KAAKxJ,KAAL,CAAWuS,cAP7B;yBAQe,KAAKvS,KAAL,CAAWqQ;;SAb9B;;;;;IAPwB3O,eAJgB;;SAgCrCyE,aAAWkP,aAAX,CAAP;CAhCF;;ACHO,SAASC,iBAAT,CAA2BvS,KAA3B,EAAkC;KACpC2F,KACH3F,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,IACA6C,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B9E,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,GAAuC,CAArE,EACEuI,MADF,CACSC,EAHV;;KAKI,CAACA,EAAL,EAAS,OAAO,gBAAP;QAEP3F,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,KACA3F,MAAMwG,MAAN,CAAagH,IAAb,CAAqB7H,EAArB,WADA,IAEA,YAFD,IAGC3F,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,KACA3F,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB8H,WADtB,IAEAzN,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB8H,WAAtB,CAAkCC,KAAlC,CACC1N,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB2H,WAAtB,IAAqC,CADtC,EAEEG,WAPH,IAQCzN,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,KACA3F,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB8H,WADtB,IAEAzN,MAAMwG,MAAN,CAAagH,IAAb,CAAkB7H,EAAlB,EAAsB8H,WAAtB,CAAkCmC,KAVnC,IAWA,gBAZD;;;AAgBD,AAAO,SAAS4C,mBAAT,CAA6BvV,KAA7B,EAAoCwV,CAApC,EAAuC;QAE3CxV,MAAM+D,IAAN,IACD/D,MAAM+D,IAAN,CAAW0O,IADV,IAED,QAAO+C,CAAP,yCAAOA,CAAP,OAAa,QAFZ,IAGDxV,MAAM+D,IAAN,CAAW0O,IAAX,IAAmB,UAHlB,IAGgC,EAAEgD,WAAWD,CAAb,EAHjC,IAIAA,CALD;;AAQD,AAAO,SAASE,cAAT,CAAwB1V,KAAxB,EAA+B;QAC9BA,MAAM+D,IAAN,IAAc/D,MAAM+D,IAAN,CAAW0O,IAAX,KAAoB,UAAzC;;AAED,AAAO,SAASkD,uBAAT,CAAiC5S,KAAjC,EAAwC;QAE5CA,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,IACA6C,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CACC9E,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,GAAuC,CADxC,EAEEuI,MAFF,CAES4H,WAHV,IAIA,CALD;;AAQD,AAAO,SAASuF,cAAT,CAAwB7S,KAAxB,EAA+B;QAEnCA,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,IACA6C,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CACC9E,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,GAAuC,CADxC,EAEEuI,MAFF,CAES4H,WAHV,IAIA,CALD;;;AASD,AAAO,SAASwF,iBAAT,CAA2B9S,KAA3B,EAAkC;MACnC,IAAI+S,IAAI/S,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8B3H,MAA9B,GAAuC,CAApD,EAAuD4V,KAAK,CAA5D,EAA+DA,GAA/D,EAAoE;MAC/D/S,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8BiO,CAA9B,EAAiChP,GAAjC,IAAwC,QAA5C,EAAsD;UAC9C/D,MAAMwG,MAAN,CAAaC,UAAb,CAAwB3B,KAAxB,CAA8BiO,CAA9B,EAAiCrN,MAAjC,CAAwCC,EAA/C;;;QAGK,IAAP;;AAED,AAAO,SAAS1B,MAAT,CAAgBjE,KAAhB,EAAuB+D,GAAvB,EAA4BuL,QAA5B,EAAsC;QAClCA,SAAShC,WAAnB,SAAkCgC,SAASE,cAA3C,SAA6DzL,GAA7D;;AAED,IAAMjC,MAAM,6CAAZ;AACA,AAAO,SAASkR,UAAT,CAAoBjP,GAApB,EAAyB;KAC3B1G,SAASyE,IAAImR,IAAJ,CAASlP,GAAT,CAAb;KACI,CAAC1G,MAAL,EAAa,OAAO,KAAP;;QAEN,EAAE6V,MAAM7V,OAAO,CAAP,CAAR,EAAmB8V,SAAS9V,OAAO,CAAP,CAA5B,EAAP;;;AAGD,AAAO,SAAS+V,aAAT,CAAuBC,UAAvB,EAAmC/I,IAAnC,EAAqE;KAA5BjN,MAA4B,uEAAnB,EAAmB;KAAfiW,MAAe,uEAAN,IAAM;;KACvEhJ,IAAJ,EACCtF,OAAOsC,IAAP,CAAYgD,IAAZ,EAAkBnF,OAAlB,CAA0B,eAAO;OAE3B,IAAIsN,IAAI,CAAb,EAAgBA,IAAIY,WAAWlW,MAA/B,EAAuCsV,GAAvC,EAA4C;OACvCY,WAAWZ,CAAX,EAAc1O,GAAd,EAAmBuG,IAAnB,EAAyBjN,MAAzB,EAAiCiW,MAAjC,CAAJ,EAA8C,OAAOjW,MAAP;;MAE3CuT,MAAMhS,SAAN,CAAgBC,aAAhB,CAA8ByL,KAAKvG,GAAL,CAA9B,CAAJ,EACC,OAAOuG,KAAKvG,GAAL,EAAUoB,OAAV,CAAkB,UAAS3H,OAAT,EAAkB;iBAC5B6V,UAAd,EAA0B7V,OAA1B,EAAmCH,MAAnC,EAA2CiN,IAA3C;GADM,CAAP;MAGGA,KAAKvG,GAAL,KAAawP,QAAOjJ,KAAKvG,GAAL,CAAP,KAAoB,QAArC,EACC,OAAOqP,cAAcC,UAAd,EAA0B/I,KAAKvG,GAAL,CAA1B,EAAqC1G,MAArC,EAA6CiN,IAA7C,CAAP;EAVF;QAYMjN,MAAP;;;AAGD,AAAO,SAASmW,iBAAT,CAA2BzS,KAA3B,EAAkC;QACjCA,SAAS,QAAOA,KAAP,yCAAOA,KAAP,MAAgB,QAAzB,GAAoCA,MAAM2R,SAA1C,GAAsD3R,KAA7D;;;;;;;;;;AAUD,AAAO,IAAM0S,iCAAiCL,cAAcvW,IAAd,CAAmB,IAAnB,EAAyB,CACtE,UAACkH,GAAD,EAAMuG,IAAN,EAAYjN,MAAZ,EAAoBiW,MAApB,EAA+B;KAC1BvP,QAAQ,YAAZ,EAA0B;MACrBuG,KAAKoJ,QAAT,EACC,OAAQrW,OAAOiN,KAAKqJ,UAAZ,IAA0BrJ,KAAKoJ,QAAhC,EAA2CrW,MAAlD;MACGiW,UAAUA,OAAOM,YAArB,EACC,OAAQvW,OAAOiN,KAAKqJ,UAAZ,IAA0BL,OAAOM,YAAlC,EAAiDvW,MAAxD;;CANmE,EAStE,UAAC0G,GAAD,EAAMuG,IAAN,EAAYjN,MAAZ,EAAoBiW,MAApB,EAA+B;KAC1BvP,OAAO,aAAP,IAAwB,CAACuG,KAAKxJ,aAAlC,EAAiD;OAC3CA,aAAL,GAAqB+S,MAArB;;CAXoE,CAAzB,CAAvC;;AAgBP,AAAO,IAAMC,0BAA0BV,cAAcvW,IAAd,CAAmB,IAAnB,EAAyB,CAC/D,UAACkH,GAAD,EAAMuG,IAAN,EAAe;KAEb,4BAA4BvI,IAA5B,CAAiCgC,GAAjC,KACA,OAAOuG,KAAKvG,GAAL,CAAP,IAAoB,SAFrB,EAGE;OACIA,GAAL,IAAY,KAAZ;;CAN6D,CAAzB,CAAhC;AAUP,IAAMgQ,gBAAgB,SAAhBA,aAAgB,CAASC,EAAT,EAAa;QAC3B,UAASjQ,GAAT,EAAc;MAChB,OAAOA,GAAP,KAAe,WAAnB,EACC,MAAM,IAAIrF,KAAJ,CAAU,yBAAV,CAAN;MACG,QAAOqF,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B,MAAM,IAAIrF,KAAJ,CAAU,yBAAV,CAAN;MACzB,OAAOqF,GAAP,KAAe,QAAnB,EAA6B,MAAM,IAAIrF,KAAJ,CAAU,sBAAV,CAAN;SACtBsV,GAAGnD,IAAH,CAAQ,IAAR,EAAc9M,GAAd,CAAP;EALD;CADD;AASA,AAAO,IAAMkQ,aAAaF,cAAc;QAAUhQ,GAAV;CAAd,CAAnB;AACP,AAAO,IAAMmQ,cAAcH,cAAc;QAAUhQ,GAAV;CAAd,CAApB;AACP,AAAO,IAAMqD,SAAO,SAAPA,IAAO;QAASvD,KAAKiC,KAAL,CAAWjC,KAAKC,SAAL,CAAe/C,KAAf,CAAX,CAAT;CAAb;;AAEP,WAAe;iDAAA;qCAAA;+BAAA;qCAAA;uBAAA;;CAAf;;;;AC5IA,AAYA,qBAAe,UAACoT,iBAAD,EAAoB9B,MAApB,EAA4BlD,SAA5B,EAA0C;MAErDqB,WAAW1Q,cAAX,CAA0BqU,iBAA1B,EAA6C,mBAA7C,KACA3D,WAAW1Q,cAAX,CAA0BuS,MAA1B,EAAkC,QAAlC,CADA,IAEA,CAAClD,SAHH,EAKE,MAAM,IAAIzQ,KAAJ,CAAU,0CAAV,CAAN;;;MAGI0Q,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;UAC5DA,SAAStO,IAAT,CAAc0B,IAAd,IAAsB,WAA1B,EAAuC;YACjC5B,gBAAgBmD,OAAOjE,KAAP,EAAcsP,SAASxO,aAAvB,EAAsCwO,QAAtC,CAApB;YACI8E,KAAKpU,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,aAAlB,CAAT;eACO;iBACEsT,EADF;gBAEC,CAAC,CAACpU,MAAMwG,MAAN,CAAagH,IAAb,CAAkByG,WAAWnT,aAAX,CAAlB,CAFH;iBAGE,CAAC,CAACd,MAAMwG,MAAN,CAAagH,IAAb,CAAkB0G,YAAYpT,aAAZ,CAAlB,CAHJ;;SAAP;;;KAJoB;GAAxB;;MAcMgP,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;aACE,eAACnK,EAAD,EAAKD,MAAL,EAAa3B,GAAb,EAAqB;iBACjB6G,mBAAmBjF,EAAnB,EAAuBD,MAAvB,EAA+B3B,GAA/B,CAAT;;KAFJ;GADF;;MAQMsQ,YA/BiD;;;;;YAZtD;iBAAQ,KAAKtV,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;0BA4CrCxB,KAAZ,EAAmB;;;6HACXA,KADW;;YAEZ+C,KAAL,GAAa,EAAb;YACKsU,UAAL,GAAkB,MAAKA,UAAL,CAAgBzX,IAAhB,OAAlB;YACKmT,cAAL,GAAsB,MAAKA,cAAL,CAAoBnT,IAApB,OAAtB;YACK0X,eAAL,GAAuB,MAAKA,eAAL,CAAqB1X,IAArB,OAAvB;YACK2V,mBAAL,GAA2B,MAAKA,mBAAL,CAAyB3V,IAAzB,OAA3B;YACKI,KAAL,CAAWoD,SAAX,CAAqBC,QAArB,GAAgC,YAAM;eAC7B,MAAKH,aAAL,EAAP;OADF;YAGKqU,YAAL,GAAoB,MAAKA,YAAL,CAAkB3X,IAAlB,OAApB;YACK8V,cAAL,GAAsB,MAAKA,cAAL,CAAoB9V,IAApB,OAAtB;;;;;;iCAES;eACF,CAAC,CAAC,KAAKI,KAAL,CAAW8D,KAAb,IAAsB,aAA7B;;;;sCAEc;eACP,IAAIQ,SAAJ,CAAqB,IAArB,EAA2B3E,GAA3B,EAAP;;;;qCAEamE,KAnDsC,EAmD/B;YAChB,KAAKH,QAAT,EAAmB;eACZ3D,KAAL,CAAWiD,YAAX,oBACG,KAAKjD,KAAL,CAAWwB,IADd,EACqB,KAAK+T,mBAAL,CAAyBzR,KAAzB,CADrB;;;;;iCAKOuQ,MA1D0C,EA0DlCtQ,IA1DkC,EA0D5BF,aA1D4B,EA0Db;YAClC,KAAKF,QAAT,EAAmB;cACb,CAAC0Q,MAAD,IAAW,CAACxQ,aAAhB,EACE,MAAM,IAAIpC,KAAJ,CAAU,2CAAV,CAAN;eACGzB,KAAL,CAAWgV,KAAX,CAAiBX,MAAjB,EAAyBzN,KAAKiC,KAAL,CAAW9E,QAAQ,IAAnB,CAAzB,EAAmDF,aAAnD;;;;;qCAG6D;YAApD2T,KAAoD,uEAA5C,KAAKxX,KAAL,CAAWwX,KAAiC;YAA1B1T,KAA0B,uEAAlB,KAAK9D,KAAL,CAAW8D,KAAO;;gBACvDyS,kBAAkBzS,KAAlB,CAAR;eACO0T,SAASA,MAAMtX,MAAf,IAAyBsX,MAAMhT,MAAN,CAAa;iBAAKC,EAAEsQ,GAAF,IAASjR,KAAd;SAAb,EAAkC5D,MAAlE;;;;6CAEkBsV,CArEiC,EAqE9B;eAElB,KAAKxV,KAAL,CAAW+D,IAAX,IACC,KAAK/D,KAAL,CAAW+D,IAAX,CAAgB0O,IADjB,IAEC,QAAO+C,CAAP,yCAAOA,CAAP,OAAa,QAFd,IAGC,KAAKxV,KAAL,CAAW+D,IAAX,CAAgB0O,IAAhB,IAAwB,UAHzB,IAGuC,EAAEgD,WAAWD,CAAb,EAHxC,IAIAA,CALF;;;;gDAQwB5R,IA9E2B,EA8ErB;YAE5B,CAACA,KAAKnD,KAAN,KACCmD,KAAKG,IAAL,CAAUC,MAAV,CAAiBF,KAAjB,KAA2B,KAAK9D,KAAL,CAAW+D,IAAX,CAAgBC,MAAhB,CAAuBF,KAAlD,IACEF,KAAKG,IAAL,CAAUC,MAAV,CAAiByT,UAAjB,KAAgC,KAAKzX,KAAL,CAAW+D,IAAX,CAAgBC,MAAhB,CAAuByT,UAAvD,IACC,CAAC7T,KAAKsR,IAFT,IAGCtR,KAAKC,aAAL,KAAuB,KAAK7D,KAAL,CAAW6D,aAHnC,IAIED,KAAKG,IAAL,CAAUC,MAAV,CAAiBF,KAAjB,IACC,OAAOF,KAAK4T,KAAZ,IAAqB,WADtB,IAEC,CAAC5T,KAAKsR,IAPV,CADF,EASE;iBACO,KAAKmC,UAAL,CACLzT,KAAKG,IAAL,CAAUC,MAAV,CAAiBF,KADZ,EAELF,KAAKG,IAAL,CAAUC,MAAV,CAAiByT,UAFZ,EAGL7T,KAAKC,aAHA,CAAP;;;YAOED,KAAK4T,KAAL,IAAc5T,KAAK4T,KAAL,CAAWtX,MAAX,IAAqB,CAAnC,IAAwC,CAAC0D,KAAKE,KAAlD,EAAyD;iBAChD,KAAKwT,eAAL,CAAqB1T,KAAK4T,KAAL,CAAW,CAAX,EAAczC,GAAnC,CAAP;;;YAICnR,KAAK4T,KAAL,IACC5T,KAAKE,KADN,IAEC,CAAC,KAAKyT,YAAL,CAAkB3T,KAAK4T,KAAvB,EAA8B5T,KAAKE,KAAnC,CAFH,IAGC,CAACF,KAAK4T,KAAN,IAAe,CAAC5T,KAAKsR,IAArB,IAA6B,CAACtR,KAAKnD,KAJtC,EAKE;iBACO,KAAKsS,cAAL,CAAoB,IAApB,CAAP;;;;;sCAIY1K,IA9GqC,EA8G/B;;;mBACT,YAAM;iBACV0K,cAAL,CAAoB1K,IAApB;SADF,EAEG,CAFH;;;;6CAIqB;aAChB1E,QAAL,GAAgB,KAAhB;;;;0CAEe;eACR,KAAK3D,KAAL,CAAW+D,IAAX,IAAmB,KAAK/D,KAAL,CAAW+D,IAAX,CAAgB0O,IAAhB,KAAyB,UAAnD;;;;0CAEkB;;;aACb9O,QAAL,GAAgB,IAAhB;YACI,CAAC,KAAK3D,KAAL,CAAWwX,KAAhB,EAAuB;eACxBxX,KAAL,CAAWkC,GAAX,CACU,qDAAqD,KAAKlC,KAAL,CAAWwB,IAD1E;eAGa6V,UAAL,CACE,KAAKrX,KAAL,CAAW+D,IAAX,CAAgBC,MAAhB,CAAuBF,KADzB,EAEE,KAAK9D,KAAL,CAAW+D,IAAX,CAAgBC,MAAhB,CAAuByT,UAFzB,EAGE,KAAKzX,KAAL,CAAW6D,aAHb;;;YAQA,KAAK7D,KAAL,CAAWwX,KAAX,IACA,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,IAA2B,CAD3B,IAEA,CAAC,KAAKF,KAAL,CAAW8D,KAHd,EAIE;iBACO,KAAKwT,eAAL,CAAqB,KAAKtX,KAAL,CAAWwX,KAAX,CAAiB,CAAjB,EAAoBzC,GAAzC,CAAP;;YAGA,KAAKW,cAAL,MACA,KAAK1V,KAAL,CAAW8D,KADX,IAEAwS,QAAO,KAAKtW,KAAL,CAAW8D,KAAlB,MAA4B,QAH9B,EAIE;;iBAEOsD,WAAW,YAAM;mBACjB2L,cAAL,CAAoB,OAAK/S,KAAL,CAAW8D,KAA/B;WADK,EAEJ,CAFI,CAAP;;;;;oCAKU0R,CAxJuC,EAwJpC;eACR,CAACA,CAAD,IAAM,CAACA,EAAEtV,MAAhB;;;;iDAEO;;;aAGRF,KAAL,CAAWkC,GAAX,gBAA4B,KAAKlC,KAAL,CAAWwB,IAAvC;YACU,KAAKkW,aAAL,CAAmB,KAAK1X,KAAL,CAAWwX,KAA9B,CAAJ,EAA0C;eAC3CxX,KAAL,CAAWkC,GAAX,CAAkB,KAAKlC,KAAL,CAAWwB,IAA7B;iBACee,6BAAC,iBAAD,OAAP;;eAGAA,6BAAC,MAAD;iBACS,KAAKvC,KAAL,CAAW6F,KADpB;iBAGItD,6BAAC,SAAD;sBAEI,CAAC,CAAC,KAAKvC,KAAL,CAAW+D,IAAX,CAAgB+B,QAAlB,IACC,KAAK9F,KAAL,CAAWwX,KAAX,IAAoB,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,IAA2B,CAHpD;oBAKU,KAAK6C,KAAL,CAAW3B,MALrB;mBAMS,KAAKpB,KAAL,CAAW6F,KANpB;mBAOS,KAAK7F,KAAL,CAAWwX,KAPpB;6BAQkB,cARlB;yBASc,KATd;mBAUSjB,kBAAkB,KAAKvW,KAAL,CAAW8D,KAA7B,CAVT;0BAWgB,KAAKiP;;UAf3B;;;;;IApIuBrR,eA/B4B;;SA2LhDwR,mBACLf,eADK,EAELU,kBAFK,EAGL1M,aAAWiR,YAAX,CAHK,CAAP;CA3LF;;;;ACZA,AAUA,wBAAe,UAAChC,MAAD,EAASuC,MAAT,EAAiBjD,WAAjB,EAA8BxC,SAA9B,EAA4C;;aAE9CrP,cAAX,CAA0BuS,MAA1B,EAAkC,QAAlC;aACWvS,cAAX,CAA0B8U,MAA1B,EAAkC,QAAlC;aACW9U,cAAX,CAA0BqP,SAA1B,EAAqC,WAArC;MACM0F,SAAS,mBAAf;MACMC,UAAU,EAAhB;MACMhF,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;gBACK,kBAACnK,EAAD,EAAK3E,IAAL,EAAW+C,GAAX,EAAgByN,KAAhB;eACR/I,SAASmC,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkCyN,KAAlC,CAAT,CADQ;;KADZ;GADF;MAMMpC,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;UAC5DxO,gBAAgBmD,OAAOjE,KAAP,EAAcsP,SAASxO,aAAvB,EAAsCwO,QAAtC,CAApB;UACEmF,QAAQzU,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,aAAlB,KAAoCwO,SAAStO,IAAT,CAAcyT,KAD5D;aAEO;cACC,CAAC,CAACzU,MAAMwG,MAAN,CAAagH,IAAb,CAAkByG,WAAWnT,aAAX,CAAlB,CADH;eAEE,CAAC,CAACd,MAAMwG,MAAN,CAAagH,IAAb,CAAkB0G,YAAYpT,aAAZ,CAAlB,CAFJ;oBAAA;sBAISiU,mBAAmBzF,SAASvO,KAA5B,EAAmC0T,KAAnC,CAJT;;OAAP;KAHsB;GAAxB;MAWMM,qBAAqB,SAArBA,kBAAqB,CAAStC,CAAT,EAAYgC,KAAZ,EAAmB;QACxChC,KAAKgC,KAAL,IAAcA,MAAMtX,MAAxB,EAAgC;UAC1B6X,IAAIxB,kBAAkBf,CAAlB,CAAR;UACIwC,IAAIR,MAAMhT,MAAN,CAAa;eAAKC,EAAEiE,EAAF,IAAQqP,CAAb;OAAb,CAAR;aACQC,EAAE9X,MAAF,IAAY8X,EAAE,CAAF,EAAKxF,QAAlB,IAA+BqF,OAAtC;;;WAGKA,OAAP;GAPF;;MASMI,eAjCmD;;;;;YAVxD;iBAAQ,KAAKnW,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;6BA4CrCxB,KAAZ,EAAmB;;;mIACXA,KADW,EACJkC,GADI;;YAEZgW,UAAL,GAAkB,MAAKA,UAAL,CAAgBtY,IAAhB,OAAlB;YACKuY,oBAAL,GAA4B,MAAKA,oBAAL,CAA0BvY,IAA1B,OAA5B;YACKwY,uBAAL,GAA+B,MAAKA,uBAAL,CAA6BxY,IAA7B,OAA/B;YACKyY,cAAL,GAAsB,MAAKA,cAAL,CAAoBzY,IAApB,OAAtB;YACK0Y,iBAAL,GAAyB,MAAKA,iBAAL,CAAuB1Y,IAAvB,OAAzB;UACI2Y,kBAAkB,CAACvY,MAAMwY,YAAN,IAAsB,EAAvB,EAA2BnY,MAA3B,CAAkC,UAACoY,GAAD,EAAMhU,CAAN,EAAY;YAC9D,MAAKzE,KAAL,CAAWuU,KAAX,CAAiBxN,cAAjB,CAAgCtC,EAAEjD,IAAlC,CAAJ,EACEiX,IAAIhU,EAAEjD,IAAN,IAAc,MAAKxB,KAAL,CAAWuU,KAAX,CAAiB9P,EAAEjD,IAAnB,CAAd;eACKiX,GAAP;OAHoB,EAInB,EAJmB,CAAtB;YAKK1V,KAAL,GAAa;wCAAA;4BAES;OAFtB;YAIKuU,eAAL,GAAuB,MAAKA,eAAL,CAAqB1X,IAArB,OAAvB;YACK8Y,2BAAL,GAAmC,MAAKA,2BAAL,CAAiC9Y,IAAjC,OAAnC;YAGK+Y,SAAL,GAAiB,MAAKA,SAAL,CAAe/Y,IAAf,OAAjB;YACKI,KAAL,CAAWoD,SAAX,CAAqBC,QAArB,GAAgC,YAAM;eAC7B,MAAKH,aAAL,EAAP;OADF;YAGKqS,mBAAL,GAA2B,MAAKA,mBAAL,CAAyB3V,IAAzB,OAA3B;YACK8V,cAAL,GAAsB,MAAKA,cAAL,CAAoB9V,IAApB,OAAtB;;;;;;iCAES;eACF,CAAC,CAAC,KAAKI,KAAL,CAAW8D,KAAb,IAAsB,aAA7B;;;;sCAEc;eACPjE,QAAQ6T,GAAR,CAAY,CACjB,IAAIpP,SAAJ,CAAqB,IAArB,EAA2B3E,GAA3B,EADiB,EAEjB,KAAKoD,KAAL,CAAW6V,kBAAX,CAA8BvV,QAA9B,EAFiB,CAAZ,CAAP;;;;gDAMwBO,IAvE6B,EAuEvB;YAE5B,CAACA,KAAKnD,KAAN,KACCmD,KAAKG,IAAL,CAAU8U,SAAV,KAAwB,KAAK7Y,KAAL,CAAW+D,IAAX,CAAgB8U,SAAxC,IACEjV,KAAKC,aAAL,KAAuB,KAAK7D,KAAL,CAAW6D,aAAlC,IACCD,KAAKG,IAAL,CAAU8U,SAFb,IAGC,OAAOjV,KAAK4T,KAAZ,IAAqB,WAJvB,KAKA,CAAC5T,KAAKsR,IANR,EAQE,KAAKmC,UAAL,CACEzT,KAAKG,IAAL,CAAU8U,SADZ,EAEEjV,KAAKG,IAAL,CAAU+U,aAFZ,EAGElV,KAAKC,aAHP;;YAMED,KAAK4T,KAAL,IAAc5T,KAAK4T,KAAL,CAAWtX,MAAX,IAAqB,CAAnC,IAAwC,CAAC0D,KAAKE,KAAlD,EAAyD;iBAChD,KAAKwT,eAAL,CAAqB1T,KAAK4T,KAA1B,CAAP;;;;;mCAIS;aACNxX,KAAL,CAAWkC,GAAX;aACKmV,UAAL,CACE,KAAKrX,KAAL,CAAW+D,IAAX,CAAgB8U,SADlB,EAEE,KAAK7Y,KAAL,CAAW+D,IAAX,CAAgB+U,aAFlB,EAGE,KAAK9Y,KAAL,CAAW6D,aAHb,EAIE,EAAE0L,OAAO,IAAT,EAJF;;;;iCAQS8E,MArG4C,EAqGpCtQ,IArGoC,EAqG9BF,aArG8B,EAqGf;YAClCkV,QAAQ,KAAKC,wBAAL,CAA8BpF,IAA9B,CACV,IADU,EAEV,KAAK7Q,KAAL,CAAWwV,eAFD,CAAZ;cAIMU,KAAN;aACKjZ,KAAL,CAAWkC,GAAX;aACKlC,KAAL,CAAWkZ,QAAX,CACE7E,MADF,EAEEtM,OAAOpC,MAAP,CACEiB,KAAKiC,KAAL,CAAW9E,QAAQ,KAAK/D,KAAL,CAAW+D,IAAX,CAAgB+U,aAAxB,IAAyC,IAApD,CADF,EAEE;;SAFF,CAFF,EAQEjV,iBAAiB,KAAK7D,KAAL,CAAW6D,aAR9B;;;;6CAYqB;aAChBF,QAAL,GAAgB,KAAhB;;;;0CAEkB;;;aACbA,QAAL,GAAgB,IAAhB;YACI,KAAK3D,KAAL,CAAW+D,IAAX,CAAgB8U,SAAhB,IAA6B,OAAO,KAAK7Y,KAAL,CAAWwX,KAAlB,IAA2B,WAA5D,EAAyE;eAClEH,UAAL,CAAgB,KAAKrX,KAAL,CAAW+D,IAAX,CAAgB8U,SAAhC;;;YAIA,KAAK7Y,KAAL,CAAWwX,KAAX,IACA,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,IAA2B,CAD3B,IAEA,CAAC,KAAKF,KAAL,CAAW8D,KAHd,EAIE;iBACOsD,WAAW,YAAM;mBACjBkQ,eAAL;WADK,EAEJ,CAFI,CAAP;;;YAMA,KAAK5B,cAAL,MACA,KAAK1V,KAAL,CAAW8D,KADX,IAEAwS,QAAO,KAAKtW,KAAL,CAAW8D,KAAlB,MAA4B,QAH9B,EAIE;;iBAEOsD,WAAW,YAAM;mBACjB+Q,oBAAL,CAA0B,OAAKnY,KAAL,CAAW8D,KAArC;WADK,EAEJ,CAFI,CAAP;;;;;0CAMa;eACR,KAAK9D,KAAL,CAAW+D,IAAX,IAAmB,KAAK/D,KAAL,CAAW+D,IAAX,CAAgB0O,IAAhB,KAAyB,UAAnD;;;;kCAEU;eACH,KAAKzS,KAAL,CAAWwX,KAAX,IAAoB,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,IAA2B,CAAtD;;;;iDAEyB;eAEtB,KAAKF,KAAL,CAAW+D,IAAX,CAAgBoV,IAAhB,uBACE,KAAKnZ,KAAL,CAAW+D,IAAX,CAAgBoV,IADlB,EACyB,KAAKnZ,KAAL,CAAWuU,KAAX,CAAiB,KAAKvU,KAAL,CAAW+D,IAAX,CAAgBoV,IAAjC,CADzB,CAAD,IAGA,KAAKpW,KAAL,CAAWwV,eAJb;;;;wCAOwC;YAA1Bf,KAA0B,uEAAlB,KAAKxX,KAAL,CAAWwX,KAAO;;aACnCW,oBAAL,CAA0BX,MAAM,CAAN,EAAS9O,EAAnC;;;;uCAEuC;YAA1B5E,KAA0B,uEAAlB,KAAK9D,KAAL,CAAW8D,KAAO;;kCAEpC,KAAK9D,KAAL,CAAWwB,IADd,EACqB,KAAK+T,mBAAL,CAAyBzR,KAAzB,CADrB;;;;8CAKsBA,KA9K+B,EA8KxBsV,WA9KwB,EA8KX;;;;;;;;YAQtCC,MAAM,KAAKL,wBAAL,CAA8BpF,IAA9B,CAAmC,IAAnC,EAAyC9P,KAAzC,EAAgDsV,WAAhD,CAAV;;;aAGKpZ,KAAL,CAAWiD,YAAX,CAAwBqW,KAAxB,CAA8B,IAA9B,EAAoCD,GAApC;;;;qDAE6B5U,CA3LwB,EA2LrByP,CA3LqB,EA2LlBqF,CA3LkB,EA2LfC,CA3Le,EA2LZ1S,GA3LY,EA2LP;YAC1CyS,KAAKC,CAAT,EAAY,OAAO,IAAP;YACR1S,OAAO,OAAX,EAAoB;cACdoN,EAAEsE,YAAF,IAAkBtE,EAAEsE,YAAF,CAAetY,MAArC,EACE,OAAO+I,EAAEC,OAAF,CAAUqQ,EAAErF,EAAEnQ,IAAF,CAAOoV,IAAT,CAAV,EAA0BK,EAAEtF,EAAEnQ,IAAF,CAAOoV,IAAT,CAA1B,CAAP;;iBAEK,IAAP;;;;;;;4CAIkBM,SArMiC,EAqMtBC,SArMsB,EAqMX;YAExC,CAACD,UAAU1V,IAAV,CAAeoV,IAAf,IACE,CAACM,UAAU1V,IAAV,CAAeoV,IAAhB,IAAwB,CAACM,UAAUjB,YAAV,CAAuBtY,MADnD,KAEA+I,EAAEC,OAAF,CAAU,KAAKnG,KAAL,CAAW3B,MAArB,EAA6BsY,UAAUtY,MAAvC,CAFA,IAGA6H,EAAE0Q,WAAF,CACE,KAAK3Z,KADP,EAEEyZ,SAFF,EAGE,KAAKG,8BAAL,CAAoCha,IAApC,CAAyC,IAAzC,EAA+C,KAAKI,KAApD,EAA2DyZ,SAA3D,CAHF,CAJF,EASE;iBACO,KAAP;;;eAGK,IAAP;;;;+CAEuB3V,KArN8B,EAqNvBsV,WArNuB,EAqNV;;;sBAC7BA,eAAe,KAAKf,cAAL,EAA7B;YACI,KAAKrY,KAAL,CAAW+D,IAAX,CAAgBoV,IAApB,EAA0B;cACpBxI,KAAK,CAACyI,WAAD,CAAT;;cAEI,CAACtV,KAAL,EAAY6M,GAAGtP,IAAH,oBAAW,KAAKrB,KAAL,CAAW+D,IAAX,CAAgBoV,IAA3B,EAAkCjS,SAAlC,GAAZ,KACKyJ,GAAGtP,IAAH,CAAQyC,KAAR;iBACE6M,EAAP;;;YAGEkJ,cACF,KAAK9W,KAAL,CAAWwV,eAAX,IACAxQ,OAAOsC,IAAP,CAAY,KAAKtH,KAAL,CAAWwV,eAAvB,EAAwClY,MAAxC,CAA+C,UAACoY,GAAD,EAAMhU,CAAN,EAAY;iBACjDgU,IAAIhU,CAAJ,IAASyC,SAAV,EAAsBuR,GAA7B;SADF,EAEG,EAFH,CAFF;;;YAOIrY,UACFgZ,WADE,2BAECrR,OAAOsC,IAAP,CAAavG,SAASA,MAAM8T,MAAN,CAAV,IAA4B,EAAxC,EAA4CtN,GAA5C,CAAgD,aAAK;oCAC5C7F,CAAV,EAAcX,MAAM8T,MAAN,EAAcnT,CAAd,CAAd;SADC,CAFD,EAAJ;;YAOIoV,eAAe9R,OAAOsC,IAAP,CAAYwP,WAAZ,EAAyB3Z,MAAzB,GAAkC,CAArD,EAAwD;;iBAE/C8I,MAAP,CAAc,CAAd,EAAiB,CAAjB,EAAoB6Q,WAApB;;mBAES,YAAM;cACX,OAAKlW,QAAT,EAAmB;mBACZrC,QAAL,CAAc;+BACMwC,SAASA,MAAM8T,MAAN,CAAV,IAA4B;aAD/C;;SAFJ;aAOK5X,KAAL,CAAWkC,GAAX,+BAA2C0E,KAAKC,SAAL,CAAezG,MAAf,CAA3C;eACOA,MAAP;;;;6CAGkBoV,CA5PmC,EA4PhC;eAElB,KAAKxV,KAAL,CAAW+D,IAAX,IACC,KAAK/D,KAAL,CAAW+D,IAAX,CAAgB0O,IADjB,IAEC,QAAO+C,CAAP,yCAAOA,CAAP,OAAa,QAFd,IAGC,KAAKxV,KAAL,CAAW+D,IAAX,CAAgB0O,IAAhB,IAAwB,UAHzB,IAGuC,EAAEgD,WAAWD,CAAb,EAHxC,IAIAA,CALF;;;;kDAQ0BA,CArQ2B,EAqQxB;aACxB4C,uBAAL,CAA6B,IAA7B,EAAmC,KAAKC,cAAL,CAAoB7C,CAApB,CAAnC;;;;2CAEmBA,CAxQkC,EAwQ/B;aACjB4C,uBAAL,CACE,KAAK0B,wBAAL,EADF,EAEE,KAAKzB,cAAL,CAAoB7C,CAApB,CAFF;;;;0CAKkB;eACX,KAAKxV,KAAL,CAAW+D,IAAX,CAAgBoV,IAAhB,GACH,KAAKnZ,KAAL,CAAWuU,KAAX,GACE,KAAKvU,KAAL,CAAWuU,KAAX,CAAiB,KAAKvU,KAAL,CAAW+D,IAAX,CAAgBoV,IAAjC,CADF,GAEE,EAHC,GAIH,KAAKnZ,KAAL,CAAWuU,KAJf;;;;oCAMYiB,CArRyC,EAqRtC;eACR,CAACA,CAAD,IAAM,CAACA,EAAEtV,MAAhB;;;;iDAEO;aACFF,KAAL,CAAWkC,GAAX;;YAEI,KAAKlC,KAAL,CAAWkV,IAAf,EAAqB;eACdlV,KAAL,CAAWkC,GAAX,CAAkB,KAAKlC,KAAL,CAAWwB,IAA7B;iBACOe,6BAAC,WAAD,IAAa,SAAS,KAAKvC,KAAL,CAAWkY,UAAjC,GAAP;;;eAIA3V,6BAAC,MAAD;iBACS,KAAKvC,KAAL,CAAW6F,KADpB;iBAGItD,6BAAC,MAAD;mBACS,KAAKvC,KAAL,CAAW6F,KADpB;sBAEY,CAAC,CAAC,KAAK7F,KAAL,CAAW+D,IAAX,CAAgB+B,QAAlB,IAA8B,KAAK6S,SAAL,EAF1C;mBAGS,KAAK3Y,KAAL,CAAWwX,KAHpB;oBAIU,KAAKzU,KAAL,CAAW3B,MAJrB;6BAKkB,cALlB;yBAMc,IANd;mBAOSmV,kBAAkB,KAAKvW,KAAL,CAAW8D,KAA7B,CAPT;0BAQgB,KAAK4U,2BARrB;4BASkB,KAAK1Y,KAAL,CAAWuS,cAT7B;yBAUe,KAAKvS,KAAL,CAAWqQ;YAb9B;yBAiBI9N,6BAAC,SAAD;kBACQ,KAAKvC,KAAL,CAAW+D,IAAX,CAAgBoV,IAAhB,IAAwBvB,MADhC;mBAES,KAAKU,iBAAL,EAFT;0BAGgB,KAAKF,uBAHrB;sBAIY,KAAKpY,KAAL,CAAWwY,YAJvB;uBAKa,KAAKzV,KAAL,CAAW6V,kBALxB;wBAMc,KAAK5Y,KAAL,CAAWwJ,UANzB;4BAOkB,KAAKxJ,KAAL,CAAWuS,cAP7B;yBAQe,KAAKvS,KAAL,CAAWqQ;;UA1BhC;;;;;IA/P0B9N,eAAMb,SAjCqB;;kBAmUzCsS,WAAhB,GAA8B,IAA9B;SACOd,mBACLf,eADK,EAELU,kBAFK,EAGL1M,aAAW8R,eAAX,CAHK,CAAP;CApUF;;;;ACVA,AAaA,mBAAe,UACb7C,MADa,EAEb2E,MAFa,EAGbC,IAHa,EAIbC,KAJa,EAKbC,SALa,EAMbxF,WANa,EAObxC,SAPa,EAQV;aACQrP,cAAX,CAA0BuS,MAA1B,EAAkC,QAAlC;aACWvS,cAAX,CAA0BkX,MAA1B,EAAkC,QAAlC;aACWlX,cAAX,CAA0BmX,IAA1B,EAAgC,MAAhC;aACWnX,cAAX,CAA0BoX,KAA1B,EAAiC,OAAjC;aACWpX,cAAX,CAA0BqX,SAA1B,EAAqC,WAArC;aACWrX,cAAX,CAA0BqP,SAA1B,EAAqC,WAArC;;MAEMiI,OAAO,MAAb;MACEC,MAAM,KADR;MAEMjI,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;UAC5DxO,gBAAgBmD,OAAOjE,KAAP,EAAcsP,SAASxO,aAAvB,EAAsCwO,QAAtC,CAApB;;aAEO;sBAEHtP,MAAMsX,GAAN,IACAtX,MAAMsX,GAAN,CAAUC,kBADV,IAEAvX,MAAMsX,GAAN,CAAUC,kBAAV,CAA6BzW,aAA7B,CAJG;uBAKUd,MAAMwG,MAAN,CAAagH,IAAb,CAAkBgK,aAL5B;sBAMSxX,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,aAAlB,CANT;oCAAA;cAQCd,MAAMwG,MAAN,CAAagH,IAAb,CAAqB1M,aAArB,WARD;eASEwO,SAASvO;OATlB;KAHsB;GAAxB;MAeM0W,aAAa,SAAbA,UAAa,CAASjQ,GAAT,EAAckQ,IAAd,EAAoB;QAChC,CAAClQ,GAAD,IAAQ,CAACkQ,IAAV,IAAoBlQ,OAAOA,IAAIrK,MAAJ,IAAc,CAArB,IAA0Bua,IAA1B,IAAkCA,KAAKva,MAAL,IAAe,CAAzE,EACE,OAAO,IAAP;;QAEGqK,OAAO,CAACkQ,IAAT,IAAmBA,QAAQ,CAAClQ,GAA5B,IAAoCA,IAAIrK,MAAJ,KAAeua,KAAKva,MAA5D,EACE,OAAO,KAAP;;WAEK+I,EAAE0Q,WAAF,CAAcpP,GAAd,EAAmBkQ,IAAnB,EAAyB,UAACC,QAAD,EAAWC,UAAX,EAA0B;UACpDD,aAAanQ,GAAb,IAAoBoQ,eAAeF,IAAvC,EAA6C;UACzC,OAAOE,UAAP,IAAqB,QAAzB,EAAmC;eAC1B,CAAC,CAAC1R,EAAE2R,OAAF,CAAUF,QAAV,EAAoB,UAASlF,CAAT,EAAY;iBAChCA,KAAKmF,UAAZ;SADO,CAAT;;UAIE3C,IAAI/O,EAAE4R,OAAF,CAAUH,QAAV,EAAoBC,UAApB,CAAR;aACO3C,CAAP;KARK,CAAP;GAPF;MAkBMnF,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;+BACoB,iCAACnK,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eACvB0E,SAASmC,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,CAAT,CADuB;OADpB;wBAGa,6BAAC4B,EAAD,EAAK0C,OAAL,EAAc3C,MAAd;eAChB+C,SAASL,iBAAiBzC,EAAjB,EAAqB0C,OAArB,EAA8B3C,MAA9B,CAAT,CADgB;OAHb;wBAKa;eAAO+C,SAASgC,iBAAiB1G,GAAjB,CAAT,CAAP;;KALpB;GADF;;MAUMgU,UArDH;;;;;YArBF;iBAAQ,KAAKhZ,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;wBA2ErCxB,KAAZ,EAAmB;;;yHACXA,KADW;;YAEZ+C,KAAL,GAAa;mBACA,EADA;sBAEG;OAFhB;YAIKgY,SAAL,GAAiB,MAAKA,SAAL,CAAenb,IAAf,OAAjB;YACKob,UAAL,GAAkB,MAAKA,UAAL,CAAgBpb,IAAhB,OAAlB;YACKqD,YAAL,GAAoB,MAAKA,YAAL,CAAkBrD,IAAlB,OAApB;YACKqO,eAAL,GAAuB,MAAKA,eAAL,CAAqBrO,IAArB,OAAvB;YACKqb,IAAL,GAAY,MAAKA,IAAL,CAAUrb,IAAV,OAAZ;YACKsD,aAAL,GAAqB,MAAKA,aAAL,CAAmBtD,IAAnB,OAArB;YACKsb,UAAL,GAAkB,MAAKA,UAAL,CAAgBtb,IAAhB,OAAlB;YACKub,uBAAL,GAA+B,MAAKA,uBAAL,CAA6Bvb,IAA7B,OAA/B;YACKI,KAAL,CAAWoD,SAAX,CAAqBC,QAArB,GAAgC,YAAM;eAC7B,MAAKH,aAAL,EAAP;OADF;YAGKmE,MAAL,GAAc,MAAKA,MAAL,CAAYzH,IAAZ,OAAd;;;;;;gDAGwBgE,IA1EzB,EA0E+B;YAE5BA,KAAKwX,YAAL,KAAsB,KAAKpb,KAAL,CAAWob,YAAjC,IACAxX,KAAKwX,YADL,IAEAxX,KAAKwX,YAAL,CAAkB3S,MAFlB,IAGA,OAAO7E,KAAKwX,YAAL,CAAkB3S,MAAlB,CAAyBU,KAAhC,KAA0C,WAH1C,IAIA,KAAKnJ,KAAL,CAAWwX,KAJX,IAKA,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MANnB,EAOE;cACIsX,QAAQ,CAAC,KAAKxX,KAAL,CAAWwX,KAAX,IAAoB,EAArB,EAAyBvP,KAAzB,EAAZ;iBAEEuP,MAAMxO,MAAN,CAAapF,KAAKwX,YAAL,CAAkB3S,MAAlB,CAAyBU,KAAtC,EAA6C,CAA7C,GACA,KAAKnJ,KAAL,CAAWiD,YAAX,oBACG,KAAKjD,KAAL,CAAWwB,IADd,EACqBgW,KADrB,EAFF;;YAOE,KAAKxX,KAAL,CAAW6D,aAAX,KAA6BD,KAAKC,aAAtC,EAAqD;cAC/C,KAAKF,QAAT,EAAmB;iBACZsK,eAAL;gBAEE,CAAC,CAACrK,KAAKyX,YAAN,IAAsBzX,KAAKyX,YAAL,CAAkBnb,MAAzC,KACA,CAAC0D,KAAK4T,KADN,IAEA5T,KAAKG,IAFL,IAGAH,KAAKG,IAAL,CAAUwB,OAHV,IAIA3B,KAAKG,IAAL,CAAUwB,OAAV,CAAkBrF,MALpB,EAME;mBACKF,KAAL,CAAWiD,YAAX,oBACG,KAAKjD,KAAL,CAAWwB,IADd,EACqBoC,KAAKG,IAAL,CAAUwB,OAAV,CAAkB0C,KAAlB,EADrB;;iBAIG3G,QAAL,CAAc;oBACN,IADM;4BAEE;aAFhB;;;YAOFsC,KAAKG,IAAL,CAAUuX,6BAAV,IACA1X,KAAK4T,KADL,IAEA5T,KAAK4T,KAAL,CAAWtX,MAFX,IAGA0D,KAAK4T,KAAL,KAAe5T,KAAKyX,YAHpB,IAIAzX,KAAKyX,YAAL,IAAqB,KAAKrb,KAAL,CAAWqb,YAJhC,IAKA,CAACzX,KAAKsR,IANR,EAOE;eACKiG,uBAAL,CAA6BvX,KAAK4T,KAAlC,EAAyC5T,IAAzC;;;YAIAA,KAAKyX,YAAL,IACAzX,KAAKyX,YAAL,KAAsB,KAAKrb,KAAL,CAAWqb,YADjC,IAEA,CAACzX,KAAKsR,IAHR,EAIE;cACI,KAAKvR,QAAT,EAAmB;iBACZ3D,KAAL,CAAWiD,YAAX,oBACG,KAAKjD,KAAL,CAAWwB,IADd,EACqBoC,KAAKyX,YAD1B;;;;;;;6CAOiB;aAChB1X,QAAL,GAAgB,KAAhB;;aAEK3D,KAAL,CAAWwN,gBAAX,CAA4B,KAAKxN,KAAL,CAAW6D,aAAvC;;;;0CAGkB;;;aACbF,QAAL,GAAgB,IAAhB;;YAEI,KAAK4X,aAAL,EAAJ,EAA0B;eACnBvb,KAAL,CAAWua,aAAX,CACE,KAAKgB,aAAL,EADF,IAEI5H,MAAMhS,SAAN,CAAgBC,aAAhB,CAA8B,KAAK5B,KAAL,CAAW+D,IAAX,CAAgB4S,YAA9C,IACA,KAAK3W,KAAL,CAAW+D,IAAX,CAAgB4S,YADhB,GAEA,KAAK3W,KAAL,CAAW+D,IAAX,CAAgB4S,YAAhB,CAA6BF,QAJjC;;;YAOE+E,QAAQhB,WAAW,KAAKxa,KAAL,CAAWqb,YAAtB,EAAoC,KAAKrb,KAAL,CAAWwX,KAA/C,CAAZ;;YAGE,KAAKxX,KAAL,CAAW+D,IAAX,CAAgBuX,6BAAhB,IACA,KAAKtb,KAAL,CAAWwX,KADX,IAEA,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAFjB,IAGA,CAACsb,KAJH,EAKE;eACKL,uBAAL,CAA6B,KAAKnb,KAAL,CAAWwX,KAAxC;;;YAGE,KAAKxX,KAAL,CAAWqb,YAAX,IAA2B,KAAKrb,KAAL,CAAWqb,YAAX,CAAwBnb,MAAnD,IAA6Dsb,KAAjE,EAAwE;qBAC3D,YAAM;mBACVxb,KAAL,CAAWiD,YAAX,oBACG,OAAKjD,KAAL,CAAWwB,IADd,EACqB,OAAKxB,KAAL,CAAWqb,YADhC;WADF,EAIG,CAJH;;;YAQA,CAAC,CAAC,KAAKrb,KAAL,CAAWqb,YAAZ,IAA4B,CAAC,KAAKrb,KAAL,CAAWqb,YAAX,CAAwBnb,MAAtD,KACA,CAAC,KAAKF,KAAL,CAAWwX,KADZ,IAEA,KAAKxX,KAAL,CAAW+D,IAFX,IAGA,KAAK/D,KAAL,CAAW+D,IAAX,CAAgBwB,OAHhB,IAIA,KAAKvF,KAAL,CAAW+D,IAAX,CAAgBwB,OAAhB,CAAwBrF,MAL1B,EAME;qBACW,YAAM;mBACVF,KAAL,CAAWiD,YAAX,oBACG,OAAKjD,KAAL,CAAWwB,IADd,EACqB,OAAKxB,KAAL,CAAW+D,IAAX,CAAgBwB,OAAhB,CAAwB0C,KAAxB,EADrB;WADF;;;aAOGgG,eAAL;;;;8CAGsB6H,CA5LvB,EA4L8C;YAApB9V,KAAoB,uEAAZ,KAAKA,KAAO;;aACxCA,KAAL,CAAWmb,uBAAX,CACEnb,MAAM+D,IAAN,CAAWuX,6BADb,EAEExF,CAFF,EAGE9V,MAAM6D,aAHR;;;;sCAMc;eAEX,KAAK7D,KAAL,CAAW+D,IAAX,CAAgB4S,YAAhB,IACC,CAAChD,MAAMhS,SAAN,CAAgBC,aAAhB,CAA8B,KAAK5B,KAAL,CAAW+D,IAAX,CAAgB4S,YAA9C,CADF,IAEC,KAAK3W,KAAL,CAAW+D,IAAX,CAAgB4S,YAAhB,CAA6BD,UAF/B,IAGC,KAAK1W,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,IACC,KAAKzb,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,CAAyB/E,UAD1B,IAEC,KAAK1W,KAAL,CAAW+D,IAAX,CAAgB4S,YANpB;;;;sCASc;eACP,IAAI+E,SAAJ,CAAoB,IAApB,EAA0B/b,GAA1B,EAAP;;;;mCAEW;eACJ,KAAKK,KAAL,CAAW+D,IAAX,IAAmB,KAAK/D,KAAL,CAAW+D,IAAX,CAAgB+B,QAA1C;;;;kCAEU;YACN,CAAC,KAAKoV,UAAL,EAAL,EAAwB,KAAK5Z,QAAL,CAAc,EAAEqa,cAAc,IAAhB,EAAsBlJ,MAAM2H,GAA5B,EAAd;;;;iCAEf;eAEN,KAAKpa,KAAL,CAAWwX,KAAX,IAAoB,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAAtC,IACA,0DAFF;;;;0CAKkBK,OA5NnB,EA4N4B;eAExB,KAAKP,KAAL,CAAWwX,KAAX,IACC,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MADlB,IAEC,KAAKF,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,IAA2BK,QAAQwD,IAAR,CAAaW,GAF1C,IAGCnE,QAAQE,KAAR,IAAiB,oCAAoCF,QAAQwD,IAAR,CAAaW,GAJrE;;;;6CAOqBnE,OApOtB,EAoO+B;eAE3B,KAAKP,KAAL,CAAWwX,KAAX,IACC,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MADlB,IAEC,KAAKF,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,IAA2BK,QAAQwD,IAAR,CAAaY,GAF1C,IAGCpE,QAAQE,KAAR,IAAiB,oCAAoCF,QAAQwD,IAAR,CAAaY,GAJrE;;;;iCAOSvE,MA5OV,EA4OkB;;;;YAEbA,MAAJ,EAAY;eACL2C,KAAL,CAAWK,SAAX,CACGC,QADH,GAEG8J,IAFH,CAEQ,YAAM;gBACNqK,QAAQ,CAAC,OAAKxX,KAAL,CAAWwX,KAAX,IAAoB,EAArB,EAAyBvP,KAAzB,EAAZ;;gBAEI,OAAKlF,KAAL,CAAW0P,IAAX,IAAmB2H,GAAvB,EAA4B5C,MAAMnW,IAAN,CAAW,OAAK0B,KAAL,CAAWkY,IAAtB,EAA5B,KACKzD,MAAMxO,MAAN,CAAa,OAAKjG,KAAL,CAAW6Y,QAAxB,EAAkC,CAAlC,EAAqC,OAAK7Y,KAAL,CAAWkY,IAAhD;mBACAjb,KAAL,CAAWiD,YAAX,oBAA2B,OAAKjD,KAAL,CAAWwB,IAAtC,EAA6CgW,KAA7C;mBACKlW,QAAL,CAAc;4BACE,KADF;oBAEN,IAFM;wBAGF;aAHZ;;;;WARJ,EAiBGuP,KAjBH,CAiBS,cAAM;mBAClB7Q,KAAL,CAAWkC,GAAX,CAAe4O,EAAf;WAlBQ;;;;;aAwBGxP,QAAL,CAAc,EAAEqa,cAAc,KAAhB,EAAuBV,MAAM,IAA7B,EAAd;;;;sCAEWzF,CAzQZ,EAyQe;;aAETlU,QAAL,CAAc,EAAE2Z,MAAMzF,KAAKA,EAAEsF,WAAWe,SAAX,EAAF,CAAb,EAAd;;;;6BAGK1S,KA9QN,EA8Qa;aACPnJ,KAAL,CAAWmL,gBAAX,CACE,KAAKnL,KAAL,CAAW6D,aADb,EAEE,6CAFF,EAGE,EAAEsF,YAAF,EAHF;;;;2BAMGA,KArRJ,EAqRW;aACL7H,QAAL,CAAc;gBACNsF,KAAKiC,KAAL,CAAWjC,KAAKC,SAAL,CAAe,KAAK7G,KAAL,CAAWwX,KAAX,CAAiBrO,KAAjB,CAAf,CAAX,CADM;oBAEFA,KAFE;gBAGNgR,IAHM;wBAIE;SAJhB;;;;2CAUgB;;;YACZ,KAAKpX,KAAL,CAAW4T,YAAf,EAA6B;;YAEzB,CAAC,KAAK3W,KAAL,CAAW+D,IAAX,CAAgB4S,YAArB,EAAmC;cAE/B,CAAC,CAAC,KAAK3W,KAAL,CAAW+D,IAAX,CAAgB0X,QAAjB,IACC,CAAC,KAAKzb,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,CAAyBK,YAD5B,KAEA,CAAC,KAAK9b,KAAL,CAAW+D,IAAX,CAAgB+B,QAHnB,EAKE,MAAM,IAAIrE,KAAJ,CAAU,+BAAV,CAAN;;eAEGzB,KAAL,CAAW+D,IAAX,CAAgB4S,YAAhB,GACE,KAAK3W,KAAL,CAAWua,aAAX,CACE,KAAKva,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,IAA4B,KAAKzb,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,CAAyBK,YADvD,KAEK,EAHP;;;YAMEnF,eAAexM,OACjB,KAAKoR,aAAL,MACA,CAAC5H,MAAMhS,SAAN,CAAgBC,aAAhB,CAA8B,KAAK5B,KAAL,CAAW+D,IAAX,CAAgB4S,YAA9C,CADD,GAEI,KAAK3W,KAAL,CAAW+D,IAAX,CAAgB4S,YAAhB,CAA6BF,QAFjC,GAGI,KAAKzW,KAAL,CAAW+D,IAAX,CAAgB4S,YAJH,CAAnB;;YAQE,KAAK3W,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,IACA,KAAKzb,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,CAAyBM,SADzB,IAEA,KAAK/b,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,CAAyBM,SAAzB,CAAmC7b,MAHrC,EAKE,KAAKF,KAAL,CAAW+D,IAAX,CAAgB0X,QAAhB,CAAyBM,SAAzB,CAAmC7T,OAAnC,CAA2C,UAAC3H,OAAD,EAAU4I,KAAV,EAAoB;kBACrDrC,GAAR,GAAcqC,KAAd;uBACa9H,IAAb,CAAkB8I,OAAK5J,OAAL,CAAlB;SAFF;;;mBAMS,YAAM;cACX,OAAKoD,QAAT,EACE,OAAKrC,QAAL,CAAc;0BACEqV;WADhB;SAFJ,EAKG,CALH;;;;iDAQO;YACH,KAAK3W,KAAL,CAAWkV,IAAf,EAAqB;iBACZ3S,6BAAC,WAAD,OAAP;;;mBAGS,KAAK2Y,UAAL,EADX;;;;;kBAKE;cAAQ,OAAO,KAAKlb,KAAL,CAAW6F,KAA1B,EAAiC,aAAa,KAAK7F,KAAL,CAAWwQ,WAAzD;yCACG,MAAD,IAAQ,UAAU1K,QAAlB,EAA4B,OAAO,KAAKiV,SAAxC,GADF;yCAEG,IAAD;qBACS,KAAK/a,KAAL,CAAWwX,KADpB;0BAEc,KAAKyD,IAFnB;0BAGc,KAAK5T,MAHnB;2BAKI,KAAKrH,KAAL,CAAW+D,IAAX,CAAgBiY,WAAhB,IACApV,KAAKiC,KAAL,CAAW,KAAK7I,KAAL,CAAW+D,IAAX,CAAgBiY,WAA3B,CANJ;wBAQYlW;cAVd;yCAYG,SAAD,IAAW,OAAO,KAAK/C,KAAL,CAAW3B,MAA7B,GAZF;yCAaG,KAAD;wBAEImB,6BAAC,SAAD;0BACY,KAAKQ,KAAL,CAAW4T,YADvB;uBAES,KAAK5T,KAAL,CAAWkY,IAFpB;sBAGQH,WAAWe,SAAX,EAHR;2BAIa,KAAK9Y,KAAL,CAAWK,SAJxB;8BAKgB,KAAKH,YALrB;4BAMc,KAAKjD,KAAL,CAAWwJ,UANzB;gCAOkB,KAAKxJ,KAAL,CAAWuS,cAP7B;6BAQe,KAAKvS,KAAL,CAAWqQ;gBAV9B;0BAac,KAAKtN,KAAL,CAAW4Y,YAbzB;oBAcQ,KAAKX;;;;;;;;;kCAlFA;eACV,SAAP;;;;IAzOqBtZ,eArDtB;;SAuXIwR,mBACLf,eADK,EAELU,kBAFK,EAGL1M,aAAW2U,UAAX,CAHK,CAAP;CA/XF;;;;ACbA,IAGqBmB;;;;;OAHlB;WAAQ,KAAKna,wBAAL,EAAP;IAAJ,CAA4C,OAAMC,CAAN,EAAQ;WAAQC,uBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;uBAIxCxB,KAAZ,EAAmB;;;yHACZA,KADY;;QAEbkc,IAAL,GAAY,MAAKA,IAAL,CAAUtc,IAAV,OAAZ;;;;;;sCAEmB;QACdsc,IAAL;;;;yBAEwB;OAApBlc,KAAoB,uEAAZ,KAAKA,KAAO;;OAEvBA,MAAM+D,IAAN,IACA/D,MAAM+D,IAAN,CAAWwB,OADX,IAEAvF,MAAM+D,IAAN,CAAWwB,OAAX,KAAuBvF,MAAM8D,KAF7B,IAGA,CAAC9D,MAAM8D,KAJR,EAMC,OAAO,KAAK9D,KAAL,CAAWiD,YAAX,oBACLjD,MAAMwB,IADD,EACQ+T,oBAAoBvV,KAApB,EAA2BA,MAAM+D,IAAN,CAAWwB,OAAtC,CADR,EAAP;;OAIGmQ,eAAe1V,KAAf,KAAyB,KAAKA,KAAL,CAAW8D,KAAX,KAAqB9D,MAAM8D,KAAxD,EAA+D;SACzD9D,KAAL,CAAWiD,YAAX,oBACEjD,MAAMwB,IADR,EACe+T,oBAAoBvV,KAApB,EAA2BA,MAAM8D,KAAjC,CADf;;;;;4CAKwBF,MAAM;QAC1BsY,IAAL,CAAUtY,IAAV;;;;6CAGQ;UACD,IAAP;;;;EA9BwCrB,eAAMb;;;;ACHhD,AAIA,kBAAe,UAACya,IAAD,EAAOC,iBAAP,EAA6B;MACtC7I,WAAW1Q,cAAX,CAA0BsZ,IAA1B,EAAgC,MAAhC,KAA2C,CAACC,iBAAhD,EACE,MAAM,IAAI3a,KAAJ,CAAU,+CAAV,CAAN;;MAEI4a,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;;KAAP;GADF;;MAMMlK,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,iBAAS;aAC7C;iBACIrP,SAASA,MAAMwG,MAAN,CAAagH,IAAtB,IAA8BxN,MAAMwG,MAAN,CAAagH,IAAb,CAAkB+L;OAD3D;KADsB;GAAxB;;;;MAOMC,SAjBoC;;;;;YAJzC;iBAAQ,KAAKza,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,wBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;uBAsBrCxB,KAAZ,EAAmB;;;uHACXA,KADW;;YAEZwc,EAAL,GAAU,MAAKA,EAAL,CAAQ5c,IAAR,OAAV;YACKmD,KAAL,GAAa,EAAE0Z,MAAM,MAAKzc,KAAL,CAAW8D,KAAnB,EAAb;;;;;;2BAaG;YACC2E,SAAS,IAAb;YACIgU,OACF,KAAK1Z,KAAL,CAAW0Z,IAAX,IACC,KAAKzc,KAAL,CAAW+D,IAAX,CAAgBC,MAAhB,IAA0B,KAAKhE,KAAL,CAAW+D,IAAX,CAAgBC,MAAhB,CAAuBF,KAFpD;YAGI2Y,IAAJ,EAAU;cACJC,gBAAgBH,UAAUI,SAAV,CAAoB,IAApB,EAA0BF,IAA1B,CAApB;cACI,KAAKzc,KAAL,CAAW+D,IAAX,CAAgB0E,MAApB,EAA4B;gBACtBmU,aAAaL,UAAUI,SAAV,CAAoB,KAApB,EAA2B,KAAK3c,KAAL,CAAW+D,IAAX,CAAgB0E,MAA3C,CAAjB;mBACO9C,MAAP,CAAc+W,cAAcjU,MAA5B,EAAoCmU,WAAWnU,MAA/C;;;iBAGKiU,cAAcD,IAArB;mBACSC,cAAcjU,MAAvB;kBACQ,KAAKzI,KAAL,CAAW+D,IAAX,CAAgB0B,IAAxB;iBACO8W,UAAUM,QAAV,CAAmBC,MAAxB;;gCAEoBC,QAAlB,CACE;qBACON,IADP;;eADF,EAKE,KAAKzc,KAAL,CAAWN,OALb,EAME,KAAKM,KAAL,CAAWwJ,UANb;;;;iBAWG+S,UAAUM,QAAV,CAAmBG,MAAxB;;gCAEoBtS,SAAlB,CACE;wBACU,EAAEhC,IAAI+T,IAAN,EAAYxH,aAAaxM,MAAzB,EADV;qBAEO;eAHT,EAKE,KAAKzI,KAAL,CAAWN,OALb,EAME,KAAKM,KAAL,CAAWwJ,UANb;;;;;;;iDAYC;;;uCAGJ,IAAD;kBACQ,KAAKxJ,KAAL,CAAW+D,IAAX,CAAgBmG,IADxB;sBAEY,KAAKlK,KAAL,CAAW+D,IAAX,CAAgB+B,QAF5B;gBAGM,KAAK0W;;;;;;;;gCA3DES,eAvBuB,EAuBNR,IAvBM,EAuBA;YAClCS,YAAYT,KAAKvY,KAAL,CAAW,GAAX,CAAhB;YACI+Y,eAAJ,EAAqBR,OAAOS,UAAUjE,KAAV,EAAP;YACjBxQ,SAASyU,UAAU7c,MAAV,CAAiB,UAACoY,GAAD,EAAMhU,CAAN,EAAY;cAClC0Y,KAAK1Y,EAAEP,KAAF,CAAQ,GAAR,CAAT;iBACQuU,IAAI0E,GAAG,CAAH,CAAJ,IAAaC,mBAAmBD,GAAG,CAAH,CAAnB,CAAd,EAA0C1E,GAAjD;SAFS,EAGR,EAHQ,CAAb;YAIErY,SAAS,EAAEqI,cAAF,EAJX;YAKIwU,mBAAmB,CAACC,UAAUhd,MAAlC,EAA0CE,OAAOqc,IAAP,GAAcA,IAAd;eACnCrc,MAAP;;;;IAfoBsB,eAjBkB;;YAwFhCmb,QAAV,GAAqB,EAAEC,QAAQ,QAAV,EAAoBE,QAAQ,QAA5B,EAArB;SACO9J,mBACLf,eADK,EAELkK,kBAFK,EAGLlW,aAAWoW,SAAX,CAHK,CAAP;CAzFF;;;;ACJA,AAGA,oBAAe,iBAAS;aACX1Z,cAAX,CAA0Bwa,KAA1B,EAAiC,OAAjC;;SAEOlX,WAAW;QANjB;UAOOrC,MAPP,GAOgC9D,KAPhC,CAOO8D,KAPP;UAOcC,KAPd,GAOgC/D,KAPhC,CAOc+D,IAPd;UAOuBuZ,KAPvB,2BAOgCtd,KAPhC;;UAQK8D,UAAS9D,MAAM+D,IAAN,CAAW0B,IAAX,IAAmB,KAAhC,EAAuC;YACjC4H,OAAOrN,MAAM+D,IAAN,CAAWC,MAAX,CAAkBqJ,IAAlB,CAAuBkQ,OAAvB,CACP,IAAI3Y,MAAJ,OAAe5E,MAAMwB,IAArB,QAA8B,GAA9B,CADO,EAEPsC,MAFO,CAAX;YAIEC,SAAOgE,OAAOpC,MAAP,CAAc,EAAd,EAAkB3F,MAAM+D,IAAxB,CAJT;eAKKC,MAAL,GAAc,EAAEqJ,UAAF,EAAd;eACO9K,6BAAC,KAAD,aAAO,MAAMwB,MAAb,IAAuBuZ,KAAvB,EAAP;;aAEK/a,6BAAC,KAAD,EAAWvC,KAAX,CAAP;KAjBJ,CAAK,OAAM+B,CAAN,EAAQ;aAAQC,wBAAqBD,CAArB,CAAP;;GAML,EAYJ,OAZI,CAAP;CAHF;;;;ACHA,AAeO,IAAMyb,aAAa;QAClB,MADkB;YAEd;CAFL;AAIP,AAAO,IAAMC,aAAa;OACnB,KADmB;QAElB;CAFD;;AAKP,mBAAe,UACbrI,MADa,EAEb4E,IAFa,EAGb0D,QAHa,EAIbtK,MAJa,EAKbsB,WALa,EAMbiJ,YANa,EAObvB,iBAPa,EAQbwB,iBARa,EASb1L,SATa,EAUV;MAEDqB,WAAW1Q,cAAX,CAA0BuS,MAA1B,EAAkC,QAAlC,KACA7B,WAAW1Q,cAAX,CAA0BuQ,MAA1B,EAAkC,QAAlC,CADA,IAEAG,WAAW1Q,cAAX,CAA0BmX,IAA1B,EAAgC,MAAhC,CAFA,IAGAzG,WAAW1Q,cAAX,CAA0B6a,QAA1B,EAAoC,UAApC,CAHA,IAIAnK,WAAW1Q,cAAX,CAA0B6R,WAA1B,EAAuC,aAAvC,CAJA,IAKAnB,WAAW1Q,cAAX,CAA0B8a,YAA1B,EAAwC,cAAxC,CALA,IAMApK,WAAW1Q,cAAX,CAA0BqP,SAA1B,EAAqC,WAArC,CANA,IAOAqB,WAAW1Q,cAAX,CAA0B+a,iBAA1B,EAA6C,mBAA7C,CAPA,IAQA,CAACxB,iBATH,EAWE,MAAM,IAAI3a,KAAJ,CAAU,gDAAV,CAAN;;MAEIoR,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;WACA,aAACnK,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eACH0E,SACEmC,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkC;wBAClB,IADkB;wBAElB;SAFhB,CADF,CADG;OADA;YAQC,cAAC4B,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eAAmB0E,SAASkC,eAAehF,EAAf,EAAmB3E,IAAnB,EAAyB+C,GAAzB,CAAT,CAAnB;OARD;UASD;eACF0E,SACE4Q,kBAAkB1R,SAAlB,CAA4B;kBAClB,EAAEhC,IAAI5E,KAAN,EADkB;eAErB;SAFP,CADF,CADE;OATC;qBAgBU,uBAAC4E,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eACb0E,SAASiD,qBAAqB/F,EAArB,EAAyB3E,IAAzB,EAA+B+C,GAA/B,CAAT,CADa;OAhBV;uBAkBY,4BAAC4B,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eACf0E,SAASyC,gBAAgBvF,EAAhB,EAAoB3E,IAApB,EAA0B+C,GAA1B,CAAT,CADe;OAlBZ;yBAoBc,8BAAC4B,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eACjB0E,SAAS6C,kBAAkB3F,EAAlB,EAAsB3E,IAAtB,EAA4B+C,GAA5B,CAAT,CADiB;OApBd;kBAsBO,uBAAC4B,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eAAmB0E,SAASuC,WAAWrF,EAAX,EAAe3E,IAAf,EAAqB+C,GAArB,CAAT,CAAnB;OAtBP;mBAuBQ;eAAW0E,SAASc,cAAYlB,OAAZ,CAAT,CAAX;;KAvBf;GADF;MA2BM+G,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;UAC5DxO,gBAAgBmD,OAAOjE,KAAP,EAAcsP,SAASxO,aAAvB,EAAsCwO,QAAtC,CAApB;UACIjS,SAAS2C,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,aAAlB,CAAb;aACO;oCAAA;;eAGEzD,UAAUA,OAAOiN,IAAjB,GAAwBjN,OAAOiN,IAAP,CAAYmK,KAApC,GAA4C,IAH9C;eAIEpX,UAAUA,OAAOiN,IAAjB,GAAwBjN,OAAOiN,IAAP,CAAYwQ,KAApC,GAA4C,CAJ9C;cAKCzd,UAAU,CAAC,CAACA,OAAO0d,YALpB;eAME1d,UAAU,CAAC,CAACA,OAAO2d,iBANrB;wBAQF3d,UAAUA,OAAO4d,cAAlB,IACC3L,SAAStO,IAAT,IAAiBsO,SAAStO,IAAT,CAAcS,MADhC,IAEA,IAVG;gBAWGpE,UAAUA,OAAOoE,MAXpB;oBAYOpE,UAAUA,OAAO6d,UAZxB;sBAaS7d,UAAUA,OAAOuW,YAb1B;4BAcevW,UAAUA,OAAO8d,kBAdhC;gCAemB9d,UAAUA,OAAO+d,qBAfpC;8BAgBiB/d,UAAUA,OAAOge,eAhBlC;2BAiBche,UAAUA,OAAO6W,YAAY,iBAAZ,CAAP,CAjBxB;6BAmBH7W,UAAUA,OAAO6W,YAAY,uBAAZ,CAAP,CAnBP;yBAoBY7W,UAAUA,OAAO6W,YAAY,oBAAZ,CAAP,CApBtB;0BAsBHlU,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,gBAAgBwa,WAAWC,qBAAX,EAAlC,CAtBG;2BAwBHvb,MAAMwG,MAAN,CAAagH,IAAb,CACE1M,gBAAgBwa,WAAWC,qBAAX,EAAhB,GAAqD,OADvD,CAxBG;mBA2BMvb,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,gBAAgBwa,WAAWE,YAAX,EAAlC;OA3Bb;KAHsB;GAAxB;;MAiCMF,UA1EH;;;;;YAlCF;iBAAQ,KAAKvc,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,wBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;wBA6GrCxB,KAAZ,EAAmB;;;yHACXA,KADW;;YAEZ+C,KAAL,GAAa;cACL,IADK;mBAEA,EAFA;0BAGO,EAHP;sBAIG,KAJH;eAKJ,MAAK/C,KAAL,CAAW+D,IAAX,CAAgBya,SAAhB,IAA6B,CALzB;+BAMY;OANzB;YAQKC,gBAAL,GAAwB,MAAKA,gBAAL,CAAsB7e,IAAtB,OAAxB;YACK8e,YAAL,GAAoB,MAAKA,YAAL,CAAkB9e,IAAlB,OAApB;YACK+e,MAAL,GAAc,MAAKA,MAAL,CAAY/e,IAAZ,OAAd;YACK8e,YAAL,GAAoB,MAAKA,YAAL,CAAkB9e,IAAlB,OAApB;YACKgf,MAAL,GAAc,MAAKA,MAAL,CAAYhf,IAAZ,OAAd;YACKif,UAAL,GAAkB,MAAKA,UAAL,CAAgBjf,IAAhB,OAAlB;YACKqD,YAAL,GAAoB,MAAKA,YAAL,CAAkBrD,IAAlB,OAApB;YACKkf,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBlf,IAAxB,OAA1B;YACKmf,IAAL,GAAY,MAAKA,IAAL,CAAUnf,IAAV,OAAZ;YACK4E,MAAL,GAAc,MAAKA,MAAL,CAAY5E,IAAZ,OAAd;YACKof,cAAL,GAAsB,MAAKA,cAAL,CAAoBpf,IAApB,OAAtB;YACKqf,YAAL,GAAoB,MAAKA,YAAL,CAAkBrf,IAAlB,OAApB;YACKsf,IAAL,GAAY,MAAKA,IAAL,CAAUtf,IAAV,OAAZ;YACKuf,QAAL,GAAgB,MAAKA,QAAL,CAAcvf,IAAd,OAAhB;YACKwf,eAAL,GAAuB,MAAKA,eAAL,CAAqBxf,IAArB,OAAvB;YACKyf,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBzf,IAAtB,OAAxB;YACK0f,WAAL,GAAmB,MAAKA,WAAL,CAAiB1f,IAAjB,OAAnB;YACK2f,iBAAL,GAAyB,MAAKA,iBAAL,CAAuB3f,IAAvB,OAAzB;YACK4f,kBAAL,GAA0B,MAAKA,kBAAL,CAAwB5f,IAAxB,OAA1B;YACK6f,mBAAL,GAA2B,MAAKA,mBAAL,CAAyB7f,IAAzB,OAA3B;UAEE,CAAC,MAAKgf,MAAL,MAAiB,MAAKC,UAAL,EAAlB,MACC,CAAC,MAAK7e,KAAL,CAAW+D,IAAX,CAAgB2b,QAAjB,IACC,CAAC,MAAK1f,KAAL,CAAW+D,IAAX,CAAgB2b,QAAhB,CAAyBlb,MAAzB,CAAgC;eAAKC,EAAEkb,WAAF,IAAiB,OAAtB;OAAhC,EACEzf,MAHL,CADF,EAKE;YACI0f,MAAM;uBACK,MADL;mBAEC,EAAE9b,OAAO,EAAT,EAFD;uBAGK,OAHL;uBAIK;SAJf;YAMI,CAAC,MAAK9D,KAAL,CAAW+D,IAAX,CAAgB2b,QAArB,EAA+B,MAAK1f,KAAL,CAAW+D,IAAX,CAAgB2b,QAAhB,GAA2B,EAA3B;cAC1B1f,KAAL,CAAW+D,IAAX,CAAgB2b,QAAhB,CAAyBG,OAAzB,CAAiCD,GAAjC;;;;;;;0CAGgB;aACbjc,QAAL,GAAgB,IAAhB;aACK8b,mBAAL;;;;6CAGqB;aAChB9b,QAAL,GAAgB,KAAhB;;;;4CAG6C;YAA3B3D,KAA2B,uEAAnB,KAAKA,KAAc;YAAP8f,KAAO;;YAE3C,CAAC9f,MAAM+f,mBAAP,IACA/f,MAAM+D,IAAN,CAAWic,eADX,IAEA,CAAChgB,MAAMigB,sBAFP,IAGA,CAACjgB,MAAMge,cAHP,KAIC,CAAC8B,KAAD,IAAWA,SAAS9f,MAAMge,cAAN,KAAyB8B,KAJ9C,CADF,EAME;eACK9f,KAAL,CAAWqO,iBAAX,CACErO,MAAM+D,IAAN,CAAWic,eADb,EAEEpZ,KAAKiC,KAAL,CAAW7I,MAAM+D,IAAN,CAAWmc,QAAX,IAAuB,IAAlC,CAFF,EAGElgB,MAAM6D,aAHR;;;;;0CAOkC;YAApB7D,KAAoB,uEAAZ,KAAKA,KAAO;;aAC/BsB,QAAL,CAAc;4BACM,KADN;iCAEW,IAFX;yBAGGtB,MAAMmgB;SAHvB;;;;2CAMmB;aACd7e,QAAL,CAAc;iCACW,KADX;kBAEJ;SAFV;;;;gDAKwBsC,IA9JzB,EA8J+B;YAC1BA,KAAKwc,SAAL,KAAmB,KAAKpgB,KAAL,CAAWogB,SAAlC,EAA6C;eACtCtB,kBAAL,CAAwB,IAAxB,EAA8B,YAA9B;;;YAGElb,KAAKuc,gBAAL,KAA0B,KAAKngB,KAAL,CAAWmgB,gBAAzC,EAA2D;eACpDZ,iBAAL,CAAuB3b,IAAvB;;;YAIAA,KAAKqa,UAAL,IACAra,KAAKqa,UAAL,KAAoB,KAAKje,KAAL,CAAWie,UAD/B,IAECra,KAAK+S,YAAL,IAAqB/S,KAAK+S,YAAL,KAAsB,KAAK3W,KAAL,CAAW2W,YAHzD,EAIE;iBACO,KAAK+H,YAAL,CACLjB,WAAWtD,IADN,EAELvW,KAAKqa,UAFA,EAGL,IAHK,EAILra,KAAK+S,YAJA,CAAP;;;YASA/S,KAAKqa,UAAL,IACAra,KAAKqa,UAAL,KAAoB,KAAKje,KAAL,CAAWie,UAD/B,IAEA,CAACra,KAAKyc,oBAHR,EAIE;iBACO,KAAK3B,YAAL,CAAkBjB,WAAWtD,IAA7B,EAAmCvW,KAAKqa,UAAxC,EAAoD,IAApD,CAAP;;;YAGEra,KAAK+S,YAAL,IAAqB/S,KAAK+S,YAAL,KAAsB,KAAK3W,KAAL,CAAW2W,YAA1D,EAAwE;iBAC/D,KAAK+H,YAAL,CACL,KAAK3b,KAAL,CAAW0P,IADN,EAEL,KAAKwM,YAAL,MAAuB,KAAKjf,KAAL,CAAWie,UAF7B,EAGL,IAHK,EAILra,KAAK+S,YAJA,CAAP;;;aAQG8I,mBAAL,CAAyB7b,IAAzB,EAA+B,KAAK5D,KAAL,CAAWge,cAA1C;;;;2CAEuE;YAAtDxZ,MAAsD,uEAA7Cwa,gBAA6C;YAA3BsB,UAA2B,uEAAd,KAAc;YAAP/L,KAAO;;aAClEvU,KAAL,CAAWsgB,UAAX,EACE,KAAKtgB,KAAL,CAAW+D,IAAX,CAAgBsQ,MADlB,EAEEtM,OAAOpC,MAAP,CACE,EADF,EAEEiB,KAAKiC,KAAL,CAAW,KAAK7I,KAAL,CAAW+D,IAAX,CAAgBmc,QAAhB,IAA4B,IAAvC,CAFF,EAGE,EAAEK,OAAO,KAAKxd,KAAL,CAAWwd,KAApB,EAA2BC,MAAM,IAAjC,EAHF,EAIEhc,SAAS,EAAE4M,OAAO5M,MAAT,EAAT,GAA6B,EAJ/B,EAKE+P,SAAS,EALX,CAFF,EASE,KAAKvU,KAAL,CAAW6D,aATb;;;;qCAYa;eACN,KAAKd,KAAL,CAAWqN,IAAlB;;;;uCAEe;eAEZ,KAAKpQ,KAAL,CAAW8D,KAAX,IAAoB,KAAK9D,KAAL,CAAW8D,KAAX,CAAiBua,WAAWoC,cAAX,EAAjB,CAArB,IACA,IAFF;;;;+BAMO;;;aACF1d,KAAL,CAAW2d,gBAAX,CAA4Brd,QAA5B,GAAuC8J,IAAvC,CACE,YAAM;iBACC2R,kBAAL,CAAwB,OAAKE,cAAL,EAAxB,EAA+C,YAA/C;SAFJ,EAIE,YAAM;iBACThf,KAAL,CAAWkC,GAAX,CAAe,8BAAf;SALM;;;;sCAkBW4B,KAjPZ,EAiPmB;aACb9D,KAAL,CAAWiD,YAAX,oBACG,KAAKjD,KAAL,CAAWwB,IADd,EACqBuG,OAAOpC,MAAP,CACjB,EADiB,EAEjB,KAAK3F,KAAL,CAAW8D,KAAX,IAAoB,EAFH,EAGjBA,SAAS,EAHQ,CADrB;;;;2BAQG6c,SA1PJ,EA0Pe;;;YACV,CAACA,SAAL,EAAgB,OAAO,KAAKhC,MAAL,EAAP;;aAEX5b,KAAL,CAAWK,SAAX,CAAqBC,QAArB,GAAgC8J,IAAhC,CACE,YAAM;cACAzE,WAAJ;kBACQ,OAAK3F,KAAL,CAAW0P,IAAnB;iBACOgL,WAAWrD,GAAhB;mBACO,OAAKpa,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsBqM,eAA3B;;iBAEGnD,WAAWtD,IAAhB;mBAEI,OAAKna,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsBsM,aAAtB,IACA,OAAK7gB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsBqM,eAFxB;;;cAKA,CAAClY,EAAL,EAAS;mBACA,OAAK1I,KAAL,CAAWkC,GAAX,CACL,wCACE,OAAKlC,KAAL,CAAW+D,IAAX,CAAgB0O,IADlB,GAEE,8CAFF,GAGE7L,KAAKC,SAAL,CAAe,OAAK7G,KAApB,EAA2B,IAA3B,EAAiC,GAAjC,CAJG,CAAP;;;iBAQGA,KAAL,CAAWL,GAAX,CACE+I,EADF,EAEEX,OAAOpC,MAAP,CAAciB,KAAKiC,KAAL,CAAW,OAAK7I,KAAL,CAAW+D,IAAX,CAAgBmc,QAAhB,IAA4B,IAAvC,CAAd,EAA4D;oBAClD,OAAKjB,YAAL;WADV,CAFF,EAKE,OAAKjf,KAAL,CAAW6D,aAAX,GAA2Bwa,WAAWE,YAAX,EAL7B;;iBAQKI,MAAL;SA9BJ,EAgCE,YAAM;iBACC3e,KAAL,CAAWkC,GAAX,CAAe,+BAAf;SAjCJ;;;;mCAqCWuQ,IAlSZ,EAkSkB1O,IAlSlB,EAkSwB+c,SAlSxB,EAkSmCC,aAlSnC,EAkSkD;YAC7CtK,WAAWsK,aAAf;YACEC,sBAAsB,KADxB;YAEEC,sBAFF;YAGI,KAAKjhB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAApB,EACE,QAAQ9B,IAAR;eACOgL,WAAWrD,GAAhB;uBAEI2G,iBACA,CACG,KAAK/gB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB2M,cAAtB,IACC,KAAKlhB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB2M,cAAtB,CAAqChhB,MADtC,IAEC,KAAKF,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB2M,cAFxB,IAGA,KAAKlhB,KAAL,CAAW2W,YAHX,IAIA,EALF,EAME1O,KANF,EAFF;;eAUGwV,WAAWtD,IAAhB;uBAEI4G,iBACA,CACG,KAAK/gB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB4M,YAAtB,IACC,KAAKnhB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB4M,YAAtB,CAAmCjhB,MADpC,IAEC,KAAKF,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB4M,YAFxB,IAGC,KAAKnhB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB2M,cAAtB,IACC,KAAKlhB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB2M,cAAtB,CAAqChhB,MADtC,IAEC,KAAKF,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB2M,cALxB,IAMA,KAAKlhB,KAAL,CAAW2W,YANX,IAOA,EARF,EASE1O,KATF,EAFF;4BAYgBlE,IAAhB;gBAEE,KAAK/D,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB6M,wBAAtB,IACA,CAAC,KAAKphB,KAAL,CAAWke,kBADZ,IAEA,CAAC,KAAKle,KAAL,CAAWqhB,eAFZ,IAGA,CAACP,SAJH,EAKE;yBACW,EAAX;8BACgB,IAAhB;mBACK9gB,KAAL,CAAWshB,aAAX,CACE,KAAKthB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsB6M,wBADxB,EAEErd,IAFF,EAGE,KAAK/D,KAAL,CAAW6D,aAHb;;;;;;YAWN,CAAC,CAAC4S,QAAD,IAAa,CAAC9C,MAAMhS,SAAN,CAAgBC,aAAhB,CAA8B6U,QAA9B,CAAf,KACA,CAAC,KAAKzW,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsBgN,sBAFzB,EAGE;iBACO,KAAKvhB,KAAL,CAAWkC,GAAX,CACL,mDACE,KAAKlC,KAAL,CAAW+D,IAAX,CAAgB0O,IADlB,GAEE,sCAFF,GAGE7L,KAAKC,SAAL,CAAe,KAAK7G,KAApB,EAA2B,IAA3B,EAAiC,GAAjC,CAJG,CAAP;;YAQA,CAAC,CAACyW,QAAD,IAAa,CAACA,SAASvW,MAAxB,KACA,CAAC,KAAKF,KAAL,CAAWqgB,oBADZ,IAEA,CAAC,KAAKrgB,KAAL,CAAWwhB,iBAFZ,IAGA,KAAKxhB,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsBgN,sBAHtB,IAIA,CAACT,SALH,EAME;gCACsB,IAAtB;eACK9gB,KAAL,CAAWiO,eAAX,CACE,KAAKjO,KAAL,CAAW+D,IAAX,CAAgBwQ,KAAhB,CAAsBgN,sBADxB,EAEExd,IAFF,EAGE,KAAK/D,KAAL,CAAW6D,aAHb;;YAME4d,SAAS;qBACA,EADA;wBAEG,IAFH;gBAGLhP,IAHK;4BAIO,KAJP;4BAKOgE;SALpB;YAOI,CAACuK,mBAAL,EACES,OAAOrR,IAAP,GAAc6Q,gBAAgB9W,OAAK8W,aAAL,CAAhB,GAAsCA,aAApD;aACG3f,QAAL,CAAcmgB,MAAd;;;;6BAGK;YACD,CAAC,KAAKtC,QAAL,EAAD,IAAoB,CAAC,KAAKnf,KAAL,CAAWkV,IAAhC,IAAwC,CAAC,KAAKlV,KAAL,CAAWS,KAAxD,EAA+D;;cAEzD2Q,QAAQ;mBACH,KAAKrO,KAAL,CAAWwd;WADpB;cAGI,KAAKvgB,KAAL,CAAWwX,KAAX,IAAoB,KAAKxX,KAAL,CAAWwX,KAAX,CAAiB,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,GAA0B,CAA3C,CAAxB,EAAuE;kBAC/D6U,GAAN,GAAY,KAAK/U,KAAL,CAAWwX,KAAX,CAAiB,KAAKxX,KAAL,CAAWwX,KAAX,CAAiBtX,MAAjB,GAA0B,CAA3C,EAA8C6U,GAA1D;iBACK/U,KAAL,CAAWkC,GAAX,CAAe,oBAAoBkP,MAAM2D,GAAzC;;;eAGG+J,kBAAL,CAAwB,KAAKE,cAAL,EAAxB,EAA+C,MAA/C,EAAuD5N,KAAvD;;;;;iCAGO;eACF,KAAKpR,KAAL,CAAWwX,KAAX,IAAoB,KAAKxX,KAAL,CAAW6d,KAAX,IAAoB,KAAK7d,KAAL,CAAWwX,KAAX,CAAiBtX,MAAhE;;;;+BAEO;aACFoB,QAAL,CAAc;gBACN,IADM;wBAEE,KAFF;4BAGM,IAHN;4BAIM,KAJN;gBAKN;SALR;;;;yCASiB;aACZA,QAAL,CAAc,EAAEogB,kBAAkB,KAApB,EAAd;;;;uCAEe5d,KAtZhB,EAsZuB;aACjBxC,QAAL,CAAc;gBACNyG,OAAOpC,MAAP,CACJ,EADI,EAEJ,KAAK5C,KAAL,CAAWqN,IAAX,IAAmB,EAFf,EAGHtM,SAASA,MAAMua,WAAWE,YAAX,EAAN,CAAV,IAA+C,EAH3C;SADR;;;;sCAQclW,IA/Zf,EA+ZqB;aACf/G,QAAL,CAAc,EAAE+G,MAAMA,IAAR,EAAcqZ,kBAAkB,IAAhC,EAAd;;;;kCAEUC,OAlaX,EAka4C;YAAxBtZ,IAAwB,uEAAjB,KAAKtF,KAAL,CAAWsF,IAAM;;gBACnCsZ,QAAQhC,WAAhB;eACO,KAAL;iBACO3f,KAAL,CAAWwc,EAAX,CAAcmF,QAAQA,OAAR,CAAgB7d,KAA9B,EAAqC;2BACtB,EAAEiR,KAAK1M,KAAK0M,GAAZ;aADf;;eAIG,OAAL;iBACO2J,YAAL,CAAkBjB,WAAWtD,IAA7B,EAAmC9R,IAAnC;;eAEG,WAAL;iBACOrI,KAAL,CAAWL,GAAX,CACEgiB,QAAQA,OAAR,CAAgB7d,KADlB,EAEEiE,OAAOpC,MAAP,CACE,EADF,EAEEiB,KAAKiC,KAAL,CAAW,KAAK7I,KAAL,CAAW+D,IAAX,CAAgBmc,QAAhB,IAA4B,IAAvC,CAFF,EAGE7X,IAHF,CAFF,EAOE,KAAKrI,KAAL,CAAW6D,aAAX,GAA2Bwa,WAAWC,qBAAX,EAP7B;;;;;;+BAYG;eACA,KAAKte,KAAL,CAAW+D,IAAX,CAAgB0O,IAAhB,IAAwB+K,WAAWoE,IAA1C;;;;mCAEW;eACJ,KAAK5hB,KAAL,CAAW+D,IAAX,CAAgB0O,IAAhB,IAAwB+K,WAAWqE,QAA1C;;;;iDAEO;;;aACF7hB,KAAL,CAAWkC,GAAX,CAAe,aAAf;;YAEI6B,OAAO,KAAK/D,KAAL,CAAW+D,IAAtB;YACE+d,SAAS,KAAK9hB,KAAL,CAAWge,cAAX,GACPzb;gBAAA;YAAQ,QAAQ;qBAAM,OAAKiC,MAAL,EAAN;aAAhB;uCACG,SAAD;sBACY,KAAKxE,KAAL,CAAWge,cADvB;mBAES,KAAKgB,cAAL,EAFT;0BAGgB,KAAK/b,YAHrB;kBAIQob,WAAWoC,cAAX,EAJR;uBAKa,KAAK1d,KAAL,CAAW2d,gBALxB;wBAMc,KAAK1gB,KAAL,CAAWwJ,UANzB;4BAOkB,KAAKxJ,KAAL,CAAWuS,cAP7B;yBAQe,KAAKvS,KAAL,CAAWqQ;;SAVrB,GAaL,KAAKrQ,KAAL,CAAWigB,sBAAX,GACF1d,6BAAC,WAAD,OADE,GAEA,IAhBN;YAiBEwf,SAAS,CAAC,KAAK5C,QAAL,EAAD,IAAoB,KAAKnf,KAAL,CAAWkV,IAA/B,GAAsC3S,6BAAC,WAAD,OAAtC,GAAwD,IAjBnE;;eAoBEA;gBAAA;;uCACG,IAAD;mBACS,KAAKvC,KAAL,CAAW6F,KADpB;0BAEgB,KAAK+Y,MAAL,EAFhB;oBAGUkD,MAHV;oBAIUC,MAJV;mBAKS,KAAK/hB,KAAL,CAAW6d,KALpB;0BAMgB,KAAKa,YANrB;mBAOS,KAAK1e,KAAL,CAAWwX,KAPpB;4BASI,KAAKxX,KAAL,CAAW+D,IAAX,CAAgBie,cAAhB,GACIpb,KAAKiC,KAAL,CAAW,KAAK7I,KAAL,CAAW+D,IAAX,CAAgBie,cAA3B,CADJ,GAEI,IAXR;kBAaQ,KAAK9C,IAbb;uBAca,CAAC,KAAKlf,KAAL,CAAW+D,IAAX,CAAgBke,uBAd9B;sBAeY,KAAKjiB,KAAL,CAAW+D,IAAX,CAAgB2b,QAf5B;yBAgBe,KAAKJ,WAhBpB;6BAiBmB,KAAKF,eAjBxB;kBAkBQ,CAAC,KAAKD,QAAL,EAAD,IAAoB,KAAKnf,KAAL,CAAWkV;YAnBzC;uCAqBG,QAAD;wBAEI,CAAC,KAAK0J,MAAL,MAAiB,KAAKC,UAAL,EAAlB,KAAwC,KAAK9b,KAAL,CAAW2b,YAFvD;kBAIQ,KAAKK,IAJb;kBAMI,KAAK/e,KAAL,CAAWke,kBAAX,IAAiC,KAAKle,KAAL,CAAWqgB,oBANhD;sBASI9d,6BAAC,SAAD;wBACY,KAAKQ,KAAL,CAAWmf,gBADvB;qBAES,KAAKjD,YAAL,EAFT;oBAGQZ,WAAWE,YAAX,EAHR;yBAIa,KAAKxb,KAAL,CAAWK,SAJxB;4BAKgB,KAAKqb,gBALrB;0BAMc,KAAKze,KAAL,CAAWwJ,UANzB;8BAOkB,KAAKxJ,KAAL,CAAWuS,cAP7B;2BAQe,KAAKvS,KAAL,CAAWqQ;;YAtChC;uCA0CG,YAAD;wBACc,KAAKtN,KAAL,CAAW2e,gBADzB;mBAES,KAAKrC,gBAFd;sBAGY,KAAKrf,KAAL,CAAW+D,IAAX,CAAgB2b,QAH5B;yBAIe,KAAKJ;YA9CtB;uCAgDG,iBAAD;wBACc,KAAKvc,KAAL,CAAWof,qBADzB;kBAEQ,KAAK3C,kBAFb;sBAIIjd,6BAAC,SAAD;wBACY,KAAKQ,KAAL,CAAWqf,aADvB;oBAEQ/D,WAAWC,qBAAX,EAFR;yBAGa,EAHb;0BAIc,KAAKte,KAAL,CAAWwJ,UAJzB;8BAKkB,KAAKxJ,KAAL,CAAWuS,cAL7B;2BAMe,KAAKvS,KAAL,CAAWqQ;cAV9B;mBAaS,EAbT;kBAcQ,KAAKrQ,KAAL,CAAWqiB;;SA/DvB;;;;qCA7OoB;eACb,YAAP;;;;uCAEsB;eACf,cAAP;;;;8CAE6B;eACtB,qBAAP;;;;IArKqB9f,eAAMb,SA1E5B;;SA2hBIwR,mBACLf,eADK,EAELU,kBAFK,EAGL1M,WAAWkY,UAAX,CAHK,CAAP;CAriBF;;;;ACxBA,AAEA,uBAAe,6BAAqB;SAC3BlY;;;;;YAHN;iBAAQ,KAAKrE,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,wBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;8BAKnCxB,KAAZ,EAAmB;;gIACXA,KADW;;;;;iDAGV;eAELuC,6BAAC,iBAAD;gBAEI,KAAKvC,KAAL,CAAW8D,KAAX,IACC,KAAK9D,KAAL,CAAW+D,IAAX,IAAmB,KAAK/D,KAAL,CAAW+D,IAAX,CAAgBue,IADpC,IAEA;WAEE,KAAKtiB,KANX,EADF;;;;IAL2B0B,eAD1B,EAAP;CADF;;;;ACFA,AAQA;;;;;;;AAOA,yBAAe,UAAC6gB,QAAD,EAAW7N,WAAX,EAAwB8N,IAAxB,EAAgD;MAAlBC,QAAkB,uEAAP,EAAO;;aAClD5f,cAAX,CAA0B0f,QAA1B,EAAoC,UAApC;aACW1f,cAAX,CAA0B6R,WAA1B,EAAuC,aAAvC;aACW7R,cAAX,CAA0B2f,IAA1B,EAAgC,MAAhC;;MAEME,gBALuD;;;;;YAf5D;iBAAQ,KAAK5gB,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,wBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;8BAqBrCxB,KAAZ,EAAmB;;;qIACXA,KADW;;YAEZ+C,KAAL,GAAa,EAAb;YACK4f,YAAL,GAAoB,MAAKC,cAAL,CAAoBhP,IAApB,OAApB;YACKiP,UAAL,GAAkB,MAAKC,WAAL,EAAlB;YACKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBnjB,IAAjB,OAAnB;YACKojB,MAAL,GAAc,MAAKC,eAAL,EAAd;YACKjjB,KAAL,CAAWoD,SAAX,CAAqBC,QAArB,GAAgC,YAAM;eAC7B,MAAKH,aAAL,EAAP;OADF;YAGKggB,MAAL,GAAc,MAAKA,MAAL,CAAYtjB,IAAZ,OAAd;;;;;;sCAEc;eACP,IAAI0E,SAAJ,CAAqB,IAArB,EAA2B3E,GAA3B,EAAP;;;;iCAES;eACF,CAAC,CAAC,KAAKK,KAAL,CAAWmjB,UAAb,IAA2B,aAAlC;;;;wCAEgB;eACTZ,SAASU,eAAT,CAAyB,KAAKjjB,KAAL,CAAW+D,IAAX,CAAgBoN,QAAzC,CAAP;;;;uCAEe;aACV,IAAI2E,IAAI,CAAb,EAAgBA,IAAI2M,SAASviB,MAA7B,EAAqC4V,GAArC,EAA0C;cACpC2M,SAAS3M,CAAT,EAAYpN,EAAZ,CAAe5D,IAAf,CAAoB,KAAK9E,KAAL,CAAW+D,IAAX,CAAgBoN,QAApC,CAAJ,EAAmD;mBAC1CsR,SAAS3M,CAAT,CAAP;;;;;;oCAIQ;eACLyM,SAASa,QAAT,CAAkB,KAAKpjB,KAAL,CAAW+D,IAAX,CAAgBoN,QAAlC,CAAP;;;;0CAEkB;;;aACbxN,QAAL,GAAgB,IAAhB;YACI,KAAK3D,KAAL,CAAWmjB,UAAX,IAAyB,CAAC,KAAKnjB,KAAL,CAAWqjB,OAAzC,EAAkD;eAC3CN,WAAL,CAAiB,KAAK/iB,KAAL,CAAWmjB,UAA5B;;YAEE,KAAKnjB,KAAL,CAAWmjB,UAAX,KAA0B,KAAKnjB,KAAL,CAAW8D,KAAzC,EAAgD;;qBAEnC,YAAM;gBACX,OAAKH,QAAT,EACE,OAAK3D,KAAL,CAAWiD,YAAX,oBACG,OAAKjD,KAAL,CAAWwB,IADd,EACqB,OAAKxB,KAAL,CAAWmjB,UADhC;WAFJ,EAKG,CALH;;;;;6CAQmB;aAChBxf,QAAL,GAAgB,KAAhB;;;;kCAEU+E,EAvD+C,EAuD3C;aACT1I,KAAL,CAAWsjB,UAAX,CACE5a,EADF,EAEE,KAAK1I,KAAL,CAAW6D,aAFb,EAGE,KAAK7D,KAAL,CAAW+D,IAAX,CAAgBoN,QAHlB,EAIE,KAAK6R,MAJP;;;;gDAQwBpf,IAhEiC,EAgE3B;YAE5BA,KAAKuf,UAAL,KAAoB,KAAKnjB,KAAL,CAAWmjB,UAA/B,IACAvf,KAAKC,aAAL,KAAuB,KAAK7D,KAAL,CAAW6D,aADlC,IAEAD,KAAKuf,UAAL,KAAoBvf,KAAKE,KAH3B,EAIE;cAEEF,KAAKuf,UAAL,KACC,CAACvf,KAAKyf,OAAN,IAAiBzf,KAAKuf,UAAL,KAAoB,KAAKnjB,KAAL,CAAWmjB,UADjD,CADF,EAIE,KAAKJ,WAAL,CAAiBnf,KAAKuf,UAAtB;eACGnjB,KAAL,CAAWiD,YAAX,oBACG,KAAKjD,KAAL,CAAWwB,IADd,EACqBoC,KAAKuf,UAD1B;;;;;6BAKG1R,IAhFoD,EAgF9C;aACNzR,KAAL,CAAWkjB,MAAX,CAAkBzR,IAAlB,EAAwB,KAAKzR,KAAL,CAAW6D,aAAnC;;;;iDAEO;aACR7D,KAAL,CAAWkC,GAAX,wBAAoC,KAAKlC,KAAL,CAAWwB,IAA/C;YACU,KAAKxB,KAAL,CAAWkV,IAAf,EAAqB,OAAO3S,6BAAC,WAAD,OAAP;YACjB,CAAC,KAAKsgB,UAAV,EACE,OAAOtgB,6BAAC,IAAD,IAAM,SAAS,8BAAf,GAAP;eAEAA,6BAAC,QAAD;eACO,KAAKvC,KAAL,CAAW6D,aADlB;iBAES,KAAK7D,KAAL,CAAW6F,KAFpB;uBAGe,KAAK7F,KAAL,CAAWwQ,WAH1B;kBAIU,KAAK0S,MAJf;yBAKiB,KAAKljB,KAAL,CAAW6D,aAL5B;mBAMW,KAAK7D,KAAL,CAAW+D,IAAX,CAAgBoN,QAN3B;uBAOe,KAAKwR,YAPpB;mBAQW,KAAK3iB,KAAL,CAAWqjB,OARtB;kBASU,KAAKtgB,KAAL,CAAW3B,MATrB;oBAUY,KAAKpB,KAAL,CAAW8F;UAXzB;;;;IAnF2BpE,eAL8B;;MAyGvDyQ,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;UAC5DxO,gBAAgBmD,OAAOjE,KAAP,EAAcsP,SAASxO,aAAvB,EAAsCwO,QAAtC,CAApB;UACI8E,KAAKpU,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,aAAlB,KAAoC,EAA7C;aACO;oCAAA;iBAEIsT,GAAGkM,OAFP;cAGClM,GAAGjC,IAHJ;kBAIK7C,SAAStO,IAAT,IAAiBsO,SAAStO,IAAT,CAAc+B,QAJpC;oBAKOqR,GAAGgM,UAAH,IAAiB9Q,SAASvO;OALxC;KAHsB;GAAxB;MAWM+O,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;cACG,gBAACpB,IAAD,EAAO3K,GAAP;eAAe0E,SAASgG,iBAAiBC,IAAjB,EAAuB3K,GAAvB,CAAT,CAAf;OADH;kBAEO,oBAAC4B,EAAD,EAAK5B,GAAL,EAAUqK,QAAV,EAAoBC,KAApB;eACV5F,SAAS0F,qBAAqBxI,EAArB,EAAyB5B,GAAzB,EAA8BqK,QAA9B,EAAwCC,KAAxC,CAAT,CADU;;KAFd;GADF;;SAQO8B,mBACLf,eADK,EAELU,kBAFK,EAGL1M,aAAWuc,gBAAX,CAHK,CAAP;CA5HF;;;;ACfA,AAOA,yBAAe,UACbtN,MADa,EAEbV,WAFa,EAGb6O,MAHa,EAIbC,eAJa,EAKbC,gBALa,EAMV;aACQ5gB,cAAX,CAA0B0gB,MAA1B,EAAkC,QAAlC;aACW1gB,cAAX,CAA0B2gB,eAA1B,EAA2C,iBAA3C;aACW3gB,cAAX,CAA0B4gB,gBAA1B,EAA4C,kBAA5C;aACW5gB,cAAX,CAA0B6R,WAA1B,EAAuC,aAAvC;aACW7R,cAAX,CAA0BuS,MAA1B,EAAkC,QAAlC;;MAEMvC,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;WACA,aAACnK,EAAD,EAAK3E,IAAL,EAAW+C,GAAX;eACH0E,SAASmC,mBAAmBjF,EAAnB,EAAuB3E,IAAvB,EAA6B+C,GAA7B,EAAkC,EAAEuI,cAAc,IAAhB,EAAlC,CAAT,CADG;OADA;;;;;;;;;;;QAGQ;eAAW7D,SAASc,YAAYlB,OAAZ,CAAT,CAAX;OAAb;KAHF;GADF;MAOM+G,kBAAkB,SAAlBA,eAAkB,CAAClJ,IAAD,EAAImJ,YAAJ;WAAqB,UAACrP,KAAD,EAAQsP,QAAR,EAAqB;UAC5DxO,gBAAgBmD,OAAOjE,KAAP,EAAcsP,SAASxO,aAAvB,EAAsCwO,QAAtC,CAApB;UACEqR,eAAe3gB,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,aAAlB,CADjB;aAEO;kBACK6f,iBAAiBA,aAAaC,EAAb,IAAmBD,YAApC,CADL;oBAEOA,gBAAgBA,aAAarW,IAFpC;cAGC,CAAC,CAACtK,MAAMwG,MAAN,CAAagH,IAAb,CAAkB1M,gBAAgB,OAAlC,CAHH;;OAAP;KAHsB;GAAxB;MAUM0a,eAAe,YAArB;MACMqF,kBAAkB,eAAxB;;MACMC,gBA1BH;;;;;YAbF;iBAAQ,KAAK/hB,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,wBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;8BAwCrCxB,KAAZ,EAAmB;;;qIACXA,KADW;;YAEZ+C,KAAL,GAAa,EAAE2d,kBAAkB,EAApB,EAAwBtd,WAAW,EAAnC,EAAb;YACKoB,MAAL,GAAc,MAAKA,MAAL,CAAY5E,IAAZ,OAAd;YACKqD,YAAL,GAAoB,MAAKA,YAAL,CAAkBrD,IAAlB,OAApB;YACKkkB,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBlkB,IAAxB,OAA1B;;;;;;gDAEwBgE,IAlCzB,EAkC+B;YAC1B,CAACqF,EAAEC,OAAF,CAAUtF,KAAKmgB,UAAf,EAA2B,KAAK/jB,KAAL,CAAW+jB,UAAtC,CAAL,EAAwD;eACjD9gB,YAAL,oBAAqB2gB,eAArB,EAAuChgB,KAAKmgB,UAA5C;;;;;+BAGK;;;aACFhhB,KAAL,CAAW2d,gBAAX,CAA4Brd,QAA5B,GAAuC8J,IAAvC,CACE,YAAM;qBAEF,OAAKnN,KAAL,CAAW8D,KAAX,IAAoB,EAFlB;cACqBkgB,YADrB,QACGJ,eADH;cACsCtG,IADtC,kCACGsG,eADH;;iBAGC5jB,KAAL,CAAWL,GAAX,CACE,OAAKK,KAAL,CAAW+D,IAAX,CAAgBwD,MADlB,EAEE+V,IAFF,EAGE,OAAKtd,KAAL,CAAW6D,aAHb;SAJJ,EAUE,YAAM;iBACC7D,KAAL,CAAWkC,GAAX,CAAe,8BAAf;SAXJ;;;;yCAeiB4B,KAvDlB,EAuDyB;aACnBb,YAAL,CAAkBa,SAASA,MAAMya,YAAN,CAA3B;;;;sCAEWza,KA1DZ,EA0DmB;aACb9D,KAAL,CAAWkC,GAAX,mCAA+C4B,KAA/C;aACK9D,KAAL,CAAWiD,YAAX,oBACG,KAAKjD,KAAL,CAAWwB,IADd,EACqBuG,OAAOpC,MAAP,CACjB,EADiB,EAEjB,KAAK3F,KAAL,CAAW8D,KAAX,IAAoB,EAFH,EAGjBA,SAAS,EAHQ,CADrB;;;;iDAQO;aACF9D,KAAL,CAAWkC,GAAX,CAAe,WAAf;YACI,KAAKlC,KAAL,CAAWkV,IAAf,EAAqB,OAAO3S,6BAAC,WAAD,OAAP;;oBAEnB,KAAKvC,KAAL,CAAW8D,KAAX,IAAoB,EAJf;0CAGA8f,eAHA;YAGkBI,YAHlB,yCAGiC,EAHjC;YAGwC1G,IAHxC,mCAGAsG,eAHA;;eAMLrhB;gBAAA;;;kBACE;;2BACe,KAAKvC,KAAL,CAAW+D,IAAX,CAAgBkgB,WAD/B;sBAEU,KAAKzf;;yCAEZ,eAAD;wBACY,KAAKxE,KAAL,CAAW+D,IAAX,CAAgByO,QAD5B;qBAES8K,IAFT;oBAGQiB,YAHR;yBAIa,KAAKxb,KAAL,CAAW2d,gBAJxB;4BAKgB,KAAKoD,kBALrB;0BAMc,KAAK9jB,KAAL,CAAWwJ,UANzB;8BAOkB,KAAKxJ,KAAL,CAAWuS,cAP7B;2BAQe,KAAKvS,KAAL,CAAWqQ;;WAb9B;uCAgBG,gBAAD;kBACQuT,eADR;sBAEY,KAAK5jB,KAAL,CAAWkkB,QAFvB;mBAGSF,YAHT;uBAIa,KAAKjhB,KAAL,CAAWK,SAJxB;0BAKgB,KAAKH,YALrB;wBAMc,KAAKjD,KAAL,CAAWwJ,UANzB;4BAOkB,KAAKxJ,KAAL,CAAWuS,cAP7B;yBAQe,KAAKvS,KAAL,CAAWqQ;;SAzB9B;;;;IA/C2B9N,eAAMb,SA1BlC;;SAyGIwR,mBACLf,eADK,EAELU,kBAFK,EAGL1M,aAAW0d,gBAAX,CAHK,CAAP;CA/GF;;;;ACPA,AAEA,oBAAe,iBAAS;YACZhhB,cAAX,CAA0BshB,KAA1B,EAAiC,OAAjC;QACO;MAJL;OAKKrgB,MALL,GAKqC9D,KALrC,CAKK8D,KALL;OAKY0M,YALZ,GAKqCxQ,KALrC,CAKYwQ,WALZ;OAK4B8M,KAL5B,2BAKqCtd,KALrC;;OAMG8D,MAAJ,EAAW;WACMvB,6BAAC,KAAD,aAAO,aAAauB,MAApB,IAA+BwZ,KAA/B,EAAP;;UAEH/a,6BAAC,KAAD,EAAWvC,KAAX,CAAP;GATF,CAAK,OAAM+B,CAAN,EAAQ;UAAQC,wBAAqBD,CAArB,CAAP;;EAIb;CAFD;;;;ACFA,AAEA,sBAAe,UAACqiB,OAAD,EAAU5B,IAAV,EAAmB;;;;;;YAF/B;iBAAQ,KAAK1gB,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,wBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;2BAIrCxB,KAAZ,EAAmB;;0HACXA,KADW;;;;;iDAGV;YACH,KAAKA,KAAL,CAAW+D,IAAX,IAAmB,KAAK/D,KAAL,CAAW+D,IAAX,CAAgBsgB,GAAvC,EAA4C;iBACnC9hB,6BAAC,OAAD,IAAS,KAAK,KAAKvC,KAAL,CAAW+D,IAAX,CAAgBsgB,GAA9B,GAAP;SADF,MAEO;iBACE9hB;gBAAA;;;WAAP;;;;;IAR6B+hB,mBAAnC;CADF;;;;ACFA,AAMA,sBAAe,UAACnI,IAAD,EAAOoI,qBAAP,EAAiC;aACnC1hB,cAAX,CAA0BsZ,IAA1B,EAAgC,MAAhC;;MAEME,qBAAqB,SAArBA,kBAAqB,WAAY;WAC9B;;KAAP;GADF;;MAKMmI,aARwC;;;;;YAN7C;iBAAQ,KAAK1iB,wBAAL,EAAP;SAAJ,CAA4C,OAAMC,CAAN,EAAQ;iBAAQC,wBAAqBD,CAArB,EAAwB,KAAKE,WAAL,CAAiBT,IAAzC,CAAP;;;;;2BAerCxB,KAAZ,EAAmB;;;+HACXA,KADW;;YAEZwc,EAAL,GAAU,MAAKA,EAAL,CAAQ5c,IAAR,OAAV;YACKD,GAAL,GAAW,MAAKA,GAAL,CAASC,IAAT,OAAX;;;;;;4BAEI;aACCI,KAAL,CAAWwL,QAAX,CACEmC,mBACE,KAAK3N,KAAL,CAAW+D,IAAX,CAAgB0gB,gBADlB,EAEG,KAAKzkB,KAAL,CAAW+D,IAAX,CAAgB2gB,oBAAhB,IACC9d,KAAKiC,KAAL,CAAW,KAAK7I,KAAL,CAAW+D,IAAX,CAAgB2gB,oBAA3B,CADF,IAEE,EAJJ,EAKE,KAAK1kB,KAAL,CAAW6D,aALb,CADF;;;;2BAUG;gBACK,KAAK7D,KAAL,CAAW+D,IAAX,CAAgB4b,WAAxB;eACO6E,cAAcG,YAAd,CAA2BC,QAAhC;gBACM,CAAC,KAAK5kB,KAAL,CAAW+D,IAAX,CAAgB2gB,oBAArB,EAA2C;oBACnC,IAAIjjB,KAAJ,CAAU,iCAAV,CAAN;;gBAEE4iB,YAAJ;gBACI;kBACErgB,YAAS4C,KAAKiC,KAAL,CAAW,KAAK7I,KAAL,CAAW+D,IAAX,CAAgB2gB,oBAA3B,CAAb;oBACMlY,kBAAkB+Q,OAAlB,CAA0B,KAA1B,EAAiCvZ,UAAO0E,EAAxC,CAAN;kBACI1E,UAAO6gB,YAAX,EAAyBR,iBAAergB,UAAO6gB,YAAtB;kBACrB7gB,UAAO8gB,WAAX,EACET,QAAUA,IAAI/P,OAAJ,CAAY,GAAZ,KAAoB,CAAC,CAArB,GAAyB,GAAzB,GAA+B,GAAzC;aALJ,CAME,OAAOvS,CAAP,EAAU;oBACJ,IAAIN,KAAJ,CAAU,iCAAV,CAAN;;iBAEGzB,KAAL,CAAWwL,QAAX,CAAoB+Y,sBAAsB,KAAKvkB,KAAL,CAAW+D,IAAjC,EAAuCsgB,GAAvC,CAApB;;;iBAGK1kB,GAAL;;;;;;iDAIG;;;uCAGJ,IAAD;kBACQ,KAAKK,KAAL,CAAW+D,IAAX,CAAgBkgB,WADxB;kBAEQ,KAAKjkB,KAAL,CAAW+D,IAAX,CAAgBghB,WAFxB;gBAGM,KAAKvI;;;;;;;;IA9CW9a,eARkB;;gBA4DhCijB,YAAd,GAA6B,EAAEK,SAAS,SAAX,EAAsBJ,UAAU,UAAhC,EAA7B;SACO1R,mBACL,IADK,EAELmJ,kBAFK,EAGLlW,aAAWqe,aAAX,CAHK,CAAP;CA7DF;;ACaA,iBAAe;2BAAA;yBAAA;mCAAA;+BAAA;+BAAA;6BAAA;mCAAA;yBAAA;4BAAA;uBAAA;yBAAA;2BAAA;qCAAA;qCAAA;iCAAA;2BAAA;+BAAA;;CAAf;;AClBA,IAAMS,aAAa;QACXC,WAAWC,YADA;OAEZD,WAAWjS,WAFC;YAGPiS,WAAWE,gBAHJ;UAITF,WAAWG,cAJF;UAKTH,WAAWI,cALF;SAMVJ,WAAWK,aAND;YAOPL,WAAWM,gBAPJ;OAQZN,WAAWO,WARC;SASVP,WAAWQ,aATD;MAUbR,WAAWS,UAVE;QAWXT,WAAWU,YAXA;OAYZV,WAAWW,WAZC;aAaNX,WAAWY,iBAbL;aAcNZ,WAAWa,iBAdL;WAeRb,WAAWc,eAfH;QAgBXd,WAAWe,YAhBA;UAiBTf,WAAWgB,cAjBF;YAkBPhB,WAAWiB,gBAlBJ;UAmBTjB,WAAWkB,cAnBF;UAoBT,EApBS;cAqBL,EArBK;iBAAA,4BAsBDC,YAtBC,EAsBa;;;SACvB,mBAAW;OACbC,gBAAJ;OACID,YAAJ,EACCC,UAAUD,aAAa3mB,OAAb,SAA4B,MAAK6mB,WAAjC,CAAV;OACG,CAACD,OAAL,EAAc;QACT5mB,QAAQ+U,GAAZ,EAAiB;SACZ,MAAK/U,QAAQ+U,GAAb,CAAJ,EAAuB,OAAO,MAAK/U,QAAQ+U,GAAb,CAAP;SACnB+R,QAAQ9mB,QAAQ+U,GAAR,CAAYgS,WAAZ,EAAZ;SACI,MAAKD,KAAL,CAAJ,EAAiB,OAAO,MAAKA,KAAL,CAAP;;WAEX,MAAK9mB,QAAQ8U,WAAb,CAAP;;UAEM8R,OAAP;GAZD;EAvBiB;KAAA,gBAsCb9kB,IAtCa,EAsCPklB,MAtCO,EAsCCC,UAtCD,EAsCa;;;MAC1BnlB,QAAQklB,MAAZ,EAAoB;OACf,CAAC/S,MAAMhS,SAAN,CAAgBC,aAAhB,CAA8B8kB,MAA9B,CAAL,EAA4C;UACrC,IAAIjlB,KAAJ,CAAU,yBAAV,CAAN;;OAEG,CAAC,KAAK8kB,WAAL,CAAiB/kB,IAAjB,CAAL,EACC,MAAM,IAAIC,KAAJ,CAAU,yCAAV,CAAN;OACGD,QAAQmlB,UAAZ,EAAwB;YACfC,IAAR,CAAa,0CAAb;;;OAGGC,SAAS,KAAKN,WAAL,CAAiB/kB,IAAjB,EAAuB8X,KAAvB,CAA6B,IAA7B,EAAmCoN,MAAnC,CAAb;OACIC,UAAJ,EAAgB,KAAKA,UAAL,IAAmBE,MAAnB;UACTA,MAAP;;;MAGG,CAAC,KAAKC,OAAV,EAAmB;QACbA,OAAL,GAAe,IAAf;UACOzc,IAAP,CAAY,KAAK0c,OAAjB,EAA0B7e,OAA1B,CAAkC,kBAAU;WACtCqe,WAAL,CAAiBG,MAAjB,IAA2B,OAAKA,MAAL,CAA3B;WACKA,MAAL,IAAe,OAAKA,MAAL,EAAapN,KAAb,CAAmB,IAAnB,EAAyB,OAAKyN,OAAL,CAAaL,MAAb,CAAzB,CAAf;IAFD;;SAKM,IAAP;;CA7DF;;ACIe,mBAA6B;;;KAApB3jB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;SACnCA,OAAO9B,IAAf;OACM+B,QAAQiG,UAAb;UACQ1F,OAAOpC,MAAP,CAAc5C,KAAd,qBAAwBwE,OAAOK,OAA/B,EAAyC,IAAzC,EAAP;OACIJ,QAAQ0D,sBAAb;UACQnD,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB;uBACZwE,OAAOK;IADpB,CAAP;OAGIJ,QAAQwD,yBAAb;UACQjI,MAAMuZ,iBAAb;UACOvU,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,CAAP;OACIyE,QAAQoB,WAAb;UACQ,EAAP;OACIpB,QAAQuJ,qBAAb;UACQhJ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLiU,WAAWzP,OAAOmE,IAAlB,CADK,EACqB,KADrB,EAAP;;OAIIlE,QAAQQ,aAAb;OACKsK,SAAS/K,OAAOK,OAAP,CAAevH,MAAf,CACZ,UAACoY,GAAD,EAAMhU,CAAN,EAAY;QACP1B,MAAM0B,EAAEgE,MAAF,CAASC,EAAf,CAAJ,EAAwB;SACnBjE,EAAEgE,MAAF,CAASC,EAAb,IAAmB3F,MAAM0B,EAAEgE,MAAF,CAASC,EAAf,CAAnB;;WAEM+P,GAAP;IALW,EAOZ;uBACoB1V,MAAMuZ,iBAD1B;aAEUvZ,MAAMqI;IATJ,CAAb;UAYOkH,MAAP;OACI9K,QAAQY,yBAAb;;;;;OAMEb,OAAOK,OAAP,CAAeS,IAAf,CAAoBvB,GAApB,IAA2B,QAA3B,IACAS,OAAOK,OAAP,CAAeS,IAAf,CAAoBE,UAApB,IAAkC,QAFnC,EAGE;;;QAGG+J,UAASvP,MAAMwE,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CAA2BC,EAAjC,CAAb;QACC2H,cAAeiC,WAAUA,QAAOjC,WAAlB,IAAkC,CADjD;QAGC9I,OAAOK,OAAP,CAAeof,UAAf,CAA0Bzf,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CAA2BC,EAArD,KACAnB,OAAOK,OAAP,CAAeof,UAAf,CACCzf,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CAA2BC,EAD5B,EAEE,CAFF,KAEQ,CAJT,EAKE;YACMX,OAAOpC,MAAP,CACN,EADM;;YAGC0E,IAAP,CAAYtH,KAAZ,EAAmB1C,MAAnB,CAA0B,UAACoY,GAAD,EAAMhU,CAAN,EAAY;UACjCqC,MAAMiP,WAAWtR,CAAX,CAAV;UAEC,CAACqC,GAAD,IACCA,OACAA,IAAImP,IAAJ,KAAa5F,WADb,IAEAvJ,IAAIoP,OAAJ,KACC3O,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CAA2BC,EAL9B,EAOC+P,IAAIhU,CAAJ,IAAS1B,MAAM0B,CAAN,CAAT;aACMgU,GAAP;MAVD,EAWG,EAXH,CAHM,qBAgBJlR,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CAA2BC,EAhBvB,EAgB4B,IAhB5B,EAAP;;QAqBA4J,WACA,OAAO/K,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CAA2B4H,WAAlC,KACC,WAHF,EAIE;;;;aAIMA,WAAP,GAAqBiC,QAAOjC,WAAP,GAAqB,CAArB,IAA0B,CAA/C;aACOG,WAAP,CAAmBC,KAAnB,GAA2B6B,QAAO9B,WAAP,CAAmBC,KAAnB,CAAyBxI,KAAzB,EAA3B;aACOuI,WAAP,CAAmBC,KAAnB,CAAyBnI,GAAzB;YACOP,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CACCC,EAFI,EAECX,OAAOpC,MAAP,CAAc,EAAd,EAAkB2M,WAAU,EAA5B,qBACL/K,OAAOK,OAAP,CAAeS,IAAf,CAAoBI,MAApB,CAA2B4H,WADtB,EACoC,IADpC,EAFD,EAAP;;;UAQKtN,KAAP;OACIyE,QAAQ8I,kBAAb;OACK/I,OAAO9G,KAAP,IAAgB,CAAC8G,OAAOK,OAA5B,EAAqC;WAC7B7E,KAAP;;OAEGkkB,OAAOlkB,MAAMwE,OAAOK,OAAP,CAAec,EAArB,CAAX;OACCA,KAAKnB,OAAOK,OAAP,CAAec,EADrB;OAEC2E,OAAO9F,OAAOK,OAAP,CAAeyF,IAFvB;OAGC6Z,eAAe;iBACDD,KAAK5W,WAAL,IAAoB;IAJnC;OAMC6E,OAAO,KANR;OAOC1E,cAAcyW,KAAKzW,WAPpB;OASExM,OAAOgJ,UAAP,IACAzF,OAAOK,OAAP,CAAeyF,IADf,IAEA9F,OAAOK,OAAP,CAAeyF,IAAf,CAAoBxB,MAApB,IAA8B,WAF/B,IAGC,CAAC7H,OAAOgJ,UAAR,KACCwD,YAAYC,KAAZ,CAAkBvQ,MAAlB,IAA4B,CAA5B,IACAgnB,aAAa7W,WAAb,GAA2B,CAA3B,GACCG,YAAYC,KAAZ,CAAkBvQ,MAAlB,GAA2B,CAH7B,CAJF,EAQE;;;WACM6H,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,yDACL2F,EADK,EACA;gBACM;KAFN,mCAILsO,WAAWtO,EAAX,CAJK,EAIY,KAJZ,8CAKI,QAAO2E,IAAP,yCAAOA,IAAP,MAAe,QAAf,IAA2BA,KAAKjC,OAAjC,IAA6C,IALhD,oBAAP;;;gBASY4F,UAAb,GAA0B3D,OAAOA,KAAK8Z,WAAZ,GAA0B,IAApD;OACInjB,OAAOgJ,UAAP,IAAqBwD,YAAYE,yBAArC,EACCF,YAAYC,KAAZ,CAAkB,CAAlB,IAAuBpD,KAAK+Z,SAA5B,CADD,KAEK;QACApjB,OAAOgJ,UAAX,EAAuB;SAErBwD,YAAYC,KAAZ,CAAkBvQ,MAAlB,IACAgnB,aAAa7W,WAAb,GAA2B,CAF5B,EAGE;kBACWI,KAAZ,CAAkBpP,IAAlB,CAAuBgM,KAAK+Z,SAA5B;;;iBAGW/W,WAAb,GAA2B6W,aAAa7W,WAAb,GAA2B,CAAtD;;gBAEY6W,aAAa7W,WAA1B,IACC,QAAOhD,IAAP,yCAAOA,IAAP,MAAe,QAAf,IACAiJ,QAAOjJ,KAAKjC,OAAZ,KAAuB,QADvB,IAEAiC,KAAKjC,OAHN;UAIOrD,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,yDACL2F,EADK,EACAX,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,MAAM2F,EAAN,CAAlB,EAA6Bwe,YAA7B,CADA,mCAELlQ,WAAWtO,EAAX,CAFK,EAEYwM,IAFZ,oBAAP;;OAKI1N,QAAQoG,aAAb;UACQ7F,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IAAP,CAAY5E,GADP,EACagX,aAAa/a,MAAMwE,OAAOmE,IAAP,CAAY5E,GAAlB,CAAb,EAAqCS,MAArC,CADb,EAAP;OAGIC,QAAQwG,aAAb;UACQjG,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgBugB,aACrBtkB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CADqB,EAErBS,MAFqB,CADhB,EAAP;OAMIC,QAAQkH,wBAAb;UACQ3G,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IAAP,CAAY5E,GADP,EACa2H,uBAClB1L,MAAMwE,OAAOmE,IAAP,CAAY5E,GAAlB,CADkB,EAElBS,MAFkB,CADb,EAAP;;OAOIC,QAAQmH,wBAAb;UACQ5G,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgBwgB,qBACrBvkB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CADqB,EAErBS,MAFqB,CADhB,EAAP;OAMIC,QAAQoH,wCAAb;UACQ7G,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgBygB,mCACrBxkB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CADqB,EAErBS,MAFqB,CADhB,EAAP;OAMIC,QAAQsG,yBAAb;UACQ/F,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACSqS,kBAAkBhb,MAAMwE,OAAOmE,IAAb,CAAlB,CADT,EAAP;;OAIIlE,QAAQqG,wBAAb;UACQ9F,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgB0gB,WACrBzkB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CADqB,EAErBS,MAFqB,CADhB,EAAP;;OAOIC,QAAQ2I,sBAAb;UACQpI,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLiU,WAAWzP,OAAOmE,IAAP,CAAYhD,EAAvB,CADK,EACwB,CAACnB,OAAO9G,KADhC,oCAEL8G,OAAOmE,IAAP,CAAYhD,EAFP,EAEYX,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,MAAMwE,OAAOmE,IAAP,CAAYhD,EAAlB,CAAlB,qBAChB3F,MAAMwE,OAAOmE,IAAP,CAAYhD,EAAlB,EAAsB2H,WAAtB,IAAqC,CADrB,EACyB9I,OAAOmE,IAAP,CAAY0E,IADrC,EAFZ,qBAAP;OAMI5I,QAAQ8D,aAAb;UACQvD,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAec,EADV,EACeX,OAAOpC,MAAP,CACpB,EADoB,EAEpB5C,MAAMwE,OAAOK,OAAP,CAAec,EAArB,CAFoB,qBAIlB3F,MAAMwE,OAAOK,OAAP,CAAec,EAArB,EAAyB2H,WAAzB,IAAwC,CAJtB,EAI0B9I,OAC3CK,OAD2C,CACnCwI,IALS,EADf,EAAP;OAUI5I,QAAQiI,oBAAb;UACQ1H,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLwE,OAAOK,OAAP,CAAed,GADV,EACgBS,OAAOK,OAAP,CAAeyF,IAD/B,oCAEL2J,WAAWzP,OAAOK,OAAP,CAAed,GAA1B,CAFK,EAE4B,KAF5B,oCAGLmQ,YAAY1P,OAAOK,OAAP,CAAed,GAA3B,CAHK,EAG6B,CAAC,CAACS,OAAO9G,KAHtC,qBAAP;;OAMI+G,QAAQsI,wBAAb;UACQ/H,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLiU,WAAWzP,OAAOmE,IAAP,CAAY5E,GAAvB,CADK,EACyB,CAACS,OAAO9G,KADjC,oCAELwW,YAAY1P,OAAOmE,IAAP,CAAY5E,GAAxB,CAFK,EAE0B,CAAC,CAACS,OAAO9G,KAFnC,qBAAP;OAII+G,QAAQuI,uBAAb;UACQhI,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLiU,WAAWzP,OAAOmE,IAAlB,CADK,EACqB,KADrB,oCAELnE,OAAOmE,IAFF,EAES,IAFT,oCAGLuL,YAAY1P,OAAOmE,IAAnB,CAHK,EAGsB,IAHtB,qBAAP;OAKIlE,QAAQqF,eAAb;OACK4a,eAAe1f,OAAOpC,MAAP,CAAc,EAAd,EAAkB4B,OAAOK,OAAP,CAAeyF,IAAf,CAAoBA,IAAtC,CAAnB;OACIqa,qBAAqB3f,OAAOpC,MAAP,CACxB,EADwB,EAExB4B,OAAOK,OAAP,CAAeyF,IAAf,CAAoBmD,WAFI,CAAzB;UAIOzI,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLwE,OAAOK,OAAP,CAAec,EADV,EACe;iBACPgf,kBADO;OAEjBD;IAHE,yDAMa1kB,MAAMuZ,iBANnB,qDAOSvZ,MAAMwX,aAAN,IAAuB,EAPhC,oCAQLvD,WAAWzP,OAAOK,OAAP,CAAec,EAA1B,CARK,EAQ2B,KAR3B,oCASLuO,YAAY1P,OAAOK,OAAP,CAAec,EAA3B,CATK,EAS4BnB,OAAO9G,KATnC,qBAAP;OAWI+G,QAAQyF,gBAAb;UACQlF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLiU,WAAWzP,OAAOmE,IAAlB,CADK,EACqB,CAACnE,OAAO9G,KAD7B,oCAELwW,YAAY1P,OAAOmE,IAAnB,CAFK,EAEsB,CAAC,CAACnE,OAAO9G,KAF/B,qBAAP;OAII+G,QAAQ+F,uBAAb;UACQxF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLwE,OAAOmE,IADF,EACS,IADT,yDAGa3I,MAAMuZ,iBAHnB,oCAILtF,WAAWzP,OAAOmE,IAAlB,CAJK,EAIqB,KAJrB,oCAKLuL,YAAY1P,OAAOmE,IAAnB,CALK,EAKsB,IALtB,qBAAP;OAOIlE,QAAQqK,iBAAb;UACQ9J,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACSic,YAAY5kB,MAAMwE,OAAOmE,IAAb,CAAZ,EAAgCnE,MAAhC,CADT,EAAP;OAGIC,QAAQsK,aAAb;UACQ/J,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgB8gB,WACrB7kB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CADqB,EAErBS,MAFqB,CADhB,EAAP;OAMIC,QAAQuK,kBAAb;UACQhK,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACSmc,aAAa9kB,MAAMwE,OAAOmE,IAAb,CAAb,EAAiCnE,MAAjC,CADT,EAAP;OAGIC,QAAQ6J,WAAb;UACQtJ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACS4X,WAAWvgB,MAAMwE,OAAOmE,IAAb,CAAX,EAA+BnE,MAA/B,CADT,EAAP;OAGIC,QAAQ8J,WAAb;UACQvJ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgBghB,WACrB/kB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CADqB,EAErBS,MAFqB,CADhB,EAAP;OAMIC,QAAQ+J,qBAAb;UACQxJ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACSqc,mBAAmBhlB,MAAMwE,OAAOmE,IAAb,CAAnB,EAAuCnE,MAAvC,CADT,EAAP;OAGIC,QAAQ0G,iBAAb;UACQnG,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IAAP,CAAY5E,GADP,EACakhB,YAClB,iBADkB,EAElBjlB,MAAMwE,OAAOmE,IAAP,CAAY5E,GAAlB,CAFkB,EAGlBS,MAHkB,CADb,EAAP;OAOIC,QAAQ2G,iBAAb;UACQpG,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgBmhB,YACrB,iBADqB,EAErB,cAFqB,EAGrBllB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CAHqB,EAIrBS,MAJqB,CADhB,EAAP;OAQIC,QAAQ4G,2BAAb;UACQrG,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACSwc,oBACd,iBADc,EAEdnlB,MAAMwE,OAAOmE,IAAb,CAFc,EAGdnE,MAHc,CADT,EAAP;OAOIC,QAAQ8G,mBAAb;UACQvG,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IAAP,CAAY5E,GADP,EACakhB,YAClB,uBADkB,EAElBjlB,MAAMwE,OAAOmE,IAAP,CAAY5E,GAAlB,CAFkB,EAGlBS,MAHkB,CADb,EAAP;OAOIC,QAAQ+G,mBAAb;OACKhH,OAAO9G,KAAX,EAAkB;WACVsH,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACSwc,oBACd,uBADc,EAEdnlB,MAAMwE,OAAOmE,IAAb,CAFc,EAGdnE,MAHc,CADT,EAAP;;UAQMQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOK,OAAP,CAAed,GADV,EACgBmhB,YACrB,uBADqB,EAErB,gBAFqB,EAGrBllB,MAAMwE,OAAOK,OAAP,CAAed,GAArB,CAHqB,EAIrBS,MAJqB,CADhB,EAAP;OAQIC,QAAQgH,6BAAb;UACQzG,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBACLwE,OAAOmE,IADF,EACSwc,oBACd,uBADc,EAEdnlB,MAAMwE,OAAOmE,IAAb,CAFc,EAGdnE,MAHc,CADT,EAAP;;UAQOxE,KAAP;;;;AAIH,SAASilB,WAAT,CAAqBG,aAArB,EAAwD;;;KAApBplB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAChDQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLolB,aADK,EACW,CAAC5gB,OAAO9G,KADnB,oCAELwW,YAAYkR,aAAZ,CAFK,EAEwB5gB,OAAO9G,KAF/B,qBAAP;;AAKD,SAASwnB,WAAT,CAAqBE,aAArB,EAAoCC,QAApC,EAAkE;;;KAApBrlB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAC1DQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,2DACLqlB,QADK,EACM7gB,OAAOK,OAAP,CAAeyF,IADrB,oCAEL8a,aAFK,EAEW,KAFX,oCAGLlR,YAAYkR,aAAZ,CAHK,EAGwB5gB,OAAO9G,KAH/B,qBAAP;;AAMD,SAASynB,mBAAT,CAA6BC,aAA7B,EAAgE;KAApBplB,KAAoB,uEAAZ,EAAY;QACxDgF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,qBAA4BolB,aAA5B,EAA4C,KAA5C,EAAP;;;AAGD,SAASR,WAAT,GAAyC;KAApB5kB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QACjCQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB,EAAEqb,iBAAiB,CAAC7W,OAAO9G,KAA3B,EAAzB,CAAP;;AAED,SAASmnB,UAAT,GAAwC;KAApB7kB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAChCQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB;cACnBwE,OAAOK,OAAP,CAAec,EADI;QAEzB;EAFA,CAAP;;AAKD,SAASmf,YAAT,GAA0C;KAApB9kB,KAAoB,uEAAZ,EAAY;QAClCgF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB,EAAEmS,MAAM,KAAR,EAAzB,CAAP;;AAED,SAASoO,UAAT,GAAwC;KAApBvgB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAChCQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB,EAAEmS,MAAM,CAAC3N,OAAO9G,KAAhB,EAAzB,CAAP;;AAED,SAASqnB,UAAT,GAAwC;KAApB/kB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAChCQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB;WACtBwE,OAAOK,OAAP,CAAeyF,IADO;QAEzB;EAFA,CAAP;;AAKD,SAAS0a,kBAAT,GAAgD;KAApBhlB,KAAoB,uEAAZ,EAAY;QACxCgF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB,EAAEmS,MAAM,KAAR,EAAzB,CAAP;;;AAGD,SAASsS,UAAT,GAAwC;KAApBzkB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;KACnC,CAACxE,MAAMsK,IAAP,IAAetK,MAAMsK,IAAN,CAAWmK,KAAX,CAAiBtX,MAAjB,GAA0BqH,OAAOK,OAAP,CAAeyF,IAAf,CAAoBwQ,KAAjE,EAAwE;MACnEvd,UAAUyC,MAAMsK,IAAN,GAAatK,MAAMsK,IAAN,CAAWmK,KAAxB,GAAgC,EAA9C;SACO5P,OAAP,CAAeyF,IAAf,CAAoBmK,KAApB,GAA4BlX,QAAQ+nB,MAAR,CAAe9gB,OAAOK,OAAP,CAAeyF,IAAf,CAAoBmK,KAAnC,CAA5B;QACMnK,IAAN,GAAa9F,OAAOK,OAAP,CAAeyF,IAA5B;SACOtF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB;iBACjB,KADiB;sBAEZ,CAAC,CAACwE,OAAO9G;GAFtB,CAAP;;QAKMsC,KAAP;;;AAGD,SAASskB,YAAT,GAA0C;KAApBtkB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;KACrCjH,UAAUyC,MAAMsK,IAAN,GAAatK,MAAMsK,IAAN,CAAWmK,KAAxB,GAAgC,EAA9C;OACMnK,IAAN,GAAa9F,OAAOK,OAAP,CAAeyF,IAA5B;QACOtF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB;gBACjB,KADiB;qBAEZ,CAAC,CAACwE,OAAO9G;EAFtB,CAAP;;;AAMD,SAASqd,YAAT,GAA0C;KAApB/a,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAClCQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB;gBACjB,CAACwE,OAAO9G,KADS;qBAEZ,CAAC,CAAC8G,OAAO9G,KAFG;UAGvB8G,OAAOmE,IAAP,IAAenE,OAAOmE,IAAP,CAAY3H,IAA3B,GAAkCwD,OAAOmE,IAAP,CAAY3H,IAAZ,CAAiBqN,KAAnD,GAA2D;EAH7D,CAAP;;;AAOD,SAAS2M,iBAAT,GAAuC;KAAZhb,KAAY,uEAAJ,EAAI;;QAC/BgF,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB;gBACjB,KADiB;qBAEZ;EAFb,CAAP;;;AAMD,SAAS0L,sBAAT,GAAkD;KAApB1L,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAC1CQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB;sBACc,CAACwE,OAAO9G;IAC3BwW,YAAY,oBAAZ,CAFK,EAE+B,CAAC,CAAC1P,OAAO9G,KAFxC,EAAP;;;AAMD,SAAS6mB,oBAAT,GAAkD;KAApBvkB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QAC1CQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB;cACMwE,OAAOK,OAAP,CAAeyF,IADrB;sBAEc;IACnB4J,YAAY,oBAAZ,CAHK,EAG+B,CAAC,CAAC1P,OAAO9G,KAHxC,EAAP;;;AAOD,SAAS8mB,kCAAT,GAAgE;KAApBxkB,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;QACxDQ,OAAOpC,MAAP,CAAc,EAAd,EAAkB5C,KAAlB;sBACc,KADd;cAEMmE;IACX+P,YAAY,oBAAZ,CAHK,EAG+B,CAAC,CAAC1P,OAAO9G,KAHxC,EAAP;;;AC/bD,IAAM6nB,WAAW,CAChB,EAAE9mB,MAAM,YAAR,EAAsB7B,KAAK6J,UAA3B,EADgB,EAEhB,EAAEhI,MAAM,MAAR,EAAgB7B,KAAK4Q,MAArB,EAFgB,CAAjB;AAIA,AAAe,oBAA6B;KAApBxN,KAAoB,uEAAZ,EAAY;KAARwE,MAAQ;;KACvCA,OAAO9B,IAAP,IAAe,mBAAnB,EAAwC;MACnC8iB,WAAWhhB,OAAOK,OAAP,CAAe2B,MAA9B;MACIgf,QAAJ,EAAc;2BACWA,QAAxB;wBAEIxlB,KADJ,EAEIwlB,QAFJ;;;KAMEC,UAAU,KAAd;KACCC,eAAeH,SAASjoB,MAAT,CAAgB,UAACiS,MAAD,EAASoW,OAAT,EAAqB;MAC/CxB,eAAenkB,MAAM2lB,QAAQlnB,IAAd,CAAnB;MACCmnB,WAAYrW,OAAOoW,QAAQlnB,IAAf,IAAuBknB,QAAQ/oB,GAAR,CAClCunB,YADkC,EAElC3f,MAFkC,CADpC;MAKI2f,iBAAiByB,QAArB,EAA+B;aACpB,IAAV;;SAEMrW,MAAP;EATc,EAUZ,EAVY,CADhB;QAYOkW,UAAUC,YAAV,GAAyB1lB,KAAhC;;;AC9Bc,2BAAS6lB,MAAT,EAA0B;KACpCC,MAAMD,OAAOE,QAAP,EAAV;;mCADkCxL,IAAM;MAAA;;;KAEpCA,KAAKpd,MAAT,EAAiB;MACZ6oB,YAAWzL,KAAK,CAAL,CAAX,CAAJ;MACIxW,GAAJ;MACI/C,OAAO,aAAaglB,CAAb,IAAkB,aAAaA,CAA/B,GAAmCzL,IAAnC,GAA0CA,KAAK,CAAL,CAArD;;OAEKxW,GAAL,IAAY/C,IAAZ,EAAkB;SACX8kB,IAAItL,OAAJ,CAAY,IAAI3Y,MAAJ,CAAW,QAAQkC,GAAR,GAAc,KAAzB,EAAgC,IAAhC,CAAZ,EAAmD/C,KAAK+C,GAAL,CAAnD,CAAN;;;;QAIK+hB,GAAP;;;ACLD,cAAe;uBAAA;mBAAA;mCAAA;qBAAA;;CAAf;;;;;;;;;;;;;;;;;"}