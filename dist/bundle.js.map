{"version":3,"file":"bundle.js","sources":["../src/lib/utils/memcache.js","../src/lib/actions/index.js","../src/lib/utils/validator.js","../src/lib/utils/invariants.js","../src/lib/dynamo_input.js","../src/lib/dynamo_view.js","../src/lib/dynamo_container.js","../src/lib/dynamo_process.js","../src/lib/dynamo_section.js","../src/lib/dynamo_select.js","../src/lib/dynamo_selectset.js","../src/lib/dynamo_list.js","../src/lib/dynamo_hidden.js","../src/lib/dynamo_nav.js","../src/lib/dynamo_image.js","../src/lib/dynamo_grid.js","../src/lib/dynamo_htmlview.js","../src/lib/dynamo_fileupload.js","../src/lib/dynamo_actionview.js","../src/lib/dynamo_label.js","../src/lib/dynamo_webview.js","../src/lib/dynamo_messenger.js","../src/lib/dynamo_command.js","../src/lib/index.js","../src/dynamo_mapping.js","../src/lib/reducers/index.js","../src/lib/reducers/chat.js"],"sourcesContent":["export default class MemCache {\r\n\tconstructor(opts) {\r\n\t\tthis.defaultTTL = (opts && opts.ttl) || 300000;\r\n\t\tthis.store = this.store.bind(this);\r\n\t\tthis.get = this.get.bind(this);\r\n\t\tthis._items = {};\r\n\t}\r\n\tgetKey(obj) {\r\n\t\tswitch (typeof obj) {\r\n\t\t\tcase \"string\":\r\n\t\t\t\treturn obj;\r\n\t\t\tcase \"object\":\r\n\t\t\t\treturn JSON.stringify(obj);\r\n\t\t\tcase \"undefined\":\r\n\t\t\t\tthrow \"Key cannot be null\";\r\n\t\t}\r\n\t}\r\n\thasKey(key) {\r\n\t\treturn this._items.hasOwnProperty(this.getKey(key));\r\n\t}\r\n\tget(key) {\r\n\t\tlet _key = this.getKey(key);\r\n\t\treturn (this._items[_key] && this._items[_key].value) || undefined;\r\n\t}\r\n\tstore(key, value, ttl = this.defaultTTL) {\r\n\t\tlet _key = this.getKey(key);\r\n\t\tif (this._items[_key]) {\r\n\t\t\tclearTimeout(this._items[_key].handle);\r\n\t\t}\r\n\t\tlet handle = setTimeout(this.remove.bind(this, _key), ttl);\r\n\t\tthis._items[_key] = { value, handle };\r\n\t}\r\n\tremove(key) {\r\n\t\tdelete this._items[key];\r\n\t}\r\n}\r\n","import config from \"client_config\";\r\nimport CALL_API from \"call_api\";\r\nimport openSocket from \"socket.io-client\";\r\nimport MemCache from \"../utils/memcache\";\r\n\r\nconst preDispatch = config.preDispatch,\r\n  BASE_URL = global.BASE_URL || config.baseUrl,\r\n  CHAT_URL = global.CHAT_URL || config.chatUrl,\r\n  preLogin = config.preLogin,\r\n  cache = new MemCache({ ttl: config.processorsCacheTimeout });\r\nexport const ACTIONS = {\r\n  OPEN_CONFIRMATION: \"OPEN_CONFIRMATION\",\r\n  OPEN_CHAT: \"OPEN_CHAT\",\r\n  CLOSE_CHAT: \"CLOSE_CHAT\",\r\n  GET_CONTACTS: \"GET_CONTACTS\",\r\n  GOT_CONTACTS: \"GOT_CONTACTS\",\r\n  FAILED_TO_GET_CONTACTS: \"FAILED_TO_GET_CONTACTS\",\r\n  GET_INVITES: \"GET_INVITES\",\r\n  GOT_INVITES: \"GOT_INVITES\",\r\n  FAILED_TO_GET_INVITES: \"FAILED_TO_GET_INVITES\",\r\n  SEARCH: \"SEARCH\",\r\n  FOUND: \"FOUND\",\r\n  NOT_FOUND: \"NOT_FOUND\",\r\n  LOGIN_CHAT: \"LOGIN_CHAT\",\r\n  LOGGED_IN_CHAT: \"LOGGED_IN_CHAT\",\r\n  FAILED_TO_LOGIN_CHAT: \"FAILED_TO_LOGIN_CHAT\",\r\n  SEND_CHAT: \"SEND_CHAT\",\r\n  SENT_CHAT: \"SENT_CHAT\",\r\n  FAILED_TO_SEND_CHAT: \"FAILED_TO_SEND_CHAT\",\r\n  CREATE_GROUP: \"CREATE_GROUP\",\r\n  CREATED_GROUP: \"CREATED_GROUP\",\r\n  FAILED_TO_CREATE_GROUP: \"FAILED_TO_CREATE_GROUP\",\r\n  SEND_FRIEND_REQUEST: \"SEND_FRIEND_REQUEST\",\r\n  SENT_FRIEND_REQUEST: \"SENT_FRIEND_REQUEST\",\r\n  FAILED_TO_SEND_FRIEND_REQUEST: \"FAILED_TO_SEND_FRIEND_REQUEST\",\r\n  ACCEPT_FRIEND_REQUEST: \"ACCEPT_FRIEND_REQUEST\",\r\n  ACCEPTED_FRIEND_REQUEST: \"ACCEPTED_FRIEND_REQUEST\",\r\n  FAILED_TO_ACCEPT_FRIEND_REQUEST: \"FAILED_TO_ACCEPT_FRIEND_REQUEST\",\r\n  REJECT_FRIEND_REQUEST: \"REJECT_FRIEND_REQUEST\",\r\n  REJECTED_FRIEND_REQUEST: \"REJECTED_FRIEND_REQUEST\",\r\n  FAILED_TO_REJECT_FRIEND_REQUEST: \"FAILED_TO_REJECT_FRIEND_REQUEST\",\r\n  GET_FRIEND_REQUEST: \"GET_FRIEND_REQUEST\",\r\n  GOT_FRIEND_REQUEST: \"GOT_FRIEND_REQUEST\",\r\n  FAILED_TO_GET_FRIEND_REQUEST: \"FAILED_TO_GET_FRIEND_REQUEST\",\r\n  FETCHED_PROCESS: \"FETCHED_PROCESS\",\r\n  FAILED_TO_FETCH_PROCESS: \"FAILED_TO_FETCH_PROCESS\",\r\n  FETCHING_PROCESS: \"FETCHING_PROCESS\",\r\n  SESSION_MAY_HAVE_EXPIRED: \"SESSION_MAY_HAVE_EXPIRED\",\r\n  FETCHING_GRID: \"FETCHING_GRID\",\r\n  GET_SINGLE_ITEM_FOR_GRID: \"GET_SINGLE_ITEM_FOR_GRID\",\r\n  GOT_SINGLE_ITEM_FOR_GRID: \"GOT_SINGLE_ITEM_FOR_GRID\",\r\n  ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID:\r\n    \"ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID\",\r\n  DYNAMO_GET_MORE_FOR_GRID: \"DYNAMO_GET_MORE_FOR_GRID\",\r\n  ERROR_WHILE_FETCHING_GRID: \"ERROR_WHILE_FETCHING_GRID\",\r\n  FILTERED_GRID: \"FILTERED_GRID\",\r\n  DYNAMO_PROCESSOR_RUNNING: \"DYNAMO_PROCESSOR_RUNNING\",\r\n  DYNAMO_PROCESSOR_RAN: \"DYNAMO_PROCESSOR_RAN\",\r\n  DYNAMO_PROCESSOR_FAILED: \"DYNAMO_PROCESSOR_FAILED\",\r\n  DYNAMO_PROCESS_RUNNING: \"DYNAMO_PROCESS_RUNNING\",\r\n  DYNAMO_PROCESS_RAN: \"DYNAMO_PROCESS_RAN\",\r\n  DYNAMO_PROCESS_FAILED: \"DYNAMO_PROCESS_FAILED\",\r\n  API_ERROR: \"API_ERROR\",\r\n  START_FILE_UPLOAD: \"START_FILE_UPLOAD\",\r\n  FILE_UPLOADED: \"FILE_UPLOADED\",\r\n  FILE_UPLOAD_FAILED: \"FILE_UPLOAD_FAILED\",\r\n  GET_PREVIEW: \"GET_PREVIEW\",\r\n  GOT_PREVIEW: \"GOT_PREVIEW\",\r\n  FAILED_TO_GET_PREVIEW: \"FAILED_TO_GET_PREVIEW\",\r\n  GET_ITEM_TEMPLATE: \"GET_ITEM_TEMPLATE\",\r\n  GOT_ITEM_TEMPLATE: \"GOT_ITEM_TEMPLATE\",\r\n  FAILED_TO_GET_ITEM_TEMPLATE: \"FAILED_TO_GET_ITEM_TEMPLATE\",\r\n  GET_FILTER_TEMPLATE: \"GET_FILTER_TEMPLATE\",\r\n  GOT_FILTER_TEMPLATE: \"GOT_FILTER_TEMPLATE\",\r\n  FAILED_TO_GET_FILTER_TEMPLATE: \"FAILED_TO_GET_FILTER_TEMPLATE\",\r\n  ADD_TO_OPEN_CHATS: \"ADD_TO_OPEN_CHATS\",\r\n  NEW_MESSAGE: \"NEW_MESSAGE\",\r\n  NEW_GROUP_MESSAGE: \"NEW_GROUP_MESSAGE\"\r\n};\r\n\r\nlet socket;\r\n\r\nexport const displayMessage = text => {\r\n  return {\r\n    type: \"SHOW_MESSAGE\",\r\n    message: text\r\n  };\r\n};\r\n\r\nfunction getQueryParams(args) {\r\n  return args\r\n    ? \"?\" +\r\n      Object.keys(args)\r\n        .map((x, index, arr) => {\r\n          return `${x}=${encodeURIComponent(args[x]) +\r\n            (index != arr.length - 1 ? \"&\" : \"\")}`;\r\n        })\r\n        .join(\"\")\r\n    : \"\";\r\n}\r\nexport function openConfirmation(id, message, params) {\r\n  return {\r\n    type: ACTIONS.OPEN_CONFIRMATION,\r\n    payload: { message, params, id }\r\n  };\r\n}\r\nfunction defaultError(dispatch, customType, meta) {\r\n  return {\r\n    type: customType || \"SHOW_MESSAGE\",\r\n    meta: (action, state, res) => {\r\n      if (customType && res.status !== 401)\r\n        dispatch(\r\n          displayMessage(\r\n            res.statusText ||\r\n              (res.headers &&\r\n                res.headers.map &&\r\n                res.headers.map.errormessage &&\r\n                res.headers.map.errormessage[0]) ||\r\n              \"Sorry , an error occurred while processing your request\"\r\n          )\r\n        );\r\n\r\n      //session expired\r\n      if (res.status == 401) {\r\n        dispatch(showMessage(\"Session may have expired\"));\r\n        dispatch({ type: ACTIONS.SESSION_MAY_HAVE_EXPIRED });\r\n      }\r\n\r\n      return meta\r\n        ? meta(action, state, res)\r\n        : res.statusText || \"An unknown error has occurred\";\r\n    }\r\n  };\r\n}\r\nexport const dynamoDownloadUrl = `${BASE_URL}/api/download/:id`;\r\nexport function fetchDynamoProcess(id, args) {\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/process/describe/${id}${getQueryParams(\r\n            Object.assign({}, args || {}, { $uiOnDemand: !!config.uiOnDemand })\r\n          )}`,\r\n          types: [\r\n            { type: ACTIONS.FETCHING_PROCESS, meta: id },\r\n            {\r\n              type: ACTIONS.FETCHED_PROCESS,\r\n              payload: (action, state, res) => {\r\n                //workaround for react-native fetch.\r\n                setTimeout(() => null, 0);\r\n                return res.json().then(d => {\r\n                  return { id: id, data: d };\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FAILED_TO_FETCH_PROCESS)\r\n          ],\r\n          method: \"GET\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          }\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\n\r\nexport function getMoreForGrid(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.FETCHING_GRID,\r\n    resultCustomType: ACTIONS.DYNAMO_GET_MORE_FOR_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_FETCHING_GRID,\r\n    disableCache: true\r\n  });\r\n}\r\nexport function filterGrid(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.FETCHING_GRID,\r\n    resultCustomType: ACTIONS.FILTERED_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_FETCHING_GRID,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getItemTemplate(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_ITEM_TEMPLATE,\r\n    resultCustomType: ACTIONS.GOT_ITEM_TEMPLATE,\r\n    errorCustomType: ACTIONS.FAILED_TO_GET_ITEM_TEMPLATE,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getFilterTemplate(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_FILTER_TEMPLATE,\r\n    resultCustomType: ACTIONS.GOT_FILTER_TEMPLATE,\r\n    errorCustomType: ACTIONS.FAILED_TO_GET_FILTER_TEMPLATE,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getSingleItemForGrid(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_SINGLE_ITEM_FOR_GRID,\r\n    resultCustomType: ACTIONS.GOT_SINGLE_ITEM_FOR_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\n\r\nexport function runDynamoProcessor(\r\n  id,\r\n  args,\r\n  key,\r\n  {\r\n    requestCustomType,\r\n    resultCustomType,\r\n    errorCustomType,\r\n    returnsUI,\r\n    disableCache\r\n  } = {}\r\n) {\r\n  //console.log(arguments);\r\n  if (config.cacheProcessorResponses && !disableCache) {\r\n    let cacheKey = { id, args },\r\n      hasKey = cache.hasKey(cacheKey);\r\n    if (hasKey) {\r\n      let payload = Object.assign({}, cache.get(cacheKey));\r\n      payload.key = key;\r\n\r\n      return dispatch => {\r\n        dispatch({\r\n          type: resultCustomType || ACTIONS.DYNAMO_PROCESSOR_RAN,\r\n          payload\r\n        });\r\n      };\r\n    }\r\n  }\r\n\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/processors/run/${id}`,\r\n          types: [\r\n            {\r\n              type: requestCustomType || ACTIONS.DYNAMO_PROCESSOR_RUNNING,\r\n              meta: { id, key, args }\r\n            },\r\n            {\r\n              type: resultCustomType || ACTIONS.DYNAMO_PROCESSOR_RAN,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(data => {\r\n                  if (data && typeof data.message == \"string\") {\r\n                    dispatch(showMessage(data.message));\r\n                  }\r\n                  let response = { id, data, args, key, returnsUI };\r\n                  if (config.cacheProcessorResponses && !disableCache) {\r\n                    cache.store({ id, args }, response);\r\n                  }\r\n                  return response;\r\n                });\r\n              }\r\n            },\r\n            defaultError(\r\n              dispatch,\r\n              errorCustomType || ACTIONS.DYNAMO_PROCESSOR_FAILED,\r\n              () => key\r\n            )\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          },\r\n          body: JSON.stringify(args)\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\n\r\nexport function showMessage(message) {\r\n  return {\r\n    type: \"SHOW_MESSAGE\",\r\n    message\r\n  };\r\n}\r\n\r\nexport function runDynamoProcess(details) {\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/process/run/${details.id}`,\r\n          types: [\r\n            {\r\n              type: ACTIONS.DYNAMO_PROCESS_RUNNING,\r\n              meta: { id: details.id, form: details.form }\r\n            },\r\n            {\r\n              type: ACTIONS.DYNAMO_PROCESS_RAN,\r\n              payload: (action, state, res) => {\r\n                return res\r\n                  .json()\r\n                  .then(d => {\r\n                    if (d && typeof d.message == \"string\") {\r\n                      dispatch(showMessage(d.message));\r\n                    }\r\n\r\n                    return { id: details.id, data: d };\r\n                  })\r\n                  .catch(er => {\r\n                    dispatch({\r\n                      type: \"SHOW_MESSAGE\",\r\n                      message:\r\n                        \"An error occurred while trying to understand a response from the server.\"\r\n                    });\r\n                  });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.DYNAMO_PROCESS_FAILED)\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          },\r\n          body: JSON.stringify(\r\n            Object.assign(\r\n              {},\r\n              details.form,\r\n              {\r\n                instanceId: details.instanceId\r\n              },\r\n              { $uiOnDemand: !!config.uiOnDemand }\r\n            )\r\n          )\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\nexport function getDynamoFilePreview(id, key, fileType, query) {\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/upload/preview/${id + (query || \"\")}`,\r\n          types: [\r\n            { type: ACTIONS.GET_PREVIEW, meta: key },\r\n            {\r\n              type: ACTIONS.GOT_PREVIEW,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(d => {\r\n                  return { data: d, key };\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FAILED_TO_GET_PREVIEW, () => key)\r\n          ],\r\n          method: \"GET\",\r\n          headers: {\r\n            Accept: \"*/*\",\r\n            \"Content-Type\": \"application/json\"\r\n          }\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n  };\r\n}\r\n\r\nexport function uploadDynamoFile(file, key) {\r\n  let formData = new FormData();\r\n\r\n  formData.append(\"file\", file);\r\n\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/upload`,\r\n          types: [\r\n            { type: ACTIONS.START_FILE_UPLOAD, meta: key },\r\n            {\r\n              type: ACTIONS.FILE_UPLOADED,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(d => {\r\n                  return { key, id: d.id };\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FILE_UPLOAD_FAILED, () => key)\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\"\r\n          },\r\n          body: formData\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n  };\r\n}\r\n\r\nexport function loginChat(credentials, extra) {\r\n  return (dispatch, getState) => {\r\n    dispatch({ type: ACTIONS.LOGIN_CHAT });\r\n    socket.emit(\"login\", preLogin(credentials, getState()), msg => {\r\n      if (msg.error) {\r\n        if (!msg.isSignedUp && credentials.handle) {\r\n          dispatch(\r\n            showMessage(\r\n              \"An error occurred while contacting the chat server. Please retry\"\r\n            )\r\n          );\r\n        }\r\n        return dispatch({ type: ACTIONS.FAILED_TO_LOGIN_CHAT, payload: msg });\r\n      }\r\n      if (extra) {\r\n        extra();\r\n      }\r\n      return dispatch({\r\n        type: ACTIONS.LOGGED_IN_CHAT,\r\n        payload: msg.message,\r\n        meta: credentials\r\n      });\r\n    });\r\n  };\r\n}\r\n\r\nexport function sendMessage(type, msg) {\r\n  return emit(type, msg, {\r\n    requestType: ACTIONS.SEND_CHAT,\r\n    resultType: ACTIONS.SENT_CHAT,\r\n    errorType: ACTIONS.FAILED_TO_SEND_CHAT\r\n  });\r\n}\r\nexport function createGroup(msg) {\r\n  return emit(\"create group\", msg, {\r\n    requestType: ACTIONS.CREATE_GROUP,\r\n    resultType: ACTIONS.CREATED_GROUP\r\n  });\r\n}\r\n\r\nexport function sendFriendRequest(handle) {\r\n  return emit(\"friend request\", handle, {\r\n    requestType: ACTIONS.SEND_FRIEND_REQUEST,\r\n    resultType: ACTIONS.SENT_FRIEND_REQUEST,\r\n    errorType: ACTIONS.FAILED_TO_SEND_FRIEND_REQUEST\r\n  });\r\n}\r\nexport function getContacts() {\r\n  return emit(\"friends\", null, {\r\n    requestType: ACTIONS.GET_CONTACTS,\r\n    resultType: ACTIONS.GOT_CONTACTS,\r\n    errorType: ACTIONS.FAILED_TO_GET_CONTACTS\r\n  });\r\n}\r\n\r\nexport function fetchInvites() {\r\n  return emit(\"pending friend requests\", null, {\r\n    requestType: ACTIONS.GET_INVITES,\r\n    resultType: ACTIONS.GOT_INVITES,\r\n    errorType: ACTIONS.FAILED_TO_GET_INVITES\r\n  });\r\n}\r\n\r\nexport function acceptInvite(handle) {\r\n  return emit(\"approve friend request\", handle, {\r\n    requestType: ACTIONS.ACCEPT_FRIEND_REQUEST,\r\n    resultType: ACTIONS.ACCEPTED_FRIEND_REQUEST,\r\n    errorType: ACTIONS.FAILED_TO_ACCEPT_FRIEND_REQUEST\r\n  });\r\n}\r\nexport function rejectInvite(handle) {\r\n  return emit(\"reject friend request\", handle, {\r\n    requestType: ACTIONS.REJECT_FRIEND_REQUEST,\r\n    resultType: ACTIONS.REJECTED_FRIEND_REQUEST,\r\n    errorType: ACTIONS.FAILED_TO_REJECT_FRIEND_REQUEST\r\n  });\r\n}\r\nexport function searchForHandle(handle) {\r\n  return emit(\"search for handle\", handle, {\r\n    requestType: ACTIONS.SEARCH,\r\n    resultType: ACTIONS.FOUND,\r\n    errorType: ACTIONS.NOT_FOUND\r\n  });\r\n}\r\n\r\nfunction emit(type, message, { requestType, resultType, errorType }) {\r\n  let args = Array.prototype.slice.call(arguments);\r\n  return (dispatch, getState) => {\r\n    dispatch({ type: requestType });\r\n    socket.emit(type, message, result => {\r\n      if (result.error) {\r\n        if (result.message == \"Unauthorized\") {\r\n          let state = getState();\r\n          if (state.authentication.username) {\r\n            return dispatch(\r\n              loginChat({ username: state.authentication.username }, () => {\r\n                dispatch(emit.apply(null, args));\r\n              })\r\n            );\r\n          }\r\n        }\r\n\r\n        return (\r\n          dispatch(showMessage(result.message)),\r\n          errorType && dispatch({ type: errorType, payload: result })\r\n        );\r\n      }\r\n      dispatch({\r\n        type: resultType,\r\n        payload: result && result.message,\r\n        meta: message\r\n      });\r\n    });\r\n  };\r\n}\r\n\r\nexport function addToOpenChats(chat) {\r\n  return { type: ACTIONS.ADD_TO_OPEN_CHATS, payload: chat };\r\n}\r\nexport function openChat(chat) {\r\n  return { type: ACTIONS.OPEN_CHAT, payload: chat };\r\n}\r\nexport function closeChat() {\r\n  return { type: ACTIONS.CLOSE_CHAT };\r\n}\r\n\r\nexport function startReceivingMessages(store) {\r\n  socket = openSocket(CHAT_URL);\r\n  socket.on(\"msg\", function(message, fn) {\r\n    store.dispatch({ type: ACTIONS.NEW_MESSAGE, payload: message });\r\n    fn();\r\n  });\r\n  socket.on(\"grpmsg\", function(message, fn) {\r\n    store.dispatch({ type: ACTIONS.NEW_GROUP_MESSAGE, payload: message });\r\n    fn();\r\n  });\r\n}\r\n","export default class Validator {\r\n\tconstructor(context) {\r\n\t\tthis.run = this.run.bind(context);\r\n\t}\r\n\trun() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (\r\n\t\t\t\t(!this.props.validators || !this.props.validators.length) &&\r\n\t\t\t\t(!this.props.asyncValidators ||\r\n\t\t\t\t\t!this.props.asyncValidators.length)\r\n\t\t\t)\r\n\t\t\t\treturn resolve();\r\n\r\n\t\t\tif (this.props.validators) {\r\n\t\t\t\tlet result = this.props.validators.reduce(\r\n\t\t\t\t\t(current, element) => {\r\n\t\t\t\t\t\t// statements\r\n\t\t\t\t\t\tlet valid = current.valid,\r\n\t\t\t\t\t\t\terror = \"\";\r\n\t\t\t\t\t\tswitch (element.validatorType) {\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.REQUIRED:\r\n\t\t\t\t\t\t\t\tvalid = this.hasValue();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.MAXLENGTH:\r\n\t\t\t\t\t\t\t\tvalid = this.isLessThanMaxLength(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.MINLENGTH:\r\n\t\t\t\t\t\t\t\tvalid = this.isGreaterThanMinLength(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.REGEX:\r\n\t\t\t\t\t\t\t\tvalid = this.matchesRegex(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof valid == \"string\") {\r\n\t\t\t\t\t\t\terror = valid;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\tcurrent.errors.push(error),\r\n\t\t\t\t\t\t\t\t(current.valid = false),\r\n\t\t\t\t\t\t\t\tcurrent\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn current;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ errors: [], valid: true }\r\n\t\t\t\t);\r\n\t\t\t\tif (!result.valid) {\r\n\t\t\t\t\tthis.setState(\r\n\t\t\t\t\t\tObject.assign(this.state, { errors: result.errors })\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn reject();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.props.asyncValidators &&\r\n\t\t\t\tthis.props.asyncValidators.length &&\r\n\t\t\t\t!this.props.valid\r\n\t\t\t) {\r\n\t\t\t\treturn reject();\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState(Object.assign(this.state, { errors: null }));\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport const VALIDATOR_TYPES = {\r\n\tREQUIRED: \"REQUIRED\",\r\n\tMAXLENGTH: \"MAXLENGTH\",\r\n\tMINLENGTH: \"MINLENGTH\",\r\n\tREGEX: \"REGEX\"\r\n};\r\n","import { Component } from \"react\";\r\nexport default {\r\n\tvalidComponent: function(component, name) {\r\n\t\tif (!component) throw new Error(`${name} cannot be null`);\r\n\t\tif (\r\n\t\t\t!Component.prototype.isPrototypeOf(component) &&\r\n\t\t\ttypeof component !== \"function\"\r\n\t\t)\r\n\t\t\tthrow new Error(\r\n\t\t\t\t`${name} must either be a valid react Component or a Function`\r\n\t\t\t);\r\n\t\treturn true;\r\n\t}\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\n/**\r\n * Higher order function that recieves Platform specific implementation of Input\r\n * @param  {Function} Input Input class\r\n * @return {Function}       Wrapped class\r\n */\r\nexport default (LabelWrapper, Input, DatePicker, Checkbox) => {\r\n\tinvariants.validComponent(LabelWrapper, \"LabelWrapper\");\r\n\tinvariants.validComponent(Input, \"Input\");\r\n\tinvariants.validComponent(DatePicker, \"DatePicker\");\r\n\tinvariants.validComponent(Checkbox, \"Checkbox\");\r\n\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tif (ownProps.asyncValidators && ownProps.asyncValidators.length) {\r\n\t\t\treturn {\r\n\t\t\t\tvalid:\r\n\t\t\t\t\tstate.dynamo[\r\n\t\t\t\t\t\townProps.asyncValidators[0] + ownProps.component_uid\r\n\t\t\t\t\t]\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn {};\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\trunAsyncValidator: (id, params, key) =>\r\n\t\t\t\tdispatch(runDynamoProcessor(id, params, key))\r\n\t\t};\r\n\t};\r\n\tclass DynamoInput extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalue:\r\n\t\t\t\t\tthis.props.value ||\r\n\t\t\t\t\t(this.props.args && this.props.args.default)\r\n\t\t\t};\r\n\t\t\tthis.runValidators = this.runValidators.bind(this);\r\n\t\t\tthis.hasValue = this.hasValue.bind(this);\r\n\t\t\tthis.isLessThanMaxLength = this.isLessThanMaxLength.bind(this);\r\n\t\t\tthis.isGreaterThanMinLength = this.isGreaterThanMinLength.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.matchesRegex = this.matchesRegex.bind(this);\r\n\t\t\tthis.runAsyncValidators = this.runAsyncValidators.bind(this);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.component_uid !== this.props.component_uid) {\r\n\t\t\t\t//\t\tsetTimeout(() => {\r\n\t\t\t\tthis.valueChanged(this.props.value);\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidationHelper(this).run();\r\n\t\t}\r\n\t\trunAsyncValidators(value) {\r\n\t\t\tthis.props.runAsyncValidator(\r\n\t\t\t\tthis.props.asyncValidators[0],\r\n\t\t\t\tvalue,\r\n\t\t\t\tthis.props.asyncValidators[0] + this.props.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.state.value || \"is required\";\r\n\t\t}\r\n\t\tisRequired() {\r\n\t\t\treturn (\r\n\t\t\t\tthis.props.validators &&\r\n\t\t\t\tthis.props.validators.filter(\r\n\t\t\t\t\tx => x.validatorType == VALIDATOR_TYPES.REQUIRED\r\n\t\t\t\t).length > 0\r\n\t\t\t);\r\n\t\t}\r\n\t\tisLessThanMaxLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.value &&\r\n\t\t\t\t\tthis.state.value.length <= element.args.max) ||\r\n\t\t\t\telement.error ||\r\n\t\t\t\t\"The maximum number of letters/numbers is \" + element.args.max\r\n\t\t\t);\r\n\t\t}\r\n\t\tisGreaterThanMinLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.value &&\r\n\t\t\t\t\tthis.state.value.length >= element.args.min) ||\r\n\t\t\t\telement.error ||\r\n\t\t\t\t\"The minimum number of letters/numbers is\" + element.args.min\r\n\t\t\t);\r\n\t\t}\r\n\t\tmatchesRegex(element) {\r\n\t\t\treturn (\r\n\t\t\t\tnew RegExp(element.args.exp).test(this.state.value) ||\r\n\t\t\t\telement.error ||\r\n\t\t\t\t\"Invalid entry\"\r\n\t\t\t);\r\n\t\t}\r\n\t\tvalueChanged(value) {\r\n\t\t\tthis.props.valueChanged({ [this.props.name]: value });\r\n\t\t\tif (this.props.asyncValidators && this.props.asyncValidators.length)\r\n\t\t\t\tthis.runAsyncValidators(value);\r\n\r\n\t\t\tthis.setState({ value: value, errors: [] });\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start */\r\n\t\t\tlet args = this.props.args,\r\n\t\t\t\tResult;\r\n\t\t\tconst { type, valueChanged, ...passThrough } = this.props;\r\n\t\t\tif (\r\n\t\t\t\t!args ||\r\n\t\t\t\t!args.type ||\r\n\t\t\t\targs.type == \"text\" ||\r\n\t\t\t\targs.type == \"number\" ||\r\n\t\t\t\targs.type == \"password\"\r\n\t\t\t) {\r\n\t\t\t\tResult = Input;\r\n\t\t\t\targs = args || { type: \"text\" };\r\n\t\t\t}\r\n\t\t\tif (args.type == \"checkbox\") Result = Checkbox;\r\n\r\n\t\t\tif (args.type == \"date\") Result = DatePicker;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<LabelWrapper\r\n\t\t\t\t\tvalue={this.props.label}\r\n\t\t\t\t\tinner={\r\n\t\t\t\t\t\t<Result\r\n\t\t\t\t\t\t\ttype={args.type}\r\n\t\t\t\t\t\t\t{...passThrough}\r\n\t\t\t\t\t\t\trequired={this.isRequired()}\r\n\t\t\t\t\t\t\tvalue={this.state.value}\r\n\t\t\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end */\r\n\t\t}\r\n\t}\r\n\tDynamoInput.propTypes = {\r\n\t\tvalueChanged: React.PropTypes.func\r\n\t};\r\n\treturn DynamoInput;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default (Page, Container) => {\r\n\tinvariants.validComponent(Page, \"Page\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\t//map elements in DynamoView props to elements in store.\r\n\tconst mapStateToProps = (_, initialProps) => state => {\r\n\t\t//console.log(\"mapping state to props\");\r\n\t\tlet description = state.dynamo.description,\r\n\t\t\tmap = { value: state.dynamo.value };\r\n\t\tif (description) {\r\n\t\t\tlet step = state.dynamo.currentStep || 0;\r\n\t\t\tmap.elements = description.steps[step].form.elements;\r\n\t\t\tif (description.steps[step].mode == \"VIEW\") map.hideSubmit = true;\r\n\t\t\tmap.title=description.title;\r\n\t\t}\r\n\t\treturn map;\r\n\t};\r\n\r\n\tclass DynamoView extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.onValueChanged = this.onValueChanged.bind(this);\r\n\t\t\tthis.submit = this.submit.bind(this);\r\n\t\t\t//pass reference to validate func\r\n\t\t\tthis.state = {\r\n\t\t\t\tform: this.props.value,\r\n\t\t\t\tvalidator: {}\r\n\t\t\t};\r\n\t\t}\r\n\t\tonValueChanged(form) {\r\n\t\t\tthis.state.form = form.dynamo_view;\r\n\t\t}\r\n\t\tsubmit() {\r\n\t\t\tthis.state.validator\r\n\t\t\t\t.validate()\r\n\t\t\t\t.then(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tthis.props.submit(this.state.form);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tconsole.warn(\"the form is invalid\");\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t.catch(er => {\r\n\t\t\t\t\tconsole.log(\"an error occurred while validating form \");\r\n\t\t\t\t\tconsole.error(er);\r\n\t\t\t\t});\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\treturn (\r\n\t\t\t\t<Page submit={this.submit} hideSubmit={this.props.hideSubmit}>\r\n\t\t\t\t\t<Container\r\n\t\t\t\t\t    label={this.props.title}\r\n\t\t\t\t\t\telements={this.props.elements}\r\n\t\t\t\t\t\tname=\"dynamo_view\"\r\n\t\t\t\t\t\tvalue={this.props.value}\r\n\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\tvalidator={this.state.validator}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Page>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps)(DynamoView);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Section, Header, ComponentLocator) => {\r\n\t//invariants\r\n\r\n\tif (\r\n\t\tinvariants.validComponent(Section, \"Section\") &&\r\n\t\tinvariants.validComponent(Header, \"Header\") &&\r\n\t\t!ComponentLocator\r\n\t)\r\n\t\tthrow new Error(\"ComponentLocator cannot be null (dynamo_container)\");\r\n\r\n\treturn class extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.onValueChanged = this.onValueChanged.bind(this);\r\n\t\t\tthis.state = { form: this.props.value };\r\n\t\t\tthis._validations=[];\r\n\t\t\tthis.setValidator = this.setValidator.bind(this);\r\n\t\t\tthis.setValidator();\r\n\t\t}\r\n\t\tsetValidator() {\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn Promise.all(\r\n\t\t\t\t\tthis._validations.map(x => {\r\n\t\t\t\t\t\tif (x.validate) return x.validate();\r\n\r\n\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t};\r\n\t\t}\r\n\t\tonValueChanged() {\r\n\t\t\tthis.state.form = Object.assign(\r\n\t\t\t\t{},\r\n\t\t\t\tthis.state.form || {},\r\n\t\t\t\t...Array.prototype.slice.call(arguments)\r\n\t\t\t);\r\n\t\t\tthis.props.valueChanged({ [this.props.name]: this.state.form });\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\tthis._validations.length = 0;\r\n\t\t\tlet keys = this.props.value ? Object.keys(this.props.value) : [],\r\n\t\t\t\tself = this,\r\n\t\t\t\textraVal = {},\r\n\t\t\t\tindex = -1,\r\n\t\t\t\tnotifyExtra = [],\r\n\t\t\t\telements = (this.props.elements||[]).sort((x, y) => {\r\n\t\t\t\t\treturn x.order - y.order;\r\n\t\t\t\t}).map(x => {\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t\tlet DynamoComponent = ComponentLocator(x),\r\n\t\t\t\t\t\tsource = self.props.value,\r\n\t\t\t\t\t\tvalidator = {},\r\n\t\t\t\t\t\tvalue = source ? this.props.value[x.name] : null;\r\n\t\t\t\t\tthis._validations.push(validator);\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tsource &&\r\n\t\t\t\t\t\tself.props.value[x.name] &&\r\n\t\t\t\t\t\tkeys.indexOf(x.name) !== -1\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tkeys.splice(keys.indexOf(x.name), 1);\r\n\t\t\t\t\t/*jshint ignore:start*/\r\n\t\t\t\t\tif (!DynamoComponent)\r\n\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\"Unknown component:\" + JSON.stringify(x, null, \" \")\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\tif (DynamoComponent.notifyExtra) {\r\n\t\t\t\t\t\tnotifyExtra.push(index);\r\n\t\t\t\t\t\treturn extra =>\r\n\t\t\t\t\t\t\t<DynamoComponent\r\n\t\t\t\t\t\t\t\t{...x}\r\n\t\t\t\t\t\t\t\textra={extra}\r\n\t\t\t\t\t\t\t\tkey={x.name}\r\n\t\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t\t\tvalidator={validator}\r\n\t\t\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\t\t/>;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<DynamoComponent\r\n\t\t\t\t\t\t\t{...x}\r\n\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t\tvalidator={validator}\r\n\t\t\t\t\t\t\tkey={x.name}\r\n\t\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t\t/*jshint ignore:end*/\r\n\t\t\t\t});\r\n\r\n\t\t\tif (keys.length || notifyExtra.length) {\r\n\t\t\t\tif (!notifyExtra.length){\r\n\t\t\t\t\t// console.warn(\r\n\t\t\t\t\t// \t\"there are extra properties that no component cares about \" +\r\n\t\t\t\t\t// \t\tJSON.stringify(keys, null, \" \")\r\n\t\t\t\t\t// );\r\n\t\t\t\t\t// console.warn('shouldnt happen too often');\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\tkeys.forEach(x => {\r\n\t\t\t\t\textraVal[x] = self.props.value[x];\r\n\t\t\t\t});\r\n\r\n\t\t\t\tnotifyExtra.forEach(x => {\r\n\t\t\t\t\telements[x] = elements[x](Object.assign({}, extraVal));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\treturn (\r\n\t\t\t\t<Section>\r\n\t\t\t\t\t<Header text={this.props.label} />\r\n\t\t\t\t\t{elements}\r\n\t\t\t\t</Section>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { fetchDynamoProcess, runDynamoProcess } from \"./actions\";\r\nimport _ from \"lodash\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\n/**\r\n * Higher order function that recieves Platform specific implementation of Input\r\n * @param  {Function} Input Input class\r\n * @return {Function}       Wrapped class\r\n */\r\nexport default (ProgressBar, TextView, DynamoView) => {\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(TextView, \"TextView\");\r\n\tinvariants.validComponent(DynamoView, \"DynamoView\");\r\n\r\n\t//map elements in DynamoInput props to elements in store.\r\n\tconst mapStateToProps = (_, initialProps) => state => {\r\n\t\treturn {\r\n\t\t\tbusy: state.dynamo.busy,\r\n\t\t\tdescription: state.dynamo.description,\r\n\t\t\tinstanceId: state.dynamo.instanceId,\r\n\t\t\tmessage: state.dynamo.message,\r\n\t\t\tcompleted: state.dynamo.completed\r\n\t\t};\r\n\t};\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tfetch: (id, params) => {\r\n\t\t\t\tdispatch(fetchDynamoProcess(id, params));\r\n\t\t\t},\r\n\t\t\trunProcess: info => {\r\n\t\t\t\tdispatch(runDynamoProcess(info));\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoProcess extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.submit = this.submit.bind(this);\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tif (\r\n\t\t\t\t!this.props.description ||\r\n\t\t\t\tthis.props.id !== this.props.description._id\r\n\t\t\t) {\r\n\t\t\t\tthis.props.fetch(this.props.id, this.props.fetchParams);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.completed && next.completed != this.props.completed)\r\n\t\t\t\treturn this.props.navigation.goBack();\r\n\r\n\t\t\tif (\r\n\t\t\t\t(next.id !== this.props.id ||\r\n\t\t\t\t\t!_.isEqual(next.fetchParams, this.props.fetchParams)) &&\r\n\t\t\t\t!this.props.busy\r\n\t\t\t)\r\n\t\t\t\tthis.props.fetch(next.id, next.fetchParams);\r\n\t\t}\r\n\t\tsubmit(form) {\r\n\t\t\tthis.props.runProcess({\r\n\t\t\t\tid: this.props.id,\r\n\t\t\t\tform,\r\n\t\t\t\tinstanceId: this.props.instanceId\r\n\t\t\t});\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start */\r\n\t\t\tif (this.props.busy || typeof this.props.busy == \"undefined\") {\r\n\t\t\t\treturn <ProgressBar title=\"Please wait...\" />;\r\n\t\t\t}\r\n\t\t\tif (!this.props.description) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<TextView text=\"Sorry we couldnt load that process...please wait a few minutes and retry.\" />\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn <DynamoView submit={this.submit} />;\r\n\t\t\t/*jshint ignore:end */\r\n\t\t}\r\n\t}\r\n\t// DynamoProcess.propTypes = {\r\n\t// \tid: React.PropTypes.string.isRequired,\r\n\t// \tfetchParams: React.PropTypes.object,\r\n\t// \tdescription: React.PropTypes.object\r\n\t// };\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoProcess);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Layout, Header, Container) => {\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Header, \"Header\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\tclass DynamoSection extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\t//get the container for retrieving\r\n\t\t\treturn (\r\n\t\t\t\t<Layout>\r\n\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t{this.props.label}\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t\t<Container\r\n\t\t\t\t\t\telements={this.props.args.elements}\r\n\t\t\t\t\t\tname={this.props.name}\r\n\t\t\t\t\t\tvalue={this.props.value}\r\n\t\t\t\t\t\tvalueChanged={this.props.valueChanged}\r\n\t\t\t\t\t\tvalidator={this.props.validator}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\treturn DynamoSection;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default (ProgressIndicator, Layout, Container) => {\r\n\tif (\r\n\t\tinvariants.validComponent(ProgressIndicator, \"ProgressIndicator\") &&\r\n\t\tinvariants.validComponent(Layout, \"Layout\") &&\r\n\t\t!Container\r\n\t)\r\n\t\tthrow new Error(\"Container cannot be null (dynamo_select)\");\r\n\r\n\t//map elements in DynamoView props to elements in store.\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tif (ownProps.args.type == \"PROCESSOR\") {\r\n\t\t\tlet st = state.dynamo[ownProps.component_uid];\r\n\t\t\treturn {\r\n\t\t\t\titems: st,\r\n\t\t\t\tbusy: !!state.dynamo[`${ownProps.component_uid}-busy`]\r\n\t\t\t};\r\n\t\t}\r\n\t\t//evaluate stuff in the parent container to retrieve the\r\n\t};\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tfetch: (id, params, key) => {\r\n\t\t\t\tdispatch(runDynamoProcessor(id, params, key));\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoSelect extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\r\n\t\t\tthis.fetchItems = this.fetchItems.bind(this);\r\n\t\t\tthis.onValueChanged = this.onValueChanged.bind(this);\r\n\t\t\tthis.selectFirstItem = this.selectFirstItem.bind(this);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.isValidValue = this.isValidValue.bind(this);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalue:\r\n\t\t\t\t\tprops.value && typeof props.value == \"object\"\r\n\t\t\t\t\t\t? props.value.$objectID\r\n\t\t\t\t\t\t: props.value\r\n\t\t\t};\r\n\t\t\tthis.isObjectIdMode = this.isObjectIdMode.bind(this);\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.state.value || \"is required\";\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidationHelper(this).run();\r\n\t\t}\r\n\t\tonValueChanged(value) {\r\n\t\t\tif (this._mounted) {\r\n\t\t\t\tlet obid = this.isObjectIdMode(),\r\n\t\t\t\t\tupdateValue =\r\n\t\t\t\t\t\t(obid &&\r\n\t\t\t\t\t\t\tvalue &&\r\n\t\t\t\t\t\t\ttypeof value == \"object\" &&\r\n\t\t\t\t\t\t\tvalue.$objectID) ||\r\n\t\t\t\t\t\tvalue;\r\n\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t[this.props.name]:\r\n\t\t\t\t\t\t(obid &&\r\n\t\t\t\t\t\ttypeof value !== \"object\" && {\r\n\t\t\t\t\t\t\t$objectID: value\r\n\t\t\t\t\t\t}) ||\r\n\t\t\t\t\t\tvalue\r\n\t\t\t\t});\r\n\t\t\t\tif (this.state.value !== updateValue) {\r\n\t\t\t\t\tconsole.log(\"onValueChanged value:\" + updateValue);\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tvalue: updateValue\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfetchItems(source, args, component_uid) {\r\n\t\t\tif (this._mounted)\r\n\t\t\t\tthis.props.fetch(\r\n\t\t\t\t\tsource,\r\n\t\t\t\t\tJSON.parse(\r\n\t\t\t\t\t\targs || this.props.args.config.customArgs || \"{}\"\r\n\t\t\t\t\t),\r\n\t\t\t\t\tcomponent_uid || this.props.component_uid || \"\"\r\n\t\t\t\t);\r\n\t\t}\r\n\t\tisValidValue(items = this.props.items, value = this.props.value) {\r\n\t\t\treturn (\r\n\t\t\t\titems &&\r\n\t\t\t\titems.length &&\r\n\t\t\t\titems.filter(x => x._id == value).length\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\tnext.args.config.value !== this.props.args.config.value ||\r\n\t\t\t\t(next.args.config.customArgs !==\r\n\t\t\t\t\tthis.props.args.config.customArgs &&\r\n\t\t\t\t\t!this.props.busy) ||\r\n\t\t\t\tnext.component_uid !== this.props.component_uid ||\r\n\t\t\t\t(next.args.config.value &&\r\n\t\t\t\t\ttypeof next.items == \"undefined\" &&\r\n\t\t\t\t\t!next.busy)\r\n\t\t\t) {\r\n\t\t\t\treturn this.fetchItems(\r\n\t\t\t\t\tnext.args.config.value,\r\n\t\t\t\t\tnext.args.config.customArgs,\r\n\t\t\t\t\tnext.component_uid\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif (next.items && next.items.length == 1) {\r\n\t\t\t\treturn this.selectFirstItem(next.items[0]._id);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t(next.items &&\r\n\t\t\t\t\tnext.value &&\r\n\t\t\t\t\t!this.isValidValue(next.items, next.value)) ||\r\n\t\t\t\t!next.items\r\n\t\t\t) {\r\n\t\t\t\treturn this.onValueChanged(null);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t(next.items &&\r\n\t\t\t\t\tnext.value &&\r\n\t\t\t\t\tthis.isValidValue(next.items, next.value)) ||\r\n\t\t\t\t(this.props.items &&\r\n\t\t\t\t\tthis.isValidValue(this.props.items, next.value))\r\n\t\t\t) {\r\n\t\t\t\treturn this.onValueChanged(next.value);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tselectFirstItem(item) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.onValueChanged(item);\r\n\t\t\t}, 0);\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\tthis._mounted = false;\r\n\t\t}\r\n\t\tisObjectIdMode() {\r\n\t\t\treturn this.props.args && this.props.args.mode === \"ObjectId\";\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tthis._mounted = true;\r\n\t\t\tif (!this.props.items) {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t\"fetching items in componentDidMount for current:\" +\r\n\t\t\t\t\t\tthis.props.name\r\n\t\t\t\t);\r\n\t\t\t\tthis.fetchItems(this.props.args.config.value);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.props.items && this.props.items.length == 1) {\r\n\t\t\t\treturn this.selectFirstItem(this.props.items[0]._id);\r\n\t\t\t}\r\n\t\t\tif (this.isObjectIdMode() && this.props.value)\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tthis.onValueChanged(this.props.value);\r\n\t\t\t\t});\r\n\t\t}\r\n\t\tisEmptyOrNull(v) {\r\n\t\t\treturn !v || !v.length;\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\r\n\t\t\tif (this.isEmptyOrNull(this.props.items)) {\r\n\t\t\t\t//console.log(\"items is null or undefined\");\r\n\t\t\t\t//console.log(this.props);\r\n\t\t\t\treturn <ProgressIndicator />;\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<Layout\r\n\t\t\t\t\tvalue={this.props.label}\r\n\t\t\t\t\tinner={\r\n\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t!!this.props.args.disabled ||\r\n\t\t\t\t\t\t\t\t(this.props.items &&\r\n\t\t\t\t\t\t\t\t\tthis.props.items.length == 1)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t\t\t\tlabel={this.props.label}\r\n\t\t\t\t\t\t\titems={this.props.items}\r\n\t\t\t\t\t\t\tdisplayProperty=\"displayLabel\"\r\n\t\t\t\t\t\t\tkeyProperty=\"_id\"\r\n\t\t\t\t\t\t\tvalue={this.state.value}\r\n\t\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoSelect);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nexport default (Layout, Picker, ProgressBar, Container) => {\r\n\t//map elements in DynamoView props to elements in store.\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Picker, \"Picker\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tgetItems: (id, args, key) =>\r\n\t\t\t\tdispatch(runDynamoProcessor(id, args, key, { returnsUI: true }))\r\n\t\t};\r\n\t};\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\treturn {\r\n\t\t\tbusy: state.dynamo[`${ownProps.component_uid}-busy`],\r\n\t\t\titems: state.dynamo[ownProps.component_uid] || ownProps.args.items\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoSelectSet extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.onPickerValueChanged = this.onPickerValueChanged.bind(this);\r\n\t\t\tthis.onContainerValueChanged = this.onContainerValueChanged.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.getPickerValue = this.getPickerValue.bind(this);\r\n\t\t\tthis.getPickerItemsById = this.getPickerItemsById.bind(this);\r\n\t\t\tlet value =\r\n\t\t\t\tprops.value && typeof props.value == \"object\"\r\n\t\t\t\t\t? props.value.$objectID\r\n\t\t\t\t\t: props.value;\r\n\t\t\tthis.state = {\r\n\t\t\t\tpickerValue: value,\r\n\t\t\t\titems: this.getPickerItemsById(value),\r\n\t\t\t\tcontainerValidator: {}\r\n\t\t\t};\r\n\t\t\tthis.selectFirstItem = this.selectFirstItem.bind(this);\r\n\t\t\tthis.respondToPickerValueChanged = this.respondToPickerValueChanged.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.oneOption = this.oneOption.bind(this);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.getValueBasedOnMode = this.getValueBasedOnMode.bind(this);\r\n\t\t\tthis.isObjectIdMode = this.isObjectIdMode.bind(this);\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.state.pickerValue || \"is required\";\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn Promise.all([\r\n\t\t\t\tnew ValidationHelper(this).run(),\r\n\t\t\t\tthis.state.containerValidator.validate()\r\n\t\t\t]);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\t(next.value && next.value !== this.state.pickerValue) ||\r\n\t\t\t\t(next.items &&\r\n\t\t\t\t\tnext.items.length &&\r\n\t\t\t\t\t(!this.props.items || !this.props.items.length)) ||\r\n\t\t\t\tnext.component_uid !== this.props.component_uid\r\n\t\t\t) {\r\n\t\t\t\tthis.respondToPickerValueChanged(next.value, next.items);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.args.processor !== this.props.args.processor ||\r\n\t\t\t\t(next.component_uid !== this.props.component_uid &&\r\n\t\t\t\t\tnext.args.processor)\r\n\t\t\t)\r\n\t\t\t\tthis.fetchItems(\r\n\t\t\t\t\tnext.args.processor,\r\n\t\t\t\t\tnext.args.processorArgs,\r\n\t\t\t\t\tnext.component_uid\r\n\t\t\t\t);\r\n\r\n\t\t\tif (next.items && next.items.length == 1) {\r\n\t\t\t\tthis.selectFirstItem(next.items);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfetchItems(source, args, component_uid) {\r\n\t\t\tlet _args = this._onContainerValueChanged.call(\r\n\t\t\t\tthis,\r\n\t\t\t\tthis._currentValue\r\n\t\t\t);\r\n\t\t\t_args.shift();\r\n\t\t\tthis.props.getItems(\r\n\t\t\t\tsource,\r\n\t\t\t\tObject.assign(\r\n\t\t\t\t\tJSON.parse(args || this.props.args.processorArgs || \"{}\"),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_args\r\n\t\t\t\t\t}\r\n\t\t\t\t),\r\n\t\t\t\tcomponent_uid || this.props.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\tthis._mounted = false;\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tthis._mounted = true;\r\n\t\t\tif (this.props.args.processor) {\r\n\t\t\t\tthis.fetchItems(this.props.args.processor);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.props.items && this.props.items.length == 1) {\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tthis.selectFirstItem();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.isObjectIdMode() &&\r\n\t\t\t\tthis.props.value &&\r\n\t\t\t\ttypeof this.props.value !== \"object\"\r\n\t\t\t) {\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t\t[this.props.name]: this.getValueBasedOnMode(\r\n\t\t\t\t\t\t\tthis.props.value\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tisObjectIdMode() {\r\n\t\t\treturn this.props.args && this.props.args.mode === \"ObjectId\";\r\n\t\t}\r\n\t\toneOption() {\r\n\t\t\treturn this.props.items && this.props.items.length == 1;\r\n\t\t}\r\n\t\tselectFirstItem(items = this.props.items) {\r\n\t\t\tthis.onPickerValueChanged(items[0].id, items);\r\n\t\t}\r\n\t\tgetPickerValue(value = this.state.pickerValue) {\r\n\t\t\treturn {\r\n\t\t\t\t[this.props.name]: this.getValueBasedOnMode(value)\r\n\t\t\t};\r\n\t\t}\r\n\t\tgetPickerItemsById(v, items = this.props.items) {\r\n\t\t\tif (v && items && items.length) {\r\n\t\t\t\tlet r = items.filter(x => x.id == v);\r\n\t\t\t\treturn (r.length && r[0].elements) || [];\r\n\t\t\t}\r\n\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tonContainerValueChanged(value, pickerValue) {\r\n\t\t\tthis.props.valueChanged.apply(\r\n\t\t\t\tthis,\r\n\t\t\t\tthis._onContainerValueChanged.call(this, value, pickerValue)\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t_onContainerValueChanged(value, pickerValue) {\r\n\t\t\tlet superCancel =\r\n\t\t\t\tthis._currentValue &&\r\n\t\t\t\tObject.keys(this._currentValue).reduce((sum, x) => {\r\n\t\t\t\t\treturn (sum[x] = undefined), sum;\r\n\t\t\t\t}, {});\r\n\t\t\tthis._currentValue = value;\r\n\t\t\tpickerValue = pickerValue || this.getPickerValue();\r\n\t\t\tif (this.props.args.path) {\r\n\t\t\t\tlet _p = [pickerValue];\r\n\t\t\t\tif (superCancel) _p.push(superCancel);\r\n\t\t\t\tif (value) _p.push(value);\r\n\t\t\t\treturn _p;\r\n\t\t\t}\r\n\t\t\t//path is not defined so unpack the properties and send.\r\n\t\t\tlet result = [\r\n\t\t\t\tpickerValue,\r\n\t\t\t\t...Object.keys((value && value._no_path) || {}).map(x => {\r\n\t\t\t\t\treturn { [x]: value._no_path[x] };\r\n\t\t\t\t})\r\n\t\t\t];\r\n\r\n\t\t\tif (superCancel) {\r\n\t\t\t\tresult.splice(1, 0, superCancel);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tgetValueBasedOnMode(v) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.props.args &&\r\n\t\t\t\tthis.props.args.mode &&\r\n\t\t\t\ttypeof v !== \"object\" &&\r\n\t\t\t\tthis.props.args.mode == \"ObjectId\" && { $objectID: v }) ||\r\n\t\t\t\tv\r\n\t\t\t);\r\n\t\t}\r\n\t\trespondToPickerValueChanged(v, items = this.props.items) {\r\n\t\t\tlet _items = this.getPickerItemsById(v, items),\r\n\t\t\t\tpickerValue = null;\r\n\t\t\tif (items && items.length && items.filter(x => x.id == v).length) {\r\n\t\t\t\t//set the picker value.\r\n\t\t\t\tthis.onContainerValueChanged(null, this.getPickerValue(v));\r\n\t\t\t\tpickerValue = v;\r\n\t\t\t}\r\n\t\t\tif (this._mounted) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpickerValue,\r\n\t\t\t\t\titems: _items\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tonPickerValueChanged(v, items = this.props.items) {\r\n\t\t\tthis.respondToPickerValueChanged(\r\n\t\t\t\tv,\r\n\t\t\t\t(Array.prototype.isPrototypeOf(items) && items) || undefined\r\n\t\t\t);\r\n\t\t}\r\n\t\tisEmptyOrNull(v) {\r\n\t\t\treturn !v || !v.length;\r\n\t\t}\r\n\t\tstatic noPath() {\r\n\t\t\treturn \"_no_path\";\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\tif (this.props.busy) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\r\n\t\t\tlet initialElementsData = this.props.args.path\r\n\t\t\t\t? this.props.extra ? this.props.extra[this.props.args.path] : {}\r\n\t\t\t\t: this.props.extra;\r\n\t\t\treturn (\r\n\t\t\t\t<Layout\r\n\t\t\t\t\tvalue={this.props.label}\r\n\t\t\t\t\tinner={\r\n\t\t\t\t\t\t<Picker\r\n\t\t\t\t\t\t\tlabel={this.props.label}\r\n\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t!!this.props.args.disabled || this.oneOption()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\titems={this.props.items}\r\n\t\t\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t\t\t\tdisplayProperty=\"displayLabel\"\r\n\t\t\t\t\t\t\tkeyProperty=\"id\"\r\n\t\t\t\t\t\t\tvalue={this.state.pickerValue}\r\n\t\t\t\t\t\t\tvalueChanged={this.onPickerValueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t\textraElements={\r\n\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\tthis.props.args.path || DynamoSelectSet.noPath()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvalue={initialElementsData}\r\n\t\t\t\t\t\t\tvalueChanged={this.onContainerValueChanged}\r\n\t\t\t\t\t\t\telements={this.state.items}\r\n\t\t\t\t\t\t\tvalidator={this.state.containerValidator}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\tDynamoSelectSet.notifyExtra = true;\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoSelectSet);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport ValidatorHelper from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\nimport _ from \"lodash\";\r\nimport { runDynamoProcessor, openConfirmation } from \"./actions\";\r\n\r\nexport default (\r\n\tLayout,\r\n\tButton,\r\n\tList,\r\n\tModal,\r\n\tErrorText,\r\n\tProgressBar,\r\n\tContainer\r\n) => {\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Button, \"Button\");\r\n\tinvariants.validComponent(List, \"List\");\r\n\tinvariants.validComponent(Modal, \"Modal\");\r\n\tinvariants.validComponent(ErrorText, \"ErrorText\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\treturn {\r\n\t\t\tconfirmation:\r\n\t\t\t\tstate.app &&\r\n\t\t\t\tstate.app.confirmationResult &&\r\n\t\t\t\tstate.app.confirmationResult[ownProps.component_uid],\r\n\t\t\ttemplateCache: state.dynamo.templateCache,\r\n\t\t\tdataTemplate: state.dynamo[ownProps.component_uid],\r\n\t\t\tbusy: state.dynamo[`${ownProps.component_uid}-busy`]\r\n\t\t};\r\n\t};\r\n\tconst equivalent = function(arr, arr2) {\r\n\t\tif (\r\n\t\t\t(!arr && !arr2) ||\r\n\t\t\t(arr && arr.length == 0 && arr2 && arr2.length == 0)\r\n\t\t)\r\n\t\t\treturn true;\r\n\r\n\t\tif ((arr && !arr2) || (arr2 && !arr) || arr.length !== arr2.length)\r\n\t\t\treturn false;\r\n\r\n\t\treturn _.isEqualWith(arr, arr2, (objValue, otherValue) => {\r\n\t\t\tif (objValue === arr || otherValue === arr2) return;\r\n\t\t\tif (typeof otherValue == \"string\") {\r\n\t\t\t\treturn !!_.findKey(objValue, function(v) {\r\n\t\t\t\t\treturn v == otherValue;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tlet r = _.isMatch(objValue, otherValue);\r\n\t\t\treturn r;\r\n\t\t});\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tgetListItemDataTemplate: (id, args, key) =>\r\n\t\t\t\tdispatch(runDynamoProcessor(id, args, key)),\r\n\t\t\topenConfirmation: (id, message, params) =>\r\n\t\t\t\tdispatch(openConfirmation(id, message, params))\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoList extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalidator: {},\r\n\t\t\t\titems:\r\n\t\t\t\t\tthis.props.value ||\r\n\t\t\t\t\t(this.props.args && this.props.args.default) ||\r\n\t\t\t\t\t[],\r\n\t\t\t\tmodalVisible: false\r\n\t\t\t};\r\n\t\t\tthis.showModal = this.showModal.bind(this);\r\n\t\t\tthis.closeModal = this.closeModal.bind(this);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t\tthis.getItemTemplate = this.getItemTemplate.bind(this);\r\n\t\t\tthis.edit = this.edit.bind(this);\r\n\t\t\tthis.runValidators = this.runValidators.bind(this);\r\n\t\t\tthis.isDisabled = this.isDisabled.bind(this);\r\n\t\t\tthis.getListItemDataTemplate = this.getListItemDataTemplate.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.remove = this.remove.bind(this);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\tnext.confirmation !== this.props.confirmation &&\r\n\t\t\t\tnext.confirmation &&\r\n\t\t\t\tnext.confirmation.params &&\r\n\t\t\t\ttypeof next.confirmation.params.index !== \"undefined\" &&\r\n\t\t\t\tthis.state.items.length\r\n\t\t\t) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tthis.state.items.splice(next.confirmation.params.index, 1),\r\n\t\t\t\t\tthis.props.valueChanged({ [this.props.name]: items })\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.props.component_uid !== next.component_uid) {\r\n\t\t\t\t//setTimeout(() => {\r\n\t\t\t\tif (this._mounted) {\r\n\t\t\t\t\tlet items =\r\n\t\t\t\t\t\tnext.dataTemplate ||\r\n\t\t\t\t\t\tnext.value ||\r\n\t\t\t\t\t\t(next.args && next.args.default) ||\r\n\t\t\t\t\t\t[];\r\n\t\t\t\t\titems = items.slice();\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tnext.args.listItemDataTemplateProcessor &&\r\n\t\t\t\t\t\titems.length\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.getListItemDataTemplate(items, next);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tform: null,\r\n\t\t\t\t\t\titemTemplate: null,\r\n\t\t\t\t\t\titems,\r\n\t\t\t\t\t\tmodalVisible: false\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.props.valueChanged({ [this.props.name]: items });\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.dataTemplate &&\r\n\t\t\t\t(!equivalent(next.dataTemplate, this.props.dataTemplate) ||\r\n\t\t\t\t\t!equivalent(next.dataTemplate, this.state.items))\r\n\t\t\t) {\r\n\t\t\t\tif (this._mounted) {\r\n\t\t\t\t\tif (Array.prototype.isPrototypeOf(next.dataTemplate))\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\titems: next.dataTemplate.slice()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.state.items.splice(\r\n\t\t\t\t\t\t\tthis.state.items.length - 1,\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tnext.dataTemplate\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\tthis._mounted = false;\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tthis._mounted = true;\r\n\t\t\t//if its template is a reference then store it.\r\n\t\t\tif (this.isTemplateRef()) {\r\n\t\t\t\tthis.props.templateCache[\r\n\t\t\t\t\tthis.props.args.itemTemplate.dynamo_ref\r\n\t\t\t\t] = Array.prototype.isPrototypeOf(this.props.args.itemTemplate)\r\n\t\t\t\t\t? this.props.args.itemTemplate\r\n\t\t\t\t\t: this.props.args.itemTemplate.template;\r\n\t\t\t}\r\n\t\t\t//if theres a default then update everyone.\r\n\t\t\tif (this.state.items && this.state.items.length) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t\t[this.props.name]: this.state.items\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t\tlet equal = equivalent(this.props.dataTemplate, this.state.items);\r\n\t\t\t//if theres a data template processor then run it.\r\n\t\t\tif (\r\n\t\t\t\tthis.props.args.listItemDataTemplateProcessor &&\r\n\t\t\t\tthis.state.items &&\r\n\t\t\t\tthis.state.items.length &&\r\n\t\t\t\t!equal\r\n\t\t\t) {\r\n\t\t\t\tthis.getListItemDataTemplate(this.state.items);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.props.dataTemplate &&\r\n\t\t\t\tthis.props.dataTemplate.length &&\r\n\t\t\t\tequal\r\n\t\t\t) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\titems: this.props.dataTemplate.slice()\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tgetListItemDataTemplate(i, props = this.props) {\r\n\t\t\tthis.props.getListItemDataTemplate(\r\n\t\t\t\tprops.args.listItemDataTemplateProcessor,\r\n\t\t\t\ti,\r\n\t\t\t\tprops.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\t\tisTemplateRef() {\r\n\t\t\treturn (\r\n\t\t\t\t(this.props.args.itemTemplate &&\r\n\t\t\t\t\t!Array.prototype.isPrototypeOf(\r\n\t\t\t\t\t\tthis.props.args.itemTemplate\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\tthis.props.args.itemTemplate.dynamo_ref) ||\r\n\t\t\t\t(this.props.args.behavior &&\r\n\t\t\t\t\tthis.props.args.behavior.dynamo_ref &&\r\n\t\t\t\t\tthis.props.args.itemTemplate)\r\n\t\t\t);\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidatorHelper(this).run();\r\n\t\t}\r\n\t\tisDisabled() {\r\n\t\t\treturn this.props.args && this.props.args.disabled;\r\n\t\t}\r\n\t\tshowModal() {\r\n\t\t\tif (!this.isDisabled()) this.setState({ modalVisible: true });\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.items && this.state.items.length) ||\r\n\t\t\t\t\"Requires atleast one item to have been added to the list\"\r\n\t\t\t);\r\n\t\t}\r\n\t\tisLessThanMaxLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.items &&\r\n\t\t\t\t\tthis.state.items.length &&\r\n\t\t\t\t\tthis.state.items.length <= element.args.max) ||\r\n\t\t\t\t(element.error ||\r\n\t\t\t\t\t\"The maximum number of items is \" + element.args.max)\r\n\t\t\t);\r\n\t\t}\r\n\t\tisGreaterThanMinLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.items &&\r\n\t\t\t\t\tthis.state.items.length &&\r\n\t\t\t\t\tthis.state.items.length >= element.args.min) ||\r\n\t\t\t\t(element.error ||\r\n\t\t\t\t\t\"The minimum number of items is \" + element.args.min)\r\n\t\t\t);\r\n\t\t}\r\n\t\tcloseModal(result) {\r\n\t\t\t//he/she clicked ok\r\n\t\t\tif (result) {\r\n\t\t\t\tthis.state.validator.validate().then(() => {\r\n\t\t\t\t\tlet items = this.state.items || [];\r\n\r\n\t\t\t\t\tif (!this.state.edit) items.push(this.state.form);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\titems.splice(\r\n\t\t\t\t\t\t\titems.indexOf(this.state.edit),\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tthis.state.form\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\tthis.props.valueChanged({ [this.props.name]: items });\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\titems: Object.assign([], items),\r\n\t\t\t\t\t\tmodalVisible: false,\r\n\t\t\t\t\t\tedit: null,\r\n\t\t\t\t\t\tform: null\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (this.props.args.listItemDataTemplateProcessor)\r\n\t\t\t\t\t\tthis.getListItemDataTemplate(items);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//canceled the modal box.\r\n\r\n\t\t\tthis.setState({ modalVisible: false, form: null, edit: null });\r\n\t\t}\r\n\t\tvalueChanged(v) {\r\n\t\t\tthis.state.form = v && v[DynamoList.modalName()];\r\n\t\t}\r\n\t\tclone(item) {\r\n\t\t\treturn JSON.parse(JSON.stringify(item));\r\n\t\t}\r\n\t\tremove(index) {\r\n\t\t\tthis.props.openConfirmation(\r\n\t\t\t\tthis.props.component_uid,\r\n\t\t\t\t\"Are you sure you want to remove that item ?\",\r\n\t\t\t\t{ index }\r\n\t\t\t);\r\n\t\t}\r\n\t\tedit(index) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tedit: this.state.items[index],\r\n\t\t\t\tform: this.state.items[index],\r\n\t\t\t\tmodalVisible: true\r\n\t\t\t});\r\n\t\t}\r\n\t\tstatic modalName() {\r\n\t\t\treturn \"_modal_\";\r\n\t\t}\r\n\t\tgetItemTemplate() {\r\n\t\t\tif (this.state.itemTemplate) return this.state.itemTemplate;\r\n\r\n\t\t\tif (!this.props.args.itemTemplate) {\r\n\t\t\t\tif (\r\n\t\t\t\t\t(!this.props.args.behavior ||\r\n\t\t\t\t\t\t!this.props.args.behavior.template_ref) &&\r\n\t\t\t\t\t!this.props.args.disabled\r\n\t\t\t\t)\r\n\t\t\t\t\tthrow new Error(\"Empty List view item template\");\r\n\r\n\t\t\t\tthis.props.args.itemTemplate =\r\n\t\t\t\t\tthis.props.templateCache[\r\n\t\t\t\t\t\tthis.props.args.behavior &&\r\n\t\t\t\t\t\t\tthis.props.args.behavior.template_ref\r\n\t\t\t\t\t] || [];\r\n\t\t\t}\r\n\r\n\t\t\tlet itemTemplate = this.clone(\r\n\t\t\t\tthis.isTemplateRef()\r\n\t\t\t\t\t? this.props.args.itemTemplate.template\r\n\t\t\t\t\t: this.props.args.itemTemplate\r\n\t\t\t);\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.props.args.behavior &&\r\n\t\t\t\tthis.props.args.behavior.extension &&\r\n\t\t\t\tthis.props.args.behavior.extension.length\r\n\t\t\t)\r\n\t\t\t\tthis.props.args.behavior.extension.forEach((element, index) => {\r\n\t\t\t\t\telement.key = index;\r\n\t\t\t\t\titemTemplate.push(this.clone(element));\r\n\t\t\t\t});\r\n\t\t\t//this happens asynchronously;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this._mounted)\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\titemTemplate: itemTemplate\r\n\t\t\t\t\t});\r\n\t\t\t}, 0);\r\n\r\n\t\t\t//this.state.itemTemplate = itemTemplate;\r\n\t\t\treturn itemTemplate;\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\tif (this.props.busy) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\t\t\tlet template = this.getItemTemplate(),\r\n\t\t\t\tdisabled = this.isDisabled();\r\n\r\n\t\t\treturn (\r\n\t\t\t\t/*jshint ignore:start */\r\n\t\t\t\t<Layout value={this.props.label}>\r\n\t\t\t\t\t<Button disabled={disabled} click={this.showModal} />\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\titems={this.state.items}\r\n\t\t\t\t\t\trowClicked={this.edit}\r\n\t\t\t\t\t\trowRemoved={this.remove}\r\n\t\t\t\t\t\trowTemplate={\r\n\t\t\t\t\t\t\tthis.props.args.rowTemplate &&\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.rowTemplate)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ErrorText value={this.state.errors} />\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\t\telements={template}\r\n\t\t\t\t\t\t\t\tvalue={this.state.edit}\r\n\t\t\t\t\t\t\t\tname={DynamoList.modalName()}\r\n\t\t\t\t\t\t\t\tvalidator={this.state.validator}\r\n\t\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvisibility={this.state.modalVisible}\r\n\t\t\t\t\t\tdone={this.closeModal}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t\t/*jshint ignore:end */\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoList);\r\n};\r\n","export default props => {\r\n\tsetTimeout(\r\n\t\t() =>\r\n\t\t\t(props.value || (props.args && props.args.default)) &&\r\n\t\t\tprops.valueChanged({\r\n\t\t\t\t[props.name]: props.value || (props.args && props.args.default)\r\n\t\t\t}),\r\n\t\t0\r\n\t);\r\n\treturn null;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { fetchDynamoProcess } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Link, NavigationActions) => {\r\n\tif (invariants.validComponent(Link, \"Link\") && !NavigationActions)\r\n\t\tthrow new Error(\"NavigationActions cannot be null (dynamo_nav)\");\r\n\r\n\tconst mapDispatchToState = dispatch => {\r\n\t\treturn {\r\n\t\t\tdispatch\r\n\t\t};\r\n\t};\r\n\r\n\t//{text:\"link text\",type:\"DYNAMO or CLIENT\",config:{value:\"\"}}\r\n\tclass DynamoNav extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.go = this.go.bind(this);\r\n\t\t\tthis.state = { link: this.props.value };\r\n\t\t}\r\n\t\tstatic getParams(firstItemIsLink, link) {\r\n\t\t\tlet key_value = link.split(\"|\");\r\n\t\t\tif (firstItemIsLink) link = key_value.shift();\r\n\t\t\tlet params = key_value.reduce((sum, x) => {\r\n\t\t\t\t\tlet sp = x.split(\"=\");\r\n\t\t\t\t\treturn (sum[sp[0]] = sp[1]), sum;\r\n\t\t\t\t}, {}),\r\n\t\t\t\tresult = { params };\r\n\t\t\tif (firstItemIsLink || !key_value.length) result.link = link;\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tgo() {\r\n\t\t\tlet params = null;\r\n\t\t\tlet link =\r\n\t\t\t\tthis.state.link ||\r\n\t\t\t\t(this.props.args.config && this.props.args.config.value);\r\n\t\t\tif (link) {\r\n\t\t\t\tlet linkAndParams = DynamoNav.getParams(true, link);\r\n\t\t\t\tif (this.props.args.params) {\r\n\t\t\t\t\tlet paramsOnly = DynamoNav.getParams(\r\n\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\tthis.props.args.params\r\n\t\t\t\t\t);\r\n\t\t\t\t\tObject.assign(linkAndParams.params, paramsOnly.params);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlink = linkAndParams.link;\r\n\t\t\t\tparams = linkAndParams.params;\r\n\t\t\t\tswitch (this.props.args.type) {\r\n\t\t\t\t\tcase DynamoNav.NAV_TYPE.CLIENT:\r\n\t\t\t\t\t\tthis.props.dispatch(\r\n\t\t\t\t\t\t\tNavigationActions.setParams({\r\n\t\t\t\t\t\t\t\tkey: link,\r\n\t\t\t\t\t\t\t\tparams\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase DynamoNav.NAV_TYPE.DYNAMO:\r\n\t\t\t\t\t\tconst setParamsAction = NavigationActions.setParams({\r\n\t\t\t\t\t\t\tparams: { id: link, fetchParams: params },\r\n\t\t\t\t\t\t\tkey: \"Dynamo\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.props.dispatch(setParamsAction);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\trender() {\r\n\t\t\treturn (\r\n\t\t\t\t/*jshint ignore:start */\r\n\t\t\t\t<Link\r\n\t\t\t\t\ttext={this.props.args.text}\r\n\t\t\t\t\tdisabled={this.props.args.disabled}\r\n\t\t\t\t\tgo={this.go}\r\n\t\t\t\t/>\r\n\t\t\t\t/*jshint ignore:end */\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\tDynamoNav.NAV_TYPE = { CLIENT: \"CLIENT\", DYNAMO: \"DYNAMO\" };\r\n\treturn connect(null, mapDispatchToState)(DynamoNav);\r\n};\r\n","import React from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default Image => {\r\n\tinvariants.validComponent(Image, \"Image\");\r\n\treturn props => {\r\n\t\tlet { value, args, ...rest } = props;\r\n\t\tif (value && props.args.type == \"URL\") {\r\n\t\t\tlet data = props.args.config.data.replace(\r\n\t\t\t\t\tnew RegExp(`{${props.name}}`, \"g\"),\r\n\t\t\t\t\tvalue\r\n\t\t\t\t),\r\n\t\t\t\targs = Object.assign({}, props.args);\r\n\t\t\targs.config = { data };\r\n\t\t\treturn <Image args={args} {...rest} />;\r\n\t\t}\r\n\t\treturn <Image {...props} />;\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n\trunDynamoProcessor,\r\n\tgetMoreForGrid,\r\n\tfilterGrid,\r\n\tgetSingleItemForGrid,\r\n\tgetFilterTemplate,\r\n\tgetItemTemplate,\r\n\tshowMessage\r\n} from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport const GRID_MODES = {\r\n\tCRUD: \"CRUD\",\r\n\tEDITONLY: \"EDITONLY\"\r\n};\r\nexport const ITEM_MODES = {\r\n\tNEW: \"NEW\",\r\n\tEDIT: \"EDIT\"\r\n};\r\n\r\nexport default (\r\n\tLayout,\r\n\tList,\r\n\tItemView,\r\n\tHeader,\r\n\tProgressBar,\r\n\tCommandsView,\r\n\tNavigationActions,\r\n\tCommandResultView,\r\n\tContainer\r\n) => {\r\n\tif (\r\n\t\tinvariants.validComponent(Layout, \"Layout\") &&\r\n\t\tinvariants.validComponent(Header, \"Header\") &&\r\n\t\tinvariants.validComponent(List, \"List\") &&\r\n\t\tinvariants.validComponent(ItemView, \"ItemView\") &&\r\n\t\tinvariants.validComponent(ProgressBar, \"ProgressBar\") &&\r\n\t\tinvariants.validComponent(CommandsView, \"CommandsView\") &&\r\n\t\tinvariants.validComponent(Container, \"Container\") &&\r\n\t\tinvariants.validComponent(CommandResultView, \"CommandResultView\") &&\r\n\t\t!NavigationActions\r\n\t)\r\n\t\tthrow new Error(\"NavigationActions cannot be null (dynamo_grid)\");\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\trun: (id, args, key) =>\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\trunDynamoProcessor(id, args, key, { disableCache: true })\r\n\t\t\t\t),\r\n\t\t\tmore: (id, args, key) => dispatch(getMoreForGrid(id, args, key)),\r\n\t\t\tgo: value =>\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\tNavigationActions.setParams({\r\n\t\t\t\t\t\tparams: { id: value },\r\n\t\t\t\t\t\tkey: \"Dynamo\"\r\n\t\t\t\t\t})\r\n\t\t\t\t),\r\n\t\t\tgetSingleItem: (id, args, key) =>\r\n\t\t\t\tdispatch(getSingleItemForGrid(id, args, key)),\r\n\t\t\tgetItemTemplate: (id, args, key) =>\r\n\t\t\t\tdispatch(getItemTemplate(id, args, key)),\r\n\t\t\tgetFilterTemplate: (id, args, key) =>\r\n\t\t\t\tdispatch(getFilterTemplate(id, args, key)),\r\n\t\t\tfilterGrid: (id, args, key) => dispatch(filterGrid(id, args, key)),\r\n\t\t\tshowMessage: message => dispatch(showMessage(message))\r\n\t\t};\r\n\t};\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tvar result = state.dynamo[ownProps.component_uid];\r\n\t\treturn {\r\n\t\t\titems: result && result.data ? result.data.items : null,\r\n\t\t\ttotal: result && result.data ? result.data.total : 0,\r\n\t\t\tbusy: result && !!result.fetchingGrid,\r\n\t\t\tfilterTemplate:\r\n\t\t\t\tresult &&\r\n\t\t\t\t(result.filterTemplate ||\r\n\t\t\t\t\t(ownProps.args && ownProps.args.filter) ||\r\n\t\t\t\t\tnull),\r\n\t\t\tfilter: result && result.filter,\r\n\t\t\tsingleItem: result && result.singleItem,\r\n\t\t\titemTemplate: result && result.itemTemplate,\r\n\t\t\tfetchingSingleItem: result && result.fetchingSingleItem,\r\n\t\t\tfetchingFilterTemplate: result && result.gettingFilterTemplate,\r\n\t\t\tfetchingItemTemplate: result && result.gettingTemplate,\r\n\t\t\tcommandProcessed:\r\n\t\t\t\tstate.dynamo[\r\n\t\t\t\t\townProps.component_uid + DynamoGrid.commandResultViewName()\r\n\t\t\t\t],\r\n\t\t\tcommandProcessing:\r\n\t\t\t\tstate.dynamo[\r\n\t\t\t\t\townProps.component_uid +\r\n\t\t\t\t\t\tDynamoGrid.commandResultViewName() +\r\n\t\t\t\t\t\t\"-busy\"\r\n\t\t\t\t],\r\n\t\t\tprocessed:\r\n\t\t\t\tstate.dynamo[ownProps.component_uid + DynamoGrid.itemViewName()]\r\n\t\t};\r\n\t};\r\n\tclass DynamoGrid extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalidator: {},\r\n\t\t\t\tshowItemView: false,\r\n\t\t\t\tcount: this.props.args.pageCount || 5,\r\n\t\t\t\tshowCommandResultView: false\r\n\t\t\t};\r\n\t\t\tthis.showItemView = this.showItemView.bind(this);\r\n\t\t\tthis.cancel = this.cancel.bind(this);\r\n\t\t\tthis.showItemView = this.showItemView.bind(this);\r\n\t\t\tthis.isCRUD = this.isCRUD.bind(this);\r\n\t\t\tthis.isEDITONLY = this.isEDITONLY.bind(this);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t\tthis.getItemsFromSource = this.getItemsFromSource.bind(this);\r\n\t\t\tthis.done = this.done.bind(this);\r\n\t\t\tthis._filterValidator = {};\r\n\t\t\tthis.filter = this.filter.bind(this);\r\n\t\t\tthis.filterValueChanged = this.filterValueChanged.bind(this);\r\n\t\t\tthis.more = this.more.bind(this);\r\n\t\t\tthis.finished = this.finished.bind(this);\r\n\t\t\tthis.openCommandMenu = this.openCommandMenu.bind(this);\r\n\t\t\tthis.closeCommandView = this.closeCommandView.bind(this);\r\n\t\t\tthis.execCommand = this.execCommand.bind(this);\r\n\t\t\tthis.showCommandResult = this.showCommandResult.bind(this);\r\n\t\t\tthis.closeCommandResult = this.closeCommandResult.bind(this);\r\n\t\t\tif (\r\n\t\t\t\t(this.isCRUD() || this.isEDITONLY()) &&\r\n\t\t\t\t(!this.props.args.commands ||\r\n\t\t\t\t\t!this.props.args.commands.filter(\r\n\t\t\t\t\t\tx => x.commandType == \"$EDIT\"\r\n\t\t\t\t\t).length)\r\n\t\t\t) {\r\n\t\t\t\tlet cmd = {\r\n\t\t\t\t\tcommandText: \"Edit\",\r\n\t\t\t\t\tcommand: { value: \"\" },\r\n\t\t\t\t\tcommandType: \"$EDIT\",\r\n\t\t\t\t\tcommandIcon: \"mode-edit\"\r\n\t\t\t\t};\r\n\t\t\t\tif (!this.props.args.commands) this.props.args.commands = [];\r\n\t\t\t\tthis.props.args.commands.unshift(cmd);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tif (\r\n\t\t\t\tthis.props.args.filterProcessor &&\r\n\t\t\t\t!this.props.fetchingFilterTemplate\r\n\t\t\t) {\r\n\t\t\t\tthis.props.getFilterTemplate(\r\n\t\t\t\t\tthis.props.args.filterProcessor,\r\n\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tshowCommandResult(props = this.props) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tshowCommandsView: false,\r\n\t\t\t\tshowCommandResultView: true,\r\n\t\t\t\tcommandResult: props.commandProcessed\r\n\t\t\t});\r\n\t\t}\r\n\t\tcloseCommandResult() {\r\n\t\t\tthis.setState({\r\n\t\t\t\tshowCommandResultView: false,\r\n\t\t\t\tresult: null\r\n\t\t\t});\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.processed !== this.props.processed) {\r\n\t\t\t\t//console.log(\"componentWillReceiveProps fired get items\");\r\n\t\t\t\tthis.getItemsFromSource(null, \"filterGrid\");\r\n\t\t\t}\r\n\r\n\t\t\tif (next.commandProcessed !== this.props.commandProcessed) {\r\n\t\t\t\tthis.showCommandResult(next);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.singleItem &&\r\n\t\t\t\tnext.singleItem !== this.props.singleItem &&\r\n\t\t\t\t(next.itemTemplate &&\r\n\t\t\t\t\tnext.itemTemplate !== this.props.itemTemplate)\r\n\t\t\t) {\r\n\t\t\t\treturn this.showItemView(\r\n\t\t\t\t\tITEM_MODES.EDIT,\r\n\t\t\t\t\tnext.singleItem,\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\tnext.itemTemplate\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.singleItem &&\r\n\t\t\t\tnext.singleItem !== this.props.singleItem &&\r\n\t\t\t\t!next.fetchingItemTemplate\r\n\t\t\t) {\r\n\t\t\t\treturn this.showItemView(\r\n\t\t\t\t\tITEM_MODES.EDIT,\r\n\t\t\t\t\tnext.singleItem,\r\n\t\t\t\t\ttrue\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.itemTemplate &&\r\n\t\t\t\tnext.itemTemplate !== this.props.itemTemplate\r\n\t\t\t) {\r\n\t\t\t\tthis.showItemView(\r\n\t\t\t\t\tthis.state.mode,\r\n\t\t\t\t\tthis.state.existingValue || this.props.singleItem,\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\tnext.itemTemplate\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tgetItemsFromSource(\r\n\t\t\tfilter = this.props.filter,\r\n\t\t\tmethodName = \"run\",\r\n\t\t\textra\r\n\t\t) {\r\n\t\t\tthis.props[methodName](\r\n\t\t\t\tthis.props.args.source,\r\n\t\t\t\tObject.assign(\r\n\t\t\t\t\t{},\r\n\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\t{ count: this.state.count, full: true },\r\n\t\t\t\t\tfilter ? { query: filter } : {},\r\n\t\t\t\t\textra || {}\r\n\t\t\t\t),\r\n\t\t\t\tthis.props.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tfilter() {\r\n\t\t\tthis._filterValidator.validate().then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.getItemsFromSource(this.state.filter, \"filterGrid\");\r\n\t\t\t\t},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tconsole.warn(\"a field in filter is invalid\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tstatic itemViewName() {\r\n\t\t\treturn \"_itemView_\";\r\n\t\t}\r\n\t\tstatic filterViewName() {\r\n\t\t\treturn \"_filterView_\";\r\n\t\t}\r\n\t\tstatic commandResultViewName() {\r\n\t\t\treturn \"_commandResultView_\";\r\n\t\t}\r\n\t\tvalueChanged(value) {\r\n\t\t\tthis.state.form = value ? value[DynamoGrid.itemViewName()] : null;\r\n\t\t}\r\n\t\tdone(submitted) {\r\n\t\t\tif (!submitted)\r\n\t\t\t\treturn this.setState({ showItemView: false, form: null });\r\n\r\n\t\t\tthis.state.validator.validate().then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tlet id;\r\n\t\t\t\t\tswitch (this.state.mode) {\r\n\t\t\t\t\t\tcase ITEM_MODES.NEW:\r\n\t\t\t\t\t\t\tid = this.props.args.extra.createProcessor;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase ITEM_MODES.EDIT:\r\n\t\t\t\t\t\t\tid =\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.editProcessor ||\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.createProcessor;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!id) {\r\n\t\t\t\t\t\treturn console.error(\r\n\t\t\t\t\t\t\t\"done  was called on a grid view in \" +\r\n\t\t\t\t\t\t\t\tthis.props.args.mode +\r\n\t\t\t\t\t\t\t\t\" and it does not have a processor for it. \\n\" +\r\n\t\t\t\t\t\t\t\tJSON.stringify(this.props, null, \" \")\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.props.run(\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tObject.assign(\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tentity: this.state.form\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tthis.props.component_uid + DynamoGrid.itemViewName()\r\n\t\t\t\t\t);\r\n\t\t\t\t\t//this.setState({ showItemView: false });\r\n\t\t\t\t\tthis.cancel();\r\n\t\t\t\t},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tconsole.log(\"some modal fields are invalid\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tshowItemView(mode, args, skipFetch, _itemTemplate) {\r\n\t\t\tlet template = _itemTemplate,\r\n\t\t\t\texistingValue;\r\n\t\t\tif (this.props.args.extra)\r\n\t\t\t\tswitch (mode) {\r\n\t\t\t\t\tcase ITEM_MODES.NEW:\r\n\t\t\t\t\t\ttemplate =\r\n\t\t\t\t\t\t\t_itemTemplate ||\r\n\t\t\t\t\t\t\t((this.props.args.extra.createTemplate &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate.length &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate) ||\r\n\t\t\t\t\t\t\t\tthis.props.itemTemplate ||\r\n\t\t\t\t\t\t\t\t[])\r\n\t\t\t\t\t\t\t\t.slice();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase ITEM_MODES.EDIT:\r\n\t\t\t\t\t\ttemplate =\r\n\t\t\t\t\t\t\t_itemTemplate ||\r\n\t\t\t\t\t\t\t((this.props.args.extra.editTemplate &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.editTemplate.length &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.editTemplate) ||\r\n\t\t\t\t\t\t\t\t(this.props.args.extra.createTemplate &&\r\n\t\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate\r\n\t\t\t\t\t\t\t\t\t\t.length &&\r\n\t\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate) ||\r\n\t\t\t\t\t\t\t\tthis.props.itemTemplate ||\r\n\t\t\t\t\t\t\t\t[])\r\n\t\t\t\t\t\t\t\t.slice();\r\n\t\t\t\t\t\texistingValue = args;\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tthis.props.args.extra.fetchSingleItemProcessor &&\r\n\t\t\t\t\t\t\t!this.props.fetchingSingleItem &&\r\n\t\t\t\t\t\t\t!skipFetch\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\ttemplate = [];\r\n\t\t\t\t\t\t\texistingValue = null;\r\n\t\t\t\t\t\t\tthis.props.getSingleItem(\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.fetchSingleItemProcessor,\r\n\t\t\t\t\t\t\t\targs,\r\n\t\t\t\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t(!template || !Array.prototype.isPrototypeOf(template)) &&\r\n\t\t\t\t!this.props.args.extra.fetchTemplateProcessor\r\n\t\t\t) {\r\n\t\t\t\treturn console.error(\r\n\t\t\t\t\t\"showItemTemplate was called on a grid view in \" +\r\n\t\t\t\t\t\tthis.props.args.mode +\r\n\t\t\t\t\t\t\" and it does not have a template. \\n\" +\r\n\t\t\t\t\t\tJSON.stringify(this.props, null, \" \")\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\t(!template || !template.length) &&\r\n\t\t\t\t!this.props.fetchingItemTemplate &&\r\n\t\t\t\tthis.props.args.extra.fetchTemplateProcessor &&\r\n\t\t\t\t!skipFetch\r\n\t\t\t) {\r\n\t\t\t\tthis.props.getItemTemplate(\r\n\t\t\t\t\tthis.props.args.extra.fetchTemplateProcessor,\r\n\t\t\t\t\targs,\r\n\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tshowItemView: true,\r\n\t\t\t\tmode: mode,\r\n\t\t\t\tshowCommandsView: false,\r\n\t\t\t\titemViewElements: template,\r\n\t\t\t\texistingValue: existingValue\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tmore() {\r\n\t\t\tif (!this.finished() && !this.props.busy) {\r\n\t\t\t\t//console.log(\"more fired getItemsFromSource\");\r\n\t\t\t\tlet query = {\r\n\t\t\t\t\tcount: this.state.count\r\n\t\t\t\t};\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.props.items &&\r\n\t\t\t\t\tthis.props.items[this.props.items.length - 1]\r\n\t\t\t\t) {\r\n\t\t\t\t\tquery._id = this.props.items[\r\n\t\t\t\t\t\tthis.props.items.length - 1\r\n\t\t\t\t\t]._id;\r\n\t\t\t\t\tconsole.log(\"most recent id:\" + query._id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.getItemsFromSource(null, \"more\", query);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfinished() {\r\n\t\t\treturn (\r\n\t\t\t\tthis.props.items && this.props.total == this.props.items.length\r\n\t\t\t);\r\n\t\t}\r\n\t\tcancel() {\r\n\t\t\tthis.setState({\r\n\t\t\t\tmode: null,\r\n\t\t\t\tshowItemView: false,\r\n\t\t\t\titemViewElements: null,\r\n\t\t\t\tshowCommandsView: false,\r\n\t\t\t\texistingValue: null\r\n\t\t\t});\r\n\t\t}\r\n\t\tfilterValueChanged(value) {\r\n\t\t\tthis.state.filter = value\r\n\t\t\t\t? value[DynamoGrid.filterViewName()]\r\n\t\t\t\t: null;\r\n\t\t}\r\n\t\tcloseCommandView() {\r\n\t\t\tthis.setState({ showCommandsView: false });\r\n\t\t}\r\n\t\topenCommandMenu(item) {\r\n\t\t\tthis.setState({ item: item, showCommandsView: true });\r\n\t\t}\r\n\t\texecCommand(command, item = this.state.item) {\r\n\t\t\tswitch (command.commandType) {\r\n\t\t\t\tcase \"NAV\":\r\n\t\t\t\t\tthis.props.go(command.command.value, {\r\n\t\t\t\t\t\tfetchParams: { _id: item._id }\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"$EDIT\":\r\n\t\t\t\t\tthis.showItemView(ITEM_MODES.EDIT, item);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"PROCESSOR\":\r\n\t\t\t\t\tthis.props.run(\r\n\t\t\t\t\t\tcommand.command.value,\r\n\t\t\t\t\t\tObject.assign(\r\n\t\t\t\t\t\t\t{},\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\t\t\titem\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tthis.props.component_uid +\r\n\t\t\t\t\t\t\tDynamoGrid.commandResultViewName()\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tisCRUD() {\r\n\t\t\treturn this.props.args.mode == GRID_MODES.CRUD;\r\n\t\t}\r\n\t\tisEDITONLY() {\r\n\t\t\treturn this.props.args.mode == GRID_MODES.EDITONLY;\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tlet args = this.props.args,\r\n\t\t\t\theader = this.props.filterTemplate ? (\r\n\t\t\t\t\t<Header filter={() => this.filter()}>\r\n\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\telements={this.props.filterTemplate}\r\n\t\t\t\t\t\t\tvalue={this.state.filter}\r\n\t\t\t\t\t\t\tvalueChanged={this.filterValueChanged}\r\n\t\t\t\t\t\t\tname={DynamoGrid.filterViewName()}\r\n\t\t\t\t\t\t\tvalidator={this._filterValidator}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t) : this.props.fetchingFilterTemplate ? (\r\n\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t) : null,\r\n\t\t\t\tfooter =\r\n\t\t\t\t\t!this.finished() && this.props.busy ? (\r\n\t\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t\t) : null;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Layout>\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\ttitle={this.props.label}\r\n\t\t\t\t\t\tcanAddOrEdit={this.isCRUD()}\r\n\t\t\t\t\t\theader={header}\r\n\t\t\t\t\t\tfooter={footer}\r\n\t\t\t\t\t\ttotal={this.props.total}\r\n\t\t\t\t\t\tshowItemView={this.showItemView}\r\n\t\t\t\t\t\titems={this.props.items}\r\n\t\t\t\t\t\ttemplateConfig={\r\n\t\t\t\t\t\t\tthis.props.args.templateConfig ? (\r\n\t\t\t\t\t\t\t\tJSON.parse(this.props.args.templateConfig)\r\n\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmore={this.more}\r\n\t\t\t\t\t\tcommands={this.props.args.commands}\r\n\t\t\t\t\t\texecCommand={this.execCommand}\r\n\t\t\t\t\t\topenCommandMenu={this.openCommandMenu}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ItemView\r\n\t\t\t\t\t\tvisibility={\r\n\t\t\t\t\t\t\t(this.isCRUD() || this.isEDITONLY()) &&\r\n\t\t\t\t\t\t\tthis.state.showItemView\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdone={this.done}\r\n\t\t\t\t\t\tbusy={\r\n\t\t\t\t\t\t\tthis.props.fetchingSingleItem ||\r\n\t\t\t\t\t\t\tthis.props.fetchingItemTemplate\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\t\telements={this.state.itemViewElements}\r\n\t\t\t\t\t\t\t\tvalue={this.state.existingValue}\r\n\t\t\t\t\t\t\t\tname={DynamoGrid.itemViewName()}\r\n\t\t\t\t\t\t\t\tvalidator={this.state.validator}\r\n\t\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<CommandsView\r\n\t\t\t\t\t\tvisibility={this.state.showCommandsView}\r\n\t\t\t\t\t\tclose={this.closeCommandView}\r\n\t\t\t\t\t\tcommands={this.props.args.commands}\r\n\t\t\t\t\t\texecCommand={this.execCommand}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<CommandResultView\r\n\t\t\t\t\t\tvisibility={this.state.showCommandResultView}\r\n\t\t\t\t\t\tdone={this.closeCommandResult}\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\t\telements={this.state.commandResult}\r\n\t\t\t\t\t\t\t\tname={DynamoGrid.commandResultViewName()}\r\n\t\t\t\t\t\t\t\tvalidator={{}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttitle={\"\"}\r\n\t\t\t\t\t\tbusy={this.props.commandProcessing}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoGrid);\r\n};\r\n","import React, { Component } from \"react\";\r\n\r\nexport default PlatformComponent => {\r\n\treturn class DynamoHTMLViewer extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\treturn (\r\n\t\t\t\t<PlatformComponent\r\n\t\t\t\t\thtml={this.props.value || this.props.args.html}\r\n\t\t\t\t\t{...this.props}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { uploadDynamoFile, getDynamoFilePreview } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport ValidationHelper from \"./utils/validator\";\r\n/**\r\n * This component should render a file uploader\r\n * @param  {Class} Uploader Component responsible for uploading the file\r\n * @param  {Array} previews Array of component definitions with an id property\r\n * @return {Class}          Configured component.\r\n */\r\nexport default (Uploader, ProgressBar, Text, previews = []) => {\r\n\tinvariants.validComponent(Uploader, \"Uploader\");\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(Text, \"Text\");\r\n\r\n\tclass DynamoFileUpload extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = {};\r\n\t\t\tthis._previewType = this.getPreviewType.call(this);\r\n\t\t\tthis._supported = this.isSupported();\r\n\t\t\tthis._getPreview = this._getPreview.bind(this);\r\n\t\t\tthis._query = this.getPreviewQuery();\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.upload = this.upload.bind(this);\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidationHelper(this).run();\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.props.uploadedId || \"is required\";\r\n\t\t}\r\n\t\tgetPreviewQuery() {\r\n\t\t\treturn Uploader.getPreviewQuery(this.props.args.fileType);\r\n\t\t}\r\n\t\tgetPreviewType() {\r\n\t\t\tfor (var i = 0; i < previews.length; i++) {\r\n\t\t\t\tif (previews[i].id.test(this.props.args.fileType)) {\r\n\t\t\t\t\treturn previews[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tisSupported() {\r\n\t\t\treturn Uploader.supports(this.props.args.fileType);\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tif (this.props.uploadedId) {\r\n\t\t\t\tthis._getPreview(this.props.uploadedId);\r\n\t\t\t}\r\n\t\t}\r\n\t\t_getPreview(id) {\r\n\t\t\tthis.props.getPreview(\r\n\t\t\t\tid,\r\n\t\t\t\tthis.props.component_uid,\r\n\t\t\t\tthis.props.args.fileType,\r\n\t\t\t\tthis._query\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\tnext.uploadedId !== this.props.uploadedId ||\r\n\t\t\t\tnext.component_uid !== this.props.component_uid\r\n\t\t\t) {\r\n\t\t\t\tthis._getPreview(next.uploadedId);\r\n\t\t\t\t//setTimeout(() => {\r\n\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t[this.props.name]: next.uploadedId\r\n\t\t\t\t});\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tupload(file) {\r\n\t\t\tthis.props.upload(file, this.props.component_uid);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tif (this.props.busy) return <ProgressBar />;\r\n\t\t\tif (!this._supported)\r\n\t\t\t\treturn <Text message={\"unsupported file upload type\"} />;\r\n\t\t\treturn (\r\n\t\t\t\t<Uploader\r\n\t\t\t\t\tkey={this.props.component_uid}\r\n\t\t\t\t\ttitle={this.props.label}\r\n\t\t\t\t\tdescription={this.props.description}\r\n\t\t\t\t\tupload={this.upload}\r\n\t\t\t\t\tcomponent_uid={this.props.component_uid}\r\n\t\t\t\t\tallowed={this.props.args.fileType}\r\n\t\t\t\t\tpreviewType={this._previewType}\r\n\t\t\t\t\tpreview={this.props.preview}\r\n\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tlet st = state.dynamo[ownProps.component_uid] || {};\r\n\t\treturn {\r\n\t\t\tpreview: st.preview,\r\n\t\t\tbusy: st.busy,\r\n\t\t\tuploadedId: st.uploadedId || ownProps.value\r\n\t\t};\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tupload: (file, key) => dispatch(uploadDynamoFile(file, key)),\r\n\t\t\tgetPreview: (id, key, fileType, query) =>\r\n\t\t\t\tdispatch(getDynamoFilePreview(id, key, fileType, query))\r\n\t\t};\r\n\t};\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoFileUpload);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport _ from \"lodash\";\r\n\r\nexport default (\r\n\tLayout,\r\n\tProgressBar,\r\n\tFilter,\r\n\tFilterContainer,\r\n\tContentContainer\r\n) => {\r\n\tinvariants.validComponent(Filter, \"Filter\");\r\n\tinvariants.validComponent(FilterContainer, \"FilterContainer\");\r\n\tinvariants.validComponent(ContentContainer, \"ContentContainer\");\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\trun: (id, args, key) =>\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\trunDynamoProcessor(id, args, key, { disableCache: true })\r\n\t\t\t\t),\r\n\t\t\tshowMessage: message => dispatch(showMessage(message))\r\n\t\t};\r\n\t};\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tvar _actionState = state.dynamo[ownProps.component_uid];\r\n\t\treturn {\r\n\t\t\tresultUI: _actionState && (_actionState.ui || _actionState),\r\n\t\t\tresultData: _actionState && _actionState.data,\r\n\t\t\tbusy: !!state.dynamo[ownProps.component_uid + \"-busy\"]\r\n\t\t};\r\n\t};\r\n\tclass DynamoActionView extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = { form: this.props.value };\r\n\t\t\tthis._filterValidator = {};\r\n\t\t\tthis.filter = this.filter.bind(this);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (_.isEqual(next.value, this.state.form)) {\r\n\t\t\t\t//setTimeout(() => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tform: next.value\r\n\t\t\t\t});\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfilter() {\r\n\t\t\tthis._filterValidator.validate().then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.props.run(\r\n\t\t\t\t\t\tthis.props.args.action,\r\n\t\t\t\t\t\tthis.state.form,\r\n\t\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tconsole.warn(\"a field in filter is invalid\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tstatic itemViewName() {\r\n\t\t\treturn \"_itemView_\";\r\n\t\t}\r\n\t\tvalueChanged(value) {\r\n\t\t\tthis.state.form = value\r\n\t\t\t\t? value[DynamoActionView.itemViewName()]\r\n\t\t\t\t: null;\r\n\t\t}\r\n\t\tdoNothing() {}\r\n\t\trender() {\r\n\t\t\tif (this.props.busy) return <ProgressBar />;\r\n\t\t\treturn (\r\n\t\t\t\t<Layout>\r\n\t\t\t\t\t<Filter\r\n\t\t\t\t\t\tactionLabel={this.props.args.commandText}\r\n\t\t\t\t\t\tfilter={this.filter}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<FilterContainer\r\n\t\t\t\t\t\t\telements={this.props.args.elements}\r\n\t\t\t\t\t\t\tvalue={this.state.form}\r\n\t\t\t\t\t\t\tname={DynamoActionView.itemViewName()}\r\n\t\t\t\t\t\t\tvalidator={this._filterValidator}\r\n\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Filter>\r\n\t\t\t\t\t<ContentContainer\r\n\t\t\t\t\t\telements={this.props.resultUI}\r\n\t\t\t\t\t\tvalue={this.props.resultData}\r\n\t\t\t\t\t\tvalidator={{}}\r\n\t\t\t\t\t\tvalueChanged={this.doNothing}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoActionView);\r\n};\r\n","import React from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default Label => {\r\n\tinvariants.validComponent(Label, \"Label\");\r\n\treturn props => {\r\n\t\tlet { value, description, ...rest } = props;\r\n\t\tif (value) {\r\n            return <Label description={value} {...rest} />\r\n\t\t}\r\n\t\treturn <Label {...props} />;\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nexport default (WebView, Text) => {\r\n\treturn class DynamoWebView extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tif (this.props.args &&  this.props.args.url) {\r\n\t\t\t\treturn <WebView url={this.props.args.url} />;\r\n\t\t\t} else {\r\n\t\t\t\treturn <Text>{\"Missing url\"}</Text>;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport SocketIOClient from \"socket.io-client\";\r\nimport invariants from \"./utils/invariants\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n\tsendMessage,\r\n\tloginChat,\r\n\tcreateGroup,\r\n\tsendFriendRequest,\r\n\tsearchForHandle,\r\n\tacceptInvite,\r\n\trejectInvite,\r\n\tfetchInvites,\r\n\tgetContacts,\r\n\taddToOpenChats,\r\n\topenChat,\r\n\tcloseChat\r\n} from \"./actions\";\r\n\r\nexport default (\r\n\tLayout,\r\n\tPane,\r\n\tOpenChats,\r\n\tEditor,\r\n\tContextMenu,\r\n\tNewChatButton,\r\n\tOpenChatsLayout,\r\n\tModal,\r\n\tProgressBar,\r\n\tLogin,\r\n\tContactList,\r\n\tChatHistory,\r\n\tAddNewContact,\r\n\tPendingInvites,\r\n\tChatLayout\r\n) => {\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Pane, \"Pane\");\r\n\tinvariants.validComponent(Editor, \"Editor\");\r\n\tinvariants.validComponent(ContextMenu, \"ContextMenu\");\r\n\tinvariants.validComponent(OpenChats, \"OpenChats\");\r\n\tinvariants.validComponent(NewChatButton, \"NewChatButton\");\r\n\tinvariants.validComponent(ContactList, \"ContactList\");\r\n\tinvariants.validComponent(ChatHistory, \"ChatHistory\");\r\n\tinvariants.validComponent(OpenChatsLayout, \"OpenChatsLayout\");\r\n\tinvariants.validComponent(Modal, \"Modal\");\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(Login, \"Login\");\r\n\tinvariants.validComponent(AddNewContact, \"AddNewContact\");\r\n\tinvariants.validComponent(PendingInvites, \"PendingInvites\");\r\n\tinvariants.validComponent(ChatLayout, \"ChatLayout\");\r\n\r\n\tconst mapStateToProps = state => {\r\n\t\tlet _state = state.chat;\r\n\t\treturn {\r\n\t\t\tchat: _state.chat,\r\n\t\t\tcontacts: _state.contacts,\r\n\t\t\topenChats: _state.openChats,\r\n\t\t\tnewMessage: _state.newMessage,\r\n\t\t\thandle: _state.chatHandle,\r\n\t\t\tusername: state.authentication.username,\r\n\t\t\tmessageSent: _state.chatMessageSent,\r\n\t\t\tloggingIn: _state.busyWithChatLogin,\r\n\t\t\tsearchResult: _state.searchResult,\r\n\t\t\tbusyWithInvite: _state.busyWithInvite,\r\n\t\t\tbusyWithInvites: _state.busyWithInvites,\r\n\t\t\tbusyWithContacts: _state.busyWithContacts,\r\n\t\t\tinvites: _state.invites,\r\n\t\t\tmessageDelivered: _state.messageDelivered\r\n\t\t};\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tsend: (type, msg) => dispatch(sendMessage(type, msg)),\r\n\t\t\tcreateGroup: msg => dispatch(createGroup(msg)),\r\n\t\t\tlogin: credentials => dispatch(loginChat(credentials)),\r\n\t\t\tsendFriendRequest: handle => dispatch(sendFriendRequest(handle)),\r\n\t\t\tacceptInvite: handle => dispatch(acceptInvite(handle)),\r\n\t\t\trejectInvite: handle => dispatch(rejectInvite(handle)),\r\n\t\t\tsearch: query => dispatch(searchForHandle(query)),\r\n\t\t\tfetchInvites: () => dispatch(fetchInvites()),\r\n\t\t\tgetContacts: () => dispatch(getContacts()),\r\n\t\t\taddToOpenChats: chat => dispatch(addToOpenChats(chat)),\r\n\t\t\topenChat: chat => dispatch(openChat(chat)),\r\n\t\t\tcloseChat: () => dispatch(closeChat())\r\n\t\t};\r\n\t};\r\n\tclass DynamoMessenger extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.renderChat = this.renderChat.bind(this);\r\n\t\t\tthis.renderPendingInvites = this.renderPendingInvites.bind(this);\r\n\t\t\tthis.sendMessage = this.sendMessage.bind(this);\r\n\t\t\tthis.openSelectContact = this.openSelectContact.bind(this);\r\n\t\t\tthis.getMessageLayout = this.getMessageLayout.bind(this);\r\n\t\t\tthis.selectedPaneChanged = this.selectedPaneChanged.bind(this);\r\n\t\t\tthis.hideModal = this.hideModal.bind(this);\r\n\t\t\tthis.openAddNewContact = this.openAddNewContact.bind(this);\r\n\t\t\tthis.openChatModal = this.openChatModal.bind(this);\r\n\t\t\tthis.state = {\r\n\t\t\t\tselectedPane: 0,\r\n\t\t\t\tmodalTemplate: null,\r\n\t\t\t\tshowModal: false,\r\n\t\t\t\t_panes: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Chat\",\r\n\t\t\t\t\t\ticon: \"comment-multiple-outline\",\r\n\t\t\t\t\t\trender: this.renderChat\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Pending Invites\",\r\n\t\t\t\t\t\ticon: \"account-plus\",\r\n\t\t\t\t\t\trender: this.renderPendingInvites\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t};\r\n\t\t\tthis._chatLayoutCommands = [\r\n\t\t\t\t{ title: \"New Group\", uid: \"NEW_GROUP\" }\r\n\t\t\t];\r\n\t\t\tthis._chatCommands = [{ title: \"Delete Chat\", uid: \"DELETE_CHAT\" }];\r\n\t\t}\r\n\t\tsendMessage(contact, message) {\r\n\t\t\tthis.props.send(contact.type !== \"group\" ? \"msg\" : \"grpmsg\", {\r\n\t\t\t\tto: contact.handle,\r\n\t\t\t\tmessage\r\n\t\t\t});\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.chat && next.chat !== this.props.chat) {\r\n\t\t\t\tthis.openChatModal(next.chat);\r\n\t\t\t}\r\n\t\t}\r\n\t\topenChatModal(chat = this.props.chat) {\r\n\t\t   //\tsetTimeout(() => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tmodalTemplate: () => this.getMessageLayout(chat),\r\n\t\t\t\t\tshowModal: true\r\n\t\t\t\t});\r\n\t\t\t//}, 0);\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tconsole.log(\"logging in...\");\r\n\t\t\tthis.props.login({ username: this.props.username });\r\n\r\n\t\t\tif (this.props.chat) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.openChatModal(\r\n\t\t\t\t\t\tthis.props.openChats[this.props.chat.contact.handle]\r\n\t\t\t\t\t);\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\trenderPendingInvites() {\r\n\t\t\tif (this.props.busyWithInvites) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<PendingInvites\r\n\t\t\t\t\tgetInvites={this.props.fetchInvites}\r\n\t\t\t\t\tinvites={this.props.invites}\r\n\t\t\t\t\tacceptInvite={this.props.acceptInvite}\r\n\t\t\t\t\trejectInvite={this.props.rejectInvite}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\trenderChat() {\r\n\t\t\tlet chats = Object.keys(this.props.openChats || {}).map(x => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\thandle: x,\r\n\t\t\t\t\tmessages: this.props.openChats[x].messages\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\treturn (\r\n\t\t\t\t<OpenChatsLayout>\r\n\t\t\t\t\t<ContextMenu commands={this._chatLayoutCommands} />\r\n\t\t\t\t\t{this.props.fetchingContacts ? (\r\n\t\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<OpenChats\r\n\t\t\t\t\t\t\topen={handle => {\r\n\t\t\t\t\t\t\t\tthis.props.openChat(\r\n\t\t\t\t\t\t\t\t\tthis.props.openChats[handle]\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tnewMessage={this.props.newMessage}\r\n\t\t\t\t\t\t\tchats={chats}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<NewChatButton onClick={this.openSelectContact} />\r\n\t\t\t\t</OpenChatsLayout>\r\n\t\t\t);\r\n\t\t}\r\n\t\tgetMessageLayout(chat) {\r\n\t\t\treturn (\r\n\t\t\t\t<ChatLayout info={chat.contact.handle}>\r\n\t\t\t\t\t<ContextMenu commands={this._chatCommands} />\r\n\t\t\t\t\t<ChatHistory\r\n\t\t\t\t\t\tmessages={chat.messages}\r\n\t\t\t\t\t\tme={this.props.handle}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Editor\r\n\t\t\t\t\t\tmessageDelivered={this.props.messageDelivered}\r\n\t\t\t\t\t\tsend={message =>\r\n\t\t\t\t\t\t\tthis.sendMessage(chat.contact, message)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</ChatLayout>\r\n\t\t\t);\r\n\t\t}\r\n\t\topenChat(chat) {\r\n\t\t\tthis.props.openChat(chat);\r\n\t\t}\r\n\t\topenSelectContact() {\r\n\t\t\tif (!this.props.busyWithContacts && !this.props.contacts) {\r\n\t\t\t\tthis.props.getContacts();\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tmodalTemplate: () =>\r\n\t\t\t\t\tthis.props.busyWithContacts ? (\r\n\t\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<ContactList\r\n\t\t\t\t\t\t\tcontacts={this.props.contacts}\r\n\t\t\t\t\t\t\topenAddNewContact={this.openAddNewContact}\r\n\t\t\t\t\t\t\tcontactSelected={contact => {\r\n\t\t\t\t\t\t\t\t//add chat to history.\r\n\t\t\t\t\t\t\t\tlet chat = (this.props.openChats || {})[\r\n\t\t\t\t\t\t\t\t\tcontact.handle\r\n\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\tif (!chat)\r\n\t\t\t\t\t\t\t\t\tthis.props.addToOpenChats(\r\n\t\t\t\t\t\t\t\t\t\t(chat = { contact, messages: [] })\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.openChat(chat);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t),\r\n\t\t\t\tshowModal: true\r\n\t\t\t});\r\n\t\t}\r\n\t\topenAddNewContact() {\r\n\t\t\tthis.setState({\r\n\t\t\t\tmodalTemplate: () => (\r\n\t\t\t\t\t<AddNewContact\r\n\t\t\t\t\t\tsearch={query => this.props.search(query)}\r\n\t\t\t\t\t\tsearchResult={this.props.searchResult}\r\n\t\t\t\t\t\tsendFriendRequest={handle =>\r\n\t\t\t\t\t\t\tthis.props.sendFriendRequest(handle)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t),\r\n\t\t\t\tshowModal: true\r\n\t\t\t});\r\n\t\t}\r\n\t\thideModal() {\r\n\t\t\tthis.setState({ showModal: false });\r\n\t\t\t//this will cause a useless rerender. need to change this later.\r\n\t\t\tthis.props.closeChat();\r\n\t\t}\r\n\t\tselectedPaneChanged(selectedPane) {\r\n\t\t\tthis.setState({ selectedPane });\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tif (this.props.loggingIn) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\t\t\tif (!this.props.handle) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Login\r\n\t\t\t\t\t\tfirstTimer={this.props.firstTimer}\r\n\t\t\t\t\t\twelcomeMessage={\r\n\t\t\t\t\t\t\t(this.props.args &&\r\n\t\t\t\t\t\t\t\tthis.props.args.welcomeMessage) ||\r\n\t\t\t\t\t\t\t\"Please enter the name with which you want to be known. Please note once saved it cannot be changed\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsubmit={handle =>\r\n\t\t\t\t\t\t\tthis.props.login({\r\n\t\t\t\t\t\t\t\tusername: this.props.username,\r\n\t\t\t\t\t\t\t\thandle\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<Layout\r\n\t\t\t\t\tselectedPane={this.state.selectedPane}\r\n\t\t\t\t\tselectedPaneChanged={this.selectedPaneChanged}\r\n\t\t\t\t\tpanes={this.state._panes.map(x => ({\r\n\t\t\t\t\t\ttitle: x.title,\r\n\t\t\t\t\t\ticon: x.icon\r\n\t\t\t\t\t}))}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t(this.state.modalTemplate &&\r\n\t\t\t\t\t\t\t\tthis.state.modalTemplate()) ||\r\n\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thideDone={true}\r\n\t\t\t\t\t\tdone={this.hideModal}\r\n\t\t\t\t\t\tvisibility={this.state.showModal}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{this.state._panes[this.state.selectedPane].render()}\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoMessenger);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor, dynamoDownloadUrl } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Link, customDownloadCommand) => {\r\n\tinvariants.validComponent(Link, \"Link\");\r\n\r\n\tconst mapDispatchToState = dispatch => {\r\n\t\treturn {\r\n\t\t\tdispatch\r\n\t\t};\r\n\t};\r\n\tclass DynamoCommand extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.go = this.go.bind(this);\r\n\t\t\tthis.run = this.run.bind(this);\r\n\t\t}\r\n\t\trun() {\r\n\t\t\tthis.props.dispatch(\r\n\t\t\t\trunDynamoProcessor(\r\n\t\t\t\t\tthis.props.args.commmandProcessor,\r\n\t\t\t\t\tJSON.parse(this.props.args.commandProcessorArgs || {}),\r\n\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t}\r\n\t\tgo() {\r\n\t\t\tswitch (this.props.args.commandType) {\r\n\t\t\t\tcase DynamoCommand.COMMAND_TYPE.DOWNLOAD:\r\n\t\t\t\t\tif (!this.props.args.commandProcessorArgs) {\r\n\t\t\t\t\t\tthrow new Error(\"Download is not properly setup.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet url;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\turl = dynamoDownloadUrl.replace(\r\n\t\t\t\t\t\t\t\":id\",\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.commandProcessorArgs).id\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tthrow new Error(\"Download is not properly setup.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.props.dispatch(customDownloadCommand(this.props.args, url));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.run();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\trender() {\r\n\t\t\treturn (\r\n\t\t\t\t/*jshint ignore:start */\r\n\t\t\t\t<Link\r\n\t\t\t\t\ttext={this.props.args.commandText}\r\n\t\t\t\t\ticon={this.props.args.commandIcon}\r\n\t\t\t\t\tgo={this.go}\r\n\t\t\t\t/>\r\n\t\t\t\t/*jshint ignore:end */\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\tDynamoCommand.COMMAND_TYPE = { DEFAULT: \"DEFAULT\", DOWNLOAD: \"DOWNLOAD\" };\r\n\treturn connect(null, mapDispatchToState)(DynamoCommand);\r\n};\r\n","import dynamo_input from \"./dynamo_input.js\";\r\nimport dynamo_view from \"./dynamo_view.js\";\r\nimport dynamo_container from \"./dynamo_container.js\";\r\nimport dynamo_process from \"./dynamo_process.js\";\r\nimport dynamo_section from \"./dynamo_section.js\";\r\nimport dynamo_select from \"./dynamo_select.js\";\r\nimport dynamo_selectset from \"./dynamo_selectset.js\";\r\nimport dynamo_list from \"./dynamo_list.js\";\r\nimport dynamo_hidden from \"./dynamo_hidden.js\";\r\nimport dynamo_nav from \"./dynamo_nav\";\r\nimport dynamo_image from \"./dynamo_image\";\r\nimport dynamo_grid from \"./dynamo_grid\";\r\nimport dynamo_htmlview from \"./dynamo_htmlview\";\r\nimport dynamo_fileupload from './dynamo_fileupload';\r\nimport dynamo_actionview from \"./dynamo_actionview\";\r\nimport dynamo_label from './dynamo_label';\r\nimport dynamo_webview from \"./dynamo_webview\";\r\nimport dynamo_messenger from \"./dynamo_messenger\";\r\nimport dynamo_command from \"./dynamo_command\";\r\n\r\nexport default {\r\n\tdynamo_input,\r\n\tdynamo_view,\r\n\tdynamo_container,\r\n\tdynamo_process, \r\n\tdynamo_section,\r\n\tdynamo_select,\r\n\tdynamo_selectset,\r\n\tdynamo_list,\r\n\tdynamo_hidden,\r\n\tdynamo_nav,\r\n\tdynamo_grid, \r\n\tdynamo_image,\r\n\tdynamo_fileupload,\r\n\tdynamo_actionview,\r\n\tdynamo_htmlview,\r\n\tdynamo_label,\r\n\tdynamo_webview,\r\n\tdynamo_messenger,\r\n\tdynamo_command\r\n}; \r\n","import components from \"./lib\";\r\nconst defaultMap = {\r\n\tINPUT: components.dynamo_input,\r\n\tVIEW: components.dynamo_view,\r\n\tCONTAINER: components.dynamo_container,\r\n\tPROCESS: components.dynamo_process,\r\n\tSECTION: components.dynamo_section,\r\n\tSELECT: components.dynamo_select,\r\n\tSELECTSET: components.dynamo_selectset,\r\n\tLIST: components.dynamo_list,\r\n\tHIDDEN: components.dynamo_hidden,\r\n\tNAV:components.dynamo_nav,\r\n\tIMAGE:components.dynamo_image,\r\n\tGRID:components.dynamo_grid,\r\n\tFILEUPLOAD:components.dynamo_fileupload,\r\n\tACTIONVIEW:components.dynamo_actionview,\r\n\tHTMLVIEW:components.dynamo_htmlview,\r\n\tLABEL:components.dynamo_label,\r\n\tWEBVIEW:components.dynamo_webview,\r\n\tMESSENGER:components.dynamo_messenger,\r\n\tCOMMAND:components.dynamo_command\r\n};\r\nexport default defaultMap;\r\n","import _ from \"lodash\";\r\nimport uuid from \"uuid/v4\";\r\nimport { ACTIONS } from \"../actions\";\r\nimport config from \"client_config\";\r\n\r\nexport default function(state = {}, action) {\r\n\tswitch (action.type) {\r\n\t\tcase \"persist/REHYDRATE\":\r\n\t\t\tvar incoming = action.payload.dynamo;\r\n\t\t\tif (incoming) {\r\n\t\t\t\ttoggleAllBusyIndicators(incoming);\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\t...incoming\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn state;\r\n\t\tcase ACTIONS.DYNAMO_PROCESS_FAILED:\r\n\t\t\treturn Object.assign({}, state, { busy: false });\r\n\t\tcase ACTIONS.DYNAMO_PROCESS_RAN:\r\n\t\t\tlet currentState = {\r\n\t\t\t\tbusy: false,\r\n\t\t\t\tcurrentStep: state.currentStep || 0\r\n\t\t\t};\r\n\t\t\tif (\r\n\t\t\t\t(config.uiOnDemand &&\r\n\t\t\t\t\taction.payload.data.status == \"COMPLETED\") ||\r\n\t\t\t\t(!config.uiOnDemand &&\r\n\t\t\t\t\t(state.description.steps.length == 1 ||\r\n\t\t\t\t\t\tcurrentState.currentStep + 1 >\r\n\t\t\t\t\t\t\tstate.description.steps.length - 1))\r\n\t\t\t) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tbusy: false,\r\n\t\t\t\t\tcompleted: true,\r\n\t\t\t\t\tmessage:\r\n\t\t\t\t\t\t(typeof action.payload.data == \"object\" &&\r\n\t\t\t\t\t\t\taction.payload.data.message) ||\r\n\t\t\t\t\t\tnull\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tcurrentState.instanceId =\r\n\t\t\t\taction.payload && action.payload.data\r\n\t\t\t\t\t? action.payload.data.instanceId\r\n\t\t\t\t\t: null;\r\n\t\t\tif (config.uiOnDemand)\r\n\t\t\t\tstate.description.steps[0] = action.payload.data.$nextStep;\r\n\t\t\telse currentState.currentStep = currentState.currentStep + 1;\r\n\t\t\t//potentially costly will have to test and see what happens.\r\n\t\t\t//currentState.templateCache = getTemplatesAndAddComponentUid(state.description.steps[currentState.currentStep].form.elements);\r\n\t\t\tcurrentState.value =\r\n\t\t\t\ttypeof action.payload.data == \"object\" &&\r\n\t\t\t\ttypeof action.payload.data.message == \"object\" &&\r\n\t\t\t\taction.payload.data.message;\r\n\t\t\treturn Object.assign({}, state, currentState);\r\n\r\n\t\tcase ACTIONS.FETCHING_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: fetchingGrid(state[action.meta.key], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILTERED_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: filteredGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: getSingleItemForGrid(\r\n\t\t\t\t\tstate[action.meta.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.GOT_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotSingleItemForGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: errorWhileGettingSingleItemForGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.ERROR_WHILE_FETCHING_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: failedToFetchGrid(\r\n\t\t\t\t\tstate[action.payload.key]\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.DYNAMO_GET_MORE_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: reduceGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.DYNAMO_PROCESS_RUNNING:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tbusy: !action.error,\r\n\t\t\t\tvalue: action.meta.form\r\n\t\t\t});\r\n\t\tcase ACTIONS.DYNAMO_PROCESSOR_RAN:\r\n\t\t\tconfigureTemplates(state, action);\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: action.payload.data,\r\n\t\t\t\t[`${action.payload.key}-busy`]: false\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.DYNAMO_PROCESSOR_RUNNING:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[`${action.meta.key}-busy`]: !action.error\r\n\t\t\t});\r\n\t\tcase ACTIONS.DYNAMO_PROCESSOR_FAILED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[`${action.meta}-busy`]: false,\r\n\t\t\t\t[action.meta]: null\r\n\t\t\t});\r\n\t\tcase ACTIONS.FETCHED_PROCESS:\r\n\t\t\tlet fetchedValue = Object.assign({}, action.payload.data.data);\r\n\t\t\tlet fetchedDescription = Object.assign(\r\n\t\t\t\t{},\r\n\t\t\t\taction.payload.data.description\r\n\t\t\t);\r\n\t\t\treturn {\r\n\t\t\t\tdescription: fetchedDescription,\r\n\t\t\t\tcurrentStep: 0,\r\n\t\t\t\tbusy: false,\r\n\t\t\t\tvalue: fetchedValue,\r\n\t\t\t\ttemplateCache: {} //getTemplatesAndAddComponentUid(fetchedDescription.steps[0].form.elements)\r\n\t\t\t};\r\n\t\tcase ACTIONS.FETCHING_PROCESS:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tbusy: !action.error\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_FETCH_PROCESS:\r\n\t\t\treturn {\r\n\t\t\t\tbusy: false\r\n\t\t\t};\r\n\t\tcase ACTIONS.START_FILE_UPLOAD:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: startUpload(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILE_UPLOADED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: fileUpload(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILE_UPLOAD_FAILED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: uploadFailed(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: getPreview(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotPreview(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetPreview(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_ITEM_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: getTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\tstate[action.meta.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_ITEM_TEMPLATE:\r\n\t\t\tconfigureTemplates(state, action);\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\t\"itemTemplate\",\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_ITEM_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_FILTER_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: getTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_FILTER_TEMPLATE:\r\n\t\t\tif (action.error) {\r\n\t\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\t\taction\r\n\t\t\t\t\t)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconfigureTemplates(state, action);\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\t\"filterTemplate\",\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_FILTER_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nfunction configureTemplates(state, action) {\r\n\tif (action.payload.returnsUI) {\r\n\t\t//state.templateCache = Object.assign({}, state.templateCache, getTemplatesAndAddComponentUid(action.payload.data));\r\n\t}\r\n}\r\n\r\nfunction getTemplate(busyIndicator, state = {}, action) {\r\n\treturn Object.assign({}, state, { [busyIndicator]: !action.error });\r\n}\r\nfunction gotTemplate(busyIndicator, propName, state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\t[propName]: action.payload.data,\r\n\t\t[busyIndicator]: false\r\n\t});\r\n}\r\nfunction failedToGetTemplate(busyIndicator, state = {}, action) {\r\n\treturn Object.assign({}, state, { [busyIndicator]: false });\r\n}\r\n\r\nfunction startUpload(state = {}, action) {\r\n\treturn Object.assign({}, state, { gettingTemplate: !action.error });\r\n}\r\nfunction fileUpload(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tuploadedId: action.payload.id,\r\n\t\tbusy: false\r\n\t});\r\n}\r\nfunction uploadFailed(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: false });\r\n}\r\nfunction getPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: !action.error });\r\n}\r\nfunction gotPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tpreview: action.payload.data,\r\n\t\tbusy: false\r\n\t});\r\n}\r\nfunction failedToGetPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: false });\r\n}\r\nfunction runThroughObj(conditions, data, result = {}, parent = null) {\r\n\tif(data)\r\n\tObject.keys(data).forEach(key => {\r\n\t\tlet send = false;\r\n\t\tfor (var v = 0; v < conditions.length; v++) {\r\n\t\t\tif (conditions[v](key, data, result, parent)) return result;\r\n\t\t}\r\n\t\tif (Array.prototype.isPrototypeOf(data[key]))\r\n\t\t\treturn data[key].forEach(function(element) {\r\n\t\t\t\trunThroughObj(conditions, element, result, data);\r\n\t\t\t});\r\n\t\tif (data[key] && typeof data[key] == \"object\")\r\n\t\t\treturn runThroughObj(conditions, data[key], result, data);\r\n\t});\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * This method retrieves all the recursively declared templates and returns them. it also assigns \r\n * unique ids to every element it finds.\r\n * @param  {[type]} null    [description]\r\n * @param  {[type]} [\t(key, data,         result, parent) [description]\r\n * @param  {[type]} (key,   data,         result, parent  [description]\r\n * @return {[type]}         [description]\r\n */\r\nconst getTemplatesAndAddComponentUid = runThroughObj.bind(null, [\r\n\t(key, data, result, parent) => {\r\n\t\tif (key === \"dynamo_ref\") {\r\n\t\t\tif (data.template)\r\n\t\t\t\treturn (result[data.dynamo_ref] = data.template), result;\r\n\t\t\tif (parent && parent.itemTemplate)\r\n\t\t\t\treturn (result[data.dynamo_ref] = parent.itemTemplate), result;\r\n\t\t}\r\n\t},\r\n\t(key, data, result, parent) => {\r\n\t\tif (key == \"elementType\" && !data.component_uid) {\r\n\t\t\tdata.component_uid = uuid();\r\n\t\t}\r\n\t\t//console.log(parent ? parent : \"n/a\");\r\n\t}\r\n]);\r\n\r\nexport const toggleAllBusyIndicators = runThroughObj.bind(null, [\r\n\t(key, data) => {\r\n\t\tif (\r\n\t\t\t/(getting|busy|fetching)+/i.test(key) &&\r\n\t\t\ttypeof data[key] == \"boolean\"\r\n\t\t) {\r\n\t\t\tdata[key] = false;\r\n\t\t}\r\n\t}\r\n]);\r\n\r\nfunction reduceGrid(state = {}, action) {\r\n\tif (!state.data || state.data.items.length < action.payload.data.total) {\r\n\t\tlet current = state.data ? state.data.items : [];\r\n\t\taction.payload.data.items = current.concat(action.payload.data.items);\r\n\t\tstate.data = action.payload.data;\r\n\t\treturn Object.assign({}, state, { fetchingGrid: false });\r\n\t}\r\n}\r\n\r\nfunction filteredGrid(state = {}, action) {\r\n\tlet current = state.data ? state.data.items : [];\r\n\tstate.data = action.payload.data;\r\n\treturn Object.assign({}, state, { fetchingGrid: false });\r\n}\r\n\r\nfunction fetchingGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingGrid: !action.error,\r\n\t\tfilter: action.meta && action.meta.args ? action.meta.args.query : null\r\n\t});\r\n}\r\n\r\nfunction failedToFetchGrid(state = {}) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingGrid: false\r\n\t});\r\n}\r\n\r\nfunction getSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, { fetchingSingleItem: !action.error });\r\n}\r\n\r\nfunction gotSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tsingleItem: action.payload.data,\r\n\t\tfetchingSingleItem: false\r\n\t});\r\n}\r\n\r\nfunction errorWhileGettingSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingSingleItem: false,\r\n\t\tsingleItem: undefined\r\n\t});\r\n}\r\n","import { ACTIONS } from \"../actions\";\r\nimport { toggleAllBusyIndicators } from \"./index\";\r\nimport uuid from \"uuid/v4\";\r\nexport default function(state = {}, action) {\r\n\tswitch (action.type) {\r\n\t\tcase \"persist/REHYDRATE\":\r\n\t\t\tvar incoming = action.payload.chat;\r\n\t\t\tif (incoming) {\r\n\t\t\t\ttoggleAllBusyIndicators(incoming);\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\t...incoming\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn state;\r\n\t\tcase ACTIONS.LOGIN_CHAT:\r\n\t\t\treturn Object.assign({}, state, { busyWithChatLogin: true, chatHandle: null });\r\n\t\tcase ACTIONS.LOGGED_IN_CHAT:\r\n\t\t\treturn Object.assign({}, state, { busyWithChatLogin: false, chatHandle: action.payload.handle || action.meta.handle });\r\n\t\tcase ACTIONS.FAILED_TO_LOGIN_CHAT:\r\n\t\t\treturn Object.assign({}, state, { busyWithChatLogin: false });\r\n\t\tcase ACTIONS.SEND_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { sentFriendRequest: false, busyWithFriendRequest: true });\r\n\t\tcase ACTIONS.SENT_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { sentFriendRequest: true, busyWithFriendRequest: false });\r\n\t\tcase ACTIONS.FAILED_TO_SEND_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { busyWithFriendRequest: false, sentFriendRequest: false });\r\n\r\n\t\tcase ACTIONS.SEARCH:\r\n\t\t\treturn Object.assign({}, state, { busyWithSearch: true, searchResult: [] });\r\n\t\tcase ACTIONS.FOUND:\r\n\t\t\treturn Object.assign({}, state, { busyWithSearch: false, searchResult: action.payload });\r\n\t\tcase ACTIONS.NOT_FOUND:\r\n\t\t\treturn Object.assign({}, state, { busyWithSearch: false });\r\n\r\n\t\tcase ACTIONS.ACCEPT_FRIEND_REQUEST:\r\n\t\tcase ACTIONS.REJECT_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvite: true });\r\n\t\tcase ACTIONS.ACCEPTED_FRIEND_REQUEST:\r\n\t\tcase ACTIONS.REJECTED_FRIEND_REQUEST:\r\n\t\t\tif (state.invites) {\r\n\t\t\t\tlet req = state.invites.filter(x => x.handle == action.payload)[0];\r\n\t\t\t\tstate.invites.splice(state.invites.indexOf(req), 1);\r\n\t\t\t}\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tbusyWithInvite: false,\r\n\t\t\t\tpendingInvites: (state.invites && state.invites.slice()) || null\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_ACCEPT_FRIEND_REQUEST:\r\n\t\tcase ACTIONS.FAILED_TO_REJECT_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvite: false });\r\n\r\n\t\tcase ACTIONS.GET_INVITES:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvites: true });\r\n\t\tcase ACTIONS.GOT_INVITES:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvites: false, invites: action.payload });\r\n\t\tcase ACTIONS.FAILED_TO_GET_INVITES:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvites: false });\r\n\t\tcase ACTIONS.GET_CONTACTS:\r\n\t\t\treturn Object.assign({}, state, { busyWithContacts: true });\r\n\t\tcase ACTIONS.GOT_CONTACTS:\r\n\t\t\treturn Object.assign({}, state, { busyWithContacts: false, contacts: action.payload });\r\n\t\tcase ACTIONS.FAILED_TO_GET_CONTACTS:\r\n\t\t\treturn Object.assign({}, state, { busyWithContacts: false });\r\n\t\tcase ACTIONS.ADD_TO_OPEN_CHATS:\r\n\t\t\tlet chat = action.payload,\r\n\t\t\t\topen = state.openChats || {};\r\n\t\t\topen[chat.contact.handle] = chat;\r\n\t\t\treturn Object.assign({}, state, { openChats: open });\r\n\t\tcase ACTIONS.NEW_MESSAGE:\r\n\t\tcase ACTIONS.NEW_GROUP_MESSAGE:\r\n\t\t\tlet openChats = state.openChats || {},\r\n\t\t\t\tmsg = action.payload;\r\n\t\t\tif (!openChats[msg.from]) {\r\n\t\t\t\topenChats[msg.from] = {\r\n\t\t\t\t\tcontact: { handle: msg.from, type: action.type == ACTIONS.NEW_GROUP_MESSAGE && \"group\" },\r\n\t\t\t\t\tmessages: []\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tmsg.id = uuid();\r\n\t\t\topenChats[msg.from].messages.push(msg);\r\n\t\t\treturn Object.assign({}, state, { openChats, newMessage: msg });\r\n\t\tcase ACTIONS.OPEN_CHAT:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tchat: action.payload,\r\n\t\t\t\tnewMessage: state.newMessage && state.newMessage.from == action.payload.contact.handle ? null : state.newMessage\r\n\t\t\t});\r\n\t\tcase ACTIONS.CLOSE_CHAT:\r\n\t\t\treturn Object.assign({}, state, { chat: null });\r\n\t\tcase ACTIONS.SEND_CHAT:\r\n\t\t\treturn Object.assign({}, state, { messageDelivered: false });\r\n\t\tcase ACTIONS.SENT_CHAT:\r\n\t\t\tlet _openChats = state.openChats,\r\n\t\t\t\t_msg = action.meta;\r\n\t\t\t_openChats[_msg.to].messages.push(Object.assign({}, _msg, { from: state.chatHandle, id: uuid() }));\r\n\t\t\t_openChats[_msg.to].messages = _openChats[_msg.to].messages.slice();\r\n\t\t\treturn Object.assign({}, state, { openChats: Object.assign({}, _openChats), messageDelivered: true });\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n"],"names":["MemCache","opts","defaultTTL","ttl","store","bind","get","_items","obj","JSON","stringify","key","hasOwnProperty","getKey","_key","value","undefined","handle","setTimeout","remove","preDispatch","config","BASE_URL","global","baseUrl","CHAT_URL","chatUrl","preLogin","cache","processorsCacheTimeout","ACTIONS","socket","displayMessage","text","getQueryParams","args","Object","keys","map","x","index","arr","encodeURIComponent","length","join","openConfirmation","id","message","params","OPEN_CONFIRMATION","defaultError","dispatch","customType","meta","action","state","res","status","statusText","headers","errormessage","showMessage","type","SESSION_MAY_HAVE_EXPIRED","dynamoDownloadUrl","fetchDynamoProcess","getState","CALL_API","assign","$uiOnDemand","uiOnDemand","FETCHING_PROCESS","FETCHED_PROCESS","json","then","data","d","FAILED_TO_FETCH_PROCESS","getMoreForGrid","runDynamoProcessor","FETCHING_GRID","DYNAMO_GET_MORE_FOR_GRID","ERROR_WHILE_FETCHING_GRID","filterGrid","FILTERED_GRID","getItemTemplate","GET_ITEM_TEMPLATE","GOT_ITEM_TEMPLATE","FAILED_TO_GET_ITEM_TEMPLATE","getFilterTemplate","GET_FILTER_TEMPLATE","GOT_FILTER_TEMPLATE","FAILED_TO_GET_FILTER_TEMPLATE","getSingleItemForGrid","GET_SINGLE_ITEM_FOR_GRID","GOT_SINGLE_ITEM_FOR_GRID","ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID","requestCustomType","resultCustomType","errorCustomType","returnsUI","disableCache","cacheProcessorResponses","cacheKey","hasKey","payload","DYNAMO_PROCESSOR_RAN","DYNAMO_PROCESSOR_RUNNING","response","DYNAMO_PROCESSOR_FAILED","runDynamoProcess","details","DYNAMO_PROCESS_RUNNING","form","DYNAMO_PROCESS_RAN","catch","DYNAMO_PROCESS_FAILED","instanceId","getDynamoFilePreview","fileType","query","GET_PREVIEW","GOT_PREVIEW","FAILED_TO_GET_PREVIEW","uploadDynamoFile","file","formData","FormData","append","START_FILE_UPLOAD","FILE_UPLOADED","FILE_UPLOAD_FAILED","loginChat","credentials","extra","LOGIN_CHAT","emit","msg","error","isSignedUp","FAILED_TO_LOGIN_CHAT","LOGGED_IN_CHAT","sendMessage","SEND_CHAT","SENT_CHAT","FAILED_TO_SEND_CHAT","createGroup","CREATE_GROUP","CREATED_GROUP","sendFriendRequest","SEND_FRIEND_REQUEST","SENT_FRIEND_REQUEST","FAILED_TO_SEND_FRIEND_REQUEST","getContacts","GET_CONTACTS","GOT_CONTACTS","FAILED_TO_GET_CONTACTS","fetchInvites","GET_INVITES","GOT_INVITES","FAILED_TO_GET_INVITES","acceptInvite","ACCEPT_FRIEND_REQUEST","ACCEPTED_FRIEND_REQUEST","FAILED_TO_ACCEPT_FRIEND_REQUEST","rejectInvite","REJECT_FRIEND_REQUEST","REJECTED_FRIEND_REQUEST","FAILED_TO_REJECT_FRIEND_REQUEST","searchForHandle","SEARCH","FOUND","NOT_FOUND","requestType","resultType","errorType","Array","prototype","slice","call","arguments","result","authentication","username","apply","addToOpenChats","chat","ADD_TO_OPEN_CHATS","openChat","OPEN_CHAT","closeChat","CLOSE_CHAT","startReceivingMessages","openSocket","on","fn","NEW_MESSAGE","NEW_GROUP_MESSAGE","Validator","context","run","Promise","resolve","reject","props","validators","asyncValidators","reduce","current","element","valid","validatorType","VALIDATOR_TYPES","REQUIRED","hasValue","MAXLENGTH","isLessThanMaxLength","MINLENGTH","isGreaterThanMinLength","REGEX","matchesRegex","errors","push","setState","component","name","Error","Component","isPrototypeOf","LabelWrapper","Input","DatePicker","Checkbox","validComponent","DynamoInput","valueChanged","default","runValidators","runAsyncValidators","validator","validate","next","component_uid","ValidationHelper","runAsyncValidator","filter","max","min","RegExp","exp","test","Result","passThrough","React","label","isRequired","propTypes","PropTypes","func","Page","Container","mapStateToProps","_","initialProps","description","dynamo","step","currentStep","elements","steps","mode","hideSubmit","title","DynamoView","onValueChanged","submit","dynamo_view","warn","log","er","connect","Section","Header","ComponentLocator","invariants","_validations","setValidator","all","self","extraVal","notifyExtra","sort","y","order","DynamoComponent","source","indexOf","splice","forEach","ProgressBar","TextView","busy","completed","mapDispatchToProps","info","DynamoProcess","_id","fetch","fetchParams","navigation","goBack","isEqual","runProcess","Layout","DynamoSection","ProgressIndicator","ownProps","st","DynamoSelect","fetchItems","selectFirstItem","isValidValue","babelHelpers.typeof","$objectID","isObjectIdMode","_mounted","obid","updateValue","parse","customArgs","items","item","v","isEmptyOrNull","disabled","Picker","DynamoSelectSet","onPickerValueChanged","onContainerValueChanged","getPickerValue","getPickerItemsById","respondToPickerValueChanged","oneOption","getValueBasedOnMode","pickerValue","containerValidator","processor","processorArgs","_args","_onContainerValueChanged","_currentValue","shift","getItems","r","superCancel","sum","path","_p","_no_path","initialElementsData","noPath","Button","List","Modal","ErrorText","app","confirmationResult","templateCache","equivalent","arr2","isEqualWith","objValue","otherValue","findKey","isMatch","DynamoList","showModal","closeModal","edit","isDisabled","getListItemDataTemplate","confirmation","dataTemplate","listItemDataTemplateProcessor","isTemplateRef","itemTemplate","dynamo_ref","template","equal","i","behavior","ValidatorHelper","modalVisible","modalName","template_ref","clone","extension","rowTemplate","Link","NavigationActions","mapDispatchToState","DynamoNav","go","link","linkAndParams","getParams","paramsOnly","NAV_TYPE","CLIENT","setParams","DYNAMO","setParamsAction","firstItemIsLink","key_value","split","sp","Image","rest","replace","GRID_MODES","ITEM_MODES","ItemView","CommandsView","CommandResultView","total","fetchingGrid","filterTemplate","singleItem","fetchingSingleItem","gettingFilterTemplate","gettingTemplate","DynamoGrid","commandResultViewName","itemViewName","pageCount","showItemView","cancel","isCRUD","isEDITONLY","getItemsFromSource","done","_filterValidator","filterValueChanged","more","finished","openCommandMenu","closeCommandView","execCommand","showCommandResult","closeCommandResult","commands","commandType","cmd","unshift","filterProcessor","fetchingFilterTemplate","gridArgs","commandProcessed","processed","EDIT","fetchingItemTemplate","existingValue","methodName","count","full","submitted","NEW","createProcessor","editProcessor","console","skipFetch","_itemTemplate","createTemplate","editTemplate","fetchSingleItemProcessor","getSingleItem","fetchTemplateProcessor","filterViewName","showCommandsView","command","CRUD","EDITONLY","header","footer","templateConfig","itemViewElements","showCommandResultView","commandResult","commandProcessing","html","Uploader","Text","previews","DynamoFileUpload","_previewType","getPreviewType","_supported","isSupported","_getPreview","_query","getPreviewQuery","upload","uploadedId","supports","getPreview","preview","Filter","FilterContainer","ContentContainer","_actionState","ui","DynamoActionView","commandText","resultUI","resultData","doNothing","Label","WebView","url","Pane","OpenChats","Editor","ContextMenu","NewChatButton","OpenChatsLayout","Login","ContactList","ChatHistory","AddNewContact","PendingInvites","ChatLayout","_state","contacts","openChats","newMessage","chatHandle","chatMessageSent","busyWithChatLogin","searchResult","busyWithInvite","busyWithInvites","busyWithContacts","invites","messageDelivered","DynamoMessenger","renderChat","renderPendingInvites","openSelectContact","getMessageLayout","selectedPaneChanged","hideModal","openAddNewContact","openChatModal","_chatLayoutCommands","uid","_chatCommands","contact","send","login","chats","messages","fetchingContacts","search","selectedPane","loggingIn","firstTimer","welcomeMessage","_panes","icon","modalTemplate","render","customDownloadCommand","DynamoCommand","commmandProcessor","commandProcessorArgs","COMMAND_TYPE","DOWNLOAD","e","commandIcon","DEFAULT","defaultMap","components","dynamo_input","dynamo_container","dynamo_process","dynamo_section","dynamo_select","dynamo_selectset","dynamo_list","dynamo_hidden","dynamo_nav","dynamo_image","dynamo_grid","dynamo_fileupload","dynamo_actionview","dynamo_htmlview","dynamo_label","dynamo_webview","dynamo_messenger","dynamo_command","incoming","currentState","$nextStep","filteredGrid","gotSingleItemForGrid","errorWhileGettingSingleItemForGrid","failedToFetchGrid","reduceGrid","fetchedValue","fetchedDescription","startUpload","fileUpload","uploadFailed","gotPreview","failedToGetPreview","getTemplate","gotTemplate","failedToGetTemplate","configureTemplates","busyIndicator","propName","runThroughObj","conditions","parent","getTemplatesAndAddComponentUid","uuid","toggleAllBusyIndicators","concat","sentFriendRequest","busyWithFriendRequest","busyWithSearch","req","open","from","_openChats","_msg","to"],"mappings":"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"}