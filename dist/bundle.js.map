{"version":3,"file":"bundle.js","sources":["../src/lib/utils/memcache.js","../src/lib/actions/index.js","../src/lib/utils/validator.js","../src/lib/utils/invariants.js","../src/lib/dynamo_input.js","../src/lib/dynamo_view.js","../src/lib/dynamo_container.js","../src/lib/dynamo_process.js","../src/lib/dynamo_section.js","../src/lib/dynamo_select.js","../src/lib/dynamo_selectset.js","../src/lib/dynamo_list.js","../src/lib/dynamo_hidden.js","../src/lib/dynamo_nav.js","../src/lib/dynamo_image.js","../src/lib/dynamo_grid.js","../src/lib/dynamo_htmlview.js","../src/lib/dynamo_fileupload.js","../src/lib/dynamo_actionview.js","../src/lib/dynamo_label.js","../src/lib/dynamo_webview.js","../src/lib/dynamo_messenger.js","../src/lib/dynamo_command.js","../src/lib/index.js","../src/dynamo_mapping.js","../src/lib/reducers/index.js","../src/lib/reducers/chat.js"],"sourcesContent":["export default class MemCache {\r\n\tconstructor(opts) {\r\n\t\tthis.defaultTTL = (opts && opts.ttl) || 300000;\r\n\t\tthis.store = this.store.bind(this);\r\n\t\tthis.get = this.get.bind(this);\r\n\t\tthis._items = {};\r\n\t}\r\n\tgetKey(obj) {\r\n\t\tswitch (typeof obj) {\r\n\t\t\tcase \"string\":\r\n\t\t\t\treturn obj;\r\n\t\t\tcase \"object\":\r\n\t\t\t\treturn JSON.stringify(obj);\r\n\t\t\tcase \"undefined\":\r\n\t\t\t\tthrow \"Key cannot be null\";\r\n\t\t}\r\n\t}\r\n\thasKey(key) {\r\n\t\treturn this._items.hasOwnProperty(this.getKey(key));\r\n\t}\r\n\tget(key) {\r\n\t\tlet _key = this.getKey(key);\r\n\t\treturn (this._items[_key] && this._items[_key].value) || undefined;\r\n\t}\r\n\tstore(key, value, ttl = this.defaultTTL) {\r\n\t\tlet _key = this.getKey(key);\r\n\t\tif (this._items[_key]) {\r\n\t\t\tclearTimeout(this._items[_key].handle);\r\n\t\t}\r\n\t\tlet handle = setTimeout(this.remove.bind(this, _key), ttl);\r\n\t\tthis._items[_key] = { value, handle };\r\n\t}\r\n\tremove(key) {\r\n\t\tdelete this._items[key];\r\n\t}\r\n}\r\n","import config from \"client_config\";\r\nimport CALL_API from \"call_api\";\r\nimport openSocket from \"socket.io-client\";\r\nimport MemCache from \"../utils/memcache\";\r\n\r\nconst preDispatch = config.preDispatch,\r\n  BASE_URL = global.BASE_URL || config.baseUrl,\r\n  CHAT_URL = global.CHAT_URL || config.chatUrl,\r\n  preLogin = config.preLogin,\r\n  cache = new MemCache({ ttl: config.processorsCacheTimeout });\r\nexport const ACTIONS = {\r\n  ADD_NAVIGATION_CONTEXT: \"ADD_NAVIGATION_CONTEXT\",\r\n  REMOVE_NAVIGATION_CONTEXT: \"REMOVE_NAVIGATION_CONTEXT\",\r\n  OPEN_CONFIRMATION: \"OPEN_CONFIRMATION\",\r\n  OPEN_CHAT: \"OPEN_CHAT\",\r\n  CLOSE_CHAT: \"CLOSE_CHAT\",\r\n  GET_CONTACTS: \"GET_CONTACTS\",\r\n  GOT_CONTACTS: \"GOT_CONTACTS\",\r\n  FAILED_TO_GET_CONTACTS: \"FAILED_TO_GET_CONTACTS\",\r\n  GET_INVITES: \"GET_INVITES\",\r\n  GOT_INVITES: \"GOT_INVITES\",\r\n  FAILED_TO_GET_INVITES: \"FAILED_TO_GET_INVITES\",\r\n  SEARCH: \"SEARCH\",\r\n  FOUND: \"FOUND\",\r\n  NOT_FOUND: \"NOT_FOUND\",\r\n  LOGIN_CHAT: \"LOGIN_CHAT\",\r\n  LOGGED_IN_CHAT: \"LOGGED_IN_CHAT\",\r\n  FAILED_TO_LOGIN_CHAT: \"FAILED_TO_LOGIN_CHAT\",\r\n  SEND_CHAT: \"SEND_CHAT\",\r\n  SENT_CHAT: \"SENT_CHAT\",\r\n  FAILED_TO_SEND_CHAT: \"FAILED_TO_SEND_CHAT\",\r\n  CREATE_GROUP: \"CREATE_GROUP\",\r\n  CREATED_GROUP: \"CREATED_GROUP\",\r\n  FAILED_TO_CREATE_GROUP: \"FAILED_TO_CREATE_GROUP\",\r\n  SEND_FRIEND_REQUEST: \"SEND_FRIEND_REQUEST\",\r\n  SENT_FRIEND_REQUEST: \"SENT_FRIEND_REQUEST\",\r\n  FAILED_TO_SEND_FRIEND_REQUEST: \"FAILED_TO_SEND_FRIEND_REQUEST\",\r\n  ACCEPT_FRIEND_REQUEST: \"ACCEPT_FRIEND_REQUEST\",\r\n  ACCEPTED_FRIEND_REQUEST: \"ACCEPTED_FRIEND_REQUEST\",\r\n  FAILED_TO_ACCEPT_FRIEND_REQUEST: \"FAILED_TO_ACCEPT_FRIEND_REQUEST\",\r\n  REJECT_FRIEND_REQUEST: \"REJECT_FRIEND_REQUEST\",\r\n  REJECTED_FRIEND_REQUEST: \"REJECTED_FRIEND_REQUEST\",\r\n  FAILED_TO_REJECT_FRIEND_REQUEST: \"FAILED_TO_REJECT_FRIEND_REQUEST\",\r\n  GET_FRIEND_REQUEST: \"GET_FRIEND_REQUEST\",\r\n  GOT_FRIEND_REQUEST: \"GOT_FRIEND_REQUEST\",\r\n  FAILED_TO_GET_FRIEND_REQUEST: \"FAILED_TO_GET_FRIEND_REQUEST\",\r\n  FETCHED_PROCESS: \"FETCHED_PROCESS\",\r\n  FAILED_TO_FETCH_PROCESS: \"FAILED_TO_FETCH_PROCESS\",\r\n  FETCHING_PROCESS: \"FETCHING_PROCESS\",\r\n  SESSION_MAY_HAVE_EXPIRED: \"SESSION_MAY_HAVE_EXPIRED\",\r\n  FETCHING_GRID: \"FETCHING_GRID\",\r\n  GET_SINGLE_ITEM_FOR_GRID: \"GET_SINGLE_ITEM_FOR_GRID\",\r\n  GOT_SINGLE_ITEM_FOR_GRID: \"GOT_SINGLE_ITEM_FOR_GRID\",\r\n  ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID:\r\n    \"ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID\",\r\n  DYNAMO_GET_MORE_FOR_GRID: \"DYNAMO_GET_MORE_FOR_GRID\",\r\n  ERROR_WHILE_FETCHING_GRID: \"ERROR_WHILE_FETCHING_GRID\",\r\n  FILTERED_GRID: \"FILTERED_GRID\",\r\n  DYNAMO_PROCESSOR_RUNNING: \"DYNAMO_PROCESSOR_RUNNING\",\r\n  DYNAMO_PROCESSOR_RAN: \"DYNAMO_PROCESSOR_RAN\",\r\n  DYNAMO_PROCESSOR_FAILED: \"DYNAMO_PROCESSOR_FAILED\",\r\n  DYNAMO_PROCESS_RUNNING: \"DYNAMO_PROCESS_RUNNING\",\r\n  DYNAMO_PROCESS_RAN: \"DYNAMO_PROCESS_RAN\",\r\n  DYNAMO_PROCESS_FAILED: \"DYNAMO_PROCESS_FAILED\",\r\n  API_ERROR: \"API_ERROR\",\r\n  START_FILE_UPLOAD: \"START_FILE_UPLOAD\",\r\n  FILE_UPLOADED: \"FILE_UPLOADED\",\r\n  FILE_UPLOAD_FAILED: \"FILE_UPLOAD_FAILED\",\r\n  GET_PREVIEW: \"GET_PREVIEW\",\r\n  GOT_PREVIEW: \"GOT_PREVIEW\",\r\n  FAILED_TO_GET_PREVIEW: \"FAILED_TO_GET_PREVIEW\",\r\n  GET_ITEM_TEMPLATE: \"GET_ITEM_TEMPLATE\",\r\n  GOT_ITEM_TEMPLATE: \"GOT_ITEM_TEMPLATE\",\r\n  FAILED_TO_GET_ITEM_TEMPLATE: \"FAILED_TO_GET_ITEM_TEMPLATE\",\r\n  GET_FILTER_TEMPLATE: \"GET_FILTER_TEMPLATE\",\r\n  GOT_FILTER_TEMPLATE: \"GOT_FILTER_TEMPLATE\",\r\n  FAILED_TO_GET_FILTER_TEMPLATE: \"FAILED_TO_GET_FILTER_TEMPLATE\",\r\n  ADD_TO_OPEN_CHATS: \"ADD_TO_OPEN_CHATS\",\r\n  NEW_MESSAGE: \"NEW_MESSAGE\",\r\n  NEW_GROUP_MESSAGE: \"NEW_GROUP_MESSAGE\"\r\n};\r\n\r\nlet socket;\r\n\r\nexport const displayMessage = text => {\r\n  return {\r\n    type: \"SHOW_MESSAGE\",\r\n    message: text\r\n  };\r\n};\r\n\r\nfunction getQueryParams(args) {\r\n  return args\r\n    ? \"?\" +\r\n      Object.keys(args)\r\n        .map((x, index, arr) => {\r\n          return `${x}=${encodeURIComponent(args[x]) +\r\n            (index != arr.length - 1 ? \"&\" : \"\")}`;\r\n        })\r\n        .join(\"\")\r\n    : \"\";\r\n}\r\nexport function removeNavigationContext() {\r\n  return {\r\n    type: ACTIONS.REMOVE_NAVIGATION_CONTEXT\r\n  };\r\n}\r\n\r\nexport function addNavigationContext(args) {\r\n  return {\r\n    type: ACTIONS.ADD_NAVIGATION_CONTEXT,\r\n    payload: args\r\n  };\r\n}\r\nexport function openConfirmation(id, message, params) {\r\n  return {\r\n    type: ACTIONS.OPEN_CONFIRMATION,\r\n    payload: { message, params, id }\r\n  };\r\n}\r\nfunction defaultError(dispatch, customType, meta) {\r\n  return {\r\n    type: customType || \"SHOW_MESSAGE\",\r\n    meta: (action, state, res) => {\r\n      if (customType && res.status !== 401)\r\n        dispatch(\r\n          displayMessage(\r\n            res.statusText ||\r\n              (res.headers &&\r\n                res.headers.map &&\r\n                res.headers.map.errormessage &&\r\n                res.headers.map.errormessage[0]) ||\r\n              \"Sorry , an error occurred while processing your request\"\r\n          )\r\n        );\r\n\r\n      //session expired\r\n      if (res.status == 401) {\r\n        dispatch(showMessage(\"Session may have expired\"));\r\n        dispatch({ type: ACTIONS.SESSION_MAY_HAVE_EXPIRED });\r\n      }\r\n\r\n      return meta\r\n        ? meta(action, state, res)\r\n        : res.statusText || \"An unknown error has occurred\";\r\n    }\r\n  };\r\n}\r\nexport const dynamoDownloadUrl = `${BASE_URL}/api/download/:id`;\r\nexport function fetchDynamoProcess(id, args) {\r\n  if (config.cacheProcessDescription) {\r\n    let cacheKey = { id, args },\r\n      hasKey = cache.hasKey(cacheKey);\r\n    if (hasKey) {\r\n      let payload = Object.assign({}, cache.get(cacheKey));\r\n\r\n      return dispatch => {\r\n        dispatch({\r\n          type: ACTIONS.FETCHED_PROCESS,\r\n          payload\r\n        });\r\n      };\r\n    }\r\n  }\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/process/describe/${id}${getQueryParams(\r\n            Object.assign({}, args || {}, { $uiOnDemand: !!config.uiOnDemand })\r\n          )}`,\r\n          types: [\r\n            { type: ACTIONS.FETCHING_PROCESS, meta: id },\r\n            {\r\n              type: ACTIONS.FETCHED_PROCESS,\r\n              payload: (action, state, res) => {\r\n                //workaround for react-native fetch.\r\n                setTimeout(() => null, 0);\r\n                return res.json().then(d => {\r\n                  let response = { id: id, data: d };\r\n                  if (config.cacheProcessDescription && !d.data) {\r\n                    cache.store({ id, args }, response);\r\n                  }\r\n                  return response;\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FAILED_TO_FETCH_PROCESS)\r\n          ],\r\n          method: \"GET\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          }\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\n\r\nexport function getMoreForGrid(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.FETCHING_GRID,\r\n    resultCustomType: ACTIONS.DYNAMO_GET_MORE_FOR_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_FETCHING_GRID,\r\n    disableCache: true\r\n  });\r\n}\r\nexport function filterGrid(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.FETCHING_GRID,\r\n    resultCustomType: ACTIONS.FILTERED_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_FETCHING_GRID,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getItemTemplate(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_ITEM_TEMPLATE,\r\n    resultCustomType: ACTIONS.GOT_ITEM_TEMPLATE,\r\n    errorCustomType: ACTIONS.FAILED_TO_GET_ITEM_TEMPLATE,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getFilterTemplate(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_FILTER_TEMPLATE,\r\n    resultCustomType: ACTIONS.GOT_FILTER_TEMPLATE,\r\n    errorCustomType: ACTIONS.FAILED_TO_GET_FILTER_TEMPLATE,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function getSingleItemForGrid(id, args, key) {\r\n  return runDynamoProcessor(id, args, key, {\r\n    requestCustomType: ACTIONS.GET_SINGLE_ITEM_FOR_GRID,\r\n    resultCustomType: ACTIONS.GOT_SINGLE_ITEM_FOR_GRID,\r\n    errorCustomType: ACTIONS.ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID,\r\n    disableCache: true\r\n  });\r\n}\r\n\r\nexport function runDynamoProcessor(\r\n  id,\r\n  args,\r\n  key,\r\n  {\r\n    requestCustomType,\r\n    resultCustomType,\r\n    errorCustomType,\r\n    returnsUI,\r\n    disableCache\r\n  } = {}\r\n) {\r\n  //console.log(arguments);\r\n  if (config.cacheProcessorResponses && !disableCache) {\r\n    let cacheKey = { id, args },\r\n      hasKey = cache.hasKey(cacheKey);\r\n    if (hasKey) {\r\n      let payload = Object.assign({}, cache.get(cacheKey));\r\n      payload.key = key;\r\n\r\n      return dispatch => {\r\n        dispatch({\r\n          type: resultCustomType || ACTIONS.DYNAMO_PROCESSOR_RAN,\r\n          payload\r\n        });\r\n      };\r\n    }\r\n  }\r\n\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/processors/run/${id}`,\r\n          types: [\r\n            {\r\n              type: requestCustomType || ACTIONS.DYNAMO_PROCESSOR_RUNNING,\r\n              meta: { id, key, args }\r\n            },\r\n            {\r\n              type: resultCustomType || ACTIONS.DYNAMO_PROCESSOR_RAN,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(data => {\r\n                  if (data && typeof data.message == \"string\") {\r\n                    dispatch(showMessage(data.message));\r\n                  }\r\n                  let response = { id, data, args, key, returnsUI };\r\n                  if (config.cacheProcessorResponses && !disableCache) {\r\n                    cache.store({ id, args }, response);\r\n                  }\r\n                  return response;\r\n                });\r\n              }\r\n            },\r\n            defaultError(\r\n              dispatch,\r\n              errorCustomType || ACTIONS.DYNAMO_PROCESSOR_FAILED,\r\n              () => key\r\n            )\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          },\r\n          body: JSON.stringify(args)\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\n\r\nexport function showMessage(message) {\r\n  return {\r\n    type: \"SHOW_MESSAGE\",\r\n    message\r\n  };\r\n}\r\n\r\nexport function runDynamoProcess(details) {\r\n  return (dispatch, getState) =>\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/process/run/${details.id}`,\r\n          types: [\r\n            {\r\n              type: ACTIONS.DYNAMO_PROCESS_RUNNING,\r\n              meta: { id: details.id, form: details.form }\r\n            },\r\n            {\r\n              type: ACTIONS.DYNAMO_PROCESS_RAN,\r\n              payload: (action, state, res) => {\r\n                return res\r\n                  .json()\r\n                  .then(d => {\r\n                    if (d && typeof d.message == \"string\") {\r\n                      dispatch(showMessage(d.message));\r\n                    }\r\n\r\n                    return { id: details.id, data: d };\r\n                  })\r\n                  .catch(er => {\r\n                    dispatch({\r\n                      type: \"SHOW_MESSAGE\",\r\n                      message:\r\n                        \"An error occurred while trying to understand a response from the server.\"\r\n                    });\r\n                  });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.DYNAMO_PROCESS_FAILED)\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          },\r\n          body: JSON.stringify(\r\n            Object.assign(\r\n              {},\r\n              details.form,\r\n              {\r\n                instanceId: details.instanceId\r\n              },\r\n              { $uiOnDemand: !!config.uiOnDemand }\r\n            )\r\n          )\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n}\r\nexport function getDynamoFilePreview(id, key, fileType, query) {\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/upload/preview/${id + (query || \"\")}`,\r\n          types: [\r\n            { type: ACTIONS.GET_PREVIEW, meta: key },\r\n            {\r\n              type: ACTIONS.GOT_PREVIEW,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(d => {\r\n                  return { data: d, key };\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FAILED_TO_GET_PREVIEW, () => key)\r\n          ],\r\n          method: \"GET\",\r\n          headers: {\r\n            Accept: \"*/*\",\r\n            \"Content-Type\": \"application/json\"\r\n          }\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n  };\r\n}\r\n\r\nexport function uploadDynamoFile(file, key) {\r\n  let formData = new FormData();\r\n\r\n  formData.append(\"file\", file);\r\n\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      [CALL_API]: preDispatch(\r\n        {\r\n          endpoint: `${BASE_URL}/api/upload`,\r\n          types: [\r\n            { type: ACTIONS.START_FILE_UPLOAD, meta: key },\r\n            {\r\n              type: ACTIONS.FILE_UPLOADED,\r\n              payload: (action, state, res) => {\r\n                return res.json().then(d => {\r\n                  return { key, id: d.id };\r\n                });\r\n              }\r\n            },\r\n            defaultError(dispatch, ACTIONS.FILE_UPLOAD_FAILED, () => key)\r\n          ],\r\n          method: \"POST\",\r\n          headers: {\r\n            Accept: \"application/json\"\r\n          },\r\n          body: formData\r\n        },\r\n        getState()\r\n      )\r\n    });\r\n  };\r\n}\r\n\r\nexport function loginChat(credentials, extra) {\r\n  return (dispatch, getState) => {\r\n    dispatch({ type: ACTIONS.LOGIN_CHAT });\r\n    socket.emit(\"login\", preLogin(credentials, getState()), msg => {\r\n      if (msg.error) {\r\n        if (!msg.isSignedUp && credentials.handle) {\r\n          dispatch(\r\n            showMessage(\r\n              \"An error occurred while contacting the chat server. Please retry\"\r\n            )\r\n          );\r\n        }\r\n        return dispatch({ type: ACTIONS.FAILED_TO_LOGIN_CHAT, payload: msg });\r\n      }\r\n      if (extra) {\r\n        extra();\r\n      }\r\n      return dispatch({\r\n        type: ACTIONS.LOGGED_IN_CHAT,\r\n        payload: msg.message,\r\n        meta: credentials\r\n      });\r\n    });\r\n  };\r\n}\r\n\r\nexport function sendMessage(type, msg) {\r\n  return emit(type, msg, {\r\n    requestType: ACTIONS.SEND_CHAT,\r\n    resultType: ACTIONS.SENT_CHAT,\r\n    errorType: ACTIONS.FAILED_TO_SEND_CHAT\r\n  });\r\n}\r\nexport function createGroup(msg) {\r\n  return emit(\"create group\", msg, {\r\n    requestType: ACTIONS.CREATE_GROUP,\r\n    resultType: ACTIONS.CREATED_GROUP\r\n  });\r\n}\r\n\r\nexport function sendFriendRequest(handle) {\r\n  return emit(\"friend request\", handle, {\r\n    requestType: ACTIONS.SEND_FRIEND_REQUEST,\r\n    resultType: ACTIONS.SENT_FRIEND_REQUEST,\r\n    errorType: ACTIONS.FAILED_TO_SEND_FRIEND_REQUEST\r\n  });\r\n}\r\nexport function getContacts() {\r\n  return emit(\"friends\", null, {\r\n    requestType: ACTIONS.GET_CONTACTS,\r\n    resultType: ACTIONS.GOT_CONTACTS,\r\n    errorType: ACTIONS.FAILED_TO_GET_CONTACTS\r\n  });\r\n}\r\n\r\nexport function fetchInvites() {\r\n  return emit(\"pending friend requests\", null, {\r\n    requestType: ACTIONS.GET_INVITES,\r\n    resultType: ACTIONS.GOT_INVITES,\r\n    errorType: ACTIONS.FAILED_TO_GET_INVITES\r\n  });\r\n}\r\n\r\nexport function acceptInvite(handle) {\r\n  return emit(\"approve friend request\", handle, {\r\n    requestType: ACTIONS.ACCEPT_FRIEND_REQUEST,\r\n    resultType: ACTIONS.ACCEPTED_FRIEND_REQUEST,\r\n    errorType: ACTIONS.FAILED_TO_ACCEPT_FRIEND_REQUEST\r\n  });\r\n}\r\nexport function rejectInvite(handle) {\r\n  return emit(\"reject friend request\", handle, {\r\n    requestType: ACTIONS.REJECT_FRIEND_REQUEST,\r\n    resultType: ACTIONS.REJECTED_FRIEND_REQUEST,\r\n    errorType: ACTIONS.FAILED_TO_REJECT_FRIEND_REQUEST\r\n  });\r\n}\r\nexport function searchForHandle(handle) {\r\n  return emit(\"search for handle\", handle, {\r\n    requestType: ACTIONS.SEARCH,\r\n    resultType: ACTIONS.FOUND,\r\n    errorType: ACTIONS.NOT_FOUND\r\n  });\r\n}\r\n\r\nfunction emit(type, message, { requestType, resultType, errorType }) {\r\n  let args = Array.prototype.slice.call(arguments);\r\n  return (dispatch, getState) => {\r\n    dispatch({ type: requestType });\r\n    socket.emit(type, message, result => {\r\n      if (result.error) {\r\n        if (result.message == \"Unauthorized\") {\r\n          let state = getState();\r\n          if (state.authentication.username) {\r\n            return dispatch(\r\n              loginChat({ username: state.authentication.username }, () => {\r\n                dispatch(emit.apply(null, args));\r\n              })\r\n            );\r\n          }\r\n        }\r\n\r\n        return (\r\n          dispatch(showMessage(result.message)),\r\n          errorType && dispatch({ type: errorType, payload: result })\r\n        );\r\n      }\r\n      dispatch({\r\n        type: resultType,\r\n        payload: result && result.message,\r\n        meta: message\r\n      });\r\n    });\r\n  };\r\n}\r\n\r\nexport function addToOpenChats(chat) {\r\n  return { type: ACTIONS.ADD_TO_OPEN_CHATS, payload: chat };\r\n}\r\nexport function openChat(chat) {\r\n  return { type: ACTIONS.OPEN_CHAT, payload: chat };\r\n}\r\nexport function closeChat() {\r\n  return { type: ACTIONS.CLOSE_CHAT };\r\n}\r\n\r\nexport function startReceivingMessages(store) {\r\n  socket = openSocket(CHAT_URL);\r\n  socket.on(\"msg\", function(message, fn) {\r\n    store.dispatch({ type: ACTIONS.NEW_MESSAGE, payload: message });\r\n    fn();\r\n  });\r\n  socket.on(\"grpmsg\", function(message, fn) {\r\n    store.dispatch({ type: ACTIONS.NEW_GROUP_MESSAGE, payload: message });\r\n    fn();\r\n  });\r\n}\r\n","export default class Validator {\r\n\tconstructor(context) {\r\n\t\tthis.run = this.run.bind(context);\r\n\t}\r\n\trun() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (\r\n\t\t\t\t(!this.props.validators || !this.props.validators.length) &&\r\n\t\t\t\t(!this.props.asyncValidators ||\r\n\t\t\t\t\t!this.props.asyncValidators.length)\r\n\t\t\t)\r\n\t\t\t\treturn resolve();\r\n\r\n\t\t\tif (this.props.validators) {\r\n\t\t\t\tlet result = this.props.validators.reduce(\r\n\t\t\t\t\t(current, element) => {\r\n\t\t\t\t\t\t// statements\r\n\t\t\t\t\t\tlet valid = current.valid,\r\n\t\t\t\t\t\t\terror = \"\";\r\n\t\t\t\t\t\tswitch (element.validatorType) {\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.REQUIRED:\r\n\t\t\t\t\t\t\t\tvalid = this.hasValue();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.MAXLENGTH:\r\n\t\t\t\t\t\t\t\tvalid = this.isLessThanMaxLength(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.MINLENGTH:\r\n\t\t\t\t\t\t\t\tvalid = this.isGreaterThanMinLength(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase VALIDATOR_TYPES.REGEX:\r\n\t\t\t\t\t\t\t\tvalid = this.matchesRegex(element);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof valid == \"string\") {\r\n\t\t\t\t\t\t\terror = valid;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\tcurrent.errors.push(error),\r\n\t\t\t\t\t\t\t\t(current.valid = false),\r\n\t\t\t\t\t\t\t\tcurrent\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn current;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ errors: [], valid: true }\r\n\t\t\t\t);\r\n\t\t\t\tif (!result.valid) {\r\n\t\t\t\t\tthis.setState(\r\n\t\t\t\t\t\tObject.assign(this.state, { errors: result.errors })\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn reject();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.props.asyncValidators &&\r\n\t\t\t\tthis.props.asyncValidators.length &&\r\n\t\t\t\t!this.props.valid\r\n\t\t\t) {\r\n\t\t\t\treturn reject();\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState(Object.assign(this.state, { errors: null }));\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport const VALIDATOR_TYPES = {\r\n\tREQUIRED: \"REQUIRED\",\r\n\tMAXLENGTH: \"MAXLENGTH\",\r\n\tMINLENGTH: \"MINLENGTH\",\r\n\tREGEX: \"REGEX\"\r\n};\r\n","import { Component } from \"react\";\r\nexport default {\r\n\tvalidComponent: function(component, name) {\r\n\t\tif (!component) throw new Error(`${name} cannot be null`);\r\n\t\tif (\r\n\t\t\t!Component.prototype.isPrototypeOf(component) &&\r\n\t\t\ttypeof component !== \"function\"\r\n\t\t)\r\n\t\t\tthrow new Error(\r\n\t\t\t\t`${name} must either be a valid react Component or a Function`\r\n\t\t\t);\r\n\t\treturn true;\r\n\t}\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\n/**\r\n * Higher order function that recieves Platform specific implementation of Input\r\n * @param  {Function} Input Input class\r\n * @return {Function}       Wrapped class\r\n */\r\nexport default (LabelWrapper, Input, DatePicker, Checkbox) => {\r\n\tinvariants.validComponent(LabelWrapper, \"LabelWrapper\");\r\n\tinvariants.validComponent(Input, \"Input\");\r\n\tinvariants.validComponent(DatePicker, \"DatePicker\");\r\n\tinvariants.validComponent(Checkbox, \"Checkbox\");\r\n\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tif (ownProps.asyncValidators && ownProps.asyncValidators.length) {\r\n\t\t\treturn {\r\n\t\t\t\tvalid:\r\n\t\t\t\t\tstate.dynamo[\r\n\t\t\t\t\t\townProps.asyncValidators[0] + ownProps.component_uid\r\n\t\t\t\t\t]\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn {};\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\trunAsyncValidator: (id, params, key) =>\r\n\t\t\t\tdispatch(runDynamoProcessor(id, params, key))\r\n\t\t};\r\n\t};\r\n\tclass DynamoInput extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalue:\r\n\t\t\t\t\tthis.props.value ||\r\n\t\t\t\t\t(this.props.args && this.props.args.default)\r\n\t\t\t};\r\n\t\t\tthis.runValidators = this.runValidators.bind(this);\r\n\t\t\tthis.hasValue = this.hasValue.bind(this);\r\n\t\t\tthis.isLessThanMaxLength = this.isLessThanMaxLength.bind(this);\r\n\t\t\tthis.isGreaterThanMinLength = this.isGreaterThanMinLength.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.matchesRegex = this.matchesRegex.bind(this);\r\n\t\t\tthis.runAsyncValidators = this.runAsyncValidators.bind(this);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.component_uid !== this.props.component_uid) {\r\n\t\t\t\t//\t\tsetTimeout(() => {\r\n\t\t\t\tthis.valueChanged(this.props.value);\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidationHelper(this).run();\r\n\t\t}\r\n\t\trunAsyncValidators(value) {\r\n\t\t\tthis.props.runAsyncValidator(\r\n\t\t\t\tthis.props.asyncValidators[0],\r\n\t\t\t\tvalue,\r\n\t\t\t\tthis.props.asyncValidators[0] + this.props.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.state.value || \"is required\";\r\n\t\t}\r\n\t\tisRequired() {\r\n\t\t\treturn (\r\n\t\t\t\tthis.props.validators &&\r\n\t\t\t\tthis.props.validators.filter(\r\n\t\t\t\t\tx => x.validatorType == VALIDATOR_TYPES.REQUIRED\r\n\t\t\t\t).length > 0\r\n\t\t\t);\r\n\t\t}\r\n\t\tisLessThanMaxLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.value &&\r\n\t\t\t\t\tthis.state.value.length <= element.args.max) ||\r\n\t\t\t\telement.error ||\r\n\t\t\t\t\"The maximum number of letters/numbers is \" + element.args.max\r\n\t\t\t);\r\n\t\t}\r\n\t\tisGreaterThanMinLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.value &&\r\n\t\t\t\t\tthis.state.value.length >= element.args.min) ||\r\n\t\t\t\telement.error ||\r\n\t\t\t\t\"The minimum number of letters/numbers is\" + element.args.min\r\n\t\t\t);\r\n\t\t}\r\n\t\tmatchesRegex(element) {\r\n\t\t\treturn (\r\n\t\t\t\tnew RegExp(element.args.exp).test(this.state.value) ||\r\n\t\t\t\telement.error ||\r\n\t\t\t\t\"Invalid entry\"\r\n\t\t\t);\r\n\t\t}\r\n\t\tvalueChanged(value) {\r\n\t\t\tthis.props.valueChanged({ [this.props.name]: value });\r\n\t\t\tif (this.props.asyncValidators && this.props.asyncValidators.length)\r\n\t\t\t\tthis.runAsyncValidators(value);\r\n\r\n\t\t\tthis.setState({ value: value, errors: [] });\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start */\r\n\t\t\tlet args = this.props.args,\r\n\t\t\t\tResult;\r\n\t\t\tconst { type, valueChanged, ...passThrough } = this.props;\r\n\t\t\tif (\r\n\t\t\t\t!args ||\r\n\t\t\t\t!args.type ||\r\n\t\t\t\targs.type == \"text\" ||\r\n\t\t\t\targs.type == \"number\" ||\r\n\t\t\t\targs.type == \"password\"\r\n\t\t\t) {\r\n\t\t\t\tResult = Input;\r\n\t\t\t\targs = args || { type: \"text\" };\r\n\t\t\t}\r\n\t\t\tif (args.type == \"checkbox\") Result = Checkbox;\r\n\r\n\t\t\tif (args.type == \"date\") Result = DatePicker;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<LabelWrapper\r\n\t\t\t\t\tvalue={this.props.label}\r\n\t\t\t\t\tinner={\r\n\t\t\t\t\t\t<Result\r\n\t\t\t\t\t\t\ttype={args.type}\r\n\t\t\t\t\t\t\t{...passThrough}\r\n\t\t\t\t\t\t\trequired={this.isRequired()}\r\n\t\t\t\t\t\t\tvalue={this.state.value}\r\n\t\t\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end */\r\n\t\t}\r\n\t}\r\n\tDynamoInput.propTypes = {\r\n\t\tvalueChanged: React.PropTypes.func\r\n\t};\r\n\treturn DynamoInput;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default (Page, Container) => {\r\n\tinvariants.validComponent(Page, \"Page\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\t//map elements in DynamoView props to elements in store.\r\n\tconst mapStateToProps = (_, initialProps) => state => {\r\n\t\t//console.log(\"mapping state to props\");\r\n\t\tlet description = state.dynamo.description,\r\n\t\t\tmap = { value: state.dynamo.value };\r\n\t\tif (description) {\r\n\t\t\tlet step = state.dynamo.currentStep || 0;\r\n\t\t\tmap.elements = description.steps[step].form.elements;\r\n\t\t\tif (description.steps[step].mode == \"VIEW\") map.hideSubmit = true;\r\n\t\t\tmap.title=description.title;\r\n\t\t}\r\n\t\treturn map;\r\n\t};\r\n\r\n\tclass DynamoView extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.onValueChanged = this.onValueChanged.bind(this);\r\n\t\t\tthis.submit = this.submit.bind(this);\r\n\t\t\t//pass reference to validate func\r\n\t\t\tthis.state = {\r\n\t\t\t\tform: this.props.value,\r\n\t\t\t\tvalidator: {}\r\n\t\t\t};\r\n\t\t}\r\n\t\tonValueChanged(form) {\r\n\t\t\tthis.state.form = form.dynamo_view;\r\n\t\t}\r\n\t\tsubmit() {\r\n\t\t\tthis.state.validator\r\n\t\t\t\t.validate()\r\n\t\t\t\t.then(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tthis.props.submit(this.state.form);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tconsole.warn(\"the form is invalid\");\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t.catch(er => {\r\n\t\t\t\t\tconsole.log(\"an error occurred while validating form \");\r\n\t\t\t\t\tconsole.error(er);\r\n\t\t\t\t});\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\treturn (\r\n\t\t\t\t<Page submit={this.submit} hideSubmit={this.props.hideSubmit}>\r\n\t\t\t\t\t<Container\r\n\t\t\t\t\t    label={this.props.title}\r\n\t\t\t\t\t\telements={this.props.elements}\r\n\t\t\t\t\t\tname=\"dynamo_view\"\r\n\t\t\t\t\t\tvalue={this.props.value}\r\n\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\tvalidator={this.state.validator}\r\n\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Page>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps)(DynamoView);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Section, Header, ComponentWrapper, ComponentLocator) => {\r\n\t//invariants\r\n\tif (Array.prototype.slice.call(arguments).length == 3) {\r\n\t\tComponentLocator = ComponentWrapper;\r\n\t\tComponentWrapper = null;\r\n\t}\r\n\r\n\tif (\r\n\t\tinvariants.validComponent(Section, \"Section\") &&\r\n\t\tinvariants.validComponent(Header, \"Header\") &&\r\n\t\t!ComponentLocator\r\n\t)\r\n\t\tthrow new Error(\"ComponentLocator cannot be null (dynamo_container)\");\r\n\r\n\treturn class extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.onValueChanged = this.onValueChanged.bind(this);\r\n\t\t\tthis.state = { form: this.props.value };\r\n\t\t\tthis._validations = [];\r\n\t\t\tthis.setValidator = this.setValidator.bind(this);\r\n\t\t\tthis.setValidator();\r\n\t\t}\r\n\t\tsetValidator() {\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn Promise.all(\r\n\t\t\t\t\tthis._validations.map(x => {\r\n\t\t\t\t\t\tif (x.validate) return x.validate();\r\n\r\n\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t};\r\n\t\t}\r\n\t\tonValueChanged() {\r\n\t\t\tthis.state.form = Object.assign(\r\n\t\t\t\t{},\r\n\t\t\t\tthis.state.form || {},\r\n\t\t\t\t...Array.prototype.slice.call(arguments)\r\n\t\t\t);\r\n\t\t\tthis.props.valueChanged({ [this.props.name]: this.state.form });\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\tthis._validations.length = 0;\r\n\t\t\tlet keys = this.props.value ? Object.keys(this.props.value) : [],\r\n\t\t\t\tself = this,\r\n\t\t\t\textraVal = {},\r\n\t\t\t\tindex = -1,\r\n\t\t\t\tnotifyExtra = [],\r\n\t\t\t\telements = (this.props.elements || [])\r\n\t\t\t\t\t.sort((x, y) => {\r\n\t\t\t\t\t\treturn x.order - y.order;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.map(x => {\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\tlet DynamoComponent = ComponentLocator(x),\r\n\t\t\t\t\t\t\tsource = self.props.value,\r\n\t\t\t\t\t\t\tvalidator = {},\r\n\t\t\t\t\t\t\tvalue = source ? this.props.value[x.name] : null;\r\n\t\t\t\t\t\tthis._validations.push(validator);\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tsource &&\r\n\t\t\t\t\t\t\tself.props.value[x.name] &&\r\n\t\t\t\t\t\t\tkeys.indexOf(x.name) !== -1\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\tkeys.splice(keys.indexOf(x.name), 1);\r\n\t\t\t\t\t\t/*jshint ignore:start*/\r\n\t\t\t\t\t\tif (!DynamoComponent)\r\n\t\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\t\"Unknown component:\" +\r\n\t\t\t\t\t\t\t\t\tJSON.stringify(x, null, \" \")\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif (DynamoComponent.notifyExtra) {\r\n\t\t\t\t\t\t\tnotifyExtra.push(index);\r\n\t\t\t\t\t\t\treturn extra => {\r\n\t\t\t\t\t\t\t\tlet component = (\r\n\t\t\t\t\t\t\t\t\t<DynamoComponent\r\n\t\t\t\t\t\t\t\t\t\t{...x}\r\n\t\t\t\t\t\t\t\t\t\textra={extra}\r\n\t\t\t\t\t\t\t\t\t\tkey={x.name}\r\n\t\t\t\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t\t\t\t\tvalidator={validator}\r\n\t\t\t\t\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tif (ComponentWrapper)\r\n\t\t\t\t\t\t\t\t\treturn ComponentWrapper(\r\n\t\t\t\t\t\t\t\t\t\tx.elementType,\r\n\t\t\t\t\t\t\t\t\t\tx.uid,\r\n\t\t\t\t\t\t\t\t\t\tcomponent\r\n\t\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\treturn component;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet component = (\r\n\t\t\t\t\t\t\t<DynamoComponent\r\n\t\t\t\t\t\t\t\t{...x}\r\n\t\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t\t\tvalidator={validator}\r\n\t\t\t\t\t\t\t\tkey={x.name}\r\n\t\t\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\treturn ComponentWrapper\r\n\t\t\t\t\t\t\t? ComponentWrapper(x.elementType, x.uid, component)\r\n\t\t\t\t\t\t\t: component;\r\n\t\t\t\t\t\t/*jshint ignore:end*/\r\n\t\t\t\t\t});\r\n\r\n\t\t\tif (keys.length || notifyExtra.length) {\r\n\t\t\t\tif (!notifyExtra.length) {\r\n\t\t\t\t\t// console.warn(\r\n\t\t\t\t\t// \t\"there are extra properties that no component cares about \" +\r\n\t\t\t\t\t// \t\tJSON.stringify(keys, null, \" \")\r\n\t\t\t\t\t// );\r\n\t\t\t\t\t// console.warn('shouldnt happen too often');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkeys.forEach(x => {\r\n\t\t\t\t\textraVal[x] = self.props.value[x];\r\n\t\t\t\t});\r\n\r\n\t\t\t\tnotifyExtra.forEach(x => {\r\n\t\t\t\t\telements[x] = elements[x](Object.assign({}, extraVal));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\treturn (\r\n\t\t\t\t<Section>\r\n\t\t\t\t\t<Header text={this.props.label} />\r\n\t\t\t\t\t{elements}\r\n\t\t\t\t</Section>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { fetchDynamoProcess, runDynamoProcess } from \"./actions\";\r\nimport _ from \"lodash\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\n/**\r\n * Higher order function that recieves Platform specific implementation of Input\r\n * @param  {Function} Input Input class\r\n * @return {Function}       Wrapped class\r\n */\r\nexport default (ProgressBar, TextView, DynamoView) => {\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(TextView, \"TextView\");\r\n\tinvariants.validComponent(DynamoView, \"DynamoView\");\r\n\r\n\t//map elements in DynamoInput props to elements in store.\r\n\tconst mapStateToProps = (_, initialProps) => state => {\r\n\t\treturn {\r\n\t\t\tbusy: state.dynamo.busy,\r\n\t\t\tdescription: state.dynamo.description,\r\n\t\t\tinstanceId: state.dynamo.instanceId,\r\n\t\t\tmessage: state.dynamo.message,\r\n\t\t\tcompleted: state.dynamo.completed\r\n\t\t};\r\n\t};\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tfetch: (id, params) => {\r\n\t\t\t\tdispatch(fetchDynamoProcess(id, params));\r\n\t\t\t},\r\n\t\t\trunProcess: info => {\r\n\t\t\t\tdispatch(runDynamoProcess(info));\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoProcess extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.submit = this.submit.bind(this);\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tif (\r\n\t\t\t\t!this.props.description ||\r\n\t\t\t\tthis.props.id !== this.props.description._id\r\n\t\t\t) {\r\n\t\t\t\tthis.props.fetch(this.props.id, this.props.fetchParams);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.completed && next.completed != this.props.completed)\r\n\t\t\t\treturn this.props.navigation.goBack();\r\n\r\n\t\t\tif (\r\n\t\t\t\t(next.id !== this.props.id ||\r\n\t\t\t\t\t!_.isEqual(next.fetchParams, this.props.fetchParams)) &&\r\n\t\t\t\t!this.props.busy\r\n\t\t\t)\r\n\t\t\t\tthis.props.fetch(next.id, next.fetchParams);\r\n\t\t}\r\n\t\tsubmit(form) {\r\n\t\t\tthis.props.runProcess({\r\n\t\t\t\tid: this.props.id,\r\n\t\t\t\tform,\r\n\t\t\t\tinstanceId: this.props.instanceId\r\n\t\t\t});\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start */\r\n\t\t\tif (this.props.busy || typeof this.props.busy == \"undefined\") {\r\n\t\t\t\treturn <ProgressBar title=\"Please wait...\" />;\r\n\t\t\t}\r\n\t\t\tif (!this.props.description) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<TextView text=\"Sorry we couldnt load that process...please wait a few minutes and retry.\" />\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<DynamoView\r\n\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\tsubmit={this.submit}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end */\r\n\t\t}\r\n\t}\r\n\t// DynamoProcess.propTypes = {\r\n\t// \tid: React.PropTypes.string.isRequired,\r\n\t// \tfetchParams: React.PropTypes.object,\r\n\t// \tdescription: React.PropTypes.object\r\n\t// };\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoProcess);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Layout, Header, Container) => {\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Header, \"Header\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\tclass DynamoSection extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\t//get the container for retrieving\r\n\t\t\treturn (\r\n\t\t\t\t<Layout>\r\n\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t{this.props.label}\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t\t<Container\r\n\t\t\t\t\t\telements={this.props.args.elements}\r\n\t\t\t\t\t\tname={this.props.name}\r\n\t\t\t\t\t\tvalue={this.props.value}\r\n\t\t\t\t\t\tvalueChanged={this.props.valueChanged}\r\n\t\t\t\t\t\tvalidator={this.props.validator}\r\n\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\treturn DynamoSection;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default (ProgressIndicator, Layout, Container) => {\r\n\tif (\r\n\t\tinvariants.validComponent(ProgressIndicator, \"ProgressIndicator\") &&\r\n\t\tinvariants.validComponent(Layout, \"Layout\") &&\r\n\t\t!Container\r\n\t)\r\n\t\tthrow new Error(\"Container cannot be null (dynamo_select)\");\r\n\r\n\t//map elements in DynamoView props to elements in store.\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tif (ownProps.args.type == \"PROCESSOR\") {\r\n\t\t\tlet st = state.dynamo[ownProps.component_uid];\r\n\t\t\treturn {\r\n\t\t\t\titems: st,\r\n\t\t\t\tbusy: !!state.dynamo[`${ownProps.component_uid}-busy`]\r\n\t\t\t};\r\n\t\t}\r\n\t\t//evaluate stuff in the parent container to retrieve the\r\n\t};\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tfetch: (id, params, key) => {\r\n\t\t\t\tdispatch(runDynamoProcessor(id, params, key));\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoSelect extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\r\n\t\t\tthis.fetchItems = this.fetchItems.bind(this);\r\n\t\t\tthis.onValueChanged = this.onValueChanged.bind(this);\r\n\t\t\tthis.selectFirstItem = this.selectFirstItem.bind(this);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.isValidValue = this.isValidValue.bind(this);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalue:\r\n\t\t\t\t\tprops.value && typeof props.value == \"object\"\r\n\t\t\t\t\t\t? props.value.$objectID\r\n\t\t\t\t\t\t: props.value || props.args.default\r\n\t\t\t};\r\n\t\t\tthis.isObjectIdMode = this.isObjectIdMode.bind(this);\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.state.value || \"is required\";\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidationHelper(this).run();\r\n\t\t}\r\n\t\tonValueChanged(value) {\r\n\t\t\tif (this._mounted) {\r\n\t\t\t\tlet obid = this.isObjectIdMode(),\r\n\t\t\t\t\tupdateValue =\r\n\t\t\t\t\t\t(obid &&\r\n\t\t\t\t\t\t\tvalue &&\r\n\t\t\t\t\t\t\ttypeof value == \"object\" &&\r\n\t\t\t\t\t\t\tvalue.$objectID) ||\r\n\t\t\t\t\t\tvalue;\r\n\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t[this.props.name]:\r\n\t\t\t\t\t\t(obid &&\r\n\t\t\t\t\t\ttypeof value !== \"object\" && {\r\n\t\t\t\t\t\t\t$objectID: value\r\n\t\t\t\t\t\t}) ||\r\n\t\t\t\t\t\tvalue\r\n\t\t\t\t});\r\n\t\t\t\tif (this.state.value !== updateValue) {\r\n\t\t\t\t\tconsole.log(\"onValueChanged value:\" + updateValue);\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tvalue: updateValue\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfetchItems(source, args, component_uid) {\r\n\t\t\tif (this._mounted)\r\n\t\t\t\tthis.props.fetch(\r\n\t\t\t\t\tsource,\r\n\t\t\t\t\tJSON.parse(\r\n\t\t\t\t\t\targs || this.props.args.config.customArgs || \"{}\"\r\n\t\t\t\t\t),\r\n\t\t\t\t\tcomponent_uid || this.props.component_uid || \"\"\r\n\t\t\t\t);\r\n\t\t}\r\n\t\tisValidValue(items = this.props.items, value = this.props.value) {\r\n\t\t\treturn (\r\n\t\t\t\titems &&\r\n\t\t\t\titems.length &&\r\n\t\t\t\titems.filter(x => x._id == value).length\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\tnext.args.config.value !== this.props.args.config.value ||\r\n\t\t\t\t(next.args.config.customArgs !==\r\n\t\t\t\t\tthis.props.args.config.customArgs &&\r\n\t\t\t\t\t!this.props.busy) ||\r\n\t\t\t\tnext.component_uid !== this.props.component_uid ||\r\n\t\t\t\t(next.args.config.value &&\r\n\t\t\t\t\ttypeof next.items == \"undefined\" &&\r\n\t\t\t\t\t!next.busy)\r\n\t\t\t) {\r\n\t\t\t\treturn this.fetchItems(\r\n\t\t\t\t\tnext.args.config.value,\r\n\t\t\t\t\tnext.args.config.customArgs,\r\n\t\t\t\t\tnext.component_uid\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif (next.items && next.items.length == 1) {\r\n\t\t\t\treturn this.selectFirstItem(next.items[0]._id);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t(next.items &&\r\n\t\t\t\t\tnext.value &&\r\n\t\t\t\t\t!this.isValidValue(next.items, next.value)) ||\r\n\t\t\t\t!next.items\r\n\t\t\t) {\r\n\t\t\t\treturn this.onValueChanged(null);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t(next.items &&\r\n\t\t\t\t\tnext.value &&\r\n\t\t\t\t\tthis.isValidValue(next.items, next.value)) ||\r\n\t\t\t\t(this.props.items &&\r\n\t\t\t\t\tthis.isValidValue(this.props.items, next.value))\r\n\t\t\t) {\r\n\t\t\t\treturn this.onValueChanged(next.value);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tselectFirstItem(item) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.onValueChanged(item);\r\n\t\t\t}, 0);\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\tthis._mounted = false;\r\n\t\t}\r\n\t\tisObjectIdMode() {\r\n\t\t\treturn this.props.args && this.props.args.mode === \"ObjectId\";\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tthis._mounted = true;\r\n\t\t\tif (!this.props.items) {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t\"fetching items in componentDidMount for current:\" +\r\n\t\t\t\t\t\tthis.props.name\r\n\t\t\t\t);\r\n\t\t\t\tthis.fetchItems(this.props.args.config.value);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.props.items && this.props.items.length == 1) {\r\n\t\t\t\treturn this.selectFirstItem(this.props.items[0]._id);\r\n\t\t\t}\r\n\t\t\tif (this.isObjectIdMode() && this.props.value)\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tthis.onValueChanged(this.props.value);\r\n\t\t\t\t});\r\n\t\t}\r\n\t\tisEmptyOrNull(v) {\r\n\t\t\treturn !v || !v.length;\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\r\n\t\t\tif (this.isEmptyOrNull(this.props.items)) {\r\n\t\t\t\t//console.log(\"items is null or undefined\");\r\n\t\t\t\t//console.log(this.props);\r\n\t\t\t\treturn <ProgressIndicator />;\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<Layout\r\n\t\t\t\t\tvalue={this.props.label}\r\n\t\t\t\t\tinner={\r\n\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t!!this.props.args.disabled ||\r\n\t\t\t\t\t\t\t\t(this.props.items &&\r\n\t\t\t\t\t\t\t\t\tthis.props.items.length == 1)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t\t\t\tlabel={this.props.label}\r\n\t\t\t\t\t\t\titems={this.props.items}\r\n\t\t\t\t\t\t\tdisplayProperty=\"displayLabel\"\r\n\t\t\t\t\t\t\tkeyProperty=\"_id\"\r\n\t\t\t\t\t\t\tvalue={this.state.value}\r\n\t\t\t\t\t\t\tvalueChanged={this.onValueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoSelect);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport ValidationHelper, { VALIDATOR_TYPES } from \"./utils/validator\";\r\nexport default (Layout, Picker, ProgressBar, Container) => {\r\n\t//map elements in DynamoView props to elements in store.\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Picker, \"Picker\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tgetItems: (id, args, key) =>\r\n\t\t\t\tdispatch(runDynamoProcessor(id, args, key, { returnsUI: true }))\r\n\t\t};\r\n\t};\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\treturn {\r\n\t\t\tbusy: state.dynamo[`${ownProps.component_uid}-busy`],\r\n\t\t\titems: state.dynamo[ownProps.component_uid] || ownProps.args.items\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoSelectSet extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.onPickerValueChanged = this.onPickerValueChanged.bind(this);\r\n\t\t\tthis.onContainerValueChanged = this.onContainerValueChanged.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.getPickerValue = this.getPickerValue.bind(this);\r\n\t\t\tthis.getPickerItemsById = this.getPickerItemsById.bind(this);\r\n\t\t\tlet value =\r\n\t\t\t\tprops.value && typeof props.value == \"object\"\r\n\t\t\t\t\t? props.value.$objectID\r\n\t\t\t\t\t: props.value || props.args.default;\r\n\t\t\tthis.state = {\r\n\t\t\t\tpickerValue: value,\r\n\t\t\t\titems: this.getPickerItemsById(value),\r\n\t\t\t\tcontainerValidator: {}\r\n\t\t\t};\r\n\t\t\tthis.selectFirstItem = this.selectFirstItem.bind(this);\r\n\t\t\tthis.respondToPickerValueChanged = this.respondToPickerValueChanged.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.oneOption = this.oneOption.bind(this);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.getValueBasedOnMode = this.getValueBasedOnMode.bind(this);\r\n\t\t\tthis.isObjectIdMode = this.isObjectIdMode.bind(this);\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.state.pickerValue || \"is required\";\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn Promise.all([\r\n\t\t\t\tnew ValidationHelper(this).run(),\r\n\t\t\t\tthis.state.containerValidator.validate()\r\n\t\t\t]);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\t(next.value && next.value !== this.state.pickerValue) ||\r\n\t\t\t\t(next.items &&\r\n\t\t\t\t\tnext.items.length &&\r\n\t\t\t\t\t(!this.props.items || !this.props.items.length)) ||\r\n\t\t\t\tnext.component_uid !== this.props.component_uid\r\n\t\t\t) {\r\n\t\t\t\tthis.respondToPickerValueChanged(next.value, next.items);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.args.processor !== this.props.args.processor ||\r\n\t\t\t\t(next.component_uid !== this.props.component_uid &&\r\n\t\t\t\t\tnext.args.processor)\r\n\t\t\t)\r\n\t\t\t\tthis.fetchItems(\r\n\t\t\t\t\tnext.args.processor,\r\n\t\t\t\t\tnext.args.processorArgs,\r\n\t\t\t\t\tnext.component_uid\r\n\t\t\t\t);\r\n\r\n\t\t\tif (next.items && next.items.length == 1) {\r\n\t\t\t\tthis.selectFirstItem(next.items);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfetchItems(source, args, component_uid) {\r\n\t\t\tlet _args = this._onContainerValueChanged.call(\r\n\t\t\t\tthis,\r\n\t\t\t\tthis._currentValue\r\n\t\t\t);\r\n\t\t\t_args.shift();\r\n\t\t\tthis.props.getItems(\r\n\t\t\t\tsource,\r\n\t\t\t\tObject.assign(\r\n\t\t\t\t\tJSON.parse(args || this.props.args.processorArgs || \"{}\"),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_args\r\n\t\t\t\t\t}\r\n\t\t\t\t),\r\n\t\t\t\tcomponent_uid || this.props.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\tthis._mounted = false;\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tthis._mounted = true;\r\n\t\t\tif (this.props.args.processor) {\r\n\t\t\t\tthis.fetchItems(this.props.args.processor);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.props.items && this.props.items.length == 1) {\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tthis.selectFirstItem();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.isObjectIdMode() &&\r\n\t\t\t\tthis.props.value &&\r\n\t\t\t\ttypeof this.props.value !== \"object\"\r\n\t\t\t) {\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t\t[this.props.name]: this.getValueBasedOnMode(\r\n\t\t\t\t\t\t\tthis.props.value\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tisObjectIdMode() {\r\n\t\t\treturn this.props.args && this.props.args.mode === \"ObjectId\";\r\n\t\t}\r\n\t\toneOption() {\r\n\t\t\treturn this.props.items && this.props.items.length == 1;\r\n\t\t}\r\n\t\tselectFirstItem(items = this.props.items) {\r\n\t\t\tthis.onPickerValueChanged(items[0].id, items);\r\n\t\t}\r\n\t\tgetPickerValue(value = this.state.pickerValue) {\r\n\t\t\treturn {\r\n\t\t\t\t[this.props.name]: this.getValueBasedOnMode(value)\r\n\t\t\t};\r\n\t\t}\r\n\t\tgetPickerItemsById(v, items = this.props.items) {\r\n\t\t\tif (v && items && items.length) {\r\n\t\t\t\tlet r = items.filter(x => x.id == v);\r\n\t\t\t\treturn (r.length && r[0].elements) || [];\r\n\t\t\t}\r\n\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tonContainerValueChanged(value, pickerValue) {\r\n\t\t\tthis.props.valueChanged.apply(\r\n\t\t\t\tthis,\r\n\t\t\t\tthis._onContainerValueChanged.call(this, value, pickerValue)\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t_onContainerValueChanged(value, pickerValue) {\r\n\t\t\tlet superCancel =\r\n\t\t\t\tthis._currentValue &&\r\n\t\t\t\tObject.keys(this._currentValue).reduce((sum, x) => {\r\n\t\t\t\t\treturn (sum[x] = undefined), sum;\r\n\t\t\t\t}, {});\r\n\t\t\tthis._currentValue = value;\r\n\t\t\tpickerValue = pickerValue || this.getPickerValue();\r\n\t\t\tif (this.props.args.path) {\r\n\t\t\t\tlet _p = [pickerValue];\r\n\t\t\t\tif (superCancel) _p.push(superCancel);\r\n\t\t\t\tif (value) _p.push(value);\r\n\t\t\t\treturn _p;\r\n\t\t\t}\r\n\t\t\t//path is not defined so unpack the properties and send.\r\n\t\t\tlet result = [\r\n\t\t\t\tpickerValue,\r\n\t\t\t\t...Object.keys((value && value._no_path) || {}).map(x => {\r\n\t\t\t\t\treturn { [x]: value._no_path[x] };\r\n\t\t\t\t})\r\n\t\t\t];\r\n\r\n\t\t\tif (superCancel) {\r\n\t\t\t\tresult.splice(1, 0, superCancel);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tgetValueBasedOnMode(v) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.props.args &&\r\n\t\t\t\tthis.props.args.mode &&\r\n\t\t\t\ttypeof v !== \"object\" &&\r\n\t\t\t\tthis.props.args.mode == \"ObjectId\" && { $objectID: v }) ||\r\n\t\t\t\tv\r\n\t\t\t);\r\n\t\t}\r\n\t\trespondToPickerValueChanged(v, items = this.props.items) {\r\n\t\t\tlet _items = this.getPickerItemsById(v, items),\r\n\t\t\t\tpickerValue = null;\r\n\t\t\tif (items && items.length && items.filter(x => x.id == v).length) {\r\n\t\t\t\t//set the picker value.\r\n\t\t\t\tthis.onContainerValueChanged(null, this.getPickerValue(v));\r\n\t\t\t\tpickerValue = v;\r\n\t\t\t}\r\n\t\t\tif (this._mounted) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpickerValue,\r\n\t\t\t\t\titems: _items\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tonPickerValueChanged(v, items = this.props.items) {\r\n\t\t\tthis.respondToPickerValueChanged(\r\n\t\t\t\tv,\r\n\t\t\t\t(Array.prototype.isPrototypeOf(items) && items) || undefined\r\n\t\t\t);\r\n\t\t}\r\n\t\tisEmptyOrNull(v) {\r\n\t\t\treturn !v || !v.length;\r\n\t\t}\r\n\t\tstatic noPath() {\r\n\t\t\treturn \"_no_path\";\r\n\t\t}\r\n\t\trender() {\r\n\t\t\t/*jshint ignore:start*/\r\n\t\t\tif (this.props.busy) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\r\n\t\t\tlet initialElementsData = this.props.args.path\r\n\t\t\t\t? this.props.extra ? this.props.extra[this.props.args.path] : {}\r\n\t\t\t\t: this.props.extra;\r\n\t\t\treturn (\r\n\t\t\t\t<Layout\r\n\t\t\t\t\tvalue={this.props.label}\r\n\t\t\t\t\tinner={\r\n\t\t\t\t\t\t<Picker\r\n\t\t\t\t\t\t\tlabel={this.props.label}\r\n\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t!!this.props.args.disabled || this.oneOption()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\titems={this.props.items}\r\n\t\t\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t\t\t\tdisplayProperty=\"displayLabel\"\r\n\t\t\t\t\t\t\tkeyProperty=\"id\"\r\n\t\t\t\t\t\t\tvalue={this.state.pickerValue}\r\n\t\t\t\t\t\t\tvalueChanged={this.onPickerValueChanged}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t\textraElements={\r\n\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\tthis.props.args.path || DynamoSelectSet.noPath()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvalue={initialElementsData}\r\n\t\t\t\t\t\t\tvalueChanged={this.onContainerValueChanged}\r\n\t\t\t\t\t\t\telements={this.state.items}\r\n\t\t\t\t\t\t\tvalidator={this.state.containerValidator}\r\n\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t\t/*jshint ignore:end*/\r\n\t\t}\r\n\t}\r\n\r\n\tDynamoSelectSet.notifyExtra = true;\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoSelectSet);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport ValidatorHelper from \"./utils/validator\";\r\nimport invariants from \"./utils/invariants\";\r\nimport _ from \"lodash\";\r\nimport { runDynamoProcessor, openConfirmation } from \"./actions\";\r\n\r\nexport default (\r\n\tLayout,\r\n\tButton,\r\n\tList,\r\n\tModal,\r\n\tErrorText,\r\n\tProgressBar,\r\n\tContainer\r\n) => {\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Button, \"Button\");\r\n\tinvariants.validComponent(List, \"List\");\r\n\tinvariants.validComponent(Modal, \"Modal\");\r\n\tinvariants.validComponent(ErrorText, \"ErrorText\");\r\n\tinvariants.validComponent(Container, \"Container\");\r\n\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\treturn {\r\n\t\t\tconfirmation:\r\n\t\t\t\tstate.app &&\r\n\t\t\t\tstate.app.confirmationResult &&\r\n\t\t\t\tstate.app.confirmationResult[ownProps.component_uid],\r\n\t\t\ttemplateCache: state.dynamo.templateCache,\r\n\t\t\tdataTemplate: state.dynamo[ownProps.component_uid],\r\n\t\t\tbusy: state.dynamo[`${ownProps.component_uid}-busy`]\r\n\t\t};\r\n\t};\r\n\tconst equivalent = function(arr, arr2) {\r\n\t\tif (\r\n\t\t\t(!arr && !arr2) ||\r\n\t\t\t(arr && arr.length == 0 && arr2 && arr2.length == 0)\r\n\t\t)\r\n\t\t\treturn true;\r\n\r\n\t\tif ((arr && !arr2) || (arr2 && !arr) || arr.length !== arr2.length)\r\n\t\t\treturn false;\r\n\r\n\t\treturn _.isEqualWith(arr, arr2, (objValue, otherValue) => {\r\n\t\t\tif (objValue === arr || otherValue === arr2) return;\r\n\t\t\tif (typeof otherValue == \"string\") {\r\n\t\t\t\treturn !!_.findKey(objValue, function(v) {\r\n\t\t\t\t\treturn v == otherValue;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tlet r = _.isMatch(objValue, otherValue);\r\n\t\t\treturn r;\r\n\t\t});\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tgetListItemDataTemplate: (id, args, key) =>\r\n\t\t\t\tdispatch(runDynamoProcessor(id, args, key)),\r\n\t\t\topenConfirmation: (id, message, params) =>\r\n\t\t\t\tdispatch(openConfirmation(id, message, params))\r\n\t\t};\r\n\t};\r\n\r\n\tclass DynamoList extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalidator: {},\r\n\t\t\t\titems:\r\n\t\t\t\t\tthis.props.value ||\r\n\t\t\t\t\t(this.props.args && this.props.args.default) ||\r\n\t\t\t\t\t[],\r\n\t\t\t\tmodalVisible: false\r\n\t\t\t};\r\n\t\t\tthis.showModal = this.showModal.bind(this);\r\n\t\t\tthis.closeModal = this.closeModal.bind(this);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t\tthis.getItemTemplate = this.getItemTemplate.bind(this);\r\n\t\t\tthis.edit = this.edit.bind(this);\r\n\t\t\tthis.runValidators = this.runValidators.bind(this);\r\n\t\t\tthis.isDisabled = this.isDisabled.bind(this);\r\n\t\t\tthis.getListItemDataTemplate = this.getListItemDataTemplate.bind(\r\n\t\t\t\tthis\r\n\t\t\t);\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.remove = this.remove.bind(this);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\tnext.confirmation !== this.props.confirmation &&\r\n\t\t\t\tnext.confirmation &&\r\n\t\t\t\tnext.confirmation.params &&\r\n\t\t\t\ttypeof next.confirmation.params.index !== \"undefined\" &&\r\n\t\t\t\tthis.state.items.length\r\n\t\t\t) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tthis.state.items.splice(next.confirmation.params.index, 1),\r\n\t\t\t\t\tthis.props.valueChanged({ [this.props.name]: items })\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.props.component_uid !== next.component_uid) {\r\n\t\t\t\t//setTimeout(() => {\r\n\t\t\t\tif (this._mounted) {\r\n\t\t\t\t\tlet items =\r\n\t\t\t\t\t\tnext.dataTemplate ||\r\n\t\t\t\t\t\tnext.value ||\r\n\t\t\t\t\t\t(next.args && next.args.default) ||\r\n\t\t\t\t\t\t[];\r\n\t\t\t\t\titems = items.slice();\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tnext.args.listItemDataTemplateProcessor &&\r\n\t\t\t\t\t\titems.length\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.getListItemDataTemplate(items, next);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tform: null,\r\n\t\t\t\t\t\titemTemplate: null,\r\n\t\t\t\t\t\titems,\r\n\t\t\t\t\t\tmodalVisible: false\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.props.valueChanged({ [this.props.name]: items });\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.dataTemplate &&\r\n\t\t\t\t(!equivalent(next.dataTemplate, this.props.dataTemplate) ||\r\n\t\t\t\t\t!equivalent(next.dataTemplate, this.state.items))\r\n\t\t\t) {\r\n\t\t\t\tif (this._mounted) {\r\n\t\t\t\t\tif (Array.prototype.isPrototypeOf(next.dataTemplate))\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\titems: next.dataTemplate.slice()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.state.items.splice(\r\n\t\t\t\t\t\t\tthis.state.items.length - 1,\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tnext.dataTemplate\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\tthis._mounted = false;\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tthis._mounted = true;\r\n\t\t\t//if its template is a reference then store it.\r\n\t\t\tif (this.isTemplateRef()) {\r\n\t\t\t\tthis.props.templateCache[\r\n\t\t\t\t\tthis.props.args.itemTemplate.dynamo_ref\r\n\t\t\t\t] = Array.prototype.isPrototypeOf(this.props.args.itemTemplate)\r\n\t\t\t\t\t? this.props.args.itemTemplate\r\n\t\t\t\t\t: this.props.args.itemTemplate.template;\r\n\t\t\t}\r\n\t\t\t//if theres a default then update everyone.\r\n\t\t\tif (this.state.items && this.state.items.length) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t\t[this.props.name]: this.state.items\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t\tlet equal = equivalent(this.props.dataTemplate, this.state.items);\r\n\t\t\t//if theres a data template processor then run it.\r\n\t\t\tif (\r\n\t\t\t\tthis.props.args.listItemDataTemplateProcessor &&\r\n\t\t\t\tthis.state.items &&\r\n\t\t\t\tthis.state.items.length &&\r\n\t\t\t\t!equal\r\n\t\t\t) {\r\n\t\t\t\tthis.getListItemDataTemplate(this.state.items);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.props.dataTemplate &&\r\n\t\t\t\tthis.props.dataTemplate.length &&\r\n\t\t\t\tequal\r\n\t\t\t) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\titems: this.props.dataTemplate.slice()\r\n\t\t\t\t\t});\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tgetListItemDataTemplate(i, props = this.props) {\r\n\t\t\tthis.props.getListItemDataTemplate(\r\n\t\t\t\tprops.args.listItemDataTemplateProcessor,\r\n\t\t\t\ti,\r\n\t\t\t\tprops.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\t\tisTemplateRef() {\r\n\t\t\treturn (\r\n\t\t\t\t(this.props.args.itemTemplate &&\r\n\t\t\t\t\t!Array.prototype.isPrototypeOf(\r\n\t\t\t\t\t\tthis.props.args.itemTemplate\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\tthis.props.args.itemTemplate.dynamo_ref) ||\r\n\t\t\t\t(this.props.args.behavior &&\r\n\t\t\t\t\tthis.props.args.behavior.dynamo_ref &&\r\n\t\t\t\t\tthis.props.args.itemTemplate)\r\n\t\t\t);\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidatorHelper(this).run();\r\n\t\t}\r\n\t\tisDisabled() {\r\n\t\t\treturn this.props.args && this.props.args.disabled;\r\n\t\t}\r\n\t\tshowModal() {\r\n\t\t\tif (!this.isDisabled()) this.setState({ modalVisible: true });\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.items && this.state.items.length) ||\r\n\t\t\t\t\"Requires atleast one item to have been added to the list\"\r\n\t\t\t);\r\n\t\t}\r\n\t\tisLessThanMaxLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.items &&\r\n\t\t\t\t\tthis.state.items.length &&\r\n\t\t\t\t\tthis.state.items.length <= element.args.max) ||\r\n\t\t\t\t(element.error ||\r\n\t\t\t\t\t\"The maximum number of items is \" + element.args.max)\r\n\t\t\t);\r\n\t\t}\r\n\t\tisGreaterThanMinLength(element) {\r\n\t\t\treturn (\r\n\t\t\t\t(this.state.items &&\r\n\t\t\t\t\tthis.state.items.length &&\r\n\t\t\t\t\tthis.state.items.length >= element.args.min) ||\r\n\t\t\t\t(element.error ||\r\n\t\t\t\t\t\"The minimum number of items is \" + element.args.min)\r\n\t\t\t);\r\n\t\t}\r\n\t\tcloseModal(result) {\r\n\t\t\t//he/she clicked ok\r\n\t\t\tif (result) {\r\n\t\t\t\tthis.state.validator.validate().then(() => {\r\n\t\t\t\t\tlet items = this.state.items || [];\r\n\r\n\t\t\t\t\tif (!this.state.edit) items.push(this.state.form);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\titems.splice(\r\n\t\t\t\t\t\t\titems.indexOf(this.state.edit),\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tthis.state.form\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\tthis.props.valueChanged({ [this.props.name]: items });\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\titems: Object.assign([], items),\r\n\t\t\t\t\t\tmodalVisible: false,\r\n\t\t\t\t\t\tedit: null,\r\n\t\t\t\t\t\tform: null\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (this.props.args.listItemDataTemplateProcessor)\r\n\t\t\t\t\t\tthis.getListItemDataTemplate(items);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//canceled the modal box.\r\n\r\n\t\t\tthis.setState({ modalVisible: false, form: null, edit: null });\r\n\t\t}\r\n\t\tvalueChanged(v) {\r\n\t\t\tthis.state.form = v && v[DynamoList.modalName()];\r\n\t\t}\r\n\t\tclone(item) {\r\n\t\t\treturn JSON.parse(JSON.stringify(item));\r\n\t\t}\r\n\t\tremove(index) {\r\n\t\t\tthis.props.openConfirmation(\r\n\t\t\t\tthis.props.component_uid,\r\n\t\t\t\t\"Are you sure you want to remove that item ?\",\r\n\t\t\t\t{ index }\r\n\t\t\t);\r\n\t\t}\r\n\t\tedit(index) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tedit: this.state.items[index],\r\n\t\t\t\tform: this.state.items[index],\r\n\t\t\t\tmodalVisible: true\r\n\t\t\t});\r\n\t\t}\r\n\t\tstatic modalName() {\r\n\t\t\treturn \"_modal_\";\r\n\t\t}\r\n\t\tgetItemTemplate() {\r\n\t\t\tif (this.state.itemTemplate) return this.state.itemTemplate;\r\n\r\n\t\t\tif (!this.props.args.itemTemplate) {\r\n\t\t\t\tif (\r\n\t\t\t\t\t(!this.props.args.behavior ||\r\n\t\t\t\t\t\t!this.props.args.behavior.template_ref) &&\r\n\t\t\t\t\t!this.props.args.disabled\r\n\t\t\t\t)\r\n\t\t\t\t\tthrow new Error(\"Empty List view item template\");\r\n\r\n\t\t\t\tthis.props.args.itemTemplate =\r\n\t\t\t\t\tthis.props.templateCache[\r\n\t\t\t\t\t\tthis.props.args.behavior &&\r\n\t\t\t\t\t\t\tthis.props.args.behavior.template_ref\r\n\t\t\t\t\t] || [];\r\n\t\t\t}\r\n\r\n\t\t\tlet itemTemplate = this.clone(\r\n\t\t\t\tthis.isTemplateRef()\r\n\t\t\t\t\t? this.props.args.itemTemplate.template\r\n\t\t\t\t\t: this.props.args.itemTemplate\r\n\t\t\t);\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.props.args.behavior &&\r\n\t\t\t\tthis.props.args.behavior.extension &&\r\n\t\t\t\tthis.props.args.behavior.extension.length\r\n\t\t\t)\r\n\t\t\t\tthis.props.args.behavior.extension.forEach((element, index) => {\r\n\t\t\t\t\telement.key = index;\r\n\t\t\t\t\titemTemplate.push(this.clone(element));\r\n\t\t\t\t});\r\n\t\t\t//this happens asynchronously;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this._mounted)\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\titemTemplate: itemTemplate\r\n\t\t\t\t\t});\r\n\t\t\t}, 0);\r\n\r\n\t\t\t//this.state.itemTemplate = itemTemplate;\r\n\t\t\treturn itemTemplate;\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\tif (this.props.busy) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\t\t\tlet template = this.getItemTemplate(),\r\n\t\t\t\tdisabled = this.isDisabled();\r\n\r\n\t\t\treturn (\r\n\t\t\t\t/*jshint ignore:start */\r\n\t\t\t\t<Layout value={this.props.label}>\r\n\t\t\t\t\t<Button disabled={disabled} click={this.showModal} />\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\titems={this.state.items}\r\n\t\t\t\t\t\trowClicked={this.edit}\r\n\t\t\t\t\t\trowRemoved={this.remove}\r\n\t\t\t\t\t\trowTemplate={\r\n\t\t\t\t\t\t\tthis.props.args.rowTemplate &&\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.rowTemplate)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ErrorText value={this.state.errors} />\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\t\telements={template}\r\n\t\t\t\t\t\t\t\tvalue={this.state.edit}\r\n\t\t\t\t\t\t\t\tname={DynamoList.modalName()}\r\n\t\t\t\t\t\t\t\tvalidator={this.state.validator}\r\n\t\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvisibility={this.state.modalVisible}\r\n\t\t\t\t\t\tdone={this.closeModal}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t\t/*jshint ignore:end */\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoList);\r\n};\r\n","export default props => {\r\n\tsetTimeout(\r\n\t\t() =>\r\n\t\t\t(props.value || (props.args && props.args.default)) &&\r\n\t\t\tprops.valueChanged({\r\n\t\t\t\t[props.name]: props.value || (props.args && props.args.default)\r\n\t\t\t}),\r\n\t\t0\r\n\t);\r\n\treturn null;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { fetchDynamoProcess } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Link, NavigationActions) => {\r\n\tif (invariants.validComponent(Link, \"Link\") && !NavigationActions)\r\n\t\tthrow new Error(\"NavigationActions cannot be null (dynamo_nav)\");\r\n\r\n\tconst mapDispatchToState = dispatch => {\r\n\t\treturn {\r\n\t\t\tdispatch\r\n\t\t};\r\n\t};\r\n\r\n\tconst mapStateToProps = (_, initialProps) => state => {\r\n\t\treturn {\r\n\t\t\tcontext: state && state.dynamo && state.dynamo.navigationContext\r\n\t\t};\r\n\t};\r\n\r\n\t//{text:\"link text\",type:\"DYNAMO or CLIENT\",config:{value:\"\"}}\r\n\tclass DynamoNav extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.go = this.go.bind(this);\r\n\t\t\tthis.state = { link: this.props.value };\r\n\t\t}\r\n\t\tstatic getParams(firstItemIsLink, link) {\r\n\t\t\tlet key_value = link.split(\"|\");\r\n\t\t\tif (firstItemIsLink) link = key_value.shift();\r\n\t\t\tlet params = key_value.reduce((sum, x) => {\r\n\t\t\t\t\tlet sp = x.split(\"=\");\r\n\t\t\t\t\treturn (sum[sp[0]] = sp[1]), sum;\r\n\t\t\t\t}, {}),\r\n\t\t\t\tresult = { params };\r\n\t\t\tif (firstItemIsLink || !key_value.length) result.link = link;\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tgo() {\r\n\t\t\tlet params = null;\r\n\t\t\tlet link =\r\n\t\t\t\tthis.state.link ||\r\n\t\t\t\t(this.props.args.config && this.props.args.config.value);\r\n\t\t\tif (link) {\r\n\t\t\t\tlet linkAndParams = DynamoNav.getParams(true, link);\r\n\t\t\t\tif (this.props.args.params) {\r\n\t\t\t\t\tlet paramsOnly = DynamoNav.getParams(\r\n\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\tthis.props.args.params\r\n\t\t\t\t\t);\r\n\t\t\t\t\tObject.assign(linkAndParams.params, paramsOnly.params);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlink = linkAndParams.link;\r\n\t\t\t\tparams = linkAndParams.params;\r\n\t\t\t\tswitch (this.props.args.type) {\r\n\t\t\t\t\tcase DynamoNav.NAV_TYPE.CLIENT:\r\n\t\t\t\t\t\tthis.props.dispatch(\r\n\t\t\t\t\t\t\tNavigationActions.navigate({\r\n\t\t\t\t\t\t\t\tkey: link,\r\n\t\t\t\t\t\t\t\tparams\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase DynamoNav.NAV_TYPE.DYNAMO:\r\n\t\t\t\t\t\tconst setParamsAction = NavigationActions.setParams(\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tparams: { id: link, fetchParams: params },\r\n\t\t\t\t\t\t\t\tkey: \"Dynamo\"\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tthis.props.context,\r\n\t\t\t\t\t\t\tthis.props.navigation\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.props.dispatch(setParamsAction);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\trender() {\r\n\t\t\treturn (\r\n\t\t\t\t/*jshint ignore:start */\r\n\t\t\t\t<Link\r\n\t\t\t\t\ttext={this.props.args.text}\r\n\t\t\t\t\tdisabled={this.props.args.disabled}\r\n\t\t\t\t\tgo={this.go}\r\n\t\t\t\t/>\r\n\t\t\t\t/*jshint ignore:end */\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\tDynamoNav.NAV_TYPE = { CLIENT: \"CLIENT\", DYNAMO: \"DYNAMO\" };\r\n\treturn connect(mapStateToProps, mapDispatchToState)(DynamoNav);\r\n};\r\n","import React from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default Image => {\r\n\tinvariants.validComponent(Image, \"Image\");\r\n\treturn props => {\r\n\t\tlet { value, args, ...rest } = props;\r\n\t\tif (value && props.args.type == \"URL\") {\r\n\t\t\tlet data = props.args.config.data.replace(\r\n\t\t\t\t\tnew RegExp(`{${props.name}}`, \"g\"),\r\n\t\t\t\t\tvalue\r\n\t\t\t\t),\r\n\t\t\t\targs = Object.assign({}, props.args);\r\n\t\t\targs.config = { data };\r\n\t\t\treturn <Image args={args} {...rest} />;\r\n\t\t}\r\n\t\treturn <Image {...props} />;\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n\trunDynamoProcessor,\r\n\tgetMoreForGrid,\r\n\tfilterGrid,\r\n\tgetSingleItemForGrid,\r\n\tgetFilterTemplate,\r\n\tgetItemTemplate,\r\n\tshowMessage\r\n} from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport const GRID_MODES = {\r\n\tCRUD: \"CRUD\",\r\n\tEDITONLY: \"EDITONLY\"\r\n};\r\nexport const ITEM_MODES = {\r\n\tNEW: \"NEW\",\r\n\tEDIT: \"EDIT\"\r\n};\r\n\r\nexport default (\r\n\tLayout,\r\n\tList,\r\n\tItemView,\r\n\tHeader,\r\n\tProgressBar,\r\n\tCommandsView,\r\n\tNavigationActions,\r\n\tCommandResultView,\r\n\tContainer\r\n) => {\r\n\tif (\r\n\t\tinvariants.validComponent(Layout, \"Layout\") &&\r\n\t\tinvariants.validComponent(Header, \"Header\") &&\r\n\t\tinvariants.validComponent(List, \"List\") &&\r\n\t\tinvariants.validComponent(ItemView, \"ItemView\") &&\r\n\t\tinvariants.validComponent(ProgressBar, \"ProgressBar\") &&\r\n\t\tinvariants.validComponent(CommandsView, \"CommandsView\") &&\r\n\t\tinvariants.validComponent(Container, \"Container\") &&\r\n\t\tinvariants.validComponent(CommandResultView, \"CommandResultView\") &&\r\n\t\t!NavigationActions\r\n\t)\r\n\t\tthrow new Error(\"NavigationActions cannot be null (dynamo_grid)\");\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\trun: (id, args, key) =>\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\trunDynamoProcessor(id, args, key, { disableCache: true })\r\n\t\t\t\t),\r\n\t\t\tmore: (id, args, key) => dispatch(getMoreForGrid(id, args, key)),\r\n\t\t\tgo: value =>\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\tNavigationActions.setParams({\r\n\t\t\t\t\t\tparams: { id: value },\r\n\t\t\t\t\t\tkey: \"Dynamo\"\r\n\t\t\t\t\t})\r\n\t\t\t\t),\r\n\t\t\tgetSingleItem: (id, args, key) =>\r\n\t\t\t\tdispatch(getSingleItemForGrid(id, args, key)),\r\n\t\t\tgetItemTemplate: (id, args, key) =>\r\n\t\t\t\tdispatch(getItemTemplate(id, args, key)),\r\n\t\t\tgetFilterTemplate: (id, args, key) =>\r\n\t\t\t\tdispatch(getFilterTemplate(id, args, key)),\r\n\t\t\tfilterGrid: (id, args, key) => dispatch(filterGrid(id, args, key)),\r\n\t\t\tshowMessage: message => dispatch(showMessage(message))\r\n\t\t};\r\n\t};\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tvar result = state.dynamo[ownProps.component_uid];\r\n\t\treturn {\r\n\t\t\titems: result && result.data ? result.data.items : null,\r\n\t\t\ttotal: result && result.data ? result.data.total : 0,\r\n\t\t\tbusy: result && !!result.fetchingGrid,\r\n\t\t\tfilterTemplate:\r\n\t\t\t\tresult &&\r\n\t\t\t\t(result.filterTemplate ||\r\n\t\t\t\t\t(ownProps.args && ownProps.args.filter) ||\r\n\t\t\t\t\tnull),\r\n\t\t\tfilter: result && result.filter,\r\n\t\t\tsingleItem: result && result.singleItem,\r\n\t\t\titemTemplate: result && result.itemTemplate,\r\n\t\t\tfetchingSingleItem: result && result.fetchingSingleItem,\r\n\t\t\tfetchingFilterTemplate: result && result.gettingFilterTemplate,\r\n\t\t\tfetchingItemTemplate: result && result.gettingTemplate,\r\n\t\t\tcommandProcessed:\r\n\t\t\t\tstate.dynamo[\r\n\t\t\t\t\townProps.component_uid + DynamoGrid.commandResultViewName()\r\n\t\t\t\t],\r\n\t\t\tcommandProcessing:\r\n\t\t\t\tstate.dynamo[\r\n\t\t\t\t\townProps.component_uid +\r\n\t\t\t\t\t\tDynamoGrid.commandResultViewName() +\r\n\t\t\t\t\t\t\"-busy\"\r\n\t\t\t\t],\r\n\t\t\tprocessed:\r\n\t\t\t\tstate.dynamo[ownProps.component_uid + DynamoGrid.itemViewName()]\r\n\t\t};\r\n\t};\r\n\tclass DynamoGrid extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = {\r\n\t\t\t\tvalidator: {},\r\n\t\t\t\tshowItemView: false,\r\n\t\t\t\tcount: this.props.args.pageCount || 5,\r\n\t\t\t\tshowCommandResultView: false\r\n\t\t\t};\r\n\t\t\tthis.showItemView = this.showItemView.bind(this);\r\n\t\t\tthis.cancel = this.cancel.bind(this);\r\n\t\t\tthis.showItemView = this.showItemView.bind(this);\r\n\t\t\tthis.isCRUD = this.isCRUD.bind(this);\r\n\t\t\tthis.isEDITONLY = this.isEDITONLY.bind(this);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t\tthis.getItemsFromSource = this.getItemsFromSource.bind(this);\r\n\t\t\tthis.done = this.done.bind(this);\r\n\t\t\tthis._filterValidator = {};\r\n\t\t\tthis.filter = this.filter.bind(this);\r\n\t\t\tthis.filterValueChanged = this.filterValueChanged.bind(this);\r\n\t\t\tthis.more = this.more.bind(this);\r\n\t\t\tthis.finished = this.finished.bind(this);\r\n\t\t\tthis.openCommandMenu = this.openCommandMenu.bind(this);\r\n\t\t\tthis.closeCommandView = this.closeCommandView.bind(this);\r\n\t\t\tthis.execCommand = this.execCommand.bind(this);\r\n\t\t\tthis.showCommandResult = this.showCommandResult.bind(this);\r\n\t\t\tthis.closeCommandResult = this.closeCommandResult.bind(this);\r\n\t\t\tif (\r\n\t\t\t\t(this.isCRUD() || this.isEDITONLY()) &&\r\n\t\t\t\t(!this.props.args.commands ||\r\n\t\t\t\t\t!this.props.args.commands.filter(\r\n\t\t\t\t\t\tx => x.commandType == \"$EDIT\"\r\n\t\t\t\t\t).length)\r\n\t\t\t) {\r\n\t\t\t\tlet cmd = {\r\n\t\t\t\t\tcommandText: \"Edit\",\r\n\t\t\t\t\tcommand: { value: \"\" },\r\n\t\t\t\t\tcommandType: \"$EDIT\",\r\n\t\t\t\t\tcommandIcon: \"mode-edit\"\r\n\t\t\t\t};\r\n\t\t\t\tif (!this.props.args.commands) this.props.args.commands = [];\r\n\t\t\t\tthis.props.args.commands.unshift(cmd);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tif (\r\n\t\t\t\tthis.props.args.filterProcessor &&\r\n\t\t\t\t!this.props.fetchingFilterTemplate\r\n\t\t\t) {\r\n\t\t\t\tthis.props.getFilterTemplate(\r\n\t\t\t\t\tthis.props.args.filterProcessor,\r\n\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tshowCommandResult(props = this.props) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tshowCommandsView: false,\r\n\t\t\t\tshowCommandResultView: true,\r\n\t\t\t\tcommandResult: props.commandProcessed\r\n\t\t\t});\r\n\t\t}\r\n\t\tcloseCommandResult() {\r\n\t\t\tthis.setState({\r\n\t\t\t\tshowCommandResultView: false,\r\n\t\t\t\tresult: null\r\n\t\t\t});\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.processed !== this.props.processed) {\r\n\t\t\t\t//console.log(\"componentWillReceiveProps fired get items\");\r\n\t\t\t\tthis.getItemsFromSource(null, \"filterGrid\");\r\n\t\t\t}\r\n\r\n\t\t\tif (next.commandProcessed !== this.props.commandProcessed) {\r\n\t\t\t\tthis.showCommandResult(next);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.singleItem &&\r\n\t\t\t\tnext.singleItem !== this.props.singleItem &&\r\n\t\t\t\t(next.itemTemplate &&\r\n\t\t\t\t\tnext.itemTemplate !== this.props.itemTemplate)\r\n\t\t\t) {\r\n\t\t\t\treturn this.showItemView(\r\n\t\t\t\t\tITEM_MODES.EDIT,\r\n\t\t\t\t\tnext.singleItem,\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\tnext.itemTemplate\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.singleItem &&\r\n\t\t\t\tnext.singleItem !== this.props.singleItem &&\r\n\t\t\t\t!next.fetchingItemTemplate\r\n\t\t\t) {\r\n\t\t\t\treturn this.showItemView(\r\n\t\t\t\t\tITEM_MODES.EDIT,\r\n\t\t\t\t\tnext.singleItem,\r\n\t\t\t\t\ttrue\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tnext.itemTemplate &&\r\n\t\t\t\tnext.itemTemplate !== this.props.itemTemplate\r\n\t\t\t) {\r\n\t\t\t\tthis.showItemView(\r\n\t\t\t\t\tthis.state.mode,\r\n\t\t\t\t\tthis.state.existingValue || this.props.singleItem,\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\tnext.itemTemplate\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tgetItemsFromSource(\r\n\t\t\tfilter = this.props.filter,\r\n\t\t\tmethodName = \"run\",\r\n\t\t\textra\r\n\t\t) {\r\n\t\t\tthis.props[methodName](\r\n\t\t\t\tthis.props.args.source,\r\n\t\t\t\tObject.assign(\r\n\t\t\t\t\t{},\r\n\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\t{ count: this.state.count, full: true },\r\n\t\t\t\t\tfilter ? { query: filter } : {},\r\n\t\t\t\t\textra || {}\r\n\t\t\t\t),\r\n\t\t\t\tthis.props.component_uid\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tfilter() {\r\n\t\t\tthis._filterValidator.validate().then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.getItemsFromSource(this.state.filter, \"filterGrid\");\r\n\t\t\t\t},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tconsole.warn(\"a field in filter is invalid\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tstatic itemViewName() {\r\n\t\t\treturn \"_itemView_\";\r\n\t\t}\r\n\t\tstatic filterViewName() {\r\n\t\t\treturn \"_filterView_\";\r\n\t\t}\r\n\t\tstatic commandResultViewName() {\r\n\t\t\treturn \"_commandResultView_\";\r\n\t\t}\r\n\t\tvalueChanged(value) {\r\n\t\t\tthis.state.form = value ? value[DynamoGrid.itemViewName()] : null;\r\n\t\t}\r\n\t\tdone(submitted) {\r\n\t\t\tif (!submitted)\r\n\t\t\t\treturn this.setState({ showItemView: false, form: null });\r\n\r\n\t\t\tthis.state.validator.validate().then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tlet id;\r\n\t\t\t\t\tswitch (this.state.mode) {\r\n\t\t\t\t\t\tcase ITEM_MODES.NEW:\r\n\t\t\t\t\t\t\tid = this.props.args.extra.createProcessor;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase ITEM_MODES.EDIT:\r\n\t\t\t\t\t\t\tid =\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.editProcessor ||\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.createProcessor;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!id) {\r\n\t\t\t\t\t\treturn console.error(\r\n\t\t\t\t\t\t\t\"done  was called on a grid view in \" +\r\n\t\t\t\t\t\t\t\tthis.props.args.mode +\r\n\t\t\t\t\t\t\t\t\" and it does not have a processor for it. \\n\" +\r\n\t\t\t\t\t\t\t\tJSON.stringify(this.props, null, \" \")\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.props.run(\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tObject.assign(\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tentity: this.state.form\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tthis.props.component_uid + DynamoGrid.itemViewName()\r\n\t\t\t\t\t);\r\n\t\t\t\t\t//this.setState({ showItemView: false });\r\n\t\t\t\t\tthis.cancel();\r\n\t\t\t\t},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tconsole.log(\"some modal fields are invalid\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tshowItemView(mode, args, skipFetch, _itemTemplate) {\r\n\t\t\tlet template = _itemTemplate,\r\n\t\t\t\texistingValue;\r\n\t\t\tif (this.props.args.extra)\r\n\t\t\t\tswitch (mode) {\r\n\t\t\t\t\tcase ITEM_MODES.NEW:\r\n\t\t\t\t\t\ttemplate =\r\n\t\t\t\t\t\t\t_itemTemplate ||\r\n\t\t\t\t\t\t\t((this.props.args.extra.createTemplate &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate.length &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate) ||\r\n\t\t\t\t\t\t\t\tthis.props.itemTemplate ||\r\n\t\t\t\t\t\t\t\t[])\r\n\t\t\t\t\t\t\t\t.slice();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase ITEM_MODES.EDIT:\r\n\t\t\t\t\t\ttemplate =\r\n\t\t\t\t\t\t\t_itemTemplate ||\r\n\t\t\t\t\t\t\t((this.props.args.extra.editTemplate &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.editTemplate.length &&\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.editTemplate) ||\r\n\t\t\t\t\t\t\t\t(this.props.args.extra.createTemplate &&\r\n\t\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate\r\n\t\t\t\t\t\t\t\t\t\t.length &&\r\n\t\t\t\t\t\t\t\t\tthis.props.args.extra.createTemplate) ||\r\n\t\t\t\t\t\t\t\tthis.props.itemTemplate ||\r\n\t\t\t\t\t\t\t\t[])\r\n\t\t\t\t\t\t\t\t.slice();\r\n\t\t\t\t\t\texistingValue = args;\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tthis.props.args.extra.fetchSingleItemProcessor &&\r\n\t\t\t\t\t\t\t!this.props.fetchingSingleItem &&\r\n\t\t\t\t\t\t\t!skipFetch\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\ttemplate = [];\r\n\t\t\t\t\t\t\texistingValue = null;\r\n\t\t\t\t\t\t\tthis.props.getSingleItem(\r\n\t\t\t\t\t\t\t\tthis.props.args.extra.fetchSingleItemProcessor,\r\n\t\t\t\t\t\t\t\targs,\r\n\t\t\t\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t(!template || !Array.prototype.isPrototypeOf(template)) &&\r\n\t\t\t\t!this.props.args.extra.fetchTemplateProcessor\r\n\t\t\t) {\r\n\t\t\t\treturn console.error(\r\n\t\t\t\t\t\"showItemTemplate was called on a grid view in \" +\r\n\t\t\t\t\t\tthis.props.args.mode +\r\n\t\t\t\t\t\t\" and it does not have a template. \\n\" +\r\n\t\t\t\t\t\tJSON.stringify(this.props, null, \" \")\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\t(!template || !template.length) &&\r\n\t\t\t\t!this.props.fetchingItemTemplate &&\r\n\t\t\t\tthis.props.args.extra.fetchTemplateProcessor &&\r\n\t\t\t\t!skipFetch\r\n\t\t\t) {\r\n\t\t\t\tthis.props.getItemTemplate(\r\n\t\t\t\t\tthis.props.args.extra.fetchTemplateProcessor,\r\n\t\t\t\t\targs,\r\n\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tshowItemView: true,\r\n\t\t\t\tmode: mode,\r\n\t\t\t\tshowCommandsView: false,\r\n\t\t\t\titemViewElements: template,\r\n\t\t\t\texistingValue: existingValue\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tmore() {\r\n\t\t\tif (!this.finished() && !this.props.busy) {\r\n\t\t\t\t//console.log(\"more fired getItemsFromSource\");\r\n\t\t\t\tlet query = {\r\n\t\t\t\t\tcount: this.state.count\r\n\t\t\t\t};\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.props.items &&\r\n\t\t\t\t\tthis.props.items[this.props.items.length - 1]\r\n\t\t\t\t) {\r\n\t\t\t\t\tquery._id = this.props.items[\r\n\t\t\t\t\t\tthis.props.items.length - 1\r\n\t\t\t\t\t]._id;\r\n\t\t\t\t\tconsole.log(\"most recent id:\" + query._id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.getItemsFromSource(null, \"more\", query);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfinished() {\r\n\t\t\treturn (\r\n\t\t\t\tthis.props.items && this.props.total == this.props.items.length\r\n\t\t\t);\r\n\t\t}\r\n\t\tcancel() {\r\n\t\t\tthis.setState({\r\n\t\t\t\tmode: null,\r\n\t\t\t\tshowItemView: false,\r\n\t\t\t\titemViewElements: null,\r\n\t\t\t\tshowCommandsView: false,\r\n\t\t\t\texistingValue: null\r\n\t\t\t});\r\n\t\t}\r\n\t\tfilterValueChanged(value) {\r\n\t\t\tthis.state.filter = value\r\n\t\t\t\t? value[DynamoGrid.filterViewName()]\r\n\t\t\t\t: null;\r\n\t\t}\r\n\t\tcloseCommandView() {\r\n\t\t\tthis.setState({ showCommandsView: false });\r\n\t\t}\r\n\t\topenCommandMenu(item) {\r\n\t\t\tthis.setState({ item: item, showCommandsView: true });\r\n\t\t}\r\n\t\texecCommand(command, item = this.state.item) {\r\n\t\t\tswitch (command.commandType) {\r\n\t\t\t\tcase \"NAV\":\r\n\t\t\t\t\tthis.props.go(command.command.value, {\r\n\t\t\t\t\t\tfetchParams: { _id: item._id }\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"$EDIT\":\r\n\t\t\t\t\tthis.showItemView(ITEM_MODES.EDIT, item);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"PROCESSOR\":\r\n\t\t\t\t\tthis.props.run(\r\n\t\t\t\t\t\tcommand.command.value,\r\n\t\t\t\t\t\tObject.assign(\r\n\t\t\t\t\t\t\t{},\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.gridArgs || \"{}\"),\r\n\t\t\t\t\t\t\titem\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tthis.props.component_uid +\r\n\t\t\t\t\t\t\tDynamoGrid.commandResultViewName()\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tisCRUD() {\r\n\t\t\treturn this.props.args.mode == GRID_MODES.CRUD;\r\n\t\t}\r\n\t\tisEDITONLY() {\r\n\t\t\treturn this.props.args.mode == GRID_MODES.EDITONLY;\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tlet args = this.props.args,\r\n\t\t\t\theader = this.props.filterTemplate ? (\r\n\t\t\t\t\t<Header filter={() => this.filter()}>\r\n\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\telements={this.props.filterTemplate}\r\n\t\t\t\t\t\t\tvalue={this.state.filter}\r\n\t\t\t\t\t\t\tvalueChanged={this.filterValueChanged}\r\n\t\t\t\t\t\t\tname={DynamoGrid.filterViewName()}\r\n\t\t\t\t\t\t\tvalidator={this._filterValidator}\r\n\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t) : this.props.fetchingFilterTemplate ? (\r\n\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t) : null,\r\n\t\t\t\tfooter =\r\n\t\t\t\t\t!this.finished() && this.props.busy ? (\r\n\t\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t\t) : null;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Layout>\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\ttitle={this.props.label}\r\n\t\t\t\t\t\tcanAddOrEdit={this.isCRUD()}\r\n\t\t\t\t\t\theader={header}\r\n\t\t\t\t\t\tfooter={footer}\r\n\t\t\t\t\t\ttotal={this.props.total}\r\n\t\t\t\t\t\tshowItemView={this.showItemView}\r\n\t\t\t\t\t\titems={this.props.items}\r\n\t\t\t\t\t\ttemplateConfig={\r\n\t\t\t\t\t\t\tthis.props.args.templateConfig ? (\r\n\t\t\t\t\t\t\t\tJSON.parse(this.props.args.templateConfig)\r\n\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmore={this.more}\r\n\t\t\t\t\t\tcommands={this.props.args.commands}\r\n\t\t\t\t\t\texecCommand={this.execCommand}\r\n\t\t\t\t\t\topenCommandMenu={this.openCommandMenu}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ItemView\r\n\t\t\t\t\t\tvisibility={\r\n\t\t\t\t\t\t\t(this.isCRUD() || this.isEDITONLY()) &&\r\n\t\t\t\t\t\t\tthis.state.showItemView\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdone={this.done}\r\n\t\t\t\t\t\tbusy={\r\n\t\t\t\t\t\t\tthis.props.fetchingSingleItem ||\r\n\t\t\t\t\t\t\tthis.props.fetchingItemTemplate\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\t\telements={this.state.itemViewElements}\r\n\t\t\t\t\t\t\t\tvalue={this.state.existingValue}\r\n\t\t\t\t\t\t\t\tname={DynamoGrid.itemViewName()}\r\n\t\t\t\t\t\t\t\tvalidator={this.state.validator}\r\n\t\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<CommandsView\r\n\t\t\t\t\t\tvisibility={this.state.showCommandsView}\r\n\t\t\t\t\t\tclose={this.closeCommandView}\r\n\t\t\t\t\t\tcommands={this.props.args.commands}\r\n\t\t\t\t\t\texecCommand={this.execCommand}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<CommandResultView\r\n\t\t\t\t\t\tvisibility={this.state.showCommandResultView}\r\n\t\t\t\t\t\tdone={this.closeCommandResult}\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t<Container\r\n\t\t\t\t\t\t\t\telements={this.state.commandResult}\r\n\t\t\t\t\t\t\t\tname={DynamoGrid.commandResultViewName()}\r\n\t\t\t\t\t\t\t\tvalidator={{}}\r\n\t\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttitle={\"\"}\r\n\t\t\t\t\t\tbusy={this.props.commandProcessing}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoGrid);\r\n};\r\n","import React, { Component } from \"react\";\r\n\r\nexport default PlatformComponent => {\r\n\treturn class DynamoHTMLViewer extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\treturn (\r\n\t\t\t\t<PlatformComponent\r\n\t\t\t\t\thtml={this.props.value || this.props.args.html}\r\n\t\t\t\t\t{...this.props}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { uploadDynamoFile, getDynamoFilePreview } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport ValidationHelper from \"./utils/validator\";\r\n/**\r\n * This component should render a file uploader\r\n * @param  {Class} Uploader Component responsible for uploading the file\r\n * @param  {Array} previews Array of component definitions with an id property\r\n * @return {Class}          Configured component.\r\n */\r\nexport default (Uploader, ProgressBar, Text, previews = []) => {\r\n\tinvariants.validComponent(Uploader, \"Uploader\");\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(Text, \"Text\");\r\n\r\n\tclass DynamoFileUpload extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = {};\r\n\t\t\tthis._previewType = this.getPreviewType.call(this);\r\n\t\t\tthis._supported = this.isSupported();\r\n\t\t\tthis._getPreview = this._getPreview.bind(this);\r\n\t\t\tthis._query = this.getPreviewQuery();\r\n\t\t\tthis.props.validator.validate = () => {\r\n\t\t\t\treturn this.runValidators();\r\n\t\t\t};\r\n\t\t\tthis.upload = this.upload.bind(this);\r\n\t\t}\r\n\t\trunValidators() {\r\n\t\t\treturn new ValidationHelper(this).run();\r\n\t\t}\r\n\t\thasValue() {\r\n\t\t\treturn !!this.props.uploadedId || \"is required\";\r\n\t\t}\r\n\t\tgetPreviewQuery() {\r\n\t\t\treturn Uploader.getPreviewQuery(this.props.args.fileType);\r\n\t\t}\r\n\t\tgetPreviewType() {\r\n\t\t\tfor (var i = 0; i < previews.length; i++) {\r\n\t\t\t\tif (previews[i].id.test(this.props.args.fileType)) {\r\n\t\t\t\t\treturn previews[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tisSupported() {\r\n\t\t\treturn Uploader.supports(this.props.args.fileType);\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tif (this.props.uploadedId) {\r\n\t\t\t\tthis._getPreview(this.props.uploadedId);\r\n\t\t\t}\r\n\t\t}\r\n\t\t_getPreview(id) {\r\n\t\t\tthis.props.getPreview(\r\n\t\t\t\tid,\r\n\t\t\t\tthis.props.component_uid,\r\n\t\t\t\tthis.props.args.fileType,\r\n\t\t\t\tthis._query\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (\r\n\t\t\t\tnext.uploadedId !== this.props.uploadedId ||\r\n\t\t\t\tnext.component_uid !== this.props.component_uid\r\n\t\t\t) {\r\n\t\t\t\tthis._getPreview(next.uploadedId);\r\n\t\t\t\t//setTimeout(() => {\r\n\t\t\t\tthis.props.valueChanged({\r\n\t\t\t\t\t[this.props.name]: next.uploadedId\r\n\t\t\t\t});\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tupload(file) {\r\n\t\t\tthis.props.upload(file, this.props.component_uid);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tif (this.props.busy) return <ProgressBar />;\r\n\t\t\tif (!this._supported)\r\n\t\t\t\treturn <Text message={\"unsupported file upload type\"} />;\r\n\t\t\treturn (\r\n\t\t\t\t<Uploader\r\n\t\t\t\t\tkey={this.props.component_uid}\r\n\t\t\t\t\ttitle={this.props.label}\r\n\t\t\t\t\tdescription={this.props.description}\r\n\t\t\t\t\tupload={this.upload}\r\n\t\t\t\t\tcomponent_uid={this.props.component_uid}\r\n\t\t\t\t\tallowed={this.props.args.fileType}\r\n\t\t\t\t\tpreviewType={this._previewType}\r\n\t\t\t\t\tpreview={this.props.preview}\r\n\t\t\t\t\terrors={this.state.errors}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tlet st = state.dynamo[ownProps.component_uid] || {};\r\n\t\treturn {\r\n\t\t\tpreview: st.preview,\r\n\t\t\tbusy: st.busy,\r\n\t\t\tuploadedId: st.uploadedId || ownProps.value\r\n\t\t};\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tupload: (file, key) => dispatch(uploadDynamoFile(file, key)),\r\n\t\t\tgetPreview: (id, key, fileType, query) =>\r\n\t\t\t\tdispatch(getDynamoFilePreview(id, key, fileType, query))\r\n\t\t};\r\n\t};\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoFileUpload);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\nimport _ from \"lodash\";\r\n\r\nexport default (\r\n\tLayout,\r\n\tProgressBar,\r\n\tFilter,\r\n\tFilterContainer,\r\n\tContentContainer\r\n) => {\r\n\tinvariants.validComponent(Filter, \"Filter\");\r\n\tinvariants.validComponent(FilterContainer, \"FilterContainer\");\r\n\tinvariants.validComponent(ContentContainer, \"ContentContainer\");\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\trun: (id, args, key) =>\r\n\t\t\t\tdispatch(\r\n\t\t\t\t\trunDynamoProcessor(id, args, key, { disableCache: true })\r\n\t\t\t\t),\r\n\t\t\tshowMessage: message => dispatch(showMessage(message))\r\n\t\t};\r\n\t};\r\n\tconst mapStateToProps = (_, initialProps) => (state, ownProps) => {\r\n\t\tvar _actionState = state.dynamo[ownProps.component_uid];\r\n\t\treturn {\r\n\t\t\tresultUI: _actionState && (_actionState.ui || _actionState),\r\n\t\t\tresultData: _actionState && _actionState.data,\r\n\t\t\tbusy: !!state.dynamo[ownProps.component_uid + \"-busy\"]\r\n\t\t};\r\n\t};\r\n\tclass DynamoActionView extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.state = { form: this.props.value };\r\n\t\t\tthis._filterValidator = {};\r\n\t\t\tthis.filter = this.filter.bind(this);\r\n\t\t\tthis.valueChanged = this.valueChanged.bind(this);\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (_.isEqual(next.value, this.state.form)) {\r\n\t\t\t\t//setTimeout(() => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tform: next.value\r\n\t\t\t\t});\r\n\t\t\t\t//}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfilter() {\r\n\t\t\tthis._filterValidator.validate().then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.props.run(\r\n\t\t\t\t\t\tthis.props.args.action,\r\n\t\t\t\t\t\tthis.state.form,\r\n\t\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tconsole.warn(\"a field in filter is invalid\");\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tstatic itemViewName() {\r\n\t\t\treturn \"_itemView_\";\r\n\t\t}\r\n\t\tvalueChanged(value) {\r\n\t\t\tthis.state.form = value\r\n\t\t\t\t? value[DynamoActionView.itemViewName()]\r\n\t\t\t\t: null;\r\n\t\t}\r\n\t\tdoNothing() {}\r\n\t\trender() {\r\n\t\t\tif (this.props.busy) return <ProgressBar />;\r\n\t\t\treturn (\r\n\t\t\t\t<Layout>\r\n\t\t\t\t\t<Filter\r\n\t\t\t\t\t\tactionLabel={this.props.args.commandText}\r\n\t\t\t\t\t\tfilter={this.filter}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<FilterContainer\r\n\t\t\t\t\t\t\telements={this.props.args.elements}\r\n\t\t\t\t\t\t\tvalue={this.state.form}\r\n\t\t\t\t\t\t\tname={DynamoActionView.itemViewName()}\r\n\t\t\t\t\t\t\tvalidator={this._filterValidator}\r\n\t\t\t\t\t\t\tvalueChanged={this.valueChanged}\r\n\t\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Filter>\r\n\t\t\t\t\t<ContentContainer\r\n\t\t\t\t\t\telements={this.props.resultUI}\r\n\t\t\t\t\t\tvalue={this.props.resultData}\r\n\t\t\t\t\t\tvalidator={{}}\r\n\t\t\t\t\t\tvalueChanged={this.doNothing}\r\n\t\t\t\t\t\tnavigation={this.props.navigation}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoActionView);\r\n};\r\n","import React from \"react\";\r\nimport invariants from \"./utils/invariants\";\r\nexport default Label => {\r\n\tinvariants.validComponent(Label, \"Label\");\r\n\treturn props => {\r\n\t\tlet { value, description, ...rest } = props;\r\n\t\tif (value) {\r\n            return <Label description={value} {...rest} />\r\n\t\t}\r\n\t\treturn <Label {...props} />;\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nexport default (WebView, Text) => {\r\n\treturn class DynamoWebView extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tif (this.props.args &&  this.props.args.url) {\r\n\t\t\t\treturn <WebView url={this.props.args.url} />;\r\n\t\t\t} else {\r\n\t\t\t\treturn <Text>{\"Missing url\"}</Text>;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};\r\n","import React, { Component } from \"react\";\r\nimport SocketIOClient from \"socket.io-client\";\r\nimport invariants from \"./utils/invariants\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n\tsendMessage,\r\n\tloginChat,\r\n\tcreateGroup,\r\n\tsendFriendRequest,\r\n\tsearchForHandle,\r\n\tacceptInvite,\r\n\trejectInvite,\r\n\tfetchInvites,\r\n\tgetContacts,\r\n\taddToOpenChats,\r\n\topenChat,\r\n\tcloseChat\r\n} from \"./actions\";\r\n\r\nexport default (\r\n\tLayout,\r\n\tPane,\r\n\tOpenChats,\r\n\tEditor,\r\n\tContextMenu,\r\n\tNewChatButton,\r\n\tOpenChatsLayout,\r\n\tModal,\r\n\tProgressBar,\r\n\tLogin,\r\n\tContactList,\r\n\tChatHistory,\r\n\tAddNewContact,\r\n\tPendingInvites,\r\n\tChatLayout\r\n) => {\r\n\tinvariants.validComponent(Layout, \"Layout\");\r\n\tinvariants.validComponent(Pane, \"Pane\");\r\n\tinvariants.validComponent(Editor, \"Editor\");\r\n\tinvariants.validComponent(ContextMenu, \"ContextMenu\");\r\n\tinvariants.validComponent(OpenChats, \"OpenChats\");\r\n\tinvariants.validComponent(NewChatButton, \"NewChatButton\");\r\n\tinvariants.validComponent(ContactList, \"ContactList\");\r\n\tinvariants.validComponent(ChatHistory, \"ChatHistory\");\r\n\tinvariants.validComponent(OpenChatsLayout, \"OpenChatsLayout\");\r\n\tinvariants.validComponent(Modal, \"Modal\");\r\n\tinvariants.validComponent(ProgressBar, \"ProgressBar\");\r\n\tinvariants.validComponent(Login, \"Login\");\r\n\tinvariants.validComponent(AddNewContact, \"AddNewContact\");\r\n\tinvariants.validComponent(PendingInvites, \"PendingInvites\");\r\n\tinvariants.validComponent(ChatLayout, \"ChatLayout\");\r\n\r\n\tconst mapStateToProps = state => {\r\n\t\tlet _state = state.chat;\r\n\t\treturn {\r\n\t\t\tchat: _state.chat,\r\n\t\t\tcontacts: _state.contacts,\r\n\t\t\topenChats: _state.openChats,\r\n\t\t\tnewMessage: _state.newMessage,\r\n\t\t\thandle: _state.chatHandle,\r\n\t\t\tusername: state.authentication.username,\r\n\t\t\tmessageSent: _state.chatMessageSent,\r\n\t\t\tloggingIn: _state.busyWithChatLogin,\r\n\t\t\tsearchResult: _state.searchResult,\r\n\t\t\tbusyWithInvite: _state.busyWithInvite,\r\n\t\t\tbusyWithInvites: _state.busyWithInvites,\r\n\t\t\tbusyWithContacts: _state.busyWithContacts,\r\n\t\t\tinvites: _state.invites,\r\n\t\t\tmessageDelivered: _state.messageDelivered\r\n\t\t};\r\n\t};\r\n\tconst mapDispatchToProps = dispatch => {\r\n\t\treturn {\r\n\t\t\tsend: (type, msg) => dispatch(sendMessage(type, msg)),\r\n\t\t\tcreateGroup: msg => dispatch(createGroup(msg)),\r\n\t\t\tlogin: credentials => dispatch(loginChat(credentials)),\r\n\t\t\tsendFriendRequest: handle => dispatch(sendFriendRequest(handle)),\r\n\t\t\tacceptInvite: handle => dispatch(acceptInvite(handle)),\r\n\t\t\trejectInvite: handle => dispatch(rejectInvite(handle)),\r\n\t\t\tsearch: query => dispatch(searchForHandle(query)),\r\n\t\t\tfetchInvites: () => dispatch(fetchInvites()),\r\n\t\t\tgetContacts: () => dispatch(getContacts()),\r\n\t\t\taddToOpenChats: chat => dispatch(addToOpenChats(chat)),\r\n\t\t\topenChat: chat => dispatch(openChat(chat)),\r\n\t\t\tcloseChat: () => dispatch(closeChat())\r\n\t\t};\r\n\t};\r\n\tclass DynamoMessenger extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.renderChat = this.renderChat.bind(this);\r\n\t\t\tthis.renderPendingInvites = this.renderPendingInvites.bind(this);\r\n\t\t\tthis.sendMessage = this.sendMessage.bind(this);\r\n\t\t\tthis.openSelectContact = this.openSelectContact.bind(this);\r\n\t\t\tthis.getMessageLayout = this.getMessageLayout.bind(this);\r\n\t\t\tthis.selectedPaneChanged = this.selectedPaneChanged.bind(this);\r\n\t\t\tthis.hideModal = this.hideModal.bind(this);\r\n\t\t\tthis.openAddNewContact = this.openAddNewContact.bind(this);\r\n\t\t\tthis.openChatModal = this.openChatModal.bind(this);\r\n\t\t\tthis.state = {\r\n\t\t\t\tselectedPane: 0,\r\n\t\t\t\tmodalTemplate: null,\r\n\t\t\t\tshowModal: false,\r\n\t\t\t\t_panes: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Chat\",\r\n\t\t\t\t\t\ticon: \"comment-multiple-outline\",\r\n\t\t\t\t\t\trender: this.renderChat\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Pending Invites\",\r\n\t\t\t\t\t\ticon: \"account-plus\",\r\n\t\t\t\t\t\trender: this.renderPendingInvites\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t};\r\n\t\t\tthis._chatLayoutCommands = [\r\n\t\t\t\t{ title: \"New Group\", uid: \"NEW_GROUP\" }\r\n\t\t\t];\r\n\t\t\tthis._chatCommands = [{ title: \"Delete Chat\", uid: \"DELETE_CHAT\" }];\r\n\t\t}\r\n\t\tsendMessage(contact, message) {\r\n\t\t\tthis.props.send(contact.type !== \"group\" ? \"msg\" : \"grpmsg\", {\r\n\t\t\t\tto: contact.handle,\r\n\t\t\t\tmessage\r\n\t\t\t});\r\n\t\t}\r\n\t\tcomponentWillReceiveProps(next) {\r\n\t\t\tif (next.chat && next.chat !== this.props.chat) {\r\n\t\t\t\tthis.openChatModal(next.chat);\r\n\t\t\t}\r\n\t\t}\r\n\t\topenChatModal(chat = this.props.chat) {\r\n\t\t   //\tsetTimeout(() => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tmodalTemplate: () => this.getMessageLayout(chat),\r\n\t\t\t\t\tshowModal: true\r\n\t\t\t\t});\r\n\t\t\t//}, 0);\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\tconsole.log(\"logging in...\");\r\n\t\t\tthis.props.login({ username: this.props.username });\r\n\r\n\t\t\tif (this.props.chat) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.openChatModal(\r\n\t\t\t\t\t\tthis.props.openChats[this.props.chat.contact.handle]\r\n\t\t\t\t\t);\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\trenderPendingInvites() {\r\n\t\t\tif (this.props.busyWithInvites) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<PendingInvites\r\n\t\t\t\t\tgetInvites={this.props.fetchInvites}\r\n\t\t\t\t\tinvites={this.props.invites}\r\n\t\t\t\t\tacceptInvite={this.props.acceptInvite}\r\n\t\t\t\t\trejectInvite={this.props.rejectInvite}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\trenderChat() {\r\n\t\t\tlet chats = Object.keys(this.props.openChats || {}).map(x => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\thandle: x,\r\n\t\t\t\t\tmessages: this.props.openChats[x].messages\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\treturn (\r\n\t\t\t\t<OpenChatsLayout>\r\n\t\t\t\t\t<ContextMenu commands={this._chatLayoutCommands} />\r\n\t\t\t\t\t{this.props.fetchingContacts ? (\r\n\t\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<OpenChats\r\n\t\t\t\t\t\t\topen={handle => {\r\n\t\t\t\t\t\t\t\tthis.props.openChat(\r\n\t\t\t\t\t\t\t\t\tthis.props.openChats[handle]\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tnewMessage={this.props.newMessage}\r\n\t\t\t\t\t\t\tchats={chats}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<NewChatButton onClick={this.openSelectContact} />\r\n\t\t\t\t</OpenChatsLayout>\r\n\t\t\t);\r\n\t\t}\r\n\t\tgetMessageLayout(chat) {\r\n\t\t\treturn (\r\n\t\t\t\t<ChatLayout info={chat.contact.handle}>\r\n\t\t\t\t\t<ContextMenu commands={this._chatCommands} />\r\n\t\t\t\t\t<ChatHistory\r\n\t\t\t\t\t\tmessages={chat.messages}\r\n\t\t\t\t\t\tme={this.props.handle}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Editor\r\n\t\t\t\t\t\tmessageDelivered={this.props.messageDelivered}\r\n\t\t\t\t\t\tsend={message =>\r\n\t\t\t\t\t\t\tthis.sendMessage(chat.contact, message)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</ChatLayout>\r\n\t\t\t);\r\n\t\t}\r\n\t\topenChat(chat) {\r\n\t\t\tthis.props.openChat(chat);\r\n\t\t}\r\n\t\topenSelectContact() {\r\n\t\t\tif (!this.props.busyWithContacts && !this.props.contacts) {\r\n\t\t\t\tthis.props.getContacts();\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tmodalTemplate: () =>\r\n\t\t\t\t\tthis.props.busyWithContacts ? (\r\n\t\t\t\t\t\t<ProgressBar />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<ContactList\r\n\t\t\t\t\t\t\tcontacts={this.props.contacts}\r\n\t\t\t\t\t\t\topenAddNewContact={this.openAddNewContact}\r\n\t\t\t\t\t\t\tcontactSelected={contact => {\r\n\t\t\t\t\t\t\t\t//add chat to history.\r\n\t\t\t\t\t\t\t\tlet chat = (this.props.openChats || {})[\r\n\t\t\t\t\t\t\t\t\tcontact.handle\r\n\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\tif (!chat)\r\n\t\t\t\t\t\t\t\t\tthis.props.addToOpenChats(\r\n\t\t\t\t\t\t\t\t\t\t(chat = { contact, messages: [] })\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.openChat(chat);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t),\r\n\t\t\t\tshowModal: true\r\n\t\t\t});\r\n\t\t}\r\n\t\topenAddNewContact() {\r\n\t\t\tthis.setState({\r\n\t\t\t\tmodalTemplate: () => (\r\n\t\t\t\t\t<AddNewContact\r\n\t\t\t\t\t\tsearch={query => this.props.search(query)}\r\n\t\t\t\t\t\tsearchResult={this.props.searchResult}\r\n\t\t\t\t\t\tsendFriendRequest={handle =>\r\n\t\t\t\t\t\t\tthis.props.sendFriendRequest(handle)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t),\r\n\t\t\t\tshowModal: true\r\n\t\t\t});\r\n\t\t}\r\n\t\thideModal() {\r\n\t\t\tthis.setState({ showModal: false });\r\n\t\t\t//this will cause a useless rerender. need to change this later.\r\n\t\t\tthis.props.closeChat();\r\n\t\t}\r\n\t\tselectedPaneChanged(selectedPane) {\r\n\t\t\tthis.setState({ selectedPane });\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tif (this.props.loggingIn) {\r\n\t\t\t\treturn <ProgressBar />;\r\n\t\t\t}\r\n\t\t\tif (!this.props.handle) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Login\r\n\t\t\t\t\t\tfirstTimer={this.props.firstTimer}\r\n\t\t\t\t\t\twelcomeMessage={\r\n\t\t\t\t\t\t\t(this.props.args &&\r\n\t\t\t\t\t\t\t\tthis.props.args.welcomeMessage) ||\r\n\t\t\t\t\t\t\t\"Please enter the name with which you want to be known. Please note once saved it cannot be changed\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsubmit={handle =>\r\n\t\t\t\t\t\t\tthis.props.login({\r\n\t\t\t\t\t\t\t\tusername: this.props.username,\r\n\t\t\t\t\t\t\t\thandle\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<Layout\r\n\t\t\t\t\tselectedPane={this.state.selectedPane}\r\n\t\t\t\t\tselectedPaneChanged={this.selectedPaneChanged}\r\n\t\t\t\t\tpanes={this.state._panes.map(x => ({\r\n\t\t\t\t\t\ttitle: x.title,\r\n\t\t\t\t\t\ticon: x.icon\r\n\t\t\t\t\t}))}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\ttemplate={\r\n\t\t\t\t\t\t\t(this.state.modalTemplate &&\r\n\t\t\t\t\t\t\t\tthis.state.modalTemplate()) ||\r\n\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thideDone={true}\r\n\t\t\t\t\t\tdone={this.hideModal}\r\n\t\t\t\t\t\tvisibility={this.state.showModal}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{this.state._panes[this.state.selectedPane].render()}\r\n\t\t\t\t</Layout>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\treturn connect(mapStateToProps, mapDispatchToProps)(DynamoMessenger);\r\n};\r\n","import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { runDynamoProcessor, dynamoDownloadUrl } from \"./actions\";\r\nimport invariants from \"./utils/invariants\";\r\n\r\nexport default (Link, customDownloadCommand) => {\r\n\tinvariants.validComponent(Link, \"Link\");\r\n\r\n\tconst mapDispatchToState = dispatch => {\r\n\t\treturn {\r\n\t\t\tdispatch\r\n\t\t};\r\n\t};\r\n\tclass DynamoCommand extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.go = this.go.bind(this);\r\n\t\t\tthis.run = this.run.bind(this);\r\n\t\t}\r\n\t\trun() {\r\n\t\t\tthis.props.dispatch(\r\n\t\t\t\trunDynamoProcessor(\r\n\t\t\t\t\tthis.props.args.commmandProcessor,\r\n\t\t\t\t\tJSON.parse(this.props.args.commandProcessorArgs || {}),\r\n\t\t\t\t\tthis.props.component_uid\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t}\r\n\t\tgo() {\r\n\t\t\tswitch (this.props.args.commandType) {\r\n\t\t\t\tcase DynamoCommand.COMMAND_TYPE.DOWNLOAD:\r\n\t\t\t\t\tif (!this.props.args.commandProcessorArgs) {\r\n\t\t\t\t\t\tthrow new Error(\"Download is not properly setup.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet url;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\turl = dynamoDownloadUrl.replace(\r\n\t\t\t\t\t\t\t\":id\",\r\n\t\t\t\t\t\t\tJSON.parse(this.props.args.commandProcessorArgs).id\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tthrow new Error(\"Download is not properly setup.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.props.dispatch(customDownloadCommand(this.props.args, url));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.run();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\trender() {\r\n\t\t\treturn (\r\n\t\t\t\t/*jshint ignore:start */\r\n\t\t\t\t<Link\r\n\t\t\t\t\ttext={this.props.args.commandText}\r\n\t\t\t\t\ticon={this.props.args.commandIcon}\r\n\t\t\t\t\tgo={this.go}\r\n\t\t\t\t/>\r\n\t\t\t\t/*jshint ignore:end */\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\tDynamoCommand.COMMAND_TYPE = { DEFAULT: \"DEFAULT\", DOWNLOAD: \"DOWNLOAD\" };\r\n\treturn connect(null, mapDispatchToState)(DynamoCommand);\r\n};\r\n","import dynamo_input from \"./dynamo_input.js\";\r\nimport dynamo_view from \"./dynamo_view.js\";\r\nimport dynamo_container from \"./dynamo_container.js\";\r\nimport dynamo_process from \"./dynamo_process.js\";\r\nimport dynamo_section from \"./dynamo_section.js\";\r\nimport dynamo_select from \"./dynamo_select.js\";\r\nimport dynamo_selectset from \"./dynamo_selectset.js\";\r\nimport dynamo_list from \"./dynamo_list.js\";\r\nimport dynamo_hidden from \"./dynamo_hidden.js\";\r\nimport dynamo_nav from \"./dynamo_nav\";\r\nimport dynamo_image from \"./dynamo_image\";\r\nimport dynamo_grid from \"./dynamo_grid\";\r\nimport dynamo_htmlview from \"./dynamo_htmlview\";\r\nimport dynamo_fileupload from './dynamo_fileupload';\r\nimport dynamo_actionview from \"./dynamo_actionview\";\r\nimport dynamo_label from './dynamo_label';\r\nimport dynamo_webview from \"./dynamo_webview\";\r\nimport dynamo_messenger from \"./dynamo_messenger\";\r\nimport dynamo_command from \"./dynamo_command\";\r\n\r\nexport default {\r\n\tdynamo_input,\r\n\tdynamo_view,\r\n\tdynamo_container,\r\n\tdynamo_process, \r\n\tdynamo_section,\r\n\tdynamo_select,\r\n\tdynamo_selectset,\r\n\tdynamo_list,\r\n\tdynamo_hidden,\r\n\tdynamo_nav,\r\n\tdynamo_grid, \r\n\tdynamo_image,\r\n\tdynamo_fileupload,\r\n\tdynamo_actionview,\r\n\tdynamo_htmlview,\r\n\tdynamo_label,\r\n\tdynamo_webview,\r\n\tdynamo_messenger,\r\n\tdynamo_command\r\n}; \r\n","import components from \"./lib\";\r\nconst defaultMap = {\r\n\tINPUT: components.dynamo_input,\r\n\tVIEW: components.dynamo_view,\r\n\tCONTAINER: components.dynamo_container,\r\n\tPROCESS: components.dynamo_process,\r\n\tSECTION: components.dynamo_section,\r\n\tSELECT: components.dynamo_select,\r\n\tSELECTSET: components.dynamo_selectset,\r\n\tLIST: components.dynamo_list,\r\n\tHIDDEN: components.dynamo_hidden,\r\n\tNAV: components.dynamo_nav,\r\n\tIMAGE: components.dynamo_image,\r\n\tGRID: components.dynamo_grid,\r\n\tFILEUPLOAD: components.dynamo_fileupload,\r\n\tACTIONVIEW: components.dynamo_actionview,\r\n\tHTMLVIEW: components.dynamo_htmlview,\r\n\tLABEL: components.dynamo_label,\r\n\tWEBVIEW: components.dynamo_webview,\r\n\tMESSENGER: components.dynamo_messenger,\r\n\tCOMMAND: components.dynamo_command,\r\n\trecipes: {},\r\n\t_defaultMap: {},\r\n\tcook: function(name, recipe, customName) {\r\n\t\tif (name && recipe) {\r\n\t\t\tif (!Array.prototype.isPrototypeOf(recipe)) {\r\n\t\t\t\tthrow new Error(\"Recipe must be an array\");\r\n\t\t\t}\r\n\t\t\tif (!this._defaultMap[name])\r\n\t\t\t\tthrow new Error(\"Cannot find any recipe for that element\");\r\n\t\t\tif (name == customName) {\r\n\t\t\t\tthrow new Error(\"Cusom name will override default recipe\");\r\n\t\t\t}\r\n\r\n\t\t\tlet cooked = this._defaultMap[name].apply(null, recipe);\r\n\t\t\tif (customName) this[customName] = cooked;\r\n\t\t\treturn cooked;\r\n\t\t}\r\n\r\n\t\tif (!this._cooked) {\r\n\t\t\tthis._cooked = true;\r\n\t\t\tObject.keys(this.recipes).forEach(recipe => {\r\n\t\t\t\tthis._defaultMap[recipe] = this[recipe];\r\n\t\t\t\tthis[recipe] = this[recipe].apply(null, this.recipes[recipe]);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n};\r\nexport default defaultMap;\r\n","import _ from \"lodash\";\r\nimport uuid from \"uuid/v4\";\r\nimport { ACTIONS } from \"../actions\";\r\nimport config from \"client_config\";\r\n\r\nexport default function(state = {}, action) {\r\n\tswitch (action.type) {\r\n\t\tcase \"persist/REHYDRATE\":\r\n\t\t\tvar incoming = action.payload.dynamo;\r\n\t\t\tif (incoming) {\r\n\t\t\t\ttoggleAllBusyIndicators(incoming);\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\t...incoming\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn state;\r\n\t\tcase ACTIONS.ADD_NAVIGATION_CONTEXT:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tnavigationContext: action.payload\r\n\t\t\t});\r\n\t\tcase ACTIONS.REMOVE_NAVIGATION_CONTEXT:\r\n\t\t\tdelete state.navigationContext;\r\n\t\t\treturn Object.assign({}, state);\r\n\t\tcase ACTIONS.DYNAMO_PROCESS_FAILED:\r\n\t\t\treturn Object.assign({}, state, { busy: false });\r\n\t\tcase ACTIONS.DYNAMO_PROCESS_RAN:\r\n\t\t\tlet currentState = {\r\n\t\t\t\tbusy: false,\r\n\t\t\t\tcurrentStep: state.currentStep || 0\r\n\t\t\t};\r\n\t\t\tif (\r\n\t\t\t\t(config.uiOnDemand &&\r\n\t\t\t\t\taction.payload.data.status == \"COMPLETED\") ||\r\n\t\t\t\t(!config.uiOnDemand &&\r\n\t\t\t\t\t(state.description.steps.length == 1 ||\r\n\t\t\t\t\t\tcurrentState.currentStep + 1 >\r\n\t\t\t\t\t\t\tstate.description.steps.length - 1))\r\n\t\t\t) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tbusy: false,\r\n\t\t\t\t\tcompleted: true,\r\n\t\t\t\t\tmessage:\r\n\t\t\t\t\t\t(typeof action.payload.data == \"object\" &&\r\n\t\t\t\t\t\t\taction.payload.data.message) ||\r\n\t\t\t\t\t\tnull\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tcurrentState.instanceId =\r\n\t\t\t\taction.payload && action.payload.data\r\n\t\t\t\t\t? action.payload.data.instanceId\r\n\t\t\t\t\t: null;\r\n\t\t\tif (config.uiOnDemand)\r\n\t\t\t\tstate.description.steps[0] = action.payload.data.$nextStep;\r\n\t\t\telse currentState.currentStep = currentState.currentStep + 1;\r\n\t\t\t//potentially costly will have to test and see what happens.\r\n\t\t\t//currentState.templateCache = getTemplatesAndAddComponentUid(state.description.steps[currentState.currentStep].form.elements);\r\n\t\t\tcurrentState.value =\r\n\t\t\t\ttypeof action.payload.data == \"object\" &&\r\n\t\t\t\ttypeof action.payload.data.message == \"object\" &&\r\n\t\t\t\taction.payload.data.message;\r\n\t\t\treturn Object.assign({}, state, currentState);\r\n\r\n\t\tcase ACTIONS.FETCHING_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: fetchingGrid(state[action.meta.key], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILTERED_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: filteredGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: getSingleItemForGrid(\r\n\t\t\t\t\tstate[action.meta.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.GOT_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotSingleItemForGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: errorWhileGettingSingleItemForGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.ERROR_WHILE_FETCHING_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: failedToFetchGrid(\r\n\t\t\t\t\tstate[action.payload.key]\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.DYNAMO_GET_MORE_FOR_GRID:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: reduceGrid(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.DYNAMO_PROCESS_RUNNING:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tbusy: !action.error,\r\n\t\t\t\tvalue: action.meta.form\r\n\t\t\t});\r\n\t\tcase ACTIONS.DYNAMO_PROCESSOR_RAN:\r\n\t\t\tconfigureTemplates(state, action);\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: action.payload.data,\r\n\t\t\t\t[`${action.payload.key}-busy`]: false\r\n\t\t\t});\r\n\r\n\t\tcase ACTIONS.DYNAMO_PROCESSOR_RUNNING:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[`${action.meta.key}-busy`]: !action.error\r\n\t\t\t});\r\n\t\tcase ACTIONS.DYNAMO_PROCESSOR_FAILED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[`${action.meta}-busy`]: false,\r\n\t\t\t\t[action.meta]: null\r\n\t\t\t});\r\n\t\tcase ACTIONS.FETCHED_PROCESS:\r\n\t\t\tlet fetchedValue = Object.assign({}, action.payload.data.data);\r\n\t\t\tlet fetchedDescription = Object.assign(\r\n\t\t\t\t{},\r\n\t\t\t\taction.payload.data.description\r\n\t\t\t);\r\n\t\t\treturn {\r\n\t\t\t\tdescription: fetchedDescription,\r\n\t\t\t\tcurrentStep: 0,\r\n\t\t\t\tbusy: false,\r\n\t\t\t\tvalue: fetchedValue,\r\n\t\t\t\ttemplateCache: {},\r\n\t\t\t\t//always carry over the navigationContext.\r\n\t\t\t\tnavigationContext: state.navigationContext\r\n\t\t\t};\r\n\t\tcase ACTIONS.FETCHING_PROCESS:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tbusy: !action.error\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_FETCH_PROCESS:\r\n\t\t\treturn {\r\n\t\t\t\tbusy: false,\r\n\t\t\t\t//always carry over the navigationContext.\r\n\t\t\t\tnavigationContext:state.navigationContext\r\n\t\t\t};\r\n\t\tcase ACTIONS.START_FILE_UPLOAD:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: startUpload(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILE_UPLOADED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: fileUpload(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FILE_UPLOAD_FAILED:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: uploadFailed(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: getPreview(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotPreview(\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_PREVIEW:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetPreview(state[action.meta], action)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_ITEM_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta.key]: getTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\tstate[action.meta.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_ITEM_TEMPLATE:\r\n\t\t\tconfigureTemplates(state, action);\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\t\"itemTemplate\",\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_ITEM_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\"gettingTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GET_FILTER_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: getTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.GOT_FILTER_TEMPLATE:\r\n\t\t\tif (action.error) {\r\n\t\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\t\taction\r\n\t\t\t\t\t)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconfigureTemplates(state, action);\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.payload.key]: gotTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\t\"filterTemplate\",\r\n\t\t\t\t\tstate[action.payload.key],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_GET_FILTER_TEMPLATE:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\t[action.meta]: failedToGetTemplate(\r\n\t\t\t\t\t\"gettingFilterTemplate\",\r\n\t\t\t\t\tstate[action.meta],\r\n\t\t\t\t\taction\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nfunction configureTemplates(state, action) {\r\n\tif (action.payload.returnsUI) {\r\n\t\t//state.templateCache = Object.assign({}, state.templateCache, getTemplatesAndAddComponentUid(action.payload.data));\r\n\t}\r\n}\r\n\r\nfunction getTemplate(busyIndicator, state = {}, action) {\r\n\treturn Object.assign({}, state, { [busyIndicator]: !action.error });\r\n}\r\nfunction gotTemplate(busyIndicator, propName, state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\t[propName]: action.payload.data,\r\n\t\t[busyIndicator]: false\r\n\t});\r\n}\r\nfunction failedToGetTemplate(busyIndicator, state = {}, action) {\r\n\treturn Object.assign({}, state, { [busyIndicator]: false });\r\n}\r\n\r\nfunction startUpload(state = {}, action) {\r\n\treturn Object.assign({}, state, { gettingTemplate: !action.error });\r\n}\r\nfunction fileUpload(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tuploadedId: action.payload.id,\r\n\t\tbusy: false\r\n\t});\r\n}\r\nfunction uploadFailed(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: false });\r\n}\r\nfunction getPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: !action.error });\r\n}\r\nfunction gotPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tpreview: action.payload.data,\r\n\t\tbusy: false\r\n\t});\r\n}\r\nfunction failedToGetPreview(state = {}, action) {\r\n\treturn Object.assign({}, state, { busy: false });\r\n}\r\nfunction runThroughObj(conditions, data, result = {}, parent = null) {\r\n\tif (data)\r\n\t\tObject.keys(data).forEach(key => {\r\n\t\t\tlet send = false;\r\n\t\t\tfor (var v = 0; v < conditions.length; v++) {\r\n\t\t\t\tif (conditions[v](key, data, result, parent)) return result;\r\n\t\t\t}\r\n\t\t\tif (Array.prototype.isPrototypeOf(data[key]))\r\n\t\t\t\treturn data[key].forEach(function(element) {\r\n\t\t\t\t\trunThroughObj(conditions, element, result, data);\r\n\t\t\t\t});\r\n\t\t\tif (data[key] && typeof data[key] == \"object\")\r\n\t\t\t\treturn runThroughObj(conditions, data[key], result, data);\r\n\t\t});\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * This method retrieves all the recursively declared templates and returns them. it also assigns \r\n * unique ids to every element it finds.\r\n * @param  {[type]} null    [description]\r\n * @param  {[type]} [\t(key, data,         result, parent) [description]\r\n * @param  {[type]} (key,   data,         result, parent  [description]\r\n * @return {[type]}         [description]\r\n */\r\nconst getTemplatesAndAddComponentUid = runThroughObj.bind(null, [\r\n\t(key, data, result, parent) => {\r\n\t\tif (key === \"dynamo_ref\") {\r\n\t\t\tif (data.template)\r\n\t\t\t\treturn (result[data.dynamo_ref] = data.template), result;\r\n\t\t\tif (parent && parent.itemTemplate)\r\n\t\t\t\treturn (result[data.dynamo_ref] = parent.itemTemplate), result;\r\n\t\t}\r\n\t},\r\n\t(key, data, result, parent) => {\r\n\t\tif (key == \"elementType\" && !data.component_uid) {\r\n\t\t\tdata.component_uid = uuid();\r\n\t\t}\r\n\t\t//console.log(parent ? parent : \"n/a\");\r\n\t}\r\n]);\r\n\r\nexport const toggleAllBusyIndicators = runThroughObj.bind(null, [\r\n\t(key, data) => {\r\n\t\tif (\r\n\t\t\t/(getting|busy|fetching)+/i.test(key) &&\r\n\t\t\ttypeof data[key] == \"boolean\"\r\n\t\t) {\r\n\t\t\tdata[key] = false;\r\n\t\t}\r\n\t}\r\n]);\r\n\r\nfunction reduceGrid(state = {}, action) {\r\n\tif (!state.data || state.data.items.length < action.payload.data.total) {\r\n\t\tlet current = state.data ? state.data.items : [];\r\n\t\taction.payload.data.items = current.concat(action.payload.data.items);\r\n\t\tstate.data = action.payload.data;\r\n\t\treturn Object.assign({}, state, { fetchingGrid: false });\r\n\t}\r\n}\r\n\r\nfunction filteredGrid(state = {}, action) {\r\n\tlet current = state.data ? state.data.items : [];\r\n\tstate.data = action.payload.data;\r\n\treturn Object.assign({}, state, { fetchingGrid: false });\r\n}\r\n\r\nfunction fetchingGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingGrid: !action.error,\r\n\t\tfilter: action.meta && action.meta.args ? action.meta.args.query : null\r\n\t});\r\n}\r\n\r\nfunction failedToFetchGrid(state = {}) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingGrid: false\r\n\t});\r\n}\r\n\r\nfunction getSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, { fetchingSingleItem: !action.error });\r\n}\r\n\r\nfunction gotSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tsingleItem: action.payload.data,\r\n\t\tfetchingSingleItem: false\r\n\t});\r\n}\r\n\r\nfunction errorWhileGettingSingleItemForGrid(state = {}, action) {\r\n\treturn Object.assign({}, state, {\r\n\t\tfetchingSingleItem: false,\r\n\t\tsingleItem: undefined\r\n\t});\r\n}\r\n","import { ACTIONS } from \"../actions\";\r\nimport { toggleAllBusyIndicators } from \"./index\";\r\nimport uuid from \"uuid/v4\";\r\nexport default function(state = {}, action) {\r\n\tswitch (action.type) {\r\n\t\tcase \"persist/REHYDRATE\":\r\n\t\t\tvar incoming = action.payload.chat;\r\n\t\t\tif (incoming) {\r\n\t\t\t\ttoggleAllBusyIndicators(incoming);\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\t...incoming\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn state;\r\n\t\tcase ACTIONS.LOGIN_CHAT:\r\n\t\t\treturn Object.assign({}, state, { busyWithChatLogin: true, chatHandle: null });\r\n\t\tcase ACTIONS.LOGGED_IN_CHAT:\r\n\t\t\treturn Object.assign({}, state, { busyWithChatLogin: false, chatHandle: action.payload.handle || action.meta.handle });\r\n\t\tcase ACTIONS.FAILED_TO_LOGIN_CHAT:\r\n\t\t\treturn Object.assign({}, state, { busyWithChatLogin: false });\r\n\t\tcase ACTIONS.SEND_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { sentFriendRequest: false, busyWithFriendRequest: true });\r\n\t\tcase ACTIONS.SENT_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { sentFriendRequest: true, busyWithFriendRequest: false });\r\n\t\tcase ACTIONS.FAILED_TO_SEND_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { busyWithFriendRequest: false, sentFriendRequest: false });\r\n\r\n\t\tcase ACTIONS.SEARCH:\r\n\t\t\treturn Object.assign({}, state, { busyWithSearch: true, searchResult: [] });\r\n\t\tcase ACTIONS.FOUND:\r\n\t\t\treturn Object.assign({}, state, { busyWithSearch: false, searchResult: action.payload });\r\n\t\tcase ACTIONS.NOT_FOUND:\r\n\t\t\treturn Object.assign({}, state, { busyWithSearch: false });\r\n\r\n\t\tcase ACTIONS.ACCEPT_FRIEND_REQUEST:\r\n\t\tcase ACTIONS.REJECT_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvite: true });\r\n\t\tcase ACTIONS.ACCEPTED_FRIEND_REQUEST:\r\n\t\tcase ACTIONS.REJECTED_FRIEND_REQUEST:\r\n\t\t\tif (state.invites) {\r\n\t\t\t\tlet req = state.invites.filter(x => x.handle == action.payload)[0];\r\n\t\t\t\tstate.invites.splice(state.invites.indexOf(req), 1);\r\n\t\t\t}\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tbusyWithInvite: false,\r\n\t\t\t\tpendingInvites: (state.invites && state.invites.slice()) || null\r\n\t\t\t});\r\n\t\tcase ACTIONS.FAILED_TO_ACCEPT_FRIEND_REQUEST:\r\n\t\tcase ACTIONS.FAILED_TO_REJECT_FRIEND_REQUEST:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvite: false });\r\n\r\n\t\tcase ACTIONS.GET_INVITES:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvites: true });\r\n\t\tcase ACTIONS.GOT_INVITES:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvites: false, invites: action.payload });\r\n\t\tcase ACTIONS.FAILED_TO_GET_INVITES:\r\n\t\t\treturn Object.assign({}, state, { busyWithInvites: false });\r\n\t\tcase ACTIONS.GET_CONTACTS:\r\n\t\t\treturn Object.assign({}, state, { busyWithContacts: true });\r\n\t\tcase ACTIONS.GOT_CONTACTS:\r\n\t\t\treturn Object.assign({}, state, { busyWithContacts: false, contacts: action.payload });\r\n\t\tcase ACTIONS.FAILED_TO_GET_CONTACTS:\r\n\t\t\treturn Object.assign({}, state, { busyWithContacts: false });\r\n\t\tcase ACTIONS.ADD_TO_OPEN_CHATS:\r\n\t\t\tlet chat = action.payload,\r\n\t\t\t\topen = state.openChats || {};\r\n\t\t\topen[chat.contact.handle] = chat;\r\n\t\t\treturn Object.assign({}, state, { openChats: open });\r\n\t\tcase ACTIONS.NEW_MESSAGE:\r\n\t\tcase ACTIONS.NEW_GROUP_MESSAGE:\r\n\t\t\tlet openChats = state.openChats || {},\r\n\t\t\t\tmsg = action.payload;\r\n\t\t\tif (!openChats[msg.from]) {\r\n\t\t\t\topenChats[msg.from] = {\r\n\t\t\t\t\tcontact: { handle: msg.from, type: action.type == ACTIONS.NEW_GROUP_MESSAGE && \"group\" },\r\n\t\t\t\t\tmessages: []\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tmsg.id = uuid();\r\n\t\t\topenChats[msg.from].messages.push(msg);\r\n\t\t\treturn Object.assign({}, state, { openChats, newMessage: msg });\r\n\t\tcase ACTIONS.OPEN_CHAT:\r\n\t\t\treturn Object.assign({}, state, {\r\n\t\t\t\tchat: action.payload,\r\n\t\t\t\tnewMessage: state.newMessage && state.newMessage.from == action.payload.contact.handle ? null : state.newMessage\r\n\t\t\t});\r\n\t\tcase ACTIONS.CLOSE_CHAT:\r\n\t\t\treturn Object.assign({}, state, { chat: null });\r\n\t\tcase ACTIONS.SEND_CHAT:\r\n\t\t\treturn Object.assign({}, state, { messageDelivered: false });\r\n\t\tcase ACTIONS.SENT_CHAT:\r\n\t\t\tlet _openChats = state.openChats,\r\n\t\t\t\t_msg = action.meta;\r\n\t\t\t_openChats[_msg.to].messages.push(Object.assign({}, _msg, { from: state.chatHandle, id: uuid() }));\r\n\t\t\t_openChats[_msg.to].messages = _openChats[_msg.to].messages.slice();\r\n\t\t\treturn Object.assign({}, state, { openChats: Object.assign({}, _openChats), messageDelivered: true });\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n"],"names":["MemCache","opts","defaultTTL","ttl","store","bind","get","_items","obj","JSON","stringify","key","hasOwnProperty","getKey","_key","value","undefined","handle","setTimeout","remove","preDispatch","config","BASE_URL","global","baseUrl","CHAT_URL","chatUrl","preLogin","cache","processorsCacheTimeout","ACTIONS","socket","displayMessage","text","getQueryParams","args","Object","keys","map","x","index","arr","encodeURIComponent","length","join","removeNavigationContext","REMOVE_NAVIGATION_CONTEXT","addNavigationContext","ADD_NAVIGATION_CONTEXT","openConfirmation","id","message","params","OPEN_CONFIRMATION","defaultError","dispatch","customType","meta","action","state","res","status","statusText","headers","errormessage","showMessage","type","SESSION_MAY_HAVE_EXPIRED","dynamoDownloadUrl","fetchDynamoProcess","cacheProcessDescription","cacheKey","hasKey","payload","assign","FETCHED_PROCESS","getState","CALL_API","$uiOnDemand","uiOnDemand","FETCHING_PROCESS","json","then","response","data","d","FAILED_TO_FETCH_PROCESS","getMoreForGrid","runDynamoProcessor","FETCHING_GRID","DYNAMO_GET_MORE_FOR_GRID","ERROR_WHILE_FETCHING_GRID","filterGrid","FILTERED_GRID","getItemTemplate","GET_ITEM_TEMPLATE","GOT_ITEM_TEMPLATE","FAILED_TO_GET_ITEM_TEMPLATE","getFilterTemplate","GET_FILTER_TEMPLATE","GOT_FILTER_TEMPLATE","FAILED_TO_GET_FILTER_TEMPLATE","getSingleItemForGrid","GET_SINGLE_ITEM_FOR_GRID","GOT_SINGLE_ITEM_FOR_GRID","ERROR_WHILE_GETTING_SINGLE_ITEM_FOR_GRID","requestCustomType","resultCustomType","errorCustomType","returnsUI","disableCache","cacheProcessorResponses","DYNAMO_PROCESSOR_RAN","DYNAMO_PROCESSOR_RUNNING","DYNAMO_PROCESSOR_FAILED","runDynamoProcess","details","DYNAMO_PROCESS_RUNNING","form","DYNAMO_PROCESS_RAN","catch","DYNAMO_PROCESS_FAILED","instanceId","getDynamoFilePreview","fileType","query","GET_PREVIEW","GOT_PREVIEW","FAILED_TO_GET_PREVIEW","uploadDynamoFile","file","formData","FormData","append","START_FILE_UPLOAD","FILE_UPLOADED","FILE_UPLOAD_FAILED","loginChat","credentials","extra","LOGIN_CHAT","emit","msg","error","isSignedUp","FAILED_TO_LOGIN_CHAT","LOGGED_IN_CHAT","sendMessage","SEND_CHAT","SENT_CHAT","FAILED_TO_SEND_CHAT","createGroup","CREATE_GROUP","CREATED_GROUP","sendFriendRequest","SEND_FRIEND_REQUEST","SENT_FRIEND_REQUEST","FAILED_TO_SEND_FRIEND_REQUEST","getContacts","GET_CONTACTS","GOT_CONTACTS","FAILED_TO_GET_CONTACTS","fetchInvites","GET_INVITES","GOT_INVITES","FAILED_TO_GET_INVITES","acceptInvite","ACCEPT_FRIEND_REQUEST","ACCEPTED_FRIEND_REQUEST","FAILED_TO_ACCEPT_FRIEND_REQUEST","rejectInvite","REJECT_FRIEND_REQUEST","REJECTED_FRIEND_REQUEST","FAILED_TO_REJECT_FRIEND_REQUEST","searchForHandle","SEARCH","FOUND","NOT_FOUND","requestType","resultType","errorType","Array","prototype","slice","call","arguments","result","authentication","username","apply","addToOpenChats","chat","ADD_TO_OPEN_CHATS","openChat","OPEN_CHAT","closeChat","CLOSE_CHAT","startReceivingMessages","openSocket","on","fn","NEW_MESSAGE","NEW_GROUP_MESSAGE","Validator","context","run","Promise","resolve","reject","props","validators","asyncValidators","reduce","current","element","valid","validatorType","VALIDATOR_TYPES","REQUIRED","hasValue","MAXLENGTH","isLessThanMaxLength","MINLENGTH","isGreaterThanMinLength","REGEX","matchesRegex","errors","push","setState","component","name","Error","Component","isPrototypeOf","LabelWrapper","Input","DatePicker","Checkbox","validComponent","DynamoInput","valueChanged","default","runValidators","runAsyncValidators","validator","validate","next","component_uid","ValidationHelper","runAsyncValidator","filter","max","min","RegExp","exp","test","Result","passThrough","React","label","isRequired","propTypes","PropTypes","func","Page","Container","mapStateToProps","_","initialProps","description","dynamo","step","currentStep","elements","steps","mode","hideSubmit","title","DynamoView","onValueChanged","submit","dynamo_view","warn","log","er","navigation","connect","Section","Header","ComponentWrapper","ComponentLocator","invariants","_validations","setValidator","all","self","extraVal","notifyExtra","sort","y","order","DynamoComponent","source","indexOf","splice","elementType","uid","forEach","ProgressBar","TextView","busy","completed","mapDispatchToProps","info","DynamoProcess","_id","fetch","fetchParams","goBack","isEqual","runProcess","Layout","DynamoSection","ProgressIndicator","ownProps","st","DynamoSelect","fetchItems","selectFirstItem","isValidValue","babelHelpers.typeof","$objectID","isObjectIdMode","_mounted","obid","updateValue","parse","customArgs","items","item","v","isEmptyOrNull","disabled","Picker","DynamoSelectSet","onPickerValueChanged","onContainerValueChanged","getPickerValue","getPickerItemsById","respondToPickerValueChanged","oneOption","getValueBasedOnMode","pickerValue","containerValidator","processor","processorArgs","_args","_onContainerValueChanged","_currentValue","shift","getItems","r","superCancel","sum","path","_p","_no_path","initialElementsData","noPath","Button","List","Modal","ErrorText","app","confirmationResult","templateCache","equivalent","arr2","isEqualWith","objValue","otherValue","findKey","isMatch","DynamoList","showModal","closeModal","edit","isDisabled","getListItemDataTemplate","confirmation","dataTemplate","listItemDataTemplateProcessor","isTemplateRef","itemTemplate","dynamo_ref","template","equal","i","behavior","ValidatorHelper","modalVisible","modalName","template_ref","clone","extension","rowTemplate","Link","NavigationActions","mapDispatchToState","navigationContext","DynamoNav","go","link","linkAndParams","getParams","paramsOnly","NAV_TYPE","CLIENT","navigate","DYNAMO","setParamsAction","setParams","firstItemIsLink","key_value","split","sp","Image","rest","replace","GRID_MODES","ITEM_MODES","ItemView","CommandsView","CommandResultView","total","fetchingGrid","filterTemplate","singleItem","fetchingSingleItem","gettingFilterTemplate","gettingTemplate","DynamoGrid","commandResultViewName","itemViewName","pageCount","showItemView","cancel","isCRUD","isEDITONLY","getItemsFromSource","done","_filterValidator","filterValueChanged","more","finished","openCommandMenu","closeCommandView","execCommand","showCommandResult","closeCommandResult","commands","commandType","cmd","unshift","filterProcessor","fetchingFilterTemplate","gridArgs","commandProcessed","processed","EDIT","fetchingItemTemplate","existingValue","methodName","count","full","submitted","NEW","createProcessor","editProcessor","console","skipFetch","_itemTemplate","createTemplate","editTemplate","fetchSingleItemProcessor","getSingleItem","fetchTemplateProcessor","filterViewName","showCommandsView","command","CRUD","EDITONLY","header","footer","templateConfig","itemViewElements","showCommandResultView","commandResult","commandProcessing","html","Uploader","Text","previews","DynamoFileUpload","_previewType","getPreviewType","_supported","isSupported","_getPreview","_query","getPreviewQuery","upload","uploadedId","supports","getPreview","preview","Filter","FilterContainer","ContentContainer","_actionState","ui","DynamoActionView","commandText","resultUI","resultData","doNothing","Label","WebView","url","Pane","OpenChats","Editor","ContextMenu","NewChatButton","OpenChatsLayout","Login","ContactList","ChatHistory","AddNewContact","PendingInvites","ChatLayout","_state","contacts","openChats","newMessage","chatHandle","chatMessageSent","busyWithChatLogin","searchResult","busyWithInvite","busyWithInvites","busyWithContacts","invites","messageDelivered","DynamoMessenger","renderChat","renderPendingInvites","openSelectContact","getMessageLayout","selectedPaneChanged","hideModal","openAddNewContact","openChatModal","_chatLayoutCommands","_chatCommands","contact","send","login","chats","messages","fetchingContacts","search","selectedPane","loggingIn","firstTimer","welcomeMessage","_panes","icon","modalTemplate","render","customDownloadCommand","DynamoCommand","commmandProcessor","commandProcessorArgs","COMMAND_TYPE","DOWNLOAD","e","commandIcon","DEFAULT","defaultMap","components","dynamo_input","dynamo_container","dynamo_process","dynamo_section","dynamo_select","dynamo_selectset","dynamo_list","dynamo_hidden","dynamo_nav","dynamo_image","dynamo_grid","dynamo_fileupload","dynamo_actionview","dynamo_htmlview","dynamo_label","dynamo_webview","dynamo_messenger","dynamo_command","recipe","customName","_defaultMap","cooked","_cooked","recipes","incoming","currentState","$nextStep","filteredGrid","gotSingleItemForGrid","errorWhileGettingSingleItemForGrid","failedToFetchGrid","reduceGrid","fetchedValue","fetchedDescription","startUpload","fileUpload","uploadFailed","gotPreview","failedToGetPreview","getTemplate","gotTemplate","failedToGetTemplate","configureTemplates","busyIndicator","propName","runThroughObj","conditions","parent","getTemplatesAndAddComponentUid","uuid","toggleAllBusyIndicators","concat","sentFriendRequest","busyWithFriendRequest","busyWithSearch","req","open","from","_openChats","_msg","to"],"mappings":"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"}